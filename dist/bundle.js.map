{"version":3,"sources":["webpack:///bundle.js","webpack:///webpack/bootstrap 2843a05effcba0c5c0e9","webpack:///external \"React\"","webpack:///../src/Utilities.ts","webpack:////src/index.ts","webpack:///../../../src/utilities/selection/interfaces.ts","webpack:///./src/Data/Model.ts","webpack:///../src/dom.ts","webpack:///../../../src/utilities/selection/index.ts","webpack:///./~/office-ui-fabric-react/lib/components/DetailsList/DetailsList.Props.ts","webpack:///../src/FocusZone.ts","webpack:///../../../src/components/GroupedList/GroupSpacer.tsx","webpack:///external \"ReactDOM\"","webpack:///../src/EventGroup.ts","webpack:///../src/Check.ts","webpack:///../src/List.ts","webpack:///../../../src/components/DetailsList/DetailsRow.scss.ts","webpack:///./src/pages.ts","webpack:///./~/office-ui-fabric-react/lib/components/FocusZone/FocusZone.Props.ts","webpack:///./~/office-ui-fabric-react/lib/components/Spinner/Spinner.Props.ts","webpack:///./src/Data/Factory.ts","webpack:///../src/Async.ts","webpack:///../src/KeyCodes.ts","webpack:///../src/object.ts","webpack:///../src/scroll.ts","webpack:///../src/Icon.ts","webpack:///../src/Link.ts","webpack:///../../../src/components/DetailsList/DetailsRow.tsx","webpack:///../../../src/components/DetailsList/DetailsRowCheck.tsx","webpack:///../../../src/components/GroupedList/GroupedList.scss.ts","webpack:///../../../src/components/Icon/IconType.ts","webpack:///../../../src/components/Layer/Layer.tsx","webpack:///../../../src/utilities/selection/SelectionLayout.ts","webpack:///./src/components/ConversationFiler.tsx","webpack:///./src/functions.ts","webpack:///./~/office-ui-fabric-react/lib/components/Image/Image.Props.ts","webpack:///./src/Data/EWSData.ts","webpack:///./src/Data/RESTData.ts","webpack:///./src/components/Feedback.tsx","webpack:///./src/components/SearchResults.tsx","webpack:///./src/components/StatusMessage.tsx","webpack:///./src/index.tsx","webpack:///../src/AutoScroll.ts","webpack:///../src/BaseComponent.ts","webpack:///../src/DelayedRender.tsx","webpack:///../src/Rectangle.ts","webpack:///../src/array.ts","webpack:///../src/autobind.ts","webpack:///../src/css.ts","webpack:///../src/focus.ts","webpack:///../src/hoist.ts","webpack:///../src/index.ts","webpack:///../src/initials.ts","webpack:///../src/math.ts","webpack:///../src/properties.ts","webpack:///../src/resources.ts","webpack:///../src/rtl.ts","webpack:///../src/scroll.scss.ts","webpack:///../src/string.ts","webpack:///../src/DetailsList.ts","webpack:///../src/Fabric.ts","webpack:///../src/GroupedList.ts","webpack:///../src/Layer.ts","webpack:///../src/Spinner.ts","webpack:///../../../src/components/Check/Check.tsx","webpack:///../../../src/components/Check/Check.scss.ts","webpack:///../../../src/components/Check/index.ts","webpack:///../../../src/components/DetailsList/DetailsHeader.tsx","webpack:///../../../src/components/DetailsList/DetailsHeader.scss.ts","webpack:///../../../src/components/DetailsList/DetailsList.tsx","webpack:///../../../src/components/DetailsList/DetailsList.scss.ts","webpack:///../../../src/components/DetailsList/DetailsRowFields.tsx","webpack:///../../../src/components/DetailsList/index.ts","webpack:///../../../src/components/Fabric/Fabric.tsx","webpack:///../../../src/components/Fabric/index.ts","webpack:///../../../src/components/FocusZone/FocusZone.tsx","webpack:///../../../src/components/FocusZone/index.ts","webpack:///../../../src/components/GroupedList/GroupFooter.tsx","webpack:///../../../src/components/GroupedList/GroupFooter.scss.ts","webpack:///../../../src/components/GroupedList/GroupHeader.tsx","webpack:///../../../src/components/GroupedList/GroupHeader.scss.ts","webpack:///../../../src/components/GroupedList/GroupSpacer.scss.ts","webpack:///../../../src/components/GroupedList/GroupedList.tsx","webpack:///../../../src/components/GroupedList/GroupedListSection.tsx","webpack:///../../../src/components/GroupedList/index.ts","webpack:///../../../src/components/Icon/Icon.tsx","webpack:///../../../src/components/Icon/Icon.scss.ts","webpack:///../../../src/components/Icon/index.ts","webpack:///../../../src/components/Image/Image.tsx","webpack:///../../../src/components/Image/Image.scss.ts","webpack:///../../../src/components/Layer/Layer.scss.ts","webpack:///../../../src/components/Layer/LayerHost.tsx","webpack:///../../../src/components/Layer/index.ts","webpack:///../../../src/components/Link/Link.tsx","webpack:///../../../src/components/Link/Link.scss.ts","webpack:///../../../src/components/Link/index.ts","webpack:///../../../src/components/List/List.tsx","webpack:///../../../src/components/List/index.ts","webpack:///../../../src/components/Spinner/Spinner.tsx","webpack:///../../../src/components/Spinner/Spinner.scss.ts","webpack:///../../../src/components/Spinner/index.ts","webpack:///../../../src/utilities/decorators/BaseDecorator.ts","webpack:///../../../src/utilities/decorators/withViewport.tsx","webpack:///../../../src/utilities/dragdrop/DragDropHelper.tsx","webpack:///../../../src/utilities/selection/Selection.ts","webpack:///../../../src/utilities/selection/SelectionZone.tsx","webpack:///./~/process/browser.js","webpack:///(webpack)/buildin/global.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","React","global","loadStyles","styles","styleParts","Array","isArray","splitStyles","undefined","_injectStylesWithCssText","shouldUseCssText","applyThemableStyles","configureLoadStyles","callback","_themeState","stylesArray","styleRecord","resolveThemableArray","registerStylesIE","registerStyles","loadTheme","theme","reloadStyles","_i","_a","registeredStyles","length","themableStyle","detokenize","splitStyleArray","resolvedCss","map","currentValue","themeSlot","themedValue","defaultValue","console","warn","rawString","join","result","pos","tokenMatch","_themeTokenRegex","exec","matchIndex","index","push","substring","lastIndex","styleArray","head","document","getElementsByTagName","styleElement","createElement","type","appendChild","createTextNode","replaceChild","lastStyleElement","stylesheet","styleSheet","lastStyleContent","cssText","lastRegisteredStyle","resolvedStyleText","MAX_STYLE_CONTENT_SIZE","apply","useCSSText","emptyStyle","_root","window","__themeState__","SELECTION_CHANGE","SelectionMode","SelectionDirection","Data","Progress","setVirtualParent","child","parent","virtualChild","virtualParent","_virtual","children","oldParent","indexOf","splice","getVirtualParent","isVirtualElement","getParent","allowVirtualParents","parentNode","elementContains","isContained","nextParent","contains","setSSR","isEnabled","_isSSR","getWindow","rootElement","ownerDocument","defaultView","getDocument","getRect","element","rect","left","top","width","innerWidth","height","innerHeight","right","bottom","getBoundingClientRect","__export","ColumnActionsMode","ConstrainMode","DetailsListLayoutMode","CheckboxVisibility","Utilities_1","GroupSpacer","props","count","className","css","root","style","ReactDOM","EventGroup","this","_id","_uniqueId","_parent","_eventRecords","raise","target","eventName","eventArgs","bubbleEvent","retVal","_isElement","createEvent","ev","initEvent","dispatchEvent","evObj","fireEvent","events","__events__","eventRecords","id","eventRecordList","listIndex","record","objectCallback","isObserved","isDeclared","declaredEvents","__declaredEvents","stopPropagation","event","cancelBubble","addEventListener","HTMLElement","dispose","_isDisposed","off","onAll","useCapture","on","_this","split","parent_1","eventRecord","elementCallback","processElementEvent","args","arguments","e","preventDefault","attachEvent","processObjectEvent","targetArrayLookup","targetArray","removeEventListener","detachEvent","declare","load_themed_styles_1","rootIsSelected","rootIsContentUnselectable","cell","isMultiline","fields","check","rootIsCheckVisible","cellMeasurer","checkSpacer","Pages","shouldHaveUI","functionsRegex","test","location","pathname","getDialogUrl","href","replace","populateDialog","storedResults","localStorage","setItem","storageKey","JSON","stringify","resetDialog","removeItem","getUIParameters","dialogRegex","onComplete","folderId","Office","context","ui","messageParent","parse","getItem","mailbox","FocusZoneDirection","SpinnerSize","SpinnerType","RESTData_1","EWSData_1","Factory","getData","restUrl","RESTData","Model","EWSData","Async","onError","_timeoutIds","_immediateIds","_intervalIds","_animationFrameIds","_onErrorHandler","_noop","clearTimeout","clearImmediate","clearInterval","cancelAnimationFrame","setTimeout","duration","timeoutId","setImmediate","immediateId","setImmediateCallback","_logError","setInterval","intervalId","throttle","func","wait","options","lastResult","lastArgs","waitMS","leading","trailing","lastExecuteTime","userCall","now","Date","getTime","delta","waitLength","debounce","maxWait","lastCallTime","isNaN","executeImmediately","maxWaitDelta","maxWaitExpired","Math","min","requestAnimationFrame","animationFrameId","animationFrameCallback","KeyCodes","process","checkProperties","a","b","propName","shallowCompare","assign","filteredAssign","concat","isAllowed","args_1","sourceObject","getId","prefix","_global","CURRENT_ID_PROPERTY","disableBodyScroll","doc","dom_1","body","_bodyScrollDisabledCount","classList","add","scroll_scss_1","default","msFabricScrollDisabled","enableBodyScroll","remove","getScrollbarWidth","_scrollbarWidth","scrollDiv","setProperty","offsetWidth","clientWidth","removeChild","findScrollableParent","startingElement","el","getAttribute","DATA_IS_SCROLLABLE_ATTRIBUTE","parentElement","styles_1","getComputedStyle","overflowY","getPropertyValue","__extends","extendStatics","setPrototypeOf","__proto__","__","constructor","create","__assign","t","DetailsList_Props_1","DetailsRowCheck_1","GroupSpacer_1","DetailsRowFields_1","FocusZone_1","interfaces_1","DetailsRow","_super","state","selectionState","_getSelectionState","columnMeasureInfo","isDropping","groupNestingDepth","_hasSetFocus","_events","_droppingClassNames","_updateDroppingState","bind","componentDidMount","dragDropHelper","_dragDropSubscription","subscribe","refs","_getRowDragDropOptions","selection","_onSelectionChanged","onDidMount","item","_hasMounted","componentDidUpdate","previousProps","itemIndex","newWidth","onMeasureDone","setState","componentWillUnmount","onWillUnmount","componentWillReceiveProps","newProps","render","columns","dragDropEvents","_b","onRenderCheck","_onRenderCheck","onRenderItemColumn","selectionMode","viewport","checkboxVisibility","getRowAriaLabel","checkButtonAriaLabel","_c","_d","isSelected","anySelected","isDraggable","Boolean","canDrag","droppingClassName","ariaLabel","canSelect","canSelectItem","isContentUnselectable","multiple","ref","role","aria-label","_e","always","data-is-focusable","data-selection-index","data-item-index","data-is-draggable","draggable","data-automationid","minWidth","aria-selected","FocusZone","direction","horizontal","none","hidden","DetailsRowFields","column","measureCell","maxWidth","calculatedWidth","focus","tabIndex","DetailsRowCheck","isIndexSelected","getSelectedCount","eventMap","eventsToRegister","selectionIndex","data","canDrop","onDragStart","updateDropState","onDrop","onDragEnd","newValue","onDragEnter","onDragLeave","Component","Check_1","selected","aria-pressed","data-selection-toggle","Check","checked","group","groupIsDropping","IconType","Fabric_1","_layersByHostId","Layer","onLayerMounted","hostId","notifyHostChanged","forEach","layer","forceUpdate","_removeLayerElement","filter","host","_getHost","_host","_layerElement","_rootElement","rootIsFixed","unstable_renderSubtreeIntoContainer","Fabric","content","onLayerDidMount","_resolveRef","onLayerWillUnmount","unmountComponentAtNode","getElementById","BaseComponent","defaultProps","SelectionLayout","_direction","getItemIndexAbove","focusIndex","items","vertical","max","getItemIndexBelow","getItemIndexLeft","getItemIndexRight","Model_1","Factory_1","StatusMessage_1","SearchResults_1","Feedback_1","ConversationFiler","onSelection","progress","Success","matches","NotFound","GetCallbackToken","getItemsAsync","results","message","Error","error","log","moveItemsAsync","StatusMessage","SearchResults","Feedback","pages_1","AppFunctions","fileDialog","notificationKey","notificationMessages","replaceAsync","MailboxEnums","ItemNotificationMessageType","ErrorMessage","completed","removeAsync","displayDialogAsync","displayInIframe","dialog","onDialogComplete","closed","close","addEventHandler","EventType","DialogMessageReceived","dialogEvent","DialogEventReceived","ProgressIndicator","register","ImageFit","ImageLoadState","RequestBuilder","getItemsRequest","messages","builder","beginRequest","itemId","changeKey","endRequest","getFolderNamesRequest","folders","folder","moveItemsRequest","findConversationRequest","excludedFolderIdsRequest","Context","loadItems","onLoadComplete","onProgress","GetConversation","makeEwsRequestAsync","conversationXml","$","parseXML","getConversation","$conversation","querySelectorAll","parents","parseInt","find","text","sameFolderItemIds","each","$this","attr","$otherFolderItemIds","otherFolderItemIds","conversation","conversationId","loadExcludedFolders","excludedFolders","loadMessages","GetExcludedFolders","foldersXml","itemsXml","getMessages","$messages","msg","querySelector","from","textContent","to","slice","loadFolderDisplayNames","folderNamesXml","getFolderDisplayNames","destinations_1","GetFolderNames","displayName","Id","BodyPreview","Sender","ToRecipients","ParentFolderId","DisplayName","moveItems","onMoveComplete","ExcludedFolders","getCallbackTokenAsync","isRest","status","AsyncResultStatus","Succeeded","collateRequests","requests","onDone","onFail","when","done","fail","getRestId","diagnostics","hostName","convertToRestId","RestVersion","v2_0","token","restConversationId","ajax","url","async","dataType","headers","Authorization","getExcludedFolders","conversationMessages","currentFolderId","excludedFolderIds","restItemId","Count","getFolderNames","folderMap","entry","EmailAddress","Name","address","method","contentType","DestinationId","DetailsList_1","Link_1","onClickFolder","onRenderLink","onRenderColumn","key","fieldName","onRender","DetailsList","evt","currentTarget","Link","onClick","functions_1","ConversationFiler_1","initialize","params","EventGroup_1","scroll_1","AutoScroll","_scrollableParent","_incrementScroll","_scrollRect","_onMouseMove","_onTouchMove","_stopScroll","_computeScrollVelocity","clientY","touches","scrollRectTop","scrollClientBottom","_scrollVelocity","_startScroll","_timeoutId","scrollTop","round","_makeAllSafe","obj","methodNames","len","_makeSafe","methodName","classMethod","prototypeMethod","errorMessage","stack","_warnDeprecation","propertyName","newPropertyName","deprecationMessage","Async_1","deprecatedProps","__disposables","_disposables","disposable","funcNameRegex","toString","__async","__events","refName","__resolves","DelayedRender","isRendered","delay","Children","only","Rectangle","equals","parseFloat","toFixed","findIndex","array","cb","createArray","size","autobind","descriptor","fn","defining","fnBound","writable","set","classes","arg","getFirstFocusable","currentElement","includeElementsInFocusZones","getNextElement","getLastFocusable","getPreviousElement","focusFirstChild","checkNode","suppressParentTraversal","traverseChildren","isCurrentElementVisible","isElementVisible","isElementFocusZone","childMatch","lastElementChild","isElementTabbable","siblingMatch","previousElementSibling","suppressChildTraversal","firstElementChild","nextElementSibling","visibilityAttribute","IS_VISIBLE_ATTRIBUTE","offsetHeight","offsetParent","isVisible","disabled","isFocusableAttribute","IS_FOCUSABLE_ATTRIBUTE","tagName","FOCUSZONE_ID_ATTRIBUTE","doesElementContainFocus","currentActiveElement","activeElement","hoistMethods","destination","source","exclusions","REACT_LIFECYCLE_EXCLUSIONS","hoisted","unhoistMethods","getInitialsArabic","isRtl","getInitialsAsian","substr","getInitialsLatin","initials","splits","charAt","toUpperCase","cleanupDisplayName","CHARS_WITHIN_PARENTHESIS_REGEX","UNICODE_ALPHANUMERIC_CHARS_REGEX","MULTIPLE_WHITESPACES_REGEX_TOKEN","trim","getInitials","ARABIC_LANGUAGE_REGEX","KOREAN_LANGUAGE_REGEX","CHINESE_LANGUAGE_REGEX","RegExp","getDistanceBetweenPoints","point1","point2","sqrt","pow","x","y","getNativeProps","allowedPropNames","excludedPropNames","object_1","baseElementEvents","baseElementProperties","htmlElementProperties","anchorProperties","buttonProperties","divProperties","inputProperties","textAreaProperties","imageProperties","getResourceUrl","_baseUrl","setBaseUrl","baseUrl","getLanguage","getRTL","_isRTL","documentElement","setRTL","isRTL","setAttribute","getRTLSafeKeyCode","KeyCodes_1","format","replace_func","match","replacement","FORMAT_ARGS_REGEX","values","FORMAT_REGEX","shouldComponentUpdate","isChecked","rootIsChecked","background","__decorate","decorators","desc","r","getOwnPropertyDescriptor","Reflect","decorate","SelectAllVisibility","Icon_1","Layer_1","DetailsHeader","columnResizeDetails","isAllCollapsed","_onToggleCollapseAll","_onSelectAllClicked","_onRootMouseDown","ariaLabelForSelectAllCheckbox","selectAllVisibility","isAllSelected","isSizing","rootIsAllSelected","rootIsSelectAllHidden","onMouseMove","_onRootMouseMove","cellWrapper","visible","cellIsCheck","Icon","collapseButton","collapseButtonIsCollapsed","iconName","columnIndex","aria-sort","isSorted","isSortedDescending","columnActionsMode","headerClassName","cellIsActionable","cellIsEmpty","isGrouped","isFiltered","_onColumnClick","onContextMenu","_onColumnContextMenu","aria-haspopup","hasDropdown","data-item-key","nearIcon","iconClassName","filterChevron","data-sizer-index","cellIsSizer","cellIsResizing","onDoubleClick","_onSizerDoubleClick","sizingOverlay","_onSizerMouseMove","onMouseUp","_onSizerMouseUp","focusZone","onColumnAutoResized","toggleAllSelected","columnIndexAttr","Number","button","columnMinWidth","originX","clientX","buttons","onColumnIsSizingChanged","onColumnResized","movement","onColumnClick","onColumnContextMenu","onToggleCollapseAll","newCollapsed","isSelectAllVisible","buildColumns","canResizeColumns","sortedColumnKey","groupedColumnKey","firstItem","MIN_COLUMN_WIDTH","isCollapsable","isRowHeader","clickable","isResizable","DetailsHeader_1","DetailsRow_1","GroupedList_1","List_1","withViewport_1","index_1","DragDropHelper_1","_activeRows","_columnOverrides","_onColumnIsSizingChanged","_onColumnResized","_onColumnAutoResized","_onRowDidMount","_onRowWillUnmount","_onToggleCollapse","_onActiveRowChanged","_onHeaderKeyDown","_onContentKeyDown","_onRenderCell","_onGroupExpandStateChanged","lastWidth","adjustedColumns","_getAdjustedColumns","layoutMode","isCollapsed","groupProps","isAllGroupsCollapsed","isSomeGroupExpanded","_selection","Selection","onSelectionChanged","getKey","setItems","_dragDropHelper","DragDropHelper","_initialFocusedIndex","initialFocusedIndex","prevProps","prevState","onDidUpdate","setKey","shouldResetSelection","shouldForceUpdates","_adjustColumns","_forceListUpdates","ariaLabelForListHeader","constrainMode","groups","isHeaderVisible","onItemInvoked","onItemContextMenu","onColumnHeaderClick","onColumnHeaderContextMenu","selectionPreservedOnEmptyClick","ariaLabelForGrid","rowElementEventMap","shouldApplyApplicationRole","_getGroupNestingDepth","additionalListProps","renderedWindowsAhead","renderedWindowsBehind","single","isCollapsedGroupSelectVisible","headerProps","is-fixed","fixedColumns","rootIsHorizontalConstrained","horizontalConstrained","data-is-scrollable","onKeyDown","isInnerZoneKeystroke","which","onActiveElementChanged","SelectionZone","GroupedList","onRenderCell","listProps","onGroupExpandStateChanged","List","_onRenderRow","defaultRender","nestingDepth","onRenderMissingItem","onRenderRow","down","up","header","level","groupsInLevel","row","onRowDidMount","selectionZone","ignoreNextFocus","onRowWillUnmount","collapsed","groupedList","toggleCollapseAll","list","viewportWidth","newColumns","newItems","lastSelectionMode","_getFixedColumns","_getJustifiedColumns","newColumn","rowCheckWidth","groupExpandWidth","totalWidth","availableWidth","DEFAULT_INNER_PADDING","spaceLeft","increment","resizingColumn","newCalculatedWidth","onColumnResize","totalCount","keys","currentRow","onActiveItemChanged","justified","onHover","withViewport","_getState","cellContent","is-multiline","data-automation-key","_getCellText","DIRECTIONAL_KEY_CODES","home","end","tab","pageUp","pageDown","_lastIsFocusVisible","isFocusVisible","_onMouseDown","_onKeyDown","rootClass","is-focusVisible","FocusZone_Props_1","_allInstances","ALLOWED_INPUT_TYPES","rootProps","_focusAlignment","windowElement","nodeType","_isInnerZone","_onKeyDownCapture","_updateTabIndexes","defaultActiveElement","_activeElement","ariaLabelledBy","divProps","data-focuszone-id","aria-labelledby","onFocus","_onFocus","onMouseDownCapture","firstChild","focusElement","onBeforeFocus","_setFocusAlignment","_isImmediateDescendantOfZone","path","pop","isDefaultPrevented","innerZone","_getFirstInnerZone","altKey","space","_tryInvokeClickForFocusable","_moveFocusLeft","_moveFocusRight","_moveFocusUp","_moveFocusDown","lastChild","enter","_moveFocus","isForward","getDistanceFromCenter","candidateElement","candidateDistance","changedFocus","isBidirectional","bidirectional","_isElementInput","_shouldInputLoseFocus","activeRect","targetRect","elementDistance","isCircularNavigation","targetTop","leftAlignment","distance","targetRectTop","floor","activeRectBottom","abs","targetRectBottom","activeRectTop","topAlignment","isHorizontal","isVertical","top_1","childNodes","childIndex","toLowerCase","selectionStart","selectionEnd","isRangeSelected","inputValue","GroupFooter","groupLevel","showAllLinkText","_onSummarizeClick","onToggleSummarize","Spinner_1","GroupHeader","isLoadingVisible","isGroupLoading","newLoadingVisible","loadingText","canSelectGroup","isSelectionCheckVisible","currentlySelected","_onHeaderClick","_onToggleSelectGroupClick","dropIcon","expand","expandIsCollapsed","title","hasMoreData","loading","loadingIsVisible","Spinner","label","onToggleCollapse","onToggleSelectGroup","onGroupHeaderClick","GroupedListSection_1","_isSomeGroupExpanded","_computeIsSomeGroupExpanded","_renderGroup","getItemCountForPage","allCollapsed","groupIndex","_updateIsSomeGroupExpanded","dividerProps","_onToggleSelectGroup","_onToggleSummarize","footerProps","GroupedListSection","_getGroupKey","getGroupItemLimit","onRenderGroupHeader","onRenderHeader","onRenderGroupFooter","onRenderFooter","String","toggleRangeSelected","startIndex","groupCount","forceListUpdate","isShowingAll","some","newIsSomeGroupExpanded","GroupFooter_1","GroupHeader_1","Utilities_2","_subGroups","_getGroupDragDropOptions","_onSelectionChange","_onRenderGroupHeader","_onRenderGroupFooter","renderCount","Infinity","isFooterVisible","hasNestedGroups","groupHeaderProps","groupFooterProps","_getDroppingClassName","_renderSubGroup","_onRenderGroup","subGroupCount","subGroup","subGroupIndex","isGroup","newIsDropping","IconType_1","Image_1","customIcon","iconType","Image","containerClassName","imageContainer","imageProps","CoverStyle","Image_Props_1","CoverStyleMap","landscape","imageIsLandscape","portrait","imageIsPortrait","ImageFitMap","center","imageIsCenter","contain","imageIsContain","cover","imageIsCover","imageIsNone","_coverStyle","loadState","notLoaded","nextProps","src","loaded","_computeCoverStyle","_checkImageLoaded","onLoadingStateChange","alt","shouldFadeIn","imageFit","maximizeFrame","coverStyle","shouldStartVisible","rootIsMaximizeFrame","onLoad","_onImageLoaded","_onImageError","image","is-fadeIn","is-notLoaded","imageIsLoaded","imageIsScaleWidth","imageIsScaleHeight","imageIsScaleWidthHeight","_imageElement","naturalWidth","naturalHeight","complete","_svgRegex","desiredRatio","_frameElement","clientHeight","naturalRatio","LayerHost","is-disabled","isDisabled","_onClick","_link","_expandRect","pagesBefore","pagesAfter","_isContainedWithin","innerRect","outerRect","_mergeRect","newRect","RESIZE_DELAY","MIN_SCROLL_UPDATE_DELAY","MAX_SCROLL_UPDATE_DELAY","IDLE_DEBOUNCE_DELAY","EMPTY_RECT","_measurePageRect","_measureSurfaceRect","_measureScrollRect","pages","_estimatedPageHeight","_totalEstimates","_requiredWindowsAhead","_requiredWindowsBehind","_measureVersion","_onAsyncScroll","_async","_onAsyncIdle","_onAsyncResize","_cachedPageHeights","_focusedIndex","_scrollingToIndex","scrollToIndex","measureItem","_getRenderCount","endIndex","itemsPerPage","_getItemCountForPage","_allowedRect","itemPositionWithinPage","itemIndexInPage","scrollBottom","scrollRect","_scrollElement","scrollWindow","itemIsPartiallyAbove","itemIsPartiallyBelow","_getPageHeight","_surfaceRect","_updatePages","_onScroll","newState","oldPages","newPages","measureVersion","oldPage","newPage","itemCount","_updateRenderRects","pageElements","_renderPage","page","cells","pageStyle","_getPageStyle","itemKey","data-list-index","getPageStyle","surface","indexString","_materializedRect","_requiredRect","requiredWindowsAhead","requiredWindowsBehind","windowsAhead","windowsBehind","newListState","_buildPages","oldListPages","_updatePageMeasurements","_hasCompletedFirstRender","renderedIndexes","heightChanged","_measurePage","_onPageAdded","_onPageRemoved","hasChangedHeight","pageElement","cachedHeight","newClientRect","onPageAdded","onPageRemoved","materializedRect","pageTop","currentSpacer","focusedIndex","isFirstRender","getPageHeight","this_1","pageHeight","pageBottom","isPageRendered","isPageInAllowedRange","isPageInRequiredRange","isPageVisible","isPageFocused","isFirstPage","itemsInPage","_createPage","visibleRect","visibileRect","pageKey","surfaceRect","visibleTop","containsFocus","Spinner_Props_1","circle","circleIsXSmall","xSmall","circleIsSmall","small","circleIsMedium","medium","circleIsLarge","large","circleIsTypeMedium","normal","circleIsTypeLarge","spinAnimation","BaseDecorator","_updateComposedComponentRef","composedComponentInstance","_composedComponentInstance","_hoisted","ComposedComponent","WithViewportComponent","_updateViewport","isViewportVisible","minHeight","withForceUpdate","viewportElement","scrollElement","clientRect","updateComponent","BaseDecorator_1","_dragEnterCounts","_activeTargets","_lastId","_onMouseUp","_onDocumentMouseUp","dragDropOptions","onDragOver","onMouseDown","isDroppable","activeTarget","handlers","context_1","updateDropState_1","dragDropTarget","_isDraggable","_isDroppable","eventMap_1","event_1","handler","isHandled","_onDragEnd","handlers_1","unsubscribe","_isDragging","_dragData","dropTarget","_isChild","xDiff","yDiff","dragTarget","getSelection","_onMouseLeave","eventTarget","findDOMNode","childElement","dragContext","_changeEventSuppressionCount","_exemptedCount","_anchoredIndex","_unselectableCount","setChangeEvents","suppressChange","_hasChanged","_change","shouldClear","newKeyToIndexMap","newUnselectableIndices","hasSelectionChanged","setAllSelected","newExemptedIndicies","indexProperty","_exemptedIndices","_items","exemptKey","newIndex","_keyToIndexMap","_unselectableIndices","getItems","_selectedItems","_isAllSelected","fromIndex","selectableCount","isKeySelected","_updateCount","setKeySelected","shouldAnchor","setIndexSelected","isExempt","hasChanged","selectToKey","clearSelection","selectToIndex","anchorIndex","toggleKeySelected","toggleIndexSelected","SelectionLayout_1","win","_updateModifiers","_tryClearOnEmptyClick","_onDoubleClick","_onContextMenu","_onMouseDownCapture","onFocusCapture","_shouldHandleFocus","isToggleModifierPressed","_isCtrlPressed","_isMetaPressed","isToggle","_hasAttribute","itemRoot","_findItemRoot","_getItemIndex","_onItemSurfaceClick","_onInvokeMouseDown","_isSelectionDisabled","_onToggleAllClick","_isShiftPressed","_onToggleClick","_onInvokeClick","nativeEvent","_isInputElement","isSelectAllKey","isClearSelectionKey","escape","_clearAndSelectIndex","_isNonHandledClick","shiftKey","ctrlKey","metaKey","indexValue","attributeName","layout","isMultiSelectEnabled","isSelectedOnFocus","defaultSetTimout","defaultClearTimeout","runTimeout","fun","cachedSetTimeout","runClearTimeout","marker","cachedClearTimeout","cleanUpNextTick","draining","currentQueue","queue","queueIndex","drainQueue","timeout","run","Item","noop","nextTick","browser","env","argv","version","versions","addListener","once","removeListener","removeAllListeners","emit","binding","cwd","chdir","dir","umask","g","Function","eval"],"mappings":"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ACA,eACA,eACA,cACA,aACA,cACA,YACA,mBACA,WACA,gBACA,aACA,cACA,eACA,WACA,WAGWj0B,EAAAk0B,uBACX,iBACA,eACA,SACA,gBACA,YACA,SACA,kBACA,oBACA,MACA,QACA,eACA,YACA,WACA,UACA,cACA,cACA,UACA,YACA,UACA,WACA,UACA,YACA,OACA,UACA,UACA,kBACA,cACA,WACA,SACA,cACA,OACA,WACA,UACA,QACA,MACA,WACA,YACA,UACA,OACA,aACA,cACA,aACA,iBACA,aACA,cACA,UACA,SACA,SACA,OACA,WACA,UACA,YACA,OACA,KACA,YACA,YACA,KACA,YACA,UACA,OACA,QACA,OACA,OACA,OACA,MACA,WACA,eACA,cACA,MACA,YACA,QACA,aACA,SACA,MACA,YACA,WACA,QACA,OACA,aACA,OACA,UACA,UACA,cACA,SACA,UACA,aACA,WACA,MACA,WACA,OACA,OACA,UACA,UACA,QACA,SACA,YACA,WACA,WACA,QACA,OACA,QACA,OACA,aACA,MACA,SACA,UACA,SACA,QACA,OACA,QACA,UACA,WACA,QACA,OACA,SACA,QACA,QACA,QACA,QAGWl0B,EAAAm0B,sBAAwBn0B,EAAAk0B,sBAAsB9f,OAAOpU,EAAAi0B,mBAErDj0B,EAAAo0B,iBAAmBp0B,EAAAm0B,sBAAsB/f,QACpD,OACA,WAGWpU,EAAAq0B,iBAAmBr0B,EAAAm0B,sBAAsB/f,QACpD,aAGWpU,EAAAs0B,cAAgBt0B,EAAAm0B,sBAAsB/f,QAAQ,QAAS,WAEvDpU,EAAAu0B,gBAAkBv0B,EAAAq0B,iBAElBr0B,EAAAw0B,mBAAqBx0B,EAAAq0B,iBAErBr0B,EAAAy0B,gBAAkBz0B,EAAAs0B,cAc/Bt0B,EAAA6zB,kBtDo7HM,SAAU5zB,EAAQD,EAASH,GAEjC,YuDrpIA,SAAA60B,GAA+BxL,GAC7B,MAAOyL,GAAWzL,EAIpB,QAAA0L,GAA2BC,GACzBF,EAAWE,EAIb,QAAAC,KACE,MAAO,QvD4oITl0B,OAAOC,eAAeb,EAAS,cAAgBO,OAAO,Gu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","file":"bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 39);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports) {\n\nmodule.exports = React;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(49));\n\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(global) {/**\n * An IThemingInstruction can specify a rawString to be preserved or a theme slot and a default value\n * to use if that slot is not specified by the theme.\n */\n\n// IE needs to inject styles using cssText. However, we need to evaluate this lazily, so this\n// value will initialize as undefined, and later will be set once on first loadStyles injection.\nvar _injectStylesWithCssText;\n// Store the theming state in __themeState__ global scope for reuse in the case of duplicate\n// load-themed-styles hosted on the page.\nvar _root = (typeof window === 'undefined') ? global : window; // tslint:disable-line:no-any\nvar _themeState = _root.__themeState__ = _root.__themeState__ || {\n    theme: undefined,\n    lastStyleElement: undefined,\n    registeredStyles: []\n};\n/**\n * Matches theming tokens. For example, \"[theme: themeSlotName, default: #FFF]\" (including the quotes).\n */\n/* tslint:disable: max-line-length */\nvar _themeTokenRegex = /[\\'\\\"]\\[theme:\\s*(\\w+)\\s*(?:\\,\\s*default:\\s*([\\\\\"\\']?[\\.\\,\\(\\)\\#\\-\\s\\w]*[\\.\\,\\(\\)\\#\\-\\w][\\\"\\']?))?\\s*\\][\\'\\\"]/g;\n/* tslint:enable: max-line-length */\n/** Maximum style text length, for supporting IE style restrictions. */\nvar MAX_STYLE_CONTENT_SIZE = 10000;\n/**\n * Loads a set of style text. If it is registered too early, we will register it when the window.load\n * event is fired.\n * @param {string | ThemableArray} styles Themable style text to register.\n */\nfunction loadStyles(styles) {\n    var styleParts = Array.isArray(styles) ? styles : splitStyles(styles);\n    if (_injectStylesWithCssText === undefined) {\n        _injectStylesWithCssText = shouldUseCssText();\n    }\n    applyThemableStyles(styleParts);\n}\nexports.loadStyles = loadStyles;\n/**\n * Allows for customizable loadStyles logic. e.g. for server side rendering application\n * @param {(styles: string) => void} a loadStyles callback that gets called when styles are loaded or reloaded\n */\nfunction configureLoadStyles(callback) {\n    _themeState.loadStyles = callback;\n}\nexports.configureLoadStyles = configureLoadStyles;\n/**\n * Loads a set of style text. If it is registered too early, we will register it when the window.load event\n * is fired.\n * @param {string} styleText Style to register.\n * @param {IStyleRecord} styleRecord Existing style record to re-apply.\n */\nfunction applyThemableStyles(stylesArray, styleRecord) {\n    if (_themeState.loadStyles) {\n        var styles = resolveThemableArray(stylesArray);\n        _themeState.loadStyles(styles);\n    }\n    else {\n        _injectStylesWithCssText ?\n            registerStylesIE(stylesArray, styleRecord) :\n            registerStyles(stylesArray, styleRecord);\n    }\n}\n/**\n * Registers a set theme tokens to find and replace. If styles were already registered, they will be\n * replaced.\n * @param {theme} theme JSON object of theme tokens to values.\n */\nfunction loadTheme(theme) {\n    _themeState.theme = theme;\n    // reload styles.\n    reloadStyles();\n}\nexports.loadTheme = loadTheme;\n/**\n * Reloads styles.\n */\nfunction reloadStyles() {\n    if (_themeState.theme) {\n        for (var _i = 0, _a = _themeState.registeredStyles; _i < _a.length; _i++) {\n            var styleRecord = _a[_i];\n            applyThemableStyles(styleRecord.themableStyle, styleRecord);\n        }\n    }\n}\n/**\n * Find theme tokens and replaces them with provided theme values.\n * @param {string} styles Tokenized styles to fix.\n */\nfunction detokenize(styles) {\n    if (styles) {\n        styles = resolveThemableArray(splitStyles(styles));\n    }\n    return styles;\n}\nexports.detokenize = detokenize;\n/**\n * Resolves ThemingInstruction objects in an array and joins the result into a string.\n * @param {ThemableArray} splitStyleArray ThemableArray to resolve and join.\n */\nfunction resolveThemableArray(splitStyleArray) {\n    var theme = _themeState.theme;\n    var resolvedCss;\n    if (splitStyleArray) {\n        // Resolve the array of theming instructions to an array of strings.\n        // Then join the array to produce the final CSS string.\n        var resolvedArray = splitStyleArray.map(function (currentValue) {\n            var themeSlot = currentValue.theme;\n            if (themeSlot) {\n                // A theming annotation. Resolve it.\n                var themedValue = theme ? theme[themeSlot] : undefined;\n                var defaultValue = currentValue.defaultValue;\n                // Warn to console if we hit an unthemed value even when themes are provided.\n                // Allow the themedValue to be undefined to explicitly request the default value.\n                if (theme && !themedValue && console && !(themeSlot in theme)) {\n                    /* tslint:disable: max-line-length */\n                    console.warn(\"Theming value not provided for \\\"\" + themeSlot + \"\\\". Falling back to \\\"\" + (defaultValue || 'inherit') + \"\\\".\");\n                }\n                return themedValue || defaultValue || 'inherit';\n            }\n            else {\n                // A non-themable string. Preserve it.\n                return currentValue.rawString;\n            }\n        });\n        resolvedCss = resolvedArray.join('');\n    }\n    return resolvedCss;\n}\n/**\n * Split tokenized CSS into an array of strings and theme specification objects\n * @param {string} styles Tokenized styles to split.\n */\nfunction splitStyles(styles) {\n    var result = [];\n    if (styles) {\n        var pos = 0; // Current position in styles.\n        var tokenMatch = void 0;\n        while (tokenMatch = _themeTokenRegex.exec(styles)) {\n            var matchIndex = tokenMatch.index;\n            if (matchIndex > pos) {\n                result.push({\n                    rawString: styles.substring(pos, matchIndex)\n                });\n            }\n            result.push({\n                theme: tokenMatch[1],\n                defaultValue: tokenMatch[2] // May be undefined\n            });\n            // index of the first character after the current match\n            pos = _themeTokenRegex.lastIndex;\n        }\n        // Push the rest of the string after the last match.\n        result.push({\n            rawString: styles.substring(pos)\n        });\n    }\n    return result;\n}\nexports.splitStyles = splitStyles;\n/**\n * Registers a set of style text. If it is registered too early, we will register it when the\n * window.load event is fired.\n * @param {ThemableArray} styleArray Array of IThemingInstruction objects to register.\n * @param {IStyleRecord} styleRecord May specify a style Element to update.\n */\nfunction registerStyles(styleArray, styleRecord) {\n    var head = document.getElementsByTagName('head')[0];\n    var styleElement = document.createElement('style');\n    styleElement.type = 'text/css';\n    styleElement.appendChild(document.createTextNode(resolveThemableArray(styleArray)));\n    if (styleRecord) {\n        head.replaceChild(styleElement, styleRecord.styleElement);\n        styleRecord.styleElement = styleElement;\n    }\n    else {\n        head.appendChild(styleElement);\n    }\n    if (!styleRecord) {\n        _themeState.registeredStyles.push({\n            styleElement: styleElement,\n            themableStyle: styleArray\n        });\n    }\n}\n/**\n * Registers a set of style text, for IE 9 and below, which has a ~30 style element limit so we need\n * to register slightly differently.\n * @param {ThemableArray} styleArray Array of IThemingInstruction objects to register.\n * @param {IStyleRecord} styleRecord May specify a style Element to update.\n */\nfunction registerStylesIE(styleArray, styleRecord) {\n    var head = document.getElementsByTagName('head')[0];\n    var lastStyleElement = _themeState.lastStyleElement, registeredStyles = _themeState.registeredStyles;\n    var stylesheet = lastStyleElement ? lastStyleElement.styleSheet : undefined;\n    var lastStyleContent = stylesheet ? stylesheet.cssText : '';\n    var lastRegisteredStyle = registeredStyles[registeredStyles.length - 1];\n    var resolvedStyleText = resolveThemableArray(styleArray);\n    if (!lastStyleElement || (lastStyleContent.length + resolvedStyleText.length) > MAX_STYLE_CONTENT_SIZE) {\n        lastStyleElement = document.createElement('style');\n        lastStyleElement.type = 'text/css';\n        if (styleRecord) {\n            head.replaceChild(lastStyleElement, styleRecord.styleElement);\n            styleRecord.styleElement = lastStyleElement;\n        }\n        else {\n            head.appendChild(lastStyleElement);\n        }\n        if (!styleRecord) {\n            lastRegisteredStyle = {\n                styleElement: lastStyleElement,\n                themableStyle: styleArray\n            };\n            registeredStyles.push(lastRegisteredStyle);\n        }\n    }\n    lastStyleElement.styleSheet.cssText += detokenize(resolvedStyleText);\n    Array.prototype.push.apply(lastRegisteredStyle.themableStyle, styleArray); // concat in-place\n    // Preserve the theme state.\n    _themeState.lastStyleElement = lastStyleElement;\n}\n/**\n * Checks to see if styleSheet exists as a property off of a style element.\n * This will determine if style registration should be done via cssText (<= IE9) or not\n */\nfunction shouldUseCssText() {\n    var useCSSText = false;\n    if (typeof document !== 'undefined') {\n        var emptyStyle = document.createElement('style');\n        emptyStyle.type = 'text/css';\n        useCSSText = !!emptyStyle.styleSheet;\n    }\n    return useCSSText;\n}\n\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(105)))\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SELECTION_CHANGE = 'change';\nvar SelectionMode;\n(function (SelectionMode) {\n    SelectionMode[SelectionMode[\"none\"] = 0] = \"none\";\n    SelectionMode[SelectionMode[\"single\"] = 1] = \"single\";\n    SelectionMode[SelectionMode[\"multiple\"] = 2] = \"multiple\";\n})(SelectionMode = exports.SelectionMode || (exports.SelectionMode = {}));\nvar SelectionDirection;\n(function (SelectionDirection) {\n    SelectionDirection[SelectionDirection[\"horizontal\"] = 0] = \"horizontal\";\n    SelectionDirection[SelectionDirection[\"vertical\"] = 1] = \"vertical\";\n})(SelectionDirection = exports.SelectionDirection || (exports.SelectionDirection = {}));\n\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Data;\r\n(function (Data) {\r\n    var Progress;\r\n    (function (Progress) {\r\n        Progress[Progress[\"GetCallbackToken\"] = 0] = \"GetCallbackToken\";\r\n        Progress[Progress[\"GetConversation\"] = 1] = \"GetConversation\";\r\n        Progress[Progress[\"GetExcludedFolders\"] = 2] = \"GetExcludedFolders\";\r\n        Progress[Progress[\"GetFolderNames\"] = 3] = \"GetFolderNames\";\r\n        Progress[Progress[\"Success\"] = 4] = \"Success\";\r\n        Progress[Progress[\"NotFound\"] = 5] = \"NotFound\";\r\n        Progress[Progress[\"Error\"] = 6] = \"Error\";\r\n    })(Progress = Data.Progress || (Data.Progress = {}));\r\n})(Data = exports.Data || (exports.Data = {}));\r\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Sets the virtual parent of an element.\n * Pass `undefined` as the `parent` to clear the virtual parent.\n *\n * @export\n * @param {HTMLElement} child\n * @param {HTMLElement} parent\n */\nfunction setVirtualParent(child, parent) {\n    var virtualChild = child;\n    var virtualParent = parent;\n    if (!virtualChild._virtual) {\n        virtualChild._virtual = {\n            children: []\n        };\n    }\n    var oldParent = virtualChild._virtual.parent;\n    if (oldParent && oldParent !== parent) {\n        // Remove the child from its old parent.\n        var index = oldParent._virtual.children.indexOf(virtualChild);\n        if (index > -1) {\n            oldParent._virtual.children.splice(index, 1);\n        }\n    }\n    virtualChild._virtual.parent = virtualParent || undefined;\n    if (virtualParent) {\n        if (!virtualParent._virtual) {\n            virtualParent._virtual = {\n                children: []\n            };\n        }\n        virtualParent._virtual.children.push(virtualChild);\n    }\n}\nexports.setVirtualParent = setVirtualParent;\nfunction getVirtualParent(child) {\n    var parent;\n    if (child && isVirtualElement(child)) {\n        parent = child._virtual.parent;\n    }\n    return parent;\n}\nexports.getVirtualParent = getVirtualParent;\n/**\n * Gets the element which is the parent of a given element.\n * If `allowVirtuaParents` is `true`, this method prefers the virtual parent over\n * real DOM parent when present.\n *\n * @export\n * @param {HTMLElement} child\n * @param {boolean} [allowVirtualParents=true]\n * @returns {HTMLElement}\n */\nfunction getParent(child, allowVirtualParents) {\n    if (allowVirtualParents === void 0) { allowVirtualParents = true; }\n    return child && (allowVirtualParents && getVirtualParent(child) ||\n        child.parentNode && child.parentNode);\n}\nexports.getParent = getParent;\n/**\n * Determines whether or not a parent element contains a given child element.\n * If `allowVirtualParents` is true, this method may return `true` if the child\n * has the parent in its virtual element hierarchy.\n *\n * @export\n * @param {HTMLElement} parent\n * @param {HTMLElement} child\n * @param {boolean} [allowVirtualParents=true]\n * @returns {boolean}\n */\nfunction elementContains(parent, child, allowVirtualParents) {\n    if (allowVirtualParents === void 0) { allowVirtualParents = true; }\n    var isContained = false;\n    if (parent && child) {\n        if (allowVirtualParents) {\n            isContained = false;\n            while (child) {\n                var nextParent = getParent(child);\n                if (nextParent === parent) {\n                    isContained = true;\n                    break;\n                }\n                child = nextParent;\n            }\n        }\n        else if (parent.contains) {\n            isContained = parent.contains(child);\n        }\n    }\n    return isContained;\n}\nexports.elementContains = elementContains;\nvar _isSSR = false;\n/** Helper to set ssr mode to simulate no window object returned from getWindow helper. */\nfunction setSSR(isEnabled) {\n    _isSSR = isEnabled;\n}\nexports.setSSR = setSSR;\n/** Helper to get the window object. */\nfunction getWindow(rootElement) {\n    if (_isSSR) {\n        return undefined;\n    }\n    else {\n        return (rootElement &&\n            rootElement.ownerDocument &&\n            rootElement.ownerDocument.defaultView ?\n            rootElement.ownerDocument.defaultView :\n            window);\n    }\n}\nexports.getWindow = getWindow;\n/** Helper to get the document object. */\nfunction getDocument(rootElement) {\n    if (_isSSR) {\n        return undefined;\n    }\n    else {\n        return rootElement && rootElement.ownerDocument ? rootElement.ownerDocument : document;\n    }\n}\nexports.getDocument = getDocument;\n/** Helper to get bounding client rect, works with window. */\nfunction getRect(element) {\n    var rect;\n    if (element) {\n        if (element === window) {\n            rect = {\n                left: 0,\n                top: 0,\n                width: window.innerWidth,\n                height: window.innerHeight,\n                right: window.innerWidth,\n                bottom: window.innerHeight\n            };\n        }\n        else if (element.getBoundingClientRect) {\n            rect = element.getBoundingClientRect();\n        }\n    }\n    return rect;\n}\nexports.getRect = getRect;\n/**\n * Determines whether or not an element has the virtual hierarchy extension.\n *\n * @param {(HTMLElement | IVirtualElement)} element\n * @returns {element is IVirtualElement}\n */\nfunction isVirtualElement(element) {\n    return element && !!element._virtual;\n}\n\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(3));\n__export(__webpack_require__(102));\n__export(__webpack_require__(30));\n__export(__webpack_require__(103));\n\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Enum to describe how a particular column header behaves.... This enum is used to\r\n * to specify the property IColumn:columnActionsMode.\r\n * If IColumn:columnActionsMode is undefined, then it's equivalent to ColumnActionsMode.clickable\r\n */\r\nvar ColumnActionsMode;\r\n(function (ColumnActionsMode) {\r\n    /**\r\n     * Renders the column header as disabled.\r\n     */\r\n    ColumnActionsMode[ColumnActionsMode[\"disabled\"] = 0] = \"disabled\";\r\n    /**\r\n     * Renders the column header is clickable.\r\n     */\r\n    ColumnActionsMode[ColumnActionsMode[\"clickable\"] = 1] = \"clickable\";\r\n    /**\r\n     * Renders the column header ias clickable and displays the dropdown cheveron.\r\n     */\r\n    ColumnActionsMode[ColumnActionsMode[\"hasDropdown\"] = 2] = \"hasDropdown\";\r\n})(ColumnActionsMode = exports.ColumnActionsMode || (exports.ColumnActionsMode = {}));\r\nvar ConstrainMode;\r\n(function (ConstrainMode) {\r\n    /** If specified, lets the content grow which allows the page to manage scrolling. */\r\n    ConstrainMode[ConstrainMode[\"unconstrained\"] = 0] = \"unconstrained\";\r\n    /**\r\n     * If specified, constrains the list to the given layout space.\r\n     */\r\n    ConstrainMode[ConstrainMode[\"horizontalConstrained\"] = 1] = \"horizontalConstrained\";\r\n})(ConstrainMode = exports.ConstrainMode || (exports.ConstrainMode = {}));\r\nvar DetailsListLayoutMode;\r\n(function (DetailsListLayoutMode) {\r\n    /**\r\n     * Lets the user resize columns and makes not attempt to fit them.\r\n     */\r\n    DetailsListLayoutMode[DetailsListLayoutMode[\"fixedColumns\"] = 0] = \"fixedColumns\";\r\n    /**\r\n     * Manages which columns are visible, tries to size them according to their min/max rules and drops\r\n     * off columns that can't fit and have isCollapsable set.\r\n     */\r\n    DetailsListLayoutMode[DetailsListLayoutMode[\"justified\"] = 1] = \"justified\";\r\n})(DetailsListLayoutMode = exports.DetailsListLayoutMode || (exports.DetailsListLayoutMode = {}));\r\nvar CheckboxVisibility;\r\n(function (CheckboxVisibility) {\r\n    /**\r\n     * Visible on hover.\r\n     */\r\n    CheckboxVisibility[CheckboxVisibility[\"onHover\"] = 0] = \"onHover\";\r\n    /**\r\n     * Visible always.\r\n     */\r\n    CheckboxVisibility[CheckboxVisibility[\"always\"] = 1] = \"always\";\r\n    /**\r\n     * Hide checkboxes.\r\n     */\r\n    CheckboxVisibility[CheckboxVisibility[\"hidden\"] = 2] = \"hidden\";\r\n})(CheckboxVisibility = exports.CheckboxVisibility || (exports.CheckboxVisibility = {}));\r\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(74));\n\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/* tslint:disable:no-unused-variable */\nvar React = __webpack_require__(0);\n/* tslint:enable:no-unused-variable */\nvar Utilities_1 = __webpack_require__(1);\nvar styles = __webpack_require__(79);\nvar SPACER_WIDTH = 36;\nexports.GroupSpacer = function (props) {\n    return props.count > 0 && (React.createElement(\"span\", { className: Utilities_1.css('ms-GroupSpacer', styles.root), style: { width: props.count * SPACER_WIDTH } }));\n};\n\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports) {\n\nmodule.exports = ReactDOM;\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* tslint:disable:no-string-literal */\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/** An instance of EventGroup allows anything with a handle to it to trigger events on it.\n *  If the target is an HTMLElement, the event will be attached to the element and can be\n *  triggered as usual (like clicking for onclick).\n *  The event can be triggered by calling EventGroup.raise() here. If the target is an\n *  HTMLElement, the event gets raised and is handled by the browser. Otherwise, it gets\n *  handled here in EventGroup, and the handler is called in the context of the parent\n *  (which is passed in in the constructor).\n */\nvar EventGroup = (function () {\n    /** parent: the context in which events attached to non-HTMLElements are called */\n    function EventGroup(parent) {\n        this._id = EventGroup._uniqueId++;\n        this._parent = parent;\n        this._eventRecords = [];\n    }\n    /** For IE8, bubbleEvent is ignored here and must be dealt with by the handler.\n     *  Events raised here by default have bubbling set to false and cancelable set to true.\n     *  This applies also to built-in events being raised manually here on HTMLElements,\n     *  which may lead to unexpected behavior if it differs from the defaults.\n     */\n    EventGroup.raise = function (target, eventName, eventArgs, bubbleEvent) {\n        var retVal;\n        if (EventGroup._isElement(target)) {\n            if (document.createEvent) {\n                var ev = document.createEvent('HTMLEvents');\n                ev.initEvent(eventName, bubbleEvent, true);\n                ev['args'] = eventArgs;\n                retVal = target.dispatchEvent(ev);\n            }\n            else if (document['createEventObject']) {\n                var evObj = document['createEventObject'](eventArgs);\n                // cannot set cancelBubble on evObj, fireEvent will overwrite it\n                target.fireEvent('on' + eventName, evObj);\n            }\n        }\n        else {\n            while (target && retVal !== false) {\n                var events = target.__events__;\n                var eventRecords = events ? events[eventName] : null;\n                for (var id in eventRecords) {\n                    if (eventRecords.hasOwnProperty(id)) {\n                        var eventRecordList = eventRecords[id];\n                        for (var listIndex = 0; retVal !== false && listIndex < eventRecordList.length; listIndex++) {\n                            var record = eventRecordList[listIndex];\n                            if (record.objectCallback) {\n                                retVal = record.objectCallback.call(record.parent, eventArgs);\n                            }\n                        }\n                    }\n                }\n                // If the target has a parent, bubble the event up.\n                target = bubbleEvent ? target.parent : null;\n            }\n        }\n        return retVal;\n    };\n    EventGroup.isObserved = function (target, eventName) {\n        var events = target && target.__events__;\n        return !!events && !!events[eventName];\n    };\n    /** Check to see if the target has declared support of the given event. */\n    EventGroup.isDeclared = function (target, eventName) {\n        var declaredEvents = target && target.__declaredEvents;\n        return !!declaredEvents && !!declaredEvents[eventName];\n    };\n    EventGroup.stopPropagation = function (event) {\n        if (event.stopPropagation) {\n            event.stopPropagation();\n        }\n        else {\n            event.cancelBubble = true;\n        }\n    };\n    EventGroup._isElement = function (target) {\n        return !!target && (target.addEventListener || target instanceof HTMLElement);\n    };\n    EventGroup.prototype.dispose = function () {\n        if (!this._isDisposed) {\n            this._isDisposed = true;\n            this.off();\n            this._parent = null;\n        }\n    };\n    /** On the target, attach a set of events, where the events object is a name to function mapping. */\n    EventGroup.prototype.onAll = function (target, events, useCapture) {\n        for (var eventName in events) {\n            if (events.hasOwnProperty(eventName)) {\n                this.on(target, eventName, events[eventName], useCapture);\n            }\n        }\n    };\n    /** On the target, attach an event whose handler will be called in the context of the parent\n     * of this instance of EventGroup.\n     */\n    EventGroup.prototype.on = function (target, eventName, callback, useCapture) {\n        var _this = this;\n        if (eventName.indexOf(',') > -1) {\n            var events = eventName.split(/[ ,]+/);\n            for (var i = 0; i < events.length; i++) {\n                this.on(target, events[i], callback, useCapture);\n            }\n        }\n        else {\n            var parent_1 = this._parent;\n            var eventRecord = {\n                target: target,\n                eventName: eventName,\n                parent: parent_1,\n                callback: callback,\n                objectCallback: null,\n                elementCallback: null,\n                useCapture: useCapture\n            };\n            // Initialize and wire up the record on the target, so that it can call the callback if the event fires.\n            var events = (target.__events__ = target.__events__ || {});\n            events[eventName] = events[eventName] || {\n                count: 0\n            };\n            events[eventName][this._id] = events[eventName][this._id] || [];\n            events[eventName][this._id].push(eventRecord);\n            events[eventName].count++;\n            if (EventGroup._isElement(target)) {\n                var processElementEvent = function () {\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i] = arguments[_i];\n                    }\n                    if (_this._isDisposed) {\n                        return;\n                    }\n                    var result;\n                    try {\n                        result = callback.apply(parent_1, args);\n                        if (result === false && args[0]) {\n                            var e = args[0];\n                            if (e.preventDefault) {\n                                e.preventDefault();\n                            }\n                            if (e.stopPropagation) {\n                                e.stopPropagation();\n                            }\n                            e.cancelBubble = true;\n                        }\n                    }\n                    catch (e) {\n                        /* ErrorHelper.log(e); */\n                    }\n                    return result;\n                };\n                eventRecord.elementCallback = processElementEvent;\n                if (target.addEventListener) {\n                    /* tslint:disable:ban-native-functions */\n                    target.addEventListener(eventName, processElementEvent, useCapture);\n                    /* tslint:enable:ban-native-functions */\n                }\n                else if (target.attachEvent) {\n                    target.attachEvent('on' + eventName, processElementEvent);\n                }\n            }\n            else {\n                var processObjectEvent = function () {\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i] = arguments[_i];\n                    }\n                    if (_this._isDisposed) {\n                        return;\n                    }\n                    return callback.apply(parent_1, args);\n                };\n                eventRecord.objectCallback = processObjectEvent;\n            }\n            // Remember the record locally, so that it can be removed.\n            this._eventRecords.push(eventRecord);\n        }\n    };\n    EventGroup.prototype.off = function (target, eventName, callback, useCapture) {\n        for (var i = 0; i < this._eventRecords.length; i++) {\n            var eventRecord = this._eventRecords[i];\n            if ((!target || target === eventRecord.target) &&\n                (!eventName || eventName === eventRecord.eventName) &&\n                (!callback || callback === eventRecord.callback) &&\n                ((typeof useCapture !== 'boolean') || useCapture === eventRecord.useCapture)) {\n                var events = eventRecord.target.__events__;\n                var targetArrayLookup = events[eventRecord.eventName];\n                var targetArray = targetArrayLookup ? targetArrayLookup[this._id] : null;\n                // We may have already target's entries, so check for null.\n                if (targetArray) {\n                    if (targetArray.length === 1 || !callback) {\n                        targetArrayLookup.count -= targetArray.length;\n                        delete events[eventRecord.eventName][this._id];\n                    }\n                    else {\n                        targetArrayLookup.count--;\n                        targetArray.splice(targetArray.indexOf(eventRecord), 1);\n                    }\n                    if (!targetArrayLookup.count) {\n                        delete events[eventRecord.eventName];\n                    }\n                }\n                if (eventRecord.elementCallback) {\n                    if (eventRecord.target.removeEventListener) {\n                        eventRecord.target.removeEventListener(eventRecord.eventName, eventRecord.elementCallback, eventRecord.useCapture);\n                    }\n                    else if (eventRecord.target.detachEvent) {\n                        eventRecord.target.detachEvent('on' + eventRecord.eventName, eventRecord.elementCallback);\n                    }\n                }\n                this._eventRecords.splice(i--, 1);\n            }\n        }\n    };\n    /** Trigger the given event in the context of this instance of EventGroup. */\n    EventGroup.prototype.raise = function (eventName, eventArgs, bubbleEvent) {\n        return EventGroup.raise(this._parent, eventName, eventArgs, bubbleEvent);\n    };\n    /** Declare an event as being supported by this instance of EventGroup. */\n    EventGroup.prototype.declare = function (event) {\n        var declaredEvents = this._parent.__declaredEvents = this._parent.__declaredEvents || {};\n        if (typeof event === 'string') {\n            declaredEvents[event] = true;\n        }\n        else {\n            for (var i = 0; i < event.length; i++) {\n                declaredEvents[event[i]] = true;\n            }\n        }\n    };\n    return EventGroup;\n}());\nEventGroup._uniqueId = 0;\nexports.EventGroup = EventGroup;\n\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(64));\n\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(95));\n\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/* tslint:disable */\nvar load_themed_styles_1 = __webpack_require__(2);\nvar styles = {\n    root: 'root_05ed2f61',\n    rootIsSelected: 'rootIsSelected_05ed2f61',\n    rootIsContentUnselectable: 'rootIsContentUnselectable_05ed2f61',\n    cell: 'cell_05ed2f61',\n    isMultiline: 'isMultiline_05ed2f61',\n    fields: 'fields_05ed2f61',\n    check: 'check_05ed2f61',\n    rootIsCheckVisible: 'rootIsCheckVisible_05ed2f61',\n    cellMeasurer: 'cellMeasurer_05ed2f61',\n    checkSpacer: 'checkSpacer_05ed2f61',\n};\nload_themed_styles_1.loadStyles([{ \"rawString\": \".root_05ed2f61{display:inline-block;min-width:100%;min-height:36px;margin:1px 0;vertical-align:top;white-space:nowrap;padding:0;box-sizing:border-box;background:0 0;border:none;vertical-align:top;line-height:16px}.root_05ed2f61::-moz-focus-inner{border:0}.root_05ed2f61{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .root_05ed2f61:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid \" }, { \"theme\": \"neutralSecondary\", \"defaultValue\": \"#666666\" }, { \"rawString\": \"}html[dir=ltr] .root_05ed2f61{text-align:left}html[dir=rtl] .root_05ed2f61{text-align:right}.root_05ed2f61:hover{background:\" }, { \"theme\": \"neutralLighter\", \"defaultValue\": \"#f4f4f4\" }, { \"rawString\": \"}.rootIsSelected_05ed2f61{background:\" }, { \"theme\": \"neutralQuaternary\", \"defaultValue\": \"#d0d0d0\" }, { \"rawString\": \"}.rootIsSelected_05ed2f61:hover{background:\" }, { \"theme\": \"neutralQuaternaryAlt\", \"defaultValue\": \"#dadada\" }, { \"rawString\": \"}.rootIsContentUnselectable_05ed2f61{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.cell_05ed2f61{display:inline-block;position:relative;box-sizing:border-box;padding:10px 0;margin:0 8px;min-height:36px;vertical-align:top;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.isMultiline_05ed2f61{white-space:normal;word-break:break-word;text-overflow:clip}.fields_05ed2f61{display:inline-block}.check_05ed2f61{display:inline-block;cursor:default;padding:6px;box-sizing:border-box;vertical-align:top;background:0 0;border:none;opacity:0}.check_05ed2f61::-moz-focus-inner{border:0}.check_05ed2f61{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .check_05ed2f61:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid \" }, { \"theme\": \"neutralSecondary\", \"defaultValue\": \"#666666\" }, { \"rawString\": \"}.rootIsCheckVisible_05ed2f61 .check_05ed2f61,.rootIsSelected_05ed2f61 .check_05ed2f61,.root_05ed2f61:hover .check_05ed2f61{opacity:1}.cellMeasurer_05ed2f61 .cell_05ed2f61{overflow:visible;white-space:nowrap}.checkSpacer_05ed2f61{display:inline-block;height:20px;width:20px}\" }]);\nmodule.exports = styles;\n/* tslint:enable */ \n\n\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/// <reference path=\"../node_modules/@types/office-js/index.d.ts\" />\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Pages;\r\n(function (Pages) {\r\n    var functionsRegex = /\\/functions\\.html(\\?.*)?$/i;\r\n    var dialogRegex = /\\/dialog\\.html(\\?.*)?$/i;\r\n    var storageKey = \"conversationFilerMatches\";\r\n    function shouldHaveUI() {\r\n        return !functionsRegex.test(window.location.pathname);\r\n    }\r\n    Pages.shouldHaveUI = shouldHaveUI;\r\n    function getDialogUrl() {\r\n        return window.location.href.replace(functionsRegex, \"/dialog.html\");\r\n    }\r\n    Pages.getDialogUrl = getDialogUrl;\r\n    function populateDialog(storedResults) {\r\n        window.localStorage.setItem(storageKey, JSON.stringify(storedResults));\r\n    }\r\n    Pages.populateDialog = populateDialog;\r\n    function resetDialog() {\r\n        window.localStorage.removeItem(storageKey);\r\n    }\r\n    Pages.resetDialog = resetDialog;\r\n    function getUIParameters() {\r\n        if (dialogRegex.test(window.location.pathname)) {\r\n            return {\r\n                onComplete: function (folderId) { Office.context.ui.messageParent(folderId); },\r\n                storedResults: JSON.parse(window.localStorage.getItem(storageKey))\r\n            };\r\n        }\r\n        else {\r\n            return {\r\n                mailbox: Office.context.mailbox,\r\n            };\r\n        }\r\n    }\r\n    Pages.getUIParameters = getUIParameters;\r\n})(Pages = exports.Pages || (exports.Pages = {}));\r\n\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar FocusZoneDirection;\r\n(function (FocusZoneDirection) {\r\n    /** Only react to up/down arrows. */\r\n    FocusZoneDirection[FocusZoneDirection[\"vertical\"] = 0] = \"vertical\";\r\n    /** Only react to left/right arrows. */\r\n    FocusZoneDirection[FocusZoneDirection[\"horizontal\"] = 1] = \"horizontal\";\r\n    /** React to all arrows. */\r\n    FocusZoneDirection[FocusZoneDirection[\"bidirectional\"] = 2] = \"bidirectional\";\r\n})(FocusZoneDirection = exports.FocusZoneDirection || (exports.FocusZoneDirection = {}));\r\n\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar SpinnerSize;\r\n(function (SpinnerSize) {\r\n    /**\r\n     * 12px Spinner diameter\r\n     */\r\n    SpinnerSize[SpinnerSize[\"xSmall\"] = 0] = \"xSmall\";\r\n    /**\r\n     * 16px Spinner diameter\r\n     */\r\n    SpinnerSize[SpinnerSize[\"small\"] = 1] = \"small\";\r\n    /**\r\n     * 20px Spinner diameter\r\n     */\r\n    SpinnerSize[SpinnerSize[\"medium\"] = 2] = \"medium\";\r\n    /**\r\n     * 28px Spinner diameter\r\n     */\r\n    SpinnerSize[SpinnerSize[\"large\"] = 3] = \"large\";\r\n})(SpinnerSize = exports.SpinnerSize || (exports.SpinnerSize = {}));\r\n/**\r\n * @deprecated\r\n * Deprecated and will be removed at >= 2.0.0. Use SpinnerSize instead.\r\n */\r\nvar SpinnerType;\r\n(function (SpinnerType) {\r\n    /**\r\n     * Deprecated and will be removed at >= 2.0.0. Use SpinnerSize.medium instead.\r\n     */\r\n    SpinnerType[SpinnerType[\"normal\"] = 0] = \"normal\";\r\n    /**\r\n     * Deprecated and will be removed at >= 2.0.0. Use SpinnerSize.large instead.\r\n     */\r\n    SpinnerType[SpinnerType[\"large\"] = 1] = \"large\";\r\n})(SpinnerType = exports.SpinnerType || (exports.SpinnerType = {}));\r\n\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/// <reference path=\"../../node_modules/@types/office-js/index.d.ts\" />\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar RESTData_1 = __webpack_require__(35);\r\nvar EWSData_1 = __webpack_require__(34);\r\nvar Factory;\r\n(function (Factory) {\r\n    // Use the RESTData provider if possible, but if it's not supported, fallback to the EWSData provider\r\n    function getData(mailbox) {\r\n        return mailbox.restUrl\r\n            ? new RESTData_1.RESTData.Model(mailbox)\r\n            : new EWSData_1.EWSData.Model(mailbox);\r\n    }\r\n    Factory.getData = getData;\r\n})(Factory = exports.Factory || (exports.Factory = {}));\r\n\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\n * Bugs often appear in async code when stuff gets disposed, but async operations don't get canceled.\n * This Async helper class solves these issues by tying async code to the lifetime of a disposable object.\n *\n * Usage: Anything class extending from BaseModel can access this helper via this.async. Otherwise create a\n * new instance of the class and remember to call dispose() during your code's dispose handler.\n */\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Async = (function () {\n    function Async(parent, onError) {\n        this._timeoutIds = null;\n        this._immediateIds = null;\n        this._intervalIds = null;\n        this._animationFrameIds = null;\n        this._isDisposed = false;\n        this._parent = parent || null;\n        this._onErrorHandler = onError;\n        this._noop = function () { };\n    }\n    /**\n     * Dispose function, clears all async operations.\n     */\n    Async.prototype.dispose = function () {\n        var id;\n        this._isDisposed = true;\n        this._parent = null;\n        // Clear timeouts.\n        if (this._timeoutIds) {\n            for (id in this._timeoutIds) {\n                if (this._timeoutIds.hasOwnProperty(id)) {\n                    this.clearTimeout(id);\n                }\n            }\n            this._timeoutIds = null;\n        }\n        // Clear immediates.\n        if (this._immediateIds) {\n            for (id in this._immediateIds) {\n                if (this._immediateIds.hasOwnProperty(id)) {\n                    this.clearImmediate(id);\n                }\n            }\n            this._immediateIds = null;\n        }\n        // Clear intervals.\n        if (this._intervalIds) {\n            for (id in this._intervalIds) {\n                if (this._intervalIds.hasOwnProperty(id)) {\n                    this.clearInterval(id);\n                }\n            }\n            this._intervalIds = null;\n        }\n        // Clear animation frames.\n        if (this._animationFrameIds) {\n            for (id in this._animationFrameIds) {\n                if (this._animationFrameIds.hasOwnProperty(id)) {\n                    this.cancelAnimationFrame(id);\n                }\n            }\n            this._animationFrameIds = null;\n        }\n    };\n    /**\n     * SetTimeout override, which will auto cancel the timeout during dispose.\n     * @param callback Callback to execute.\n     * @param duration Duration in milliseconds.\n     * @return The setTimeout id.\n     */\n    Async.prototype.setTimeout = function (callback, duration) {\n        var _this = this;\n        var timeoutId = 0;\n        if (!this._isDisposed) {\n            if (!this._timeoutIds) {\n                this._timeoutIds = {};\n            }\n            /* tslint:disable:ban-native-functions */\n            timeoutId = setTimeout(function () {\n                // Time to execute the timeout, enqueue it as a foreground task to be executed.\n                try {\n                    // Now delete the record and call the callback.\n                    delete _this._timeoutIds[timeoutId];\n                    callback.apply(_this._parent);\n                }\n                catch (e) {\n                    if (_this._onErrorHandler) {\n                        _this._onErrorHandler(e);\n                    }\n                }\n            }, duration);\n            /* tslint:enable:ban-native-functions */\n            this._timeoutIds[timeoutId] = true;\n        }\n        return timeoutId;\n    };\n    /**\n     * Clears the timeout.\n     * @param id Id to cancel.\n     */\n    Async.prototype.clearTimeout = function (id) {\n        if (this._timeoutIds && this._timeoutIds[id]) {\n            /* tslint:disable:ban-native-functions */\n            clearTimeout(id);\n            delete this._timeoutIds[id];\n            /* tslint:enable:ban-native-functions */\n        }\n    };\n    /**\n     * SetImmediate override, which will auto cancel the immediate during dispose.\n     * @param callback Callback to execute.\n     * @return The setTimeout id.\n     */\n    Async.prototype.setImmediate = function (callback) {\n        var _this = this;\n        var immediateId = 0;\n        if (!this._isDisposed) {\n            if (!this._immediateIds) {\n                this._immediateIds = {};\n            }\n            /* tslint:disable:ban-native-functions */\n            var setImmediateCallback = function () {\n                // Time to execute the timeout, enqueue it as a foreground task to be executed.\n                try {\n                    // Now delete the record and call the callback.\n                    delete _this._immediateIds[immediateId];\n                    callback.apply(_this._parent);\n                }\n                catch (e) {\n                    _this._logError(e);\n                }\n            };\n            immediateId = window.setImmediate ? window.setImmediate(setImmediateCallback) : window.setTimeout(setImmediateCallback, 0);\n            /* tslint:enable:ban-native-functions */\n            this._immediateIds[immediateId] = true;\n        }\n        return immediateId;\n    };\n    /**\n     * Clears the immediate.\n     * @param id Id to cancel.\n     */\n    Async.prototype.clearImmediate = function (id) {\n        if (this._immediateIds && this._immediateIds[id]) {\n            /* tslint:disable:ban-native-functions */\n            window.clearImmediate ? window.clearImmediate(id) : window.clearTimeout(id);\n            delete this._immediateIds[id];\n            /* tslint:enable:ban-native-functions */\n        }\n    };\n    /**\n     * SetInterval override, which will auto cancel the timeout during dispose.\n     * @param callback Callback to execute.\n     * @param duration Duration in milliseconds.\n     * @return The setTimeout id.\n     */\n    Async.prototype.setInterval = function (callback, duration) {\n        var _this = this;\n        var intervalId = 0;\n        if (!this._isDisposed) {\n            if (!this._intervalIds) {\n                this._intervalIds = {};\n            }\n            /* tslint:disable:ban-native-functions */\n            intervalId = setInterval(function () {\n                // Time to execute the interval callback, enqueue it as a foreground task to be executed.\n                try {\n                    callback.apply(_this._parent);\n                }\n                catch (e) {\n                    _this._logError(e);\n                }\n            }, duration);\n            /* tslint:enable:ban-native-functions */\n            this._intervalIds[intervalId] = true;\n        }\n        return intervalId;\n    };\n    /**\n     * Clears the interval.\n     * @param id Id to cancel.\n     */\n    Async.prototype.clearInterval = function (id) {\n        if (this._intervalIds && this._intervalIds[id]) {\n            /* tslint:disable:ban-native-functions */\n            clearInterval(id);\n            delete this._intervalIds[id];\n            /* tslint:enable:ban-native-functions */\n        }\n    };\n    /**\n     * Creates a function that, when executed, will only call the func function at most once per\n     * every wait milliseconds. Provide an options object to indicate that func should be invoked\n     * on the leading and/or trailing edge of the wait timeout. Subsequent calls to the throttled\n     * function will return the result of the last func call.\n     *\n     * Note: If leading and trailing options are true func will be called on the trailing edge of\n     * the timeout only if the the throttled function is invoked more than once during the wait timeout.\n     *\n     * @param func The function to throttle.\n     * @param wait The number of milliseconds to throttle executions to. Defaults to 0.\n     * @param options The options object.\n     * @param options.leading Specify execution on the leading edge of the timeout.\n     * @param options.trailing Specify execution on the trailing edge of the timeout.\n     * @return The new throttled function.\n     */\n    Async.prototype.throttle = function (func, wait, options) {\n        var _this = this;\n        if (this._isDisposed) {\n            return this._noop;\n        }\n        var waitMS = wait || 0;\n        var leading = true;\n        var trailing = true;\n        var lastExecuteTime = 0;\n        var lastResult;\n        var lastArgs;\n        var timeoutId = null;\n        if (options && typeof (options.leading) === 'boolean') {\n            leading = options.leading;\n        }\n        if (options && typeof (options.trailing) === 'boolean') {\n            trailing = options.trailing;\n        }\n        var callback = function (userCall) {\n            var now = (new Date).getTime();\n            var delta = now - lastExecuteTime;\n            var waitLength = leading ? waitMS - delta : waitMS;\n            if (delta >= waitMS && (!userCall || leading)) {\n                lastExecuteTime = now;\n                if (timeoutId) {\n                    _this.clearTimeout(timeoutId);\n                    timeoutId = null;\n                }\n                lastResult = func.apply(_this._parent, lastArgs);\n            }\n            else if (timeoutId === null && trailing) {\n                timeoutId = _this.setTimeout(callback, waitLength);\n            }\n            return lastResult;\n        };\n        var resultFunction = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            lastArgs = args;\n            return callback(true);\n        };\n        return resultFunction;\n    };\n    /**\n     * Creates a function that will delay the execution of func until after wait milliseconds have\n     * elapsed since the last time it was invoked. Provide an options object to indicate that func\n     * should be invoked on the leading and/or trailing edge of the wait timeout. Subsequent calls\n     * to the debounced function will return the result of the last func call.\n     *\n     * Note: If leading and trailing options are true func will be called on the trailing edge of\n     * the timeout only if the the debounced function is invoked more than once during the wait\n     * timeout.\n     *\n     * @param func The function to debounce.\n     * @param wait The number of milliseconds to delay.\n     * @param options The options object.\n     * @param options.leading Specify execution on the leading edge of the timeout.\n     * @param options.maxWait The maximum time func is allowed to be delayed before it's called.\n     * @param options.trailing Specify execution on the trailing edge of the timeout.\n     * @return The new debounced function.\n     */\n    Async.prototype.debounce = function (func, wait, options) {\n        var _this = this;\n        if (this._isDisposed) {\n            return this._noop;\n        }\n        var waitMS = wait || 0;\n        var leading = false;\n        var trailing = true;\n        var maxWait = null;\n        var lastCallTime = 0;\n        var lastExecuteTime = (new Date).getTime();\n        var lastResult;\n        var lastArgs;\n        var timeoutId = null;\n        if (options && typeof (options.leading) === 'boolean') {\n            leading = options.leading;\n        }\n        if (options && typeof (options.trailing) === 'boolean') {\n            trailing = options.trailing;\n        }\n        if (options && typeof (options.maxWait) === 'number' && !isNaN(options.maxWait)) {\n            maxWait = options.maxWait;\n        }\n        var callback = function (userCall) {\n            var now = (new Date).getTime();\n            var executeImmediately = false;\n            if (userCall) {\n                if (leading && now - lastCallTime >= waitMS) {\n                    executeImmediately = true;\n                }\n                lastCallTime = now;\n            }\n            var delta = now - lastCallTime;\n            var waitLength = waitMS - delta;\n            var maxWaitDelta = now - lastExecuteTime;\n            var maxWaitExpired = false;\n            if (maxWait !== null) {\n                // maxWait only matters when there is a pending callback\n                if (maxWaitDelta >= maxWait && timeoutId) {\n                    maxWaitExpired = true;\n                }\n                else {\n                    waitLength = Math.min(waitLength, maxWait - maxWaitDelta);\n                }\n            }\n            if (delta >= waitMS || maxWaitExpired || executeImmediately) {\n                if (timeoutId) {\n                    _this.clearTimeout(timeoutId);\n                    timeoutId = null;\n                }\n                lastExecuteTime = now;\n                lastResult = func.apply(_this._parent, lastArgs);\n            }\n            else if ((timeoutId === null || !userCall) && trailing) {\n                timeoutId = _this.setTimeout(callback, waitLength);\n            }\n            return lastResult;\n        };\n        var resultFunction = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            lastArgs = args;\n            return callback(true);\n        };\n        return resultFunction;\n    };\n    Async.prototype.requestAnimationFrame = function (callback) {\n        var _this = this;\n        var animationFrameId = 0;\n        if (!this._isDisposed) {\n            if (!this._animationFrameIds) {\n                this._animationFrameIds = {};\n            }\n            /* tslint:disable:ban-native-functions */\n            var animationFrameCallback = function () {\n                try {\n                    // Now delete the record and call the callback.\n                    delete _this._animationFrameIds[animationFrameId];\n                    callback.apply(_this._parent);\n                }\n                catch (e) {\n                    _this._logError(e);\n                }\n            };\n            animationFrameId = window.requestAnimationFrame ?\n                window.requestAnimationFrame(animationFrameCallback) :\n                window.setTimeout(animationFrameCallback, 0);\n            /* tslint:enable:ban-native-functions */\n            this._animationFrameIds[animationFrameId] = true;\n        }\n        return animationFrameId;\n    };\n    Async.prototype.cancelAnimationFrame = function (id) {\n        if (this._animationFrameIds && this._animationFrameIds[id]) {\n            /* tslint:disable:ban-native-functions */\n            window.cancelAnimationFrame ? window.cancelAnimationFrame(id) : window.clearTimeout(id);\n            /* tslint:enable:ban-native-functions */\n            delete this._animationFrameIds[id];\n        }\n    };\n    Async.prototype._logError = function (e) {\n        if (this._onErrorHandler) {\n            this._onErrorHandler(e);\n        }\n    };\n    return Async;\n}());\nexports.Async = Async;\n\n\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar KeyCodes;\n(function (KeyCodes) {\n    KeyCodes[KeyCodes[\"a\"] = 65] = \"a\";\n    KeyCodes[KeyCodes[\"backspace\"] = 8] = \"backspace\";\n    KeyCodes[KeyCodes[\"comma\"] = 188] = \"comma\";\n    KeyCodes[KeyCodes[\"del\"] = 46] = \"del\";\n    KeyCodes[KeyCodes[\"down\"] = 40] = \"down\";\n    KeyCodes[KeyCodes[\"end\"] = 35] = \"end\";\n    KeyCodes[KeyCodes[\"enter\"] = 13] = \"enter\";\n    KeyCodes[KeyCodes[\"escape\"] = 27] = \"escape\";\n    KeyCodes[KeyCodes[\"home\"] = 36] = \"home\";\n    KeyCodes[KeyCodes[\"left\"] = 37] = \"left\";\n    KeyCodes[KeyCodes[\"pageDown\"] = 34] = \"pageDown\";\n    KeyCodes[KeyCodes[\"pageUp\"] = 33] = \"pageUp\";\n    KeyCodes[KeyCodes[\"right\"] = 39] = \"right\";\n    KeyCodes[KeyCodes[\"semicolon\"] = 186] = \"semicolon\";\n    KeyCodes[KeyCodes[\"space\"] = 32] = \"space\";\n    KeyCodes[KeyCodes[\"tab\"] = 9] = \"tab\";\n    KeyCodes[KeyCodes[\"up\"] = 38] = \"up\";\n})(KeyCodes = exports.KeyCodes || (exports.KeyCodes = {}));\n\n\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(process) {\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// Initialize global window id.\nvar CURRENT_ID_PROPERTY = '__currentId__';\nvar _global = (typeof window !== 'undefined' && window) || process;\nif (_global[CURRENT_ID_PROPERTY] === undefined) {\n    _global[CURRENT_ID_PROPERTY] = 0;\n}\nfunction checkProperties(a, b) {\n    for (var propName in a) {\n        if (a.hasOwnProperty(propName)) {\n            if (!b.hasOwnProperty(propName) || (b[propName] !== a[propName])) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n// Compare a to b and b to a\nfunction shallowCompare(a, b) {\n    return checkProperties(a, b) && checkProperties(b, a);\n}\nexports.shallowCompare = shallowCompare;\n/**\n * Makes a resulting merge of a bunch of objects. Pass in the target object followed by 1 or more\n * objects as arguments and they will be merged sequentially into the target. Note that this will\n * shallow merge; it will not create new cloned values for target members.\n *\n * @params target {Object} Target object to merge following object arguments into.\n * @params args {Object} One or more objects that will be mixed into the target in the order they are provided.\n * @returns Resulting merged target.\n */\nfunction assign(target) {\n    var args = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n    }\n    return filteredAssign.apply(this, [null, target].concat(args));\n}\nexports.assign = assign;\n/**\n * Makes a resulting merge of a bunch of objects, but allows a filter function to be passed in to filter\n * the resulting merges. This allows for scenarios where you want to merge \"everything except that one thing\"\n * or \"properties that start with data-\". Note that this will shallow merge; it will not create new cloned\n * values for target members.\n *\n * @params filteredAssign {Function} A callback function that tests if the property should be assigned.\n * @params target {Object} Target object to merge following object arguments into.\n * @params args {Object} One or more objects that will be mixed into the target in the order they are provided.\n * @returns Resulting merged target.\n */\nfunction filteredAssign(isAllowed, target) {\n    var args = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        args[_i - 2] = arguments[_i];\n    }\n    target = target || {};\n    for (var _a = 0, args_1 = args; _a < args_1.length; _a++) {\n        var sourceObject = args_1[_a];\n        if (sourceObject) {\n            for (var propName in sourceObject) {\n                if (sourceObject.hasOwnProperty(propName) &&\n                    !isAllowed || isAllowed(propName)) {\n                    target[propName] = sourceObject[propName];\n                }\n            }\n        }\n    }\n    return target;\n}\nexports.filteredAssign = filteredAssign;\n/** Generates a unique id in the global scope (this spans across duplicate copies of the same library.) */\nfunction getId(prefix) {\n    var index = _global[CURRENT_ID_PROPERTY]++;\n    return (prefix || '') + index;\n}\nexports.getId = getId;\n\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(104)))\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar dom_1 = __webpack_require__(5);\nvar scroll_scss_1 = __webpack_require__(55);\nvar _scrollbarWidth;\nvar _bodyScrollDisabledCount = 0;\nexports.DATA_IS_SCROLLABLE_ATTRIBUTE = 'data-is-scrollable';\nfunction disableBodyScroll() {\n    var doc = dom_1.getDocument();\n    if (doc && doc.body && !_bodyScrollDisabledCount) {\n        doc.body.classList.add(scroll_scss_1.default.msFabricScrollDisabled);\n    }\n    _bodyScrollDisabledCount++;\n}\nexports.disableBodyScroll = disableBodyScroll;\nfunction enableBodyScroll() {\n    if (_bodyScrollDisabledCount > 0) {\n        var doc = dom_1.getDocument();\n        if (doc && doc.body && _bodyScrollDisabledCount === 1) {\n            doc.body.classList.remove(scroll_scss_1.default.msFabricScrollDisabled);\n        }\n        _bodyScrollDisabledCount--;\n    }\n}\nexports.enableBodyScroll = enableBodyScroll;\n/** Calculates the width of a scrollbar for the browser/os. */\nfunction getScrollbarWidth() {\n    if (_scrollbarWidth === undefined) {\n        var scrollDiv = document.createElement('div');\n        scrollDiv.style.setProperty('width', '100px');\n        scrollDiv.style.setProperty('height', '100px');\n        scrollDiv.style.setProperty('overflow', 'scroll');\n        scrollDiv.style.setProperty('position', 'absolute');\n        scrollDiv.style.setProperty('top', '-9999px');\n        document.body.appendChild(scrollDiv);\n        // Get the scrollbar width\n        _scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n        // Delete the DIV\n        document.body.removeChild(scrollDiv);\n    }\n    return _scrollbarWidth;\n}\nexports.getScrollbarWidth = getScrollbarWidth;\n/**\n * Traverses up the DOM for the element with the data-is-scrollable=true attribute, or returns\n * document.body.\n */\nfunction findScrollableParent(startingElement) {\n    var el = startingElement;\n    // First do a quick scan for the scrollable attribute.\n    while (el && el !== document.body) {\n        if (el.getAttribute(exports.DATA_IS_SCROLLABLE_ATTRIBUTE) === 'true') {\n            return el;\n        }\n        el = el.parentElement;\n    }\n    // If we haven't found it, the use the slower method: compute styles to evaluate if overflow is set.\n    el = startingElement;\n    while (el && el !== document.body) {\n        if (el.getAttribute(exports.DATA_IS_SCROLLABLE_ATTRIBUTE) !== 'false') {\n            var styles_1 = getComputedStyle(el);\n            var overflowY = styles_1 ? styles_1.getPropertyValue('overflow-y') : '';\n            if (overflowY && (overflowY === 'scroll' || overflowY === 'auto')) {\n                return el;\n            }\n        }\n        el = el.parentElement;\n    }\n    // Fall back to window scroll.\n    if (!el || el === document.body) {\n        el = window;\n    }\n    return el;\n}\nexports.findScrollableParent = findScrollableParent;\n\n\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(85));\n\n\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(93));\n\n\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar DetailsList_Props_1 = __webpack_require__(7);\nvar DetailsRowCheck_1 = __webpack_require__(26);\nvar GroupSpacer_1 = __webpack_require__(9);\nvar DetailsRowFields_1 = __webpack_require__(69);\nvar FocusZone_1 = __webpack_require__(8);\nvar interfaces_1 = __webpack_require__(3);\nvar styles = __webpack_require__(14);\nvar DEFAULT_DROPPING_CSS_CLASS = 'is-dropping';\nvar DetailsRow = (function (_super) {\n    __extends(DetailsRow, _super);\n    function DetailsRow(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = {\n            selectionState: _this._getSelectionState(props),\n            columnMeasureInfo: null,\n            isDropping: false,\n            groupNestingDepth: props.groupNestingDepth\n        };\n        _this._hasSetFocus = false;\n        _this._events = new Utilities_1.EventGroup(_this);\n        _this._droppingClassNames = '';\n        _this._updateDroppingState = _this._updateDroppingState.bind(_this);\n        return _this;\n    }\n    DetailsRow.prototype.componentDidMount = function () {\n        var dragDropHelper = this.props.dragDropHelper;\n        if (dragDropHelper) {\n            this._dragDropSubscription = dragDropHelper.subscribe(this.refs.root, this._events, this._getRowDragDropOptions());\n        }\n        this._events.on(this.props.selection, interfaces_1.SELECTION_CHANGE, this._onSelectionChanged);\n        if (this.props.onDidMount && this.props.item) {\n            // If the item appears later, we should wait for it before calling this method.\n            this._hasMounted = true;\n            this.props.onDidMount(this);\n        }\n    };\n    DetailsRow.prototype.componentDidUpdate = function (previousProps) {\n        var state = this.state;\n        var _a = this.props, item = _a.item, onDidMount = _a.onDidMount;\n        var columnMeasureInfo = state.columnMeasureInfo;\n        if (this.props.itemIndex !== previousProps.itemIndex ||\n            this.props.item !== previousProps.item ||\n            this.props.dragDropHelper !== previousProps.dragDropHelper) {\n            if (this._dragDropSubscription) {\n                this._dragDropSubscription.dispose();\n                delete this._dragDropSubscription;\n            }\n            if (this.props.dragDropHelper) {\n                this._dragDropSubscription = this.props.dragDropHelper.subscribe(this.refs.root, this._events, this._getRowDragDropOptions());\n            }\n        }\n        if (columnMeasureInfo && columnMeasureInfo.index >= 0) {\n            var newWidth = this.refs.cellMeasurer.getBoundingClientRect().width;\n            columnMeasureInfo.onMeasureDone(newWidth);\n            this.setState({\n                columnMeasureInfo: null\n            });\n        }\n        if (item && onDidMount && !this._hasMounted) {\n            this._hasMounted = true;\n            onDidMount(this);\n        }\n    };\n    DetailsRow.prototype.componentWillUnmount = function () {\n        var _a = this.props, item = _a.item, onWillUnmount = _a.onWillUnmount;\n        this._events.dispose();\n        // Only call the onWillUnmount callback if we have an item.\n        if (onWillUnmount && item) {\n            onWillUnmount(this);\n        }\n        if (this._dragDropSubscription) {\n            this._dragDropSubscription.dispose();\n            delete this._dragDropSubscription;\n        }\n    };\n    DetailsRow.prototype.componentWillReceiveProps = function (newProps) {\n        this.setState({\n            selectionState: this._getSelectionState(newProps),\n            groupNestingDepth: newProps.groupNestingDepth\n        });\n    };\n    DetailsRow.prototype.render = function () {\n        var _a = this.props, columns = _a.columns, dragDropEvents = _a.dragDropEvents, item = _a.item, itemIndex = _a.itemIndex, _b = _a.onRenderCheck, onRenderCheck = _b === void 0 ? this._onRenderCheck : _b, onRenderItemColumn = _a.onRenderItemColumn, selectionMode = _a.selectionMode, viewport = _a.viewport, checkboxVisibility = _a.checkboxVisibility, getRowAriaLabel = _a.getRowAriaLabel, checkButtonAriaLabel = _a.checkButtonAriaLabel, selection = _a.selection;\n        var _c = this.state, _d = _c.selectionState, isSelected = _d.isSelected, anySelected = _d.anySelected, columnMeasureInfo = _c.columnMeasureInfo, isDropping = _c.isDropping, groupNestingDepth = _c.groupNestingDepth;\n        var isDraggable = Boolean(dragDropEvents && dragDropEvents.canDrag && dragDropEvents.canDrag(item));\n        var droppingClassName = isDropping ? (this._droppingClassNames ? this._droppingClassNames : DEFAULT_DROPPING_CSS_CLASS) : '';\n        var ariaLabel = getRowAriaLabel ? getRowAriaLabel(item) : null;\n        var canSelect = selection.canSelectItem(item);\n        var isContentUnselectable = selectionMode === interfaces_1.SelectionMode.multiple;\n        return (React.createElement(\"div\", { ref: 'root', role: 'row', \"aria-label\": ariaLabel, className: Utilities_1.css('ms-DetailsRow ms-u-fadeIn400', styles.root, droppingClassName, (_e = {},\n                _e['is-contentUnselectable ' + styles.rootIsContentUnselectable] = isContentUnselectable,\n                _e['is-selected ' + styles.rootIsSelected] = isSelected,\n                _e['is-check-visible ' + styles.rootIsCheckVisible] = checkboxVisibility === DetailsList_Props_1.CheckboxVisibility.always,\n                _e)), \"data-is-focusable\": true, \"data-selection-index\": itemIndex, \"data-item-index\": itemIndex, \"data-is-draggable\": isDraggable, draggable: isDraggable, \"data-automationid\": 'DetailsRow', style: { minWidth: viewport ? viewport.width : 0 }, \"aria-selected\": isSelected },\n            React.createElement(FocusZone_1.FocusZone, { direction: FocusZone_1.FocusZoneDirection.horizontal },\n                (selectionMode !== interfaces_1.SelectionMode.none && checkboxVisibility !== DetailsList_Props_1.CheckboxVisibility.hidden) && (React.createElement(\"span\", { role: 'gridcell' }, onRenderCheck({\n                    isSelected: isSelected,\n                    anySelected: anySelected,\n                    ariaLabel: checkButtonAriaLabel,\n                    canSelect: canSelect\n                }))),\n                GroupSpacer_1.GroupSpacer({ count: groupNestingDepth }),\n                item && (React.createElement(DetailsRowFields_1.DetailsRowFields, { columns: columns, item: item, itemIndex: itemIndex, onRenderItemColumn: onRenderItemColumn })),\n                columnMeasureInfo && (React.createElement(\"span\", { className: Utilities_1.css('ms-DetailsRow-cellMeasurer ms-DetailsRow-cell', styles.cellMeasurer, styles.cell), ref: 'cellMeasurer' },\n                    React.createElement(DetailsRowFields_1.DetailsRowFields, { columns: [columnMeasureInfo.column], item: item, itemIndex: itemIndex, onRenderItemColumn: onRenderItemColumn }))))));\n        var _e;\n    };\n    /**\n     * measure cell at index. and call the call back with the measured cell width when finish measure\n     *\n     * @param {number} index (the cell index)\n     * @param {(width: number) => void} onMeasureDone (the call back function when finish measure)\n     */\n    DetailsRow.prototype.measureCell = function (index, onMeasureDone) {\n        var column = Utilities_1.assign({}, this.props.columns[index]);\n        column.minWidth = 0;\n        column.maxWidth = 999999;\n        delete column.calculatedWidth;\n        this.setState({\n            columnMeasureInfo: {\n                index: index,\n                column: column,\n                onMeasureDone: onMeasureDone\n            }\n        });\n    };\n    DetailsRow.prototype.focus = function () {\n        if (this.refs && this.refs.root) {\n            this.refs.root.tabIndex = 0;\n            this.refs.root.focus();\n        }\n    };\n    DetailsRow.prototype._onRenderCheck = function (props) {\n        return React.createElement(DetailsRowCheck_1.DetailsRowCheck, __assign({}, props));\n    };\n    DetailsRow.prototype._getSelectionState = function (props) {\n        var itemIndex = props.itemIndex, selection = props.selection;\n        return {\n            isSelected: selection.isIndexSelected(itemIndex),\n            anySelected: selection.getSelectedCount() > 0\n        };\n    };\n    DetailsRow.prototype._onSelectionChanged = function () {\n        var selectionState = this._getSelectionState(this.props);\n        if (!Utilities_1.shallowCompare(selectionState, this.state.selectionState)) {\n            this.setState({\n                selectionState: selectionState\n            });\n        }\n    };\n    DetailsRow.prototype._getRowDragDropOptions = function () {\n        var _a = this.props, item = _a.item, itemIndex = _a.itemIndex, dragDropEvents = _a.dragDropEvents, eventsToRegister = _a.eventsToRegister;\n        var options = {\n            eventMap: eventsToRegister,\n            selectionIndex: itemIndex,\n            context: { data: item, index: itemIndex },\n            canDrag: dragDropEvents.canDrag,\n            canDrop: dragDropEvents.canDrop,\n            onDragStart: dragDropEvents.onDragStart,\n            updateDropState: this._updateDroppingState,\n            onDrop: dragDropEvents.onDrop,\n            onDragEnd: dragDropEvents.onDragEnd,\n        };\n        return options;\n    };\n    /**\n     * update isDropping state based on the input value, which is used to change style during drag and drop\n     *\n     * when change to true, that means drag enter. we will add default dropping class name\n     * or the custom dropping class name (return result from onDragEnter) to the root elemet.\n     *\n     * when change to false, that means drag leave. we will remove the dropping class name from root element.\n     *\n     * @private\n     * @param {boolean} newValue (new isDropping state value)\n     * @param {DragEvent} event (the event trigger dropping state change which can be dragenter, dragleave etc)\n     */\n    DetailsRow.prototype._updateDroppingState = function (newValue, event) {\n        var _a = this.state, selectionState = _a.selectionState, isDropping = _a.isDropping;\n        var _b = this.props, dragDropEvents = _b.dragDropEvents, item = _b.item;\n        if (!newValue) {\n            if (dragDropEvents.onDragLeave) {\n                dragDropEvents.onDragLeave(item, event);\n            }\n        }\n        else {\n            if (dragDropEvents.onDragEnter) {\n                this._droppingClassNames = dragDropEvents.onDragEnter(item, event);\n            }\n        }\n        if (isDropping !== newValue) {\n            this.setState({ selectionState: selectionState, isDropping: newValue });\n        }\n    };\n    return DetailsRow;\n}(React.Component));\nexports.DetailsRow = DetailsRow;\n\n\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/* tslint:disable:no-unused-variable */\nvar React = __webpack_require__(0);\n/* tslint:enable:no-unused-variable */\nvar Utilities_1 = __webpack_require__(1);\nvar Check_1 = __webpack_require__(12);\nvar styles = __webpack_require__(14);\nexports.DetailsRowCheck = function (props) {\n    var selected = props.isSelected || props.selected;\n    return (React.createElement(\"button\", { type: 'button', className: Utilities_1.css('ms-DetailsRow-check', styles.check), role: 'button', \"aria-pressed\": selected, \"data-selection-toggle\": true, \"data-automationid\": 'DetailsRowCheck', \"aria-label\": props.ariaLabel }, props.canSelect ?\n        React.createElement(Check_1.Check, { checked: selected }) :\n        React.createElement(\"div\", { className: Utilities_1.css('ms-DetailsRow-checkSpacer', styles.checkSpacer) })));\n};\n\n\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/* tslint:disable */\nvar load_themed_styles_1 = __webpack_require__(2);\nvar styles = {\n    root: 'root_1d9f9602',\n    group: 'group_1d9f9602',\n    groupIsDropping: 'groupIsDropping_1d9f9602',\n};\nload_themed_styles_1.loadStyles([{ \"rawString\": \".root_1d9f9602{position:relative;font-size:12px}.root_1d9f9602 BUTTON{font-family:inherit;background-color:transparent}.group_1d9f9602{-webkit-transition:background-color 267ms cubic-bezier(.445,.05,.55,.95);transition:background-color 267ms cubic-bezier(.445,.05,.55,.95)}.groupIsDropping_1d9f9602{background-color:\" }, { \"theme\": \"neutralLight\", \"defaultValue\": \"#eaeaea\" }, { \"rawString\": \"}.root_1d9f9602 .ms-List-cell{min-height:38px}\" }]);\nmodule.exports = styles;\n/* tslint:enable */ \n\n\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// Please keep alphabetized\nvar IconType;\n(function (IconType) {\n    IconType[IconType[\"Default\"] = 0] = \"Default\";\n    IconType[IconType[\"Image\"] = 1] = \"Image\";\n})(IconType = exports.IconType || (exports.IconType = {}));\n\n\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/* tslint:disable:no-unused-variable */\nvar React = __webpack_require__(0);\nvar ReactDOM = __webpack_require__(10);\n/* tslint:enable:no-unused-variable */\nvar Fabric_1 = __webpack_require__(58);\nvar Utilities_1 = __webpack_require__(1);\nvar styles = __webpack_require__(88);\nvar _layersByHostId = {};\nvar Layer = (function (_super) {\n    __extends(Layer, _super);\n    function Layer(props) {\n        var _this = _super.call(this, props, {\n            // Make sure to deprecate old properties.\n            'onLayerMounted': 'onLayerDidMount'\n        }) || this;\n        if (_this.props.hostId) {\n            if (!_layersByHostId[_this.props.hostId]) {\n                _layersByHostId[_this.props.hostId] = [];\n            }\n            _layersByHostId[_this.props.hostId].push(_this);\n        }\n        return _this;\n    }\n    /**\n     * Used for notifying applicable Layers that a host is available/unavailable and to re-evaluate Layers that\n     * care about the specific host.\n     */\n    Layer.notifyHostChanged = function (id) {\n        if (_layersByHostId[id]) {\n            _layersByHostId[id].forEach(function (layer) { return layer.forceUpdate(); });\n        }\n    };\n    Layer.prototype.componentDidMount = function () {\n        this.componentDidUpdate();\n    };\n    Layer.prototype.componentWillUnmount = function () {\n        var _this = this;\n        this._removeLayerElement();\n        if (this.props.hostId) {\n            _layersByHostId[this.props.hostId] = _layersByHostId[this.props.hostId].filter(function (layer) { return layer !== _this; });\n            if (!_layersByHostId[this.props.hostId].length) {\n                delete _layersByHostId[this.props.hostId];\n            }\n        }\n    };\n    Layer.prototype.componentDidUpdate = function () {\n        var _this = this;\n        var host = this._getHost();\n        if (host !== this._host) {\n            this._removeLayerElement();\n        }\n        if (host) {\n            this._host = host;\n            if (!this._layerElement) {\n                var doc = Utilities_1.getDocument(this._rootElement);\n                this._layerElement = doc.createElement('div');\n                this._layerElement.className = Utilities_1.css('ms-Layer', (_a = {},\n                    _a['ms-Layer--fixed ' + styles.rootIsFixed] = !this.props.hostId,\n                    _a));\n                host.appendChild(this._layerElement);\n                Utilities_1.setVirtualParent(this._layerElement, this._rootElement);\n            }\n            // Using this 'unstable' method allows us to retain the React context across the layer projection.\n            ReactDOM.unstable_renderSubtreeIntoContainer(this, React.createElement(Fabric_1.Fabric, { className: Utilities_1.css('ms-Layer-content', styles.content) }, this.props.children), this._layerElement, function () {\n                if (!_this._hasMounted) {\n                    _this._hasMounted = true;\n                    // TODO: @deprecated cleanup required.\n                    if (_this.props.onLayerMounted) {\n                        _this.props.onLayerMounted();\n                    }\n                    _this.props.onLayerDidMount();\n                }\n            });\n        }\n        var _a;\n    };\n    Layer.prototype.render = function () {\n        return (React.createElement(\"span\", { className: 'ms-Layer', ref: this._resolveRef('_rootElement') }));\n    };\n    Layer.prototype._removeLayerElement = function () {\n        if (this._layerElement) {\n            this.props.onLayerWillUnmount();\n            ReactDOM.unmountComponentAtNode(this._layerElement);\n            var parentNode = this._layerElement.parentNode;\n            if (parentNode) {\n                parentNode.removeChild(this._layerElement);\n            }\n            this._layerElement = undefined;\n            this._hasMounted = false;\n        }\n    };\n    Layer.prototype._getHost = function () {\n        var hostId = this.props.hostId;\n        var doc = Utilities_1.getDocument(this._rootElement);\n        if (hostId) {\n            return doc.getElementById(hostId);\n        }\n        else {\n            return doc.body;\n        }\n    };\n    return Layer;\n}(Utilities_1.BaseComponent));\nLayer.defaultProps = {\n    onLayerDidMount: function () { return undefined; },\n    onLayerWillUnmount: function () { return undefined; }\n};\nexports.Layer = Layer;\n\n\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar interfaces_1 = __webpack_require__(3);\nvar SelectionLayout = (function () {\n    function SelectionLayout(direction) {\n        this._direction = direction;\n    }\n    SelectionLayout.prototype.getItemIndexAbove = function (focusIndex, items) {\n        return (this._direction === interfaces_1.SelectionDirection.vertical) ? Math.max(0, focusIndex - 1) : focusIndex;\n    };\n    SelectionLayout.prototype.getItemIndexBelow = function (focusIndex, items) {\n        return (this._direction === interfaces_1.SelectionDirection.vertical) ? Math.min(items.length - 1, focusIndex + 1) : focusIndex;\n    };\n    SelectionLayout.prototype.getItemIndexLeft = function (focusIndex, items) {\n        return (this._direction === interfaces_1.SelectionDirection.vertical) ? focusIndex : Math.max(0, focusIndex - 1);\n    };\n    SelectionLayout.prototype.getItemIndexRight = function (focusIndex, items) {\n        return (this._direction === interfaces_1.SelectionDirection.vertical) ? focusIndex : Math.min(items.length - 1, focusIndex + 1);\n    };\n    return SelectionLayout;\n}());\nexports.SelectionLayout = SelectionLayout;\n\n\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/// <reference path=\"../../node_modules/@types/office-js/index.d.ts\" />\r\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar React = __webpack_require__(0);\r\nvar Model_1 = __webpack_require__(4);\r\nvar Factory_1 = __webpack_require__(18);\r\nvar StatusMessage_1 = __webpack_require__(38);\r\nvar SearchResults_1 = __webpack_require__(37);\r\nvar Feedback_1 = __webpack_require__(36);\r\nvar ConversationFiler = (function (_super) {\r\n    __extends(ConversationFiler, _super);\r\n    function ConversationFiler(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.onSelection = _this.onSelection.bind(_this);\r\n        if (_this.props.storedResults) {\r\n            if (_this.props.storedResults.length > 0) {\r\n                _this.state = { progress: Model_1.Data.Progress.Success, matches: _this.props.storedResults };\r\n            }\r\n            else {\r\n                _this.state = { progress: Model_1.Data.Progress.NotFound };\r\n            }\r\n        }\r\n        else {\r\n            _this.state = { progress: Model_1.Data.Progress.GetCallbackToken };\r\n        }\r\n        return _this;\r\n    }\r\n    // Start the chain of requests by getting a callback token.\r\n    ConversationFiler.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        if (!this.props.mailbox) {\r\n            return;\r\n        }\r\n        var data = Factory_1.Factory.getData(this.props.mailbox);\r\n        this.setState({ data: data });\r\n        data.getItemsAsync(function (results) {\r\n            if (results.length > 0) {\r\n                _this.setState({ progress: Model_1.Data.Progress.Success, matches: results });\r\n            }\r\n            else {\r\n                _this.setState({ progress: Model_1.Data.Progress.NotFound });\r\n            }\r\n        }, function (progress) {\r\n            _this.setState({ progress: progress });\r\n        }, function (message) {\r\n            _this.setState({ progress: Model_1.Data.Progress.Error, error: message });\r\n        });\r\n    };\r\n    ConversationFiler.prototype.onSelection = function (folderId) {\r\n        var _this = this;\r\n        console.log(\"Selected a folder: \" + folderId);\r\n        if (!this.state.data) {\r\n            // Handle the dialog or test case by just notifying the client\r\n            if (this.props.onComplete) {\r\n                this.props.onComplete(folderId);\r\n            }\r\n            return;\r\n        }\r\n        this.state.data.moveItemsAsync(folderId, function (count) {\r\n            if (_this.props.onComplete) {\r\n                _this.props.onComplete(folderId);\r\n            }\r\n        }, function (message) {\r\n            _this.setState({ progress: Model_1.Data.Progress.Error, error: message });\r\n        });\r\n    };\r\n    ConversationFiler.prototype.render = function () {\r\n        return (React.createElement(\"div\", null,\r\n            React.createElement(StatusMessage_1.StatusMessage, { progress: this.state.progress, message: this.state.error }),\r\n            React.createElement(SearchResults_1.SearchResults, { matches: this.state.matches, onSelection: this.onSelection }),\r\n            React.createElement(Feedback_1.Feedback, null)));\r\n    };\r\n    return ConversationFiler;\r\n}(React.Component));\r\nexports.ConversationFiler = ConversationFiler;\r\n\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/// <reference path=\"../node_modules/@types/office-js/index.d.ts\" />\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar pages_1 = __webpack_require__(15);\r\nvar Model_1 = __webpack_require__(4);\r\nvar Factory_1 = __webpack_require__(18);\r\nvar AppFunctions;\r\n(function (AppFunctions) {\r\n    function fileDialog(event) {\r\n        var mailbox = Office.context.mailbox;\r\n        var data = Factory_1.Factory.getData(mailbox);\r\n        var notificationKey = 'conversationFilerNotification';\r\n        console.log('Starting to load the conversation...');\r\n        data.getItemsAsync(function (results) {\r\n            console.log(\"Loaded the conversation: \" + results.length);\r\n            if (results.length === 0) {\r\n                // Special case for empty results\r\n                mailbox.item.notificationMessages.replaceAsync(notificationKey, {\r\n                    type: Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,\r\n                    message: \"It looks like you haven't filed this conversation anywhere before.\"\r\n                });\r\n                event.completed();\r\n                return;\r\n            }\r\n            console.log('Showing the dialog...');\r\n            mailbox.item.notificationMessages.removeAsync(notificationKey);\r\n            pages_1.Pages.populateDialog(results);\r\n            Office.context.ui.displayDialogAsync(pages_1.Pages.getDialogUrl(), { height: 25, width: 50, displayInIframe: true }, function (result) {\r\n                var dialog = result.value;\r\n                var onDialogComplete = function (closed) {\r\n                    pages_1.Pages.resetDialog();\r\n                    if (!closed) {\r\n                        dialog.close();\r\n                    }\r\n                    event.completed();\r\n                };\r\n                dialog.addEventHandler(Office.EventType.DialogMessageReceived, function (dialogEvent) {\r\n                    console.log('Moving the items...');\r\n                    data.moveItemsAsync(dialogEvent.message, function (count) {\r\n                        console.log(\"Finished moving the items: \" + count);\r\n                        onDialogComplete(false);\r\n                    }, function (message) {\r\n                        console.log(\"Error moving the items: \" + message);\r\n                        mailbox.item.notificationMessages.replaceAsync(notificationKey, {\r\n                            type: Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,\r\n                            message: \"Something went wrong, I couldn't move the messages.\"\r\n                        });\r\n                        onDialogComplete(false);\r\n                    });\r\n                });\r\n                dialog.addEventHandler(Office.EventType.DialogEventReceived, function () {\r\n                    onDialogComplete(true);\r\n                });\r\n            });\r\n        }, function (progress) {\r\n            console.log(\"Progress loading the conversation: \" + Model_1.Data.Progress[progress]);\r\n            // Update the progress indicator\r\n            mailbox.item.notificationMessages.replaceAsync(notificationKey, {\r\n                type: Office.MailboxEnums.ItemNotificationMessageType.ProgressIndicator,\r\n                message: 'Finding the messages in this conversation...'\r\n            });\r\n        }, function (message) {\r\n            console.log(\"Error loading the conversation: \" + message);\r\n            // Display an error\r\n            mailbox.item.notificationMessages.replaceAsync(notificationKey, {\r\n                type: Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,\r\n                message: \"Sorry, I couldn't figure out where this message should go.\"\r\n            });\r\n            event.completed();\r\n        });\r\n    }\r\n    // Add the UI-less function callbacks to the window\r\n    function register() {\r\n        window.fileDialog = fileDialog;\r\n    }\r\n    AppFunctions.register = register;\r\n})(AppFunctions = exports.AppFunctions || (exports.AppFunctions = {}));\r\n\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * The possible methods that can be used to fit the image.\r\n */\r\nvar ImageFit;\r\n(function (ImageFit) {\r\n    /**\r\n     * The image is not scaled. The image is centered and cropped within the content box.\r\n     */\r\n    ImageFit[ImageFit[\"center\"] = 0] = \"center\";\r\n    /**\r\n     * The image is scaled to maintain its aspect ratio while being fully contained within the frame. The image will\r\n     * be centered horizontally and vertically within the frame. The space in the top and bottom or in the sides of\r\n     * the frame will be empty depending on the difference in aspect ratio between the image and the frame.\r\n     */\r\n    ImageFit[ImageFit[\"contain\"] = 1] = \"contain\";\r\n    /**\r\n     * The image is scaled to maintain its aspect ratio while filling the frame. Portions of the image will be cropped from\r\n     * the top and bottom, or from the sides, depending on the difference in aspect ratio between the image and the frame.\r\n     */\r\n    ImageFit[ImageFit[\"cover\"] = 2] = \"cover\";\r\n    /**\r\n     * Neither the image nor the frame are scaled. If their sizes do not match, the image will either be cropped or the\r\n     * frame will have empty space.\r\n     */\r\n    ImageFit[ImageFit[\"none\"] = 3] = \"none\";\r\n})(ImageFit = exports.ImageFit || (exports.ImageFit = {}));\r\nvar ImageLoadState;\r\n(function (ImageLoadState) {\r\n    /**\r\n     * The image has not yet been loaded, and there is no error yet.\r\n     */\r\n    ImageLoadState[ImageLoadState[\"notLoaded\"] = 0] = \"notLoaded\";\r\n    /**\r\n     * The image has been loaded successfully.\r\n     */\r\n    ImageLoadState[ImageLoadState[\"loaded\"] = 1] = \"loaded\";\r\n    /**\r\n     * An error has been encountered while loading the image.\r\n     */\r\n    ImageLoadState[ImageLoadState[\"error\"] = 2] = \"error\";\r\n    /**\r\n     * @deprecated\r\n     * Deprecated at v1.3.6, to be removed at >= v2.0.0.\r\n     * To replace the src in case of errors, use onLoadingStateChange instead and rerender the Image with a\r\n     * difference src.\r\n     */\r\n    ImageLoadState[ImageLoadState[\"errorLoaded\"] = 3] = \"errorLoaded\";\r\n})(ImageLoadState = exports.ImageLoadState || (exports.ImageLoadState = {}));\r\n\n\n/***/ }),\n/* 34 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/// <reference path=\"../../node_modules/@types/office-js/index.d.ts\" />\r\n/// <reference path=\"../../node_modules/@types/jquery/index.d.ts\" />\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Model_1 = __webpack_require__(4);\r\nvar EWSData;\r\n(function (EWSData) {\r\n    var RequestBuilder = (function () {\r\n        function RequestBuilder() {\r\n        }\r\n        RequestBuilder.getItemsRequest = function (messages) {\r\n            var builder = [\r\n                RequestBuilder.beginRequest,\r\n                '  <m:GetItem>',\r\n                '    <m:ItemShape>',\r\n                '      <t:BaseShape>IdOnly</t:BaseShape>',\r\n                '      <t:BodyType>Text</t:BodyType>',\r\n                '      <t:AdditionalProperties>',\r\n                '        <t:FieldURI FieldURI=\"item:ParentFolderId\" />',\r\n                '        <t:FieldURI FieldURI=\"message:Sender\" />',\r\n                '        <t:FieldURI FieldURI=\"message:ToRecipients\" />',\r\n                '        <t:FieldURI FieldURI=\"item:Body\" />',\r\n                '      </t:AdditionalProperties>',\r\n                '    </m:ItemShape>',\r\n                '    <m:ItemIds>',\r\n            ];\r\n            messages.map(function (message) {\r\n                builder.push(\"      <t:ItemId Id=\\\"\" + message.itemId.id + \"\\\" ChangeKey=\\\"\" + message.itemId.changeKey + \"\\\" />\");\r\n            });\r\n            builder.push('    </m:ItemIds>', '  </m:GetItem>', RequestBuilder.endRequest);\r\n            return builder.join('\\n');\r\n        };\r\n        RequestBuilder.getFolderNamesRequest = function (folders) {\r\n            var builder = [\r\n                RequestBuilder.beginRequest,\r\n                '  <m:GetFolder>',\r\n                '    <m:FolderShape>',\r\n                '      <t:BaseShape>IdOnly</t:BaseShape>',\r\n                '      <t:AdditionalProperties>',\r\n                '        <t:FieldURI FieldURI=\"folder:DisplayName\" />',\r\n                '      </t:AdditionalProperties>',\r\n                '    </m:FolderShape>',\r\n                '    <m:FolderIds>'\r\n            ];\r\n            folders.map(function (folder) {\r\n                builder.push(\"      <t:FolderId Id=\\\"\" + folder.folderId.id + \"\\\" ChangeKey=\\\"\" + folder.folderId.changeKey + \"\\\" />\");\r\n            });\r\n            builder.push('    </m:FolderIds>', '  </m:GetFolder >', RequestBuilder.endRequest);\r\n            return builder.join('\\n');\r\n        };\r\n        RequestBuilder.moveItemsRequest = function (messages, folderId) {\r\n            var builder = [\r\n                RequestBuilder.beginRequest,\r\n                '  <m:MoveItem>',\r\n                '    <m:ToFolderId>',\r\n                '      <t:FolderId Id=\"' + folderId + '\"/>',\r\n                '    </m:ToFolderId>',\r\n                '    <m:ItemIds>',\r\n            ];\r\n            messages.map(function (message) {\r\n                builder.push(\"      <t:ItemId Id=\\\"\" + message.itemId.id + \"\\\" ChangeKey=\\\"\" + message.itemId.changeKey + \"\\\" />\");\r\n            });\r\n            builder.push('    </m:ItemIds>', '  </m:MoveItem>', RequestBuilder.endRequest);\r\n            return builder.join('\\n');\r\n        };\r\n        return RequestBuilder;\r\n    }());\r\n    RequestBuilder.beginRequest = [\r\n        '<?xml version=\"1.0\" encoding=\"utf-8\" ?>',\r\n        '<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"',\r\n        '    xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"',\r\n        '    xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"',\r\n        '    xmlns:t=\"http://schemas.microsoft.com/exchange/services/2006/types\"',\r\n        '    xmlns:m=\"http://schemas.microsoft.com/exchange/services/2006/messages\">',\r\n        '<soap:Header>',\r\n        '  <t:RequestServerVersion Version=\"Exchange2010_SP1\" />',\r\n        '</soap:Header>',\r\n        '<soap:Body>',\r\n    ].join('\\n');\r\n    RequestBuilder.endRequest = [\r\n        '</soap:Body>',\r\n        '</soap:Envelope>'\r\n    ].join('\\n');\r\n    RequestBuilder.findConversationRequest = [\r\n        RequestBuilder.beginRequest,\r\n        '  <m:FindConversation>',\r\n        '    <m:IndexedPageItemView BasePoint=\"Beginning\" Offset=\"0\" MaxEntriesReturned=\"20\" />',\r\n        '    <m:ParentFolderId>',\r\n        '      <t:DistinguishedFolderId Id=\"inbox\"/>',\r\n        '    </m:ParentFolderId>',\r\n        '  </m:FindConversation>',\r\n        RequestBuilder.endRequest\r\n    ].join('\\n');\r\n    RequestBuilder.excludedFolderIdsRequest = [\r\n        RequestBuilder.beginRequest,\r\n        '  <m:GetFolder>',\r\n        '    <m:FolderShape>',\r\n        '      <t:BaseShape>IdOnly</t:BaseShape>',\r\n        '    </m:FolderShape>',\r\n        '    <m:FolderIds>',\r\n        '      <t:DistinguishedFolderId Id=\"inbox\"/>',\r\n        '      <t:DistinguishedFolderId Id=\"drafts\"/>',\r\n        '      <t:DistinguishedFolderId Id=\"sentitems\"/>',\r\n        '      <t:DistinguishedFolderId Id=\"deleteditems\"/>',\r\n        '    </m:FolderIds>',\r\n        '  </m:GetFolder >',\r\n        RequestBuilder.endRequest\r\n    ].join('\\n');\r\n    var Context = (function () {\r\n        function Context(mailbox) {\r\n            this.mailbox = mailbox;\r\n        }\r\n        Context.prototype.loadItems = function (onLoadComplete, onProgress, onError) {\r\n            var _this = this;\r\n            this.onLoadComplete = onLoadComplete;\r\n            this.onProgress = onProgress;\r\n            this.onError = onError;\r\n            console.log('Finding the conversation with EWS...');\r\n            this.onProgress(Model_1.Data.Progress.GetConversation);\r\n            this.mailbox.makeEwsRequestAsync(RequestBuilder.findConversationRequest, function (result) {\r\n                if (!result.value) {\r\n                    _this.onError(result.error.message);\r\n                    return;\r\n                }\r\n                _this.conversationXml = $.parseXML(result.value);\r\n                _this.getConversation();\r\n            });\r\n        };\r\n        Context.prototype.getConversation = function () {\r\n            var _this = this;\r\n            var $conversation = $(this.conversationXml.querySelectorAll('Conversation > GlobalItemIds > ItemId'))\r\n                .filter(\"[Id=\\\"\" + this.mailbox.item.itemId + \"\\\"]\")\r\n                .parents('Conversation');\r\n            if (!$conversation.length) {\r\n                this.onError(\"This conversation isn't in your inbox's top 20.\");\r\n                return;\r\n            }\r\n            var messageCount = parseInt($conversation.find('MessageCount').text());\r\n            var globalCount = parseInt($conversation.find('GlobalMessageCount').text());\r\n            if (messageCount >= globalCount) {\r\n                this.onLoadComplete([]);\r\n                return;\r\n            }\r\n            var sameFolderItemIds = [];\r\n            $conversation.find('ItemIds > ItemId').each(function () {\r\n                var $this = $(this);\r\n                sameFolderItemIds.push({\r\n                    id: $this.attr('Id'),\r\n                    changeKey: $this.attr('ChangeKey')\r\n                });\r\n            });\r\n            var $otherFolderItemIds = $conversation.find('GlobalItemIds > ItemId');\r\n            sameFolderItemIds.map(function (itemId) {\r\n                $otherFolderItemIds = $otherFolderItemIds.filter(\"[Id!=\\\"\" + itemId.id + \"\\\"]\");\r\n            });\r\n            var otherFolderItemIds = [];\r\n            $otherFolderItemIds.each(function () {\r\n                var $this = $(this);\r\n                otherFolderItemIds.push({\r\n                    id: $this.attr('Id'),\r\n                    changeKey: $this.attr('ChangeKey')\r\n                });\r\n            });\r\n            if (!sameFolderItemIds.length || !otherFolderItemIds.length) {\r\n                this.onLoadComplete([]);\r\n                return;\r\n            }\r\n            this.conversation = {\r\n                id: this.mailbox.item.conversationId,\r\n                items: sameFolderItemIds.map(function (itemId) { return ({ itemId: itemId, conversation: _this.conversation }); }),\r\n                global: otherFolderItemIds.map(function (itemId) { return ({ itemId: itemId, conversation: _this.conversation }); })\r\n            };\r\n            this.loadExcludedFolders();\r\n        };\r\n        Context.prototype.loadExcludedFolders = function () {\r\n            var _this = this;\r\n            if (this.excludedFolders) {\r\n                this.loadMessages();\r\n            }\r\n            else {\r\n                console.log('Getting the list of excluded folders');\r\n                this.onProgress(Model_1.Data.Progress.GetExcludedFolders);\r\n                this.mailbox.makeEwsRequestAsync(RequestBuilder.excludedFolderIdsRequest, function (result) {\r\n                    if (!result.value) {\r\n                        _this.onError(result.error.message);\r\n                        return;\r\n                    }\r\n                    var foldersXml = $.parseXML(result.value);\r\n                    var excludedFolders = [];\r\n                    $(foldersXml.querySelectorAll('GetFolderResponseMessage > Folders > Folder > FolderId')).each(function () {\r\n                        var $this = $(this);\r\n                        excludedFolders.push({\r\n                            folderId: {\r\n                                id: $this.attr('Id'),\r\n                                changeKey: $this.attr('ChangeKey')\r\n                            }\r\n                        });\r\n                    });\r\n                    _this.excludedFolders = excludedFolders;\r\n                    _this.loadMessages();\r\n                });\r\n            }\r\n        };\r\n        Context.prototype.loadMessages = function () {\r\n            var _this = this;\r\n            if (this.itemsXml) {\r\n                this.getMessages();\r\n            }\r\n            else {\r\n                console.log(\"Getting the messages in other folders: \" + this.conversation.global.length);\r\n                this.onProgress(Model_1.Data.Progress.GetConversation);\r\n                this.mailbox.makeEwsRequestAsync(RequestBuilder.getItemsRequest(this.conversation.global), function (result) {\r\n                    if (!result.value) {\r\n                        _this.onError(result.error.message);\r\n                        return;\r\n                    }\r\n                    _this.itemsXml = $.parseXML(result.value);\r\n                    _this.getMessages();\r\n                });\r\n            }\r\n        };\r\n        Context.prototype.getMessages = function () {\r\n            var $messages = $(this.itemsXml.querySelectorAll('GetItemResponseMessage > Items > Message > ParentFolderId'));\r\n            this.excludedFolders.map(function (folder) {\r\n                $messages = $messages.filter(\"[Id!=\\\"\" + folder.folderId.id + \"\\\"]\");\r\n            });\r\n            $messages = $messages.parent();\r\n            this.conversation.global.map(function (item) {\r\n                for (var i = 0; i < $messages.length; i++) {\r\n                    var msg = $messages[i];\r\n                    if (msg.querySelector(\"ItemId[Id=\\\"\" + item.itemId.id + \"\\\"]\")) {\r\n                        var folderId = msg.querySelector('ParentFolderId');\r\n                        item.folder = {\r\n                            folderId: {\r\n                                id: folderId.getAttribute('Id'),\r\n                                changeKey: folderId.getAttribute('ChangeKey')\r\n                            }\r\n                        };\r\n                        item.from = msg.querySelector('Sender > Mailbox > Name').textContent;\r\n                        item.to = msg.querySelector('ToRecipients > Mailbox > Name').textContent;\r\n                        item.body = msg.querySelector('Body').textContent.slice(0, 200);\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n            this.loadFolderDisplayNames();\r\n        };\r\n        Context.prototype.loadFolderDisplayNames = function () {\r\n            var _this = this;\r\n            if (this.folderNamesXml) {\r\n                this.getFolderDisplayNames();\r\n            }\r\n            else {\r\n                var destinations_1 = [];\r\n                this.conversation.global.map(function (item) {\r\n                    if (item.folder) {\r\n                        destinations_1.push(item.folder);\r\n                    }\r\n                });\r\n                if (!destinations_1.length) {\r\n                    this.onLoadComplete([]);\r\n                    return;\r\n                }\r\n                console.log(\"Getting the display names of the other folders: \" + destinations_1.length);\r\n                this.onProgress(Model_1.Data.Progress.GetFolderNames);\r\n                this.mailbox.makeEwsRequestAsync(RequestBuilder.getFolderNamesRequest(destinations_1), function (result) {\r\n                    if (!result.value) {\r\n                        _this.onError(result.error.message);\r\n                        return;\r\n                    }\r\n                    _this.folderNamesXml = $.parseXML(result.value);\r\n                    _this.getFolderDisplayNames();\r\n                });\r\n            }\r\n        };\r\n        Context.prototype.getFolderDisplayNames = function () {\r\n            var _this = this;\r\n            var matches = [];\r\n            this.conversation.global.map(function (item) {\r\n                if (!item.folder) {\r\n                    return;\r\n                }\r\n                var folder = _this.folderNamesXml.querySelector(\"GetFolderResponseMessage > Folders > Folder > FolderId[Id=\\\"\" + item.folder.folderId.id + \"\\\"]\").parentNode;\r\n                item.folder.displayName = folder.querySelector('DisplayName').textContent;\r\n                matches.push({\r\n                    message: {\r\n                        Id: item.itemId.id,\r\n                        BodyPreview: item.body,\r\n                        Sender: item.from,\r\n                        ToRecipients: item.to,\r\n                        ParentFolderId: item.folder.folderId.id\r\n                    },\r\n                    folder: {\r\n                        Id: item.folder.folderId.id,\r\n                        DisplayName: item.folder.displayName\r\n                    }\r\n                });\r\n            });\r\n            console.log(\"Finished loading items in other folders: \" + matches.length);\r\n            this.onLoadComplete(matches);\r\n        };\r\n        Context.prototype.moveItems = function (folderId, onMoveComplete, onError) {\r\n            var _this = this;\r\n            this.onMoveComplete = onMoveComplete;\r\n            this.onError = onError;\r\n            console.log(\"Moving items to folder: \" + folderId);\r\n            this.mailbox.makeEwsRequestAsync(RequestBuilder.moveItemsRequest(this.conversation.items, folderId), function (result) {\r\n                if (!result.value) {\r\n                    _this.onError(result.error.message);\r\n                    return;\r\n                }\r\n                console.log(\"Finished moving items to other folder: \" + _this.conversation.items.length);\r\n                _this.onMoveComplete(_this.conversation.items.length);\r\n            });\r\n        };\r\n        return Context;\r\n    }());\r\n    var Model = (function () {\r\n        function Model(mailbox) {\r\n            this.context = new Context(mailbox);\r\n        }\r\n        Model.prototype.getItemsAsync = function (onLoadComplete, onProgress, onError) {\r\n            this.context.loadItems(onLoadComplete, onProgress, onError);\r\n        };\r\n        Model.prototype.moveItemsAsync = function (folderId, onMoveComplete, onError) {\r\n            this.context.moveItems(folderId, onMoveComplete, onError);\r\n        };\r\n        return Model;\r\n    }());\r\n    EWSData.Model = Model;\r\n})(EWSData = exports.EWSData || (exports.EWSData = {}));\r\n\n\n/***/ }),\n/* 35 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/// <reference path=\"../../node_modules/@types/office-js/index.d.ts\" />\r\n/// <reference path=\"../../node_modules/@types/jquery/index.d.ts\" />\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Model_1 = __webpack_require__(4);\r\nvar RESTData;\r\n(function (RESTData) {\r\n    var Endpoint = '/v2.0/me';\r\n    var ExcludedFolders;\r\n    (function (ExcludedFolders) {\r\n        ExcludedFolders[ExcludedFolders[\"Inbox\"] = 0] = \"Inbox\";\r\n        ExcludedFolders[ExcludedFolders[\"Drafts\"] = 1] = \"Drafts\";\r\n        ExcludedFolders[ExcludedFolders[\"SentItems\"] = 2] = \"SentItems\";\r\n        ExcludedFolders[ExcludedFolders[\"DeletedItems\"] = 3] = \"DeletedItems\";\r\n        // Sentinel value for enumerating the folder names\r\n        ExcludedFolders[ExcludedFolders[\"Count\"] = 4] = \"Count\";\r\n    })(ExcludedFolders || (ExcludedFolders = {}));\r\n    var Context = (function () {\r\n        function Context(mailbox) {\r\n            this.mailbox = mailbox;\r\n        }\r\n        Context.prototype.loadItems = function (onLoadComplete, onProgress, onError) {\r\n            var _this = this;\r\n            this.onLoadComplete = onLoadComplete;\r\n            this.onProgress = onProgress;\r\n            this.onError = onError;\r\n            console.log('Requesting the REST callback token...');\r\n            this.onProgress(Model_1.Data.Progress.GetCallbackToken);\r\n            // Start the chain of requests by getting a callback token.\r\n            this.mailbox.getCallbackTokenAsync({ isRest: true }, function (result) {\r\n                if (result.status === Office.AsyncResultStatus.Succeeded) {\r\n                    _this.getConversation(result);\r\n                }\r\n                else {\r\n                    _this.onError(result.error.message);\r\n                }\r\n            });\r\n        };\r\n        // Sometimes we need to make separate REST requests for multiple items. Wait until they all complete and then\r\n        // invoke the callbacks all at once with an array of typed results.\r\n        Context.prototype.collateRequests = function (requests, onDone, onFail) {\r\n            var _this = this;\r\n            if (requests.length > 1) {\r\n                $.when.apply($, requests)\r\n                    .done(function () {\r\n                    var results = [];\r\n                    for (var _i = 0; _i < arguments.length; _i++) {\r\n                        results[_i] = arguments[_i];\r\n                    }\r\n                    onDone(results.map(function (result) { return result[0]; }));\r\n                }).fail(function (message) {\r\n                    _this.onError(message);\r\n                });\r\n            }\r\n            else {\r\n                requests[0]\r\n                    .done(function (result) {\r\n                    onDone([result]);\r\n                }).fail(function (message) {\r\n                    _this.onError(message);\r\n                });\r\n            }\r\n        };\r\n        // If we're on iOS, the IDs we get from Office.context.mailbox.item are already REST IDs. Otherwise we need\r\n        // to convert them from the EWS ID format to the REST ID format.\r\n        Context.prototype.getRestId = function (itemId) {\r\n            if (this.mailbox.diagnostics.hostName === 'OutlookIOS') {\r\n                return itemId;\r\n            }\r\n            return this.mailbox.convertToRestId(itemId, Office.MailboxEnums.RestVersion.v2_0);\r\n        };\r\n        // Send a REST request to retrieve a list of messages in this conversation.\r\n        Context.prototype.getConversation = function (result) {\r\n            var _this = this;\r\n            this.token = result.value;\r\n            var conversationId = this.mailbox.item.conversationId;\r\n            var restConversationId = this.getRestId(conversationId);\r\n            var restUrl = \"\" + this.mailbox.restUrl + Endpoint + \"/messages?$filter=ConversationId eq '\" + restConversationId + \"'&$select=Id,Subject,BodyPreview,Sender,ToRecipients,ParentFolderId\";\r\n            console.log(\"Getting the list of items in the conversation: \" + restUrl);\r\n            this.onProgress(Model_1.Data.Progress.GetConversation);\r\n            $.ajax({\r\n                url: restUrl,\r\n                async: true,\r\n                dataType: 'json',\r\n                headers: { 'Authorization': \"Bearer \" + this.token }\r\n            }).done(function (result) {\r\n                _this.getExcludedFolders(result);\r\n            }).fail(function (message) {\r\n                _this.onError(message);\r\n            });\r\n        };\r\n        // Send a REST request to identify each of the folders we want to exclude in our results.\r\n        Context.prototype.getExcludedFolders = function (result) {\r\n            var _this = this;\r\n            if (!result || !result.value || 0 === result.value.length) {\r\n                this.onLoadComplete([]);\r\n                return;\r\n            }\r\n            this.conversationMessages = result.value;\r\n            var currentFolderId;\r\n            var excludedFolderIds = [];\r\n            // We should ignore any messages in the same folder.\r\n            var itemId = this.mailbox.item.itemId;\r\n            var restItemId = this.getRestId(itemId);\r\n            for (var i = 0; i < this.conversationMessages.length; ++i) {\r\n                if (this.conversationMessages[i].Id === restItemId) {\r\n                    currentFolderId = this.conversationMessages[i].ParentFolderId;\r\n                    excludedFolderIds.push(currentFolderId);\r\n                    break;\r\n                }\r\n            }\r\n            // We should also exclude some special folders, but we need to get their folderIds.\r\n            var requests = [];\r\n            for (var i = 0; i < ExcludedFolders.Count; ++i) {\r\n                var folderId = ExcludedFolders[i];\r\n                var restUrl = \"\" + this.mailbox.restUrl + Endpoint + \"/mailfolders/\" + folderId + \"?$select=Id\";\r\n                console.log(\"Getting excluded folder ID: \" + restUrl);\r\n                requests.push($.ajax({\r\n                    url: restUrl,\r\n                    async: true,\r\n                    dataType: 'json',\r\n                    headers: { 'Authorization': \"Bearer \" + this.token }\r\n                }));\r\n            }\r\n            this.onProgress(Model_1.Data.Progress.GetExcludedFolders);\r\n            this.collateRequests(requests, function (results) {\r\n                results.map(function (value) {\r\n                    excludedFolderIds.push(value.Id);\r\n                });\r\n                _this.getFolderNames(currentFolderId, excludedFolderIds);\r\n            }, function (message) {\r\n                _this.onError(message);\r\n            });\r\n        };\r\n        // Send REST requests to fill in the display names of all the folders we are not excluding.\r\n        Context.prototype.getFolderNames = function (currentFolderId, excludedFolderIds) {\r\n            var _this = this;\r\n            var folderMap = [];\r\n            this.conversationMessages.map(function (message) {\r\n                for (var i = 0; i < excludedFolderIds.length; ++i) {\r\n                    if (excludedFolderIds[i] === message.ParentFolderId) {\r\n                        // Skip this message.\r\n                        return;\r\n                    }\r\n                }\r\n                for (var i = 0; i < folderMap.length; ++i) {\r\n                    if (folderMap[i].folder.Id === message.ParentFolderId) {\r\n                        // Add this message to the existing entry.\r\n                        folderMap[i].messages.push(message);\r\n                        return;\r\n                    }\r\n                }\r\n                // Create a new entry for this folder.\r\n                folderMap.push({ folder: { Id: message.ParentFolderId }, messages: [message] });\r\n            });\r\n            if (folderMap.length === 0) {\r\n                this.onLoadComplete([]);\r\n                return;\r\n            }\r\n            this.currentFolderId = currentFolderId;\r\n            this.excludedFolderIds = excludedFolderIds;\r\n            var requests = folderMap.map(function (entry) {\r\n                var restUrl = \"\" + _this.mailbox.restUrl + Endpoint + \"/mailfolders/\" + entry.folder.Id + \"?$select=Id,DisplayName\";\r\n                console.log(\"Getting included folder name: \" + restUrl);\r\n                return $.ajax({\r\n                    url: restUrl,\r\n                    async: true,\r\n                    dataType: 'json',\r\n                    headers: { 'Authorization': \"Bearer \" + _this.token }\r\n                });\r\n            });\r\n            this.onProgress(Model_1.Data.Progress.GetFolderNames);\r\n            this.collateRequests(requests, function (results) {\r\n                results.map(function (value) {\r\n                    for (var i = 0; i < folderMap.length; ++i) {\r\n                        if (folderMap[i].folder.Id === value.Id) {\r\n                            folderMap[i].folder.DisplayName = value.DisplayName;\r\n                            break;\r\n                        }\r\n                    }\r\n                });\r\n                var matches = [];\r\n                folderMap.map(function (entry) {\r\n                    entry.messages.map(function (message) {\r\n                        matches.push({\r\n                            message: {\r\n                                Id: message.Id,\r\n                                BodyPreview: message.BodyPreview,\r\n                                Sender: message.Sender.EmailAddress.Name,\r\n                                ToRecipients: message.ToRecipients.map(function (address) { return address.EmailAddress.Name; }).join('; '),\r\n                                ParentFolderId: message.ParentFolderId\r\n                            },\r\n                            folder: {\r\n                                Id: entry.folder.Id,\r\n                                DisplayName: entry.folder.DisplayName\r\n                            }\r\n                        });\r\n                    });\r\n                });\r\n                console.log(\"Finished loading items in other folders: \" + matches.length);\r\n                _this.onLoadComplete(matches);\r\n            }, function (message) {\r\n                _this.onError(message);\r\n            });\r\n        };\r\n        Context.prototype.moveItems = function (folderId, onMoveComplete, onError) {\r\n            var _this = this;\r\n            this.onMoveComplete = onMoveComplete;\r\n            this.onError = onError;\r\n            console.log(\"Moving items to folder: \" + folderId);\r\n            var requests = [];\r\n            this.conversationMessages.map(function (message) {\r\n                if (message.ParentFolderId !== _this.currentFolderId) {\r\n                    // Skip any messages that are not in the current folder.\r\n                    return;\r\n                }\r\n                var restUrl = \"\" + _this.mailbox.restUrl + Endpoint + \"/messages/\" + message.Id + \"/move\";\r\n                console.log(\"Moving item: \" + restUrl);\r\n                requests.push($.ajax({\r\n                    url: restUrl,\r\n                    async: true,\r\n                    method: 'POST',\r\n                    contentType: 'application/json',\r\n                    dataType: 'json',\r\n                    data: JSON.stringify({ DestinationId: folderId }),\r\n                    headers: { 'Authorization': \"Bearer \" + _this.token }\r\n                }));\r\n            });\r\n            this.collateRequests(requests, function (results) {\r\n                console.log(\"Finished moving items to other folder: \" + results.length);\r\n                _this.onMoveComplete(results.length);\r\n            }, function (message) {\r\n                _this.onError(message);\r\n            });\r\n        };\r\n        return Context;\r\n    }());\r\n    var Model = (function () {\r\n        function Model(mailbox) {\r\n            this.context = new Context(mailbox);\r\n        }\r\n        Model.prototype.getItemsAsync = function (onLoadComplete, onProgress, onError) {\r\n            this.context.loadItems(onLoadComplete, onProgress, onError);\r\n        };\r\n        Model.prototype.moveItemsAsync = function (folderId, onMoveComplete, onError) {\r\n            this.context.moveItems(folderId, onMoveComplete, onError);\r\n        };\r\n        return Model;\r\n    }());\r\n    RESTData.Model = Model;\r\n})(RESTData = exports.RESTData || (exports.RESTData = {}));\r\n\n\n/***/ }),\n/* 36 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar React = __webpack_require__(0);\r\nvar Feedback = (function (_super) {\r\n    __extends(Feedback, _super);\r\n    function Feedback() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Feedback.prototype.render = function () {\r\n        return (React.createElement(\"div\", { className: \"feedback\" },\r\n            React.createElement(\"a\", { href: \"https://beandotnet.azurewebsites.net/\" }, \"about this app\"),\r\n            \"\\u00A0\",\r\n            React.createElement(\"a\", { href: \"mailto:wravery@hotmail.com?Subject=Conversation%20Filer%20v2.0%20App%20for%20Outlook\" }, \"send feedback\")));\r\n    };\r\n    return Feedback;\r\n}(React.Component));\r\nexports.Feedback = Feedback;\r\n\n\n/***/ }),\n/* 37 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar React = __webpack_require__(0);\r\nvar DetailsList_1 = __webpack_require__(57);\r\nvar Link_1 = __webpack_require__(24);\r\nvar SearchResults = (function (_super) {\r\n    __extends(SearchResults, _super);\r\n    function SearchResults(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.onClickFolder = _this.onClickFolder.bind(_this);\r\n        _this.onRenderLink = _this.onRenderLink.bind(_this);\r\n        _this.onRenderColumn = _this.onRenderColumn.bind(_this);\r\n        return _this;\r\n    }\r\n    SearchResults.prototype.render = function () {\r\n        if (!this.props.matches || this.props.matches.length === 0) {\r\n            return null;\r\n        }\r\n        var columns = [{\r\n                key: 'DisplayName',\r\n                name: 'Folder',\r\n                fieldName: null,\r\n                onRender: this.onRenderLink,\r\n                minWidth: 5\r\n            }, {\r\n                key: 'Sender',\r\n                name: 'From',\r\n                fieldName: null,\r\n                onRender: this.onRenderColumn,\r\n                minWidth: 10\r\n            }, {\r\n                key: 'ToRecipients',\r\n                name: 'To',\r\n                fieldName: null,\r\n                onRender: this.onRenderColumn,\r\n                minWidth: 10\r\n            }, {\r\n                key: 'BodyPreview',\r\n                name: 'Preview',\r\n                fieldName: null,\r\n                onRender: this.onRenderColumn,\r\n                minWidth: 50\r\n            }];\r\n        return (React.createElement(\"div\", null,\r\n            React.createElement(\"h3\", null, \"I found some items in this conversation filed in other folders. Click on one of the folders listed here to automatically reunite this part of the conversation with the ones that came before:\"),\r\n            React.createElement(DetailsList_1.DetailsList, { columns: columns, items: this.props.matches })));\r\n    };\r\n    SearchResults.prototype.onClickFolder = function (evt) {\r\n        this.props.onSelection(evt.currentTarget.href);\r\n        evt.preventDefault();\r\n    };\r\n    SearchResults.prototype.onRenderLink = function (item) {\r\n        return React.createElement(Link_1.Link, { onClick: this.onClickFolder, name: item.folder.Id }, item.folder.DisplayName);\r\n    };\r\n    SearchResults.prototype.onRenderColumn = function (item, index, column) {\r\n        return item.message[column.key];\r\n    };\r\n    return SearchResults;\r\n}(React.Component));\r\nexports.SearchResults = SearchResults;\r\n\n\n/***/ }),\n/* 38 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar React = __webpack_require__(0);\r\nvar Model_1 = __webpack_require__(4);\r\nvar StatusMessage = (function (_super) {\r\n    __extends(StatusMessage, _super);\r\n    function StatusMessage() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    StatusMessage.prototype.render = function () {\r\n        var className;\r\n        var status;\r\n        switch (this.props.progress) {\r\n            case Model_1.Data.Progress.GetCallbackToken:\r\n            case Model_1.Data.Progress.GetConversation:\r\n            case Model_1.Data.Progress.GetExcludedFolders:\r\n            case Model_1.Data.Progress.GetFolderNames:\r\n                return React.createElement(\"h3\", null, \"Looking for other messages in this conversation...\");\r\n            case Model_1.Data.Progress.Success:\r\n                return null;\r\n            case Model_1.Data.Progress.NotFound:\r\n                return React.createElement(\"h3\", null, \"It looks like you haven't filed this conversation anywhere before.\");\r\n            default:\r\n                return (React.createElement(\"div\", null,\r\n                    React.createElement(\"h3\", null, \"Sorry, I couldn't figure out where this message should go. :(\"),\r\n                    React.createElement(\"span\", null, this.props.message)));\r\n        }\r\n    };\r\n    return StatusMessage;\r\n}(React.Component));\r\nexports.StatusMessage = StatusMessage;\r\n\n\n/***/ }),\n/* 39 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar React = __webpack_require__(0);\r\nvar ReactDOM = __webpack_require__(10);\r\nvar pages_1 = __webpack_require__(15);\r\nvar functions_1 = __webpack_require__(32);\r\nvar ConversationFiler_1 = __webpack_require__(31);\r\nOffice.initialize = function () {\r\n    if (pages_1.Pages.shouldHaveUI()) {\r\n        // Show the UI...\r\n        var params = pages_1.Pages.getUIParameters();\r\n        ReactDOM.render(React.createElement(ConversationFiler_1.ConversationFiler, { mailbox: params.mailbox, onComplete: params.onComplete, storedResults: params.storedResults }), document.getElementById(\"conversationFilerRoot\"));\r\n    }\r\n    else {\r\n        functions_1.AppFunctions.register();\r\n    }\r\n};\r\n\n\n/***/ }),\n/* 40 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EventGroup_1 = __webpack_require__(11);\nvar scroll_1 = __webpack_require__(22);\nvar dom_1 = __webpack_require__(5);\nvar SCROLL_ITERATION_DELAY = 16;\nvar SCROLL_GUTTER_HEIGHT = 100;\nvar MAX_SCROLL_VELOCITY = 15;\n/**\n * AutoScroll simply hooks up mouse events given a parent element, and scrolls the container\n * up/down depending on how close the mouse is to the top/bottom of the container.\n *\n * Once you don't want autoscroll any more, just dispose the helper and it will unhook events.\n */\nvar AutoScroll = (function () {\n    function AutoScroll(element) {\n        this._events = new EventGroup_1.EventGroup(this);\n        this._scrollableParent = scroll_1.findScrollableParent(element);\n        this._incrementScroll = this._incrementScroll.bind(this);\n        this._scrollRect = dom_1.getRect(this._scrollableParent);\n        if (this._scrollableParent === window) {\n            this._scrollableParent = document.body;\n        }\n        if (this._scrollableParent) {\n            this._events.on(window, 'mousemove', this._onMouseMove, true);\n            this._events.on(window, 'touchmove', this._onTouchMove, true);\n        }\n    }\n    AutoScroll.prototype.dispose = function () {\n        this._events.dispose();\n        this._stopScroll();\n    };\n    AutoScroll.prototype._onMouseMove = function (ev) {\n        this._computeScrollVelocity(ev.clientY);\n    };\n    AutoScroll.prototype._onTouchMove = function (ev) {\n        if (ev.touches.length > 0) {\n            this._computeScrollVelocity(ev.touches[0].clientY);\n        }\n    };\n    AutoScroll.prototype._computeScrollVelocity = function (clientY) {\n        var scrollRectTop = this._scrollRect.top;\n        var scrollClientBottom = scrollRectTop + this._scrollRect.height - SCROLL_GUTTER_HEIGHT;\n        if (clientY < (scrollRectTop + SCROLL_GUTTER_HEIGHT)) {\n            this._scrollVelocity = Math.max(-MAX_SCROLL_VELOCITY, -MAX_SCROLL_VELOCITY * ((SCROLL_GUTTER_HEIGHT - (clientY - scrollRectTop)) / SCROLL_GUTTER_HEIGHT));\n        }\n        else if (clientY > scrollClientBottom) {\n            this._scrollVelocity = Math.min(MAX_SCROLL_VELOCITY, MAX_SCROLL_VELOCITY * ((clientY - scrollClientBottom) / SCROLL_GUTTER_HEIGHT));\n        }\n        else {\n            this._scrollVelocity = 0;\n        }\n        if (this._scrollVelocity) {\n            this._startScroll();\n        }\n        else {\n            this._stopScroll();\n        }\n    };\n    AutoScroll.prototype._startScroll = function () {\n        if (!this._timeoutId) {\n            this._incrementScroll();\n        }\n    };\n    AutoScroll.prototype._incrementScroll = function () {\n        this._scrollableParent.scrollTop += Math.round(this._scrollVelocity);\n        this._timeoutId = setTimeout(this._incrementScroll, SCROLL_ITERATION_DELAY);\n    };\n    AutoScroll.prototype._stopScroll = function () {\n        if (this._timeoutId) {\n            clearTimeout(this._timeoutId);\n            delete this._timeoutId;\n        }\n    };\n    return AutoScroll;\n}());\nexports.AutoScroll = AutoScroll;\n\n\n\n/***/ }),\n/* 41 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Async_1 = __webpack_require__(19);\nvar EventGroup_1 = __webpack_require__(11);\nvar BaseComponent = (function (_super) {\n    __extends(BaseComponent, _super);\n    /**\n     * BaseComponent constructor\n     * @param {P} props The props for the component.\n     * @param {Object} deprecatedProps The map of deprecated prop names to new names, where the key is the old name and the\n     * value is the new name. If a prop is removed rather than renamed, leave the value undefined.\n     */\n    function BaseComponent(props, deprecatedProps) {\n        var _this = _super.call(this, props) || this;\n        if (deprecatedProps) {\n            for (var propName in deprecatedProps) {\n                if (propName in props) {\n                    _warnDeprecation(_this, propName, deprecatedProps[propName]);\n                }\n            }\n        }\n        _makeAllSafe(_this, BaseComponent.prototype, [\n            'componentWillMount',\n            'componentDidMount',\n            'shouldComponentUpdate',\n            'componentWillUpdate',\n            'componentWillReceiveProps',\n            'render',\n            'componentDidUpdate',\n            'componentWillUnmount'\n        ]);\n        return _this;\n    }\n    /** If we have disposables, dispose them automatically on unmount. */\n    BaseComponent.prototype.componentWillUnmount = function () {\n        if (this.__disposables) {\n            for (var i = 0, len = this._disposables.length; i < len; i++) {\n                var disposable = this.__disposables[i];\n                if (disposable.dispose) {\n                    disposable.dispose();\n                }\n            }\n            this.__disposables = null;\n        }\n    };\n    Object.defineProperty(BaseComponent.prototype, \"className\", {\n        /** Gets the object's class name. */\n        get: function () {\n            var funcNameRegex = /function (.{1,})\\(/;\n            var results = (funcNameRegex).exec((this).constructor.toString());\n            return (results && results.length > 1) ? results[1] : '';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseComponent.prototype, \"_disposables\", {\n        /** Allows subclasses to push things to this._disposables to be auto disposed. */\n        get: function () {\n            if (!this.__disposables) {\n                this.__disposables = [];\n            }\n            return this.__disposables;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseComponent.prototype, \"_async\", {\n        /**\n         * Gets the async instance associated with the component, created on demand. The async instance gives\n         * subclasses a way to execute setTimeout/setInterval async calls safely, where the callbacks\n         * will be cleared/ignored automatically after unmounting. The helpers within the async object also\n         * preserve the this pointer so that you don't need to \"bind\" the callbacks.\n         */\n        get: function () {\n            if (!this.__async) {\n                this.__async = new Async_1.Async(this);\n                this._disposables.push(this.__async);\n            }\n            return this.__async;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseComponent.prototype, \"_events\", {\n        /**\n         * Gets the event group instance assocaited with the component, created on demand. The event instance\n         * provides on/off methods for listening to DOM (or regular javascript object) events. The event callbacks\n         * will be automatically disconnected after unmounting. The helpers within the events object also\n         * preserve the this reference so that you don't need to \"bind\" the callbacks.\n         */\n        get: function () {\n            if (!this.__events) {\n                this.__events = new EventGroup_1.EventGroup(this);\n                this._disposables.push(this.__events);\n            }\n            return this.__events;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Helper to return a memoized ref resolver function.\n     * @params refName Name of the member to assign the ref to.\n     *\n     * @examples\n     * class Foo extends BaseComponent<...> {\n     *   private _root: HTMLElement;\n     *\n     *   public render() {\n     *     return <div ref={ this._resolveRef('_root') } />\n     *   }\n     * }\n     */\n    BaseComponent.prototype._resolveRef = function (refName) {\n        var _this = this;\n        if (!this.__resolves) {\n            this.__resolves = {};\n        }\n        if (!this.__resolves[refName]) {\n            this.__resolves[refName] = function (ref) {\n                return _this[refName] = ref;\n            };\n        }\n        return this.__resolves[refName];\n    };\n    return BaseComponent;\n}(React.Component));\nexports.BaseComponent = BaseComponent;\n/**\n * Helper to override a given method with a wrapper method that can try/catch the original, but also\n * ensures that the BaseComponent's methods are called before the subclass's. This ensures that\n * componentWillUnmount in the base is called and that things in the _disposables array are disposed.\n */\nfunction _makeAllSafe(obj, prototype, methodNames) {\n    for (var i = 0, len = methodNames.length; i < len; i++) {\n        _makeSafe(obj, prototype, methodNames[i]);\n    }\n}\nfunction _makeSafe(obj, prototype, methodName) {\n    var classMethod = obj[methodName];\n    var prototypeMethod = prototype[methodName];\n    if (classMethod || prototypeMethod) {\n        obj[methodName] = function () {\n            var retVal;\n            try {\n                if (prototypeMethod) {\n                    retVal = prototypeMethod.apply(this, arguments);\n                }\n                if (classMethod) {\n                    retVal = classMethod.apply(this, arguments);\n                }\n            }\n            catch (e) {\n                var errorMessage = \"Exception in \" + obj.className + \".\" + methodName + \"(): \" + (typeof e === 'string' ? e : e.stack);\n                if (BaseComponent.onError) {\n                    BaseComponent.onError(errorMessage, e);\n                }\n            }\n            return retVal;\n        };\n    }\n}\nfunction _warnDeprecation(obj, propertyName, newPropertyName) {\n    if (console && console.warn) {\n        var deprecationMessage = obj.className + \" property '\" + propertyName + \"' was used but has been deprecated.\";\n        if (newPropertyName) {\n            deprecationMessage += \" Use '\" + newPropertyName + \"' instead.\";\n        }\n        console.warn(deprecationMessage);\n    }\n}\nBaseComponent.onError = function (errorMessage) {\n    console.error(errorMessage);\n    throw errorMessage;\n};\n\n\n\n/***/ }),\n/* 42 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\n/**\n * Utility component for delaying the render of a child component after a given delay. This component\n * requires a single child component; don't pass in many components. Wrap multiple components in a DIV\n * if necessary.\n *\n * @example\n * <DelayedRender delay={ 3000 }>\n *  <div className='foo-List-loadingSpinner'>\n *    <p>I am loading</p>\n *    <Spinner />\n *  </div>\n * </DelayedRender>\n */\nvar DelayedRender = (function (_super) {\n    __extends(DelayedRender, _super);\n    function DelayedRender(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = {\n            isRendered: false\n        };\n        return _this;\n    }\n    DelayedRender.prototype.componentDidMount = function () {\n        var _this = this;\n        var delay = this.props.delay;\n        this._timeoutId = setTimeout(function () {\n            _this.setState({\n                isRendered: true\n            });\n        }, delay);\n    };\n    DelayedRender.prototype.componentWillUnmount = function () {\n        clearTimeout(this._timeoutId);\n    };\n    DelayedRender.prototype.render = function () {\n        return this.state.isRendered ? React.Children.only(this.props.children) : null;\n    };\n    return DelayedRender;\n}(React.Component));\nDelayedRender.defaultProps = {\n    delay: 0\n};\nexports.DelayedRender = DelayedRender;\n\n\n\n/***/ }),\n/* 43 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Rectangle = (function () {\n    function Rectangle(left, right, top, bottom) {\n        if (left === void 0) { left = 0; }\n        if (right === void 0) { right = 0; }\n        if (top === void 0) { top = 0; }\n        if (bottom === void 0) { bottom = 0; }\n        this.top = top;\n        this.bottom = bottom;\n        this.left = left;\n        this.right = right;\n    }\n    Object.defineProperty(Rectangle.prototype, \"width\", {\n        /**\n         * Calculated automatically by subtracting the right from left\n         */\n        get: function () {\n            return this.right - this.left;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Rectangle.prototype, \"height\", {\n        /**\n         * Calculated automatically by subtracting the bottom from top.\n         */\n        get: function () {\n            return this.bottom - this.top;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Tests if another rect is approximately equal to this rect (within 4 decimal places.)\n     */\n    Rectangle.prototype.equals = function (rect) {\n        // I'm fixing it to 4 decimal places because it allows enough precision and will handle cases when something should be rounded,\n        // like .999999 should round to 1.\n        return (parseFloat(this.top.toFixed(4)) === parseFloat(rect.top.toFixed(4)) &&\n            parseFloat(this.bottom.toFixed(4)) === parseFloat(rect.bottom.toFixed(4)) &&\n            parseFloat(this.left.toFixed(4)) === parseFloat(rect.left.toFixed(4)) &&\n            parseFloat(this.right.toFixed(4)) === parseFloat(rect.right.toFixed(4)));\n    };\n    return Rectangle;\n}());\nexports.Rectangle = Rectangle;\n\n\n\n/***/ }),\n/* 44 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction findIndex(array, cb) {\n    var index = -1;\n    for (var i = 0; array && i < array.length; i++) {\n        if (cb(array[i], i)) {\n            index = i;\n            break;\n        }\n    }\n    return index;\n}\nexports.findIndex = findIndex;\nfunction createArray(size, getItem) {\n    var array = [];\n    for (var i = 0; i < size; i++) {\n        array.push(getItem(i));\n    }\n    return array;\n}\nexports.createArray = createArray;\n\n\n\n/***/ }),\n/* 45 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Autobind is a utility for binding methods in a class. This simplifies tagging methods as being \"bound\" to the this pointer\n * so that they can be used in scenarios that simply require a function callback.\n *\n * @example\n * import { autobind } from '../utilities/autobind';\n *\n * public class Foo {\n *   @autobind\n *   method() {\n *   }\n * }\n */\nfunction autobind(target, key, descriptor) {\n    var fn = descriptor.value;\n    var defining = false;\n    return {\n        configurable: true,\n        get: function () {\n            if (defining || this === fn.prototype || this.hasOwnProperty(key)) {\n                return fn;\n            }\n            // Bind method only once, and update the property to return the bound value from now on\n            var fnBound = fn.bind(this);\n            defining = true;\n            Object.defineProperty(this, key, {\n                configurable: true,\n                writable: true,\n                enumerable: true,\n                value: fnBound\n            });\n            defining = false;\n            return fnBound;\n        },\n        set: function (newValue) {\n            Object.defineProperty(this, key, {\n                configurable: true,\n                writable: true,\n                enumerable: true,\n                value: newValue\n            });\n        }\n    };\n}\nexports.autobind = autobind;\n\n\n\n/***/ }),\n/* 46 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction css() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var classes = [];\n    for (var _a = 0, args_1 = args; _a < args_1.length; _a++) {\n        var arg = args_1[_a];\n        if (arg) {\n            if (typeof arg === 'string') {\n                classes.push(arg);\n            }\n            else {\n                for (var key in arg) {\n                    if (arg[key]) {\n                        classes.push(key);\n                    }\n                }\n            }\n        }\n    }\n    return classes.join(' ');\n}\nexports.css = css;\n\n\n\n/***/ }),\n/* 47 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* tslint:disable:no-string-literal */\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar dom_1 = __webpack_require__(5);\nvar IS_FOCUSABLE_ATTRIBUTE = 'data-is-focusable';\nvar IS_VISIBLE_ATTRIBUTE = 'data-is-visible';\nvar FOCUSZONE_ID_ATTRIBUTE = 'data-focuszone-id';\nfunction getFirstFocusable(rootElement, currentElement, includeElementsInFocusZones) {\n    return getNextElement(rootElement, currentElement, true, false, false, includeElementsInFocusZones);\n}\nexports.getFirstFocusable = getFirstFocusable;\nfunction getLastFocusable(rootElement, currentElement, includeElementsInFocusZones) {\n    return getPreviousElement(rootElement, currentElement, true, false, true, includeElementsInFocusZones);\n}\nexports.getLastFocusable = getLastFocusable;\n/**\n * Attempts to focus the first focusable element that is a child or child's child of the rootElement.\n * @return True if focus was set, false if it was not.\n * @param {HTMLElement} rootElement - element to start the search for a focusable child.\n */\nfunction focusFirstChild(rootElement) {\n    var element = getNextElement(rootElement, rootElement, true, false, false, true);\n    if (element) {\n        element.focus();\n        return true;\n    }\n    return false;\n}\nexports.focusFirstChild = focusFirstChild;\n/** Traverse to find the previous element. */\nfunction getPreviousElement(rootElement, currentElement, checkNode, suppressParentTraversal, traverseChildren, includeElementsInFocusZones) {\n    if (!currentElement ||\n        currentElement === rootElement) {\n        return null;\n    }\n    var isCurrentElementVisible = isElementVisible(currentElement);\n    // Check its children.\n    if (traverseChildren && (includeElementsInFocusZones || !isElementFocusZone(currentElement)) && isCurrentElementVisible) {\n        var childMatch = getPreviousElement(rootElement, currentElement.lastElementChild, true, true, true, includeElementsInFocusZones);\n        if (childMatch) {\n            return childMatch;\n        }\n    }\n    // Check the current node, if it's not the first traversal.\n    if (checkNode && isCurrentElementVisible && isElementTabbable(currentElement)) {\n        return currentElement;\n    }\n    // Check its previous sibling.\n    var siblingMatch = getPreviousElement(rootElement, currentElement.previousElementSibling, true, true, true, includeElementsInFocusZones);\n    if (siblingMatch) {\n        return siblingMatch;\n    }\n    // Check its parent.\n    if (!suppressParentTraversal) {\n        return getPreviousElement(rootElement, currentElement.parentElement, true, false, false, includeElementsInFocusZones);\n    }\n    return null;\n}\nexports.getPreviousElement = getPreviousElement;\n/** Traverse to find the next focusable element. */\nfunction getNextElement(rootElement, currentElement, checkNode, suppressParentTraversal, suppressChildTraversal, includeElementsInFocusZones) {\n    if (!currentElement ||\n        (currentElement === rootElement && suppressChildTraversal)) {\n        return null;\n    }\n    var isCurrentElementVisible = isElementVisible(currentElement);\n    // Check the current node, if it's not the first traversal.\n    if (checkNode && isCurrentElementVisible && isElementTabbable(currentElement)) {\n        return currentElement;\n    }\n    // Check its children.\n    if (!suppressChildTraversal && isCurrentElementVisible && (includeElementsInFocusZones || !isElementFocusZone(currentElement))) {\n        var childMatch = getNextElement(rootElement, currentElement.firstElementChild, true, true, false, includeElementsInFocusZones);\n        if (childMatch) {\n            return childMatch;\n        }\n    }\n    if (currentElement === rootElement) {\n        return null;\n    }\n    // Check its sibling.\n    var siblingMatch = getNextElement(rootElement, currentElement.nextElementSibling, true, true, false, includeElementsInFocusZones);\n    if (siblingMatch) {\n        return siblingMatch;\n    }\n    if (!suppressParentTraversal) {\n        return getNextElement(rootElement, currentElement.parentElement, false, false, true, includeElementsInFocusZones);\n    }\n    return null;\n}\nexports.getNextElement = getNextElement;\nfunction isElementVisible(element) {\n    // If the element is not valid, return false.\n    if (!element || !element.getAttribute) {\n        return false;\n    }\n    var visibilityAttribute = element.getAttribute(IS_VISIBLE_ATTRIBUTE);\n    // If the element is explicitly marked with the visibility attribute, return that value as boolean.\n    if (visibilityAttribute !== null && visibilityAttribute !== undefined) {\n        return visibilityAttribute === 'true';\n    }\n    // Fallback to other methods of determining actual visibility.\n    return (element.offsetHeight !== 0 ||\n        element.offsetParent !== null ||\n        element.isVisible === true); // used as a workaround for testing.\n}\nexports.isElementVisible = isElementVisible;\nfunction isElementTabbable(element) {\n    // If this element is null or is disabled, it is not considered tabbable.\n    if (!element || element.disabled) {\n        return false;\n    }\n    // In IE, element.tabIndex is default to 0. We need to use element get tabIndex attribute to get the correct tabIndex\n    var tabIndex = -1;\n    if (element && element.getAttribute) {\n        tabIndex = parseInt(element.getAttribute('tabIndex'), 10);\n    }\n    var isFocusableAttribute = element.getAttribute ? element.getAttribute(IS_FOCUSABLE_ATTRIBUTE) : null;\n    return (!!element && isFocusableAttribute !== 'false' &&\n        (element.tagName === 'A' ||\n            (element.tagName === 'BUTTON') ||\n            (element.tagName === 'INPUT') ||\n            (element.tagName === 'TEXTAREA') ||\n            (tabIndex >= 0) ||\n            (element.getAttribute && (isFocusableAttribute === 'true' ||\n                element.getAttribute('role') === 'button'))));\n}\nexports.isElementTabbable = isElementTabbable;\nfunction isElementFocusZone(element) {\n    return element && !!element.getAttribute(FOCUSZONE_ID_ATTRIBUTE);\n}\nexports.isElementFocusZone = isElementFocusZone;\nfunction doesElementContainFocus(element) {\n    var currentActiveElement = dom_1.getDocument(element).activeElement;\n    if (currentActiveElement && dom_1.elementContains(element, currentActiveElement)) {\n        return true;\n    }\n    return false;\n}\nexports.doesElementContainFocus = doesElementContainFocus;\n\n\n\n/***/ }),\n/* 48 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar REACT_LIFECYCLE_EXCLUSIONS = [\n    'setState',\n    'render',\n    'componentWillMount',\n    'componentDidMount',\n    'componentWillReceiveProps',\n    'shouldComponentUpdate',\n    'componentWillUpdate',\n    'componentDidUpdate',\n    'componentWillUnmount'\n];\n/**\n * Allows you to hoist methods, except those in an exclusion set from a source object into a destination object.\n * @param destination The instance of the object to hoist the methods onto.\n * @param source The instance of the object where the methods are hoisted from.\n * @param exclusions (Optional) What methods to exclude from being hoisted.\n * @returns {string[]} An array of names of methods that were hoisted.\n */\nfunction hoistMethods(destination, source, exclusions) {\n    if (exclusions === void 0) { exclusions = REACT_LIFECYCLE_EXCLUSIONS; }\n    var hoisted = [];\n    var _loop_1 = function (methodName) {\n        if (typeof source[methodName] === 'function' &&\n            destination[methodName] === undefined &&\n            (!exclusions || exclusions.indexOf(methodName) === -1)) {\n            hoisted.push(methodName);\n            /* tslint:disable:no-function-expression */\n            destination[methodName] = function () { source[methodName].apply(source, arguments); };\n            /* tslint:enable */\n        }\n    };\n    for (var methodName in source) {\n        _loop_1(methodName);\n    }\n    return hoisted;\n}\nexports.hoistMethods = hoistMethods;\n/**\n * Provides a method for convenience to unhoist hoisted methods.\n * @param {any} source The source object upon which methods were hoisted.\n * @param {string[]} methodNames An array of method names to unhoist.\n */\nfunction unhoistMethods(source, methodNames) {\n    methodNames\n        .forEach(function (methodName) { return delete source[methodName]; });\n}\nexports.unhoistMethods = unhoistMethods;\n\n\n\n/***/ }),\n/* 49 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(19));\n__export(__webpack_require__(40));\n__export(__webpack_require__(41));\n__export(__webpack_require__(42));\n__export(__webpack_require__(11));\n__export(__webpack_require__(20));\n__export(__webpack_require__(43));\n__export(__webpack_require__(44));\n__export(__webpack_require__(45));\n__export(__webpack_require__(46));\n__export(__webpack_require__(5));\n__export(__webpack_require__(47));\n__export(__webpack_require__(48));\n__export(__webpack_require__(50));\n__export(__webpack_require__(51));\n__export(__webpack_require__(21));\n__export(__webpack_require__(52));\n__export(__webpack_require__(53));\n__export(__webpack_require__(54));\n__export(__webpack_require__(22));\n__export(__webpack_require__(56));\n\n\n\n/***/ }),\n/* 50 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/** Regex to detect words within paraenthesis in a string where gi implies global and case-insensitive. */\nvar CHARS_WITHIN_PARENTHESIS_REGEX = new RegExp('\\\\(([^)]*)\\\\)', 'gi');\n/**\n *  Matches any non-word characters with respect to the Unicode codepoints; generated by\n * https://mothereff.in/regexpu for regex /\\W /u where u stands for Unicode support (ES6 feature).\n * More info here: http://stackoverflow.com/questions/280712/javascript-unicode-regexes.\n * gi implies global and case-insensitive.\n */\n/* tslint:disable:max-line-length */\nvar UNICODE_ALPHANUMERIC_CHARS_REGEX = new RegExp('(?:[\\0-/:-@\\[-\\^`\\{-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]) ', 'gi');\n/* tslint:enable:max-line-length */\n/** Regex to detect multiple spaces in a string where gi implies global and case-insensitive. */\nvar MULTIPLE_WHITESPACES_REGEX_TOKEN = new RegExp('\\\\s+', 'gi');\n/** Regex to detect Arabic text. */\nvar ARABIC_LANGUAGE_REGEX = new RegExp('[\\u0621-\\u064A\\u0660-\\u0669]');\n/** Regex to detect Korean text. */\nvar KOREAN_LANGUAGE_REGEX = new RegExp('[\\u1100-\\u11FF|\\u3130-\\u318F|\\uA960-\\uA97F|\\uAC00-\\uD7AF|\\uD7B0-\\uD7FF]');\n/** Regex to detect Chinese text. */\n/* tslint:disable:max-line-length */\nvar CHINESE_LANGUAGE_REGEX = new RegExp('[\\u4E00-\\u9FCC\\u3400-\\u4DB5\\uFA0E\\uFA0F\\uFA11\\uFA13\\uFA14\\uFA1F\\uFA21\\uFA23\\uFA24\\uFA27-\\uFA29]|[\\ud840-\\ud868][\\udc00-\\udfff]|\\ud869[\\udc00-\\uded6\\udf00-\\udfff]|[\\ud86a-\\ud86c][\\udc00-\\udfff]|\\ud86d[\\udc00-\\udf34\\udf40-\\udfff]|\\ud86e[\\udc00-\\udc1d]');\n/* tslint:enable:max-line-length */\nfunction getInitialsArabic(displayName, isRtl) {\n    var name = displayName.replace(/\\s/, '');\n    return isRtl ? name[name.length - 1] : name[0];\n}\nfunction getInitialsAsian(displayName, isRtl) {\n    var name = displayName.replace(/\\s/, '');\n    // For short names, only display a single character of the family name\n    if (name.length <= 2) {\n        return isRtl ? name[0] : name[name.length - 1];\n    }\n    // For long names, display the two most significant characters of the family name\n    return isRtl ? name.substr(0, 2) : name.substr(name.length - 2, name.length);\n}\nfunction getInitialsLatin(displayName, isRtl) {\n    var initials = '';\n    var splits = displayName.split(' ');\n    if (splits.length === 2) {\n        initials += splits[0].charAt(0).toUpperCase();\n        initials += splits[1].charAt(0).toUpperCase();\n    }\n    else if (splits.length === 3) {\n        initials += splits[0].charAt(0).toUpperCase();\n        initials += splits[2].charAt(0).toUpperCase();\n    }\n    else if (splits.length !== 0) {\n        initials += splits[0].charAt(0).toUpperCase();\n    }\n    if (isRtl && initials.length > 1) {\n        return initials.charAt(1) + initials.charAt(0);\n    }\n    return initials;\n}\nfunction cleanupDisplayName(displayName) {\n    // Do not consider the suffixes within parenthesis while computing the initials.\n    displayName = displayName.replace(CHARS_WITHIN_PARENTHESIS_REGEX, '');\n    // Ignore non-word characters\n    displayName = displayName.replace(UNICODE_ALPHANUMERIC_CHARS_REGEX, '');\n    // Make whitespace consistent\n    displayName = displayName.replace(MULTIPLE_WHITESPACES_REGEX_TOKEN, ' ');\n    displayName = displayName.trim();\n    return displayName;\n}\n/** Get (up to 2 characters) initials based on display name of the persona. */\nfunction getInitials(displayName, isRtl) {\n    if (displayName == null) {\n        return '';\n    }\n    displayName = cleanupDisplayName(displayName);\n    if (ARABIC_LANGUAGE_REGEX.test(displayName)) {\n        return getInitialsArabic(displayName, isRtl);\n    }\n    if (KOREAN_LANGUAGE_REGEX.test(displayName) || CHINESE_LANGUAGE_REGEX.test(displayName)) {\n        return getInitialsAsian(displayName, isRtl);\n    }\n    return getInitialsLatin(displayName, isRtl);\n}\nexports.getInitials = getInitials;\n\n\n\n/***/ }),\n/* 51 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction getDistanceBetweenPoints(point1, point2) {\n    var distance = Math.sqrt(Math.pow(point1.x - point2.x, 2) + Math.pow(point1.y - point2.y, 2));\n    return distance;\n}\nexports.getDistanceBetweenPoints = getDistanceBetweenPoints;\n\n\n\n/***/ }),\n/* 52 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar object_1 = __webpack_require__(21);\nexports.baseElementEvents = [\n    'onCopy',\n    'onCut',\n    'onPaste',\n    'onCompositionEnd',\n    'onCompositionStart',\n    'onCompositionUpdate',\n    'onFocus',\n    'onFocusCapture',\n    'onBlur',\n    'onBlurCapture',\n    'onChange',\n    'onInput',\n    'onSubmit',\n    'onLoad',\n    'onError',\n    'onKeyDown',\n    'onKeyDownCapture',\n    'onKeyPress',\n    'onKeyUp',\n    'onAbort',\n    'onCanPlay',\n    'onCanPlayThrough',\n    'onDurationChange',\n    'onEmptied',\n    'onEncrypted',\n    'onEnded',\n    'onLoadedData',\n    'onLoadedMetadata',\n    'onLoadStart',\n    'onPause',\n    'onPlay',\n    'onPlaying',\n    'onProgress',\n    'onRateChange',\n    'onSeeked',\n    'onSeeking',\n    'onStalled',\n    'onSuspend',\n    'onTimeUpdate',\n    'onVolumeChange',\n    'onWaiting',\n    'onClick',\n    'onClickCapture',\n    'onContextMenu',\n    'onDoubleClick',\n    'onDrag',\n    'onDragEnd',\n    'onDragEnter',\n    'onDragExit',\n    'onDragLeave',\n    'onDragOver',\n    'onDragStart',\n    'onDrop',\n    'onMouseDown',\n    'onMouseDownCapture',\n    'onMouseEnter',\n    'onMouseLeave',\n    'onMouseMove',\n    'onMouseOut',\n    'onMouseOver',\n    'onMouseUp',\n    'onMouseUpCapture',\n    'onSelect',\n    'onTouchCancel',\n    'onTouchEnd',\n    'onTouchMove',\n    'onTouchStart',\n    'onScroll',\n    'onWheel'\n];\nexports.baseElementProperties = [\n    'defaultChecked',\n    'defaultValue',\n    'accept',\n    'acceptCharset',\n    'accessKey',\n    'action',\n    'allowFullScreen',\n    'allowTransparency',\n    'alt',\n    'async',\n    'autoComplete',\n    'autoFocus',\n    'autoPlay',\n    'capture',\n    'cellPadding',\n    'cellSpacing',\n    'charSet',\n    'challenge',\n    'checked',\n    'children',\n    'classID',\n    'className',\n    'cols',\n    'colSpan',\n    'content',\n    'contentEditable',\n    'contextMenu',\n    'controls',\n    'coords',\n    'crossOrigin',\n    'data',\n    'dateTime',\n    'default',\n    'defer',\n    'dir',\n    'download',\n    'draggable',\n    'encType',\n    'form',\n    'formAction',\n    'formEncType',\n    'formMethod',\n    'formNoValidate',\n    'formTarget',\n    'frameBorder',\n    'headers',\n    'height',\n    'hidden',\n    'high',\n    'hrefLang',\n    'htmlFor',\n    'httpEquiv',\n    'icon',\n    'id',\n    'inputMode',\n    'integrity',\n    'is',\n    'keyParams',\n    'keyType',\n    'kind',\n    'label',\n    'lang',\n    'list',\n    'loop',\n    'low',\n    'manifest',\n    'marginHeight',\n    'marginWidth',\n    'max',\n    'maxLength',\n    'media',\n    'mediaGroup',\n    'method',\n    'min',\n    'minLength',\n    'multiple',\n    'muted',\n    'name',\n    'noValidate',\n    'open',\n    'optimum',\n    'pattern',\n    'placeholder',\n    'poster',\n    'preload',\n    'radioGroup',\n    'readOnly',\n    'rel',\n    'required',\n    'role',\n    'rows',\n    'rowSpan',\n    'sandbox',\n    'scope',\n    'scoped',\n    'scrolling',\n    'seamless',\n    'selected',\n    'shape',\n    'size',\n    'sizes',\n    'span',\n    'spellCheck',\n    'src',\n    'srcDoc',\n    'srcLang',\n    'srcSet',\n    'start',\n    'step',\n    'style',\n    'summary',\n    'tabIndex',\n    'title',\n    'type',\n    'useMap',\n    'value',\n    'width',\n    'wmode',\n    'wrap'\n];\nexports.htmlElementProperties = exports.baseElementProperties.concat(exports.baseElementEvents);\nexports.anchorProperties = exports.htmlElementProperties.concat([\n    'href',\n    'target'\n]);\nexports.buttonProperties = exports.htmlElementProperties.concat([\n    'disabled'\n]);\nexports.divProperties = exports.htmlElementProperties.concat(['align', 'noWrap']);\nexports.inputProperties = exports.buttonProperties;\nexports.textAreaProperties = exports.buttonProperties;\nexports.imageProperties = exports.divProperties;\n/**\n * Gets native supported props for an html element provided the allowance set. Use one of the property\n * sets defined (divProperties, buttonPropertes, etc) to filter out supported properties from a given\n * props set. Note that all data- and aria- prefixed attributes will be allowed.\n * NOTE: getNativeProps should always be applied first when adding props to a react component. The\n * non-native props should be applied second. This will prevent getNativeProps from overriding your custom props.\n * For example, if props passed to getNativeProps has an onClick function and getNativeProps is added to\n * the component after an onClick function is added, then the getNativeProps onClick will override it.\n * @param props The unfiltered input props\n * @param allowedPropsNames The array of allowed propnames.\n * @returns The filtered props\n */\nfunction getNativeProps(props, allowedPropNames, excludedPropNames) {\n    return object_1.filteredAssign(function (propName) {\n        return ((!excludedPropNames || excludedPropNames.indexOf(propName) < 0) && ((propName.indexOf('data-') === 0) ||\n            (propName.indexOf('aria-') === 0) ||\n            (allowedPropNames.indexOf(propName) >= 0)));\n    }, {}, props);\n}\nexports.getNativeProps = getNativeProps;\n\n\n\n/***/ }),\n/* 53 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar _baseUrl = '';\n/** Sets the current base url used for fetching images. */\nfunction getResourceUrl(url) {\n    return _baseUrl + url;\n}\nexports.getResourceUrl = getResourceUrl;\n/** Gets the current base url used for fetching images. */\nfunction setBaseUrl(baseUrl) {\n    _baseUrl = baseUrl;\n}\nexports.setBaseUrl = setBaseUrl;\n/** Gets the current runtime language. */\nfunction getLanguage() {\n    return 'en-us';\n}\nexports.getLanguage = getLanguage;\n\n\n\n/***/ }),\n/* 54 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar KeyCodes_1 = __webpack_require__(20);\nvar dom_1 = __webpack_require__(5);\n// Default to undefined so that we initialize on first read.\nvar _isRTL;\n/**\n * Gets the rtl state of the page (returns true if in rtl.)\n */\nfunction getRTL() {\n    if (_isRTL === undefined) {\n        var doc = dom_1.getDocument();\n        if (doc) {\n            _isRTL = document.documentElement.getAttribute('dir') === 'rtl';\n        }\n        else {\n            throw new Error('getRTL was called in a server environment without setRTL being called first. ' +\n                'Call setRTL to set the correct direction first.');\n        }\n    }\n    return _isRTL;\n}\nexports.getRTL = getRTL;\n/**\n * Sets the rtl state of the page (by adjusting the dir attribute of the html element.)\n */\nfunction setRTL(isRTL) {\n    var doc = dom_1.getDocument();\n    if (doc) {\n        doc.documentElement.setAttribute('dir', isRTL ? 'rtl' : 'ltr');\n    }\n    _isRTL = isRTL;\n}\nexports.setRTL = setRTL;\n/**\n * Returns the given key, but flips right/left arrows if necessary.\n */\nfunction getRTLSafeKeyCode(key) {\n    if (getRTL()) {\n        if (key === KeyCodes_1.KeyCodes.left) {\n            key = KeyCodes_1.KeyCodes.right;\n        }\n        else if (key === KeyCodes_1.KeyCodes.right) {\n            key = KeyCodes_1.KeyCodes.left;\n        }\n    }\n    return key;\n}\nexports.getRTLSafeKeyCode = getRTLSafeKeyCode;\n\n\n\n/***/ }),\n/* 55 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/* tslint:disable */\nvar load_themed_styles_1 = __webpack_require__(2);\nvar styles = {\n    msFabricScrollDisabled: 'msFabricScrollDisabled_577a715c',\n};\nexports.default = styles;\nload_themed_styles_1.loadStyles([{ \"rawString\": \".msFabricScrollDisabled_577a715c{overflow:hidden!important}\" }]);\n/* tslint:enable */ \n\n\n\n/***/ }),\n/* 56 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// Regex that finds { and } so they can be removed on a lookup for string format\nvar FORMAT_ARGS_REGEX = /[\\{\\}]/g;\n// Regex that finds {#} so it can be replaced by the arguments in string format\nvar FORMAT_REGEX = /\\{\\d+\\}/g;\n/**\n * String Format is like C# string format.\n * Usage Example: \"hello {0}!\".format(\"mike\") will return \"hello mike!\"\n * Calling format on a string with less arguments than specified in the format is invalid\n * Example \"I love {0} every {1}\".format(\"CXP\") will result in a Debug Exception.\n */\nfunction format(s) {\n    'use strict';\n    var values = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        values[_i - 1] = arguments[_i];\n    }\n    var args = values;\n    // Callback match function\n    function replace_func(match) {\n        // looks up in the args\n        var replacement = args[match.replace(FORMAT_ARGS_REGEX, '')];\n        // catches undefined in nondebug and null in debug and nondebug\n        if (replacement === null || replacement === undefined) {\n            replacement = '';\n        }\n        return replacement;\n    }\n    return (s.replace(FORMAT_REGEX, replace_func));\n}\nexports.format = format;\n\n\n\n/***/ }),\n/* 57 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(70));\n\n\n\n/***/ }),\n/* 58 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(72));\n\n\n\n/***/ }),\n/* 59 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(82));\n\n\n\n/***/ }),\n/* 60 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(90));\n\n\n\n/***/ }),\n/* 61 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(98));\n\n\n\n/***/ }),\n/* 62 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar styles = __webpack_require__(63);\nvar Check = (function (_super) {\n    __extends(Check, _super);\n    function Check() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Check.prototype.shouldComponentUpdate = function (newProps) {\n        return this.props.isChecked !== newProps.isChecked || this.props.checked !== newProps.checked;\n    };\n    Check.prototype.render = function () {\n        var _a = this.props, isChecked = _a.isChecked, checked = _a.checked;\n        isChecked = isChecked || checked;\n        return (React.createElement(\"div\", { className: Utilities_1.css('ms-Check', styles.root, (_b = {},\n                _b['is-checked ' + styles.rootIsChecked] = isChecked,\n                _b)) },\n            React.createElement(\"div\", { className: Utilities_1.css('ms-Icon ms-Check-background', styles.background) }),\n            React.createElement(\"i\", { className: Utilities_1.css('ms-Check-check ms-Icon ms-Icon--CheckMark', styles.check) })));\n        var _b;\n    };\n    return Check;\n}(React.Component));\nCheck.defaultProps = {\n    isChecked: false\n};\nexports.Check = Check;\n\n\n\n/***/ }),\n/* 63 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/* tslint:disable */\nvar load_themed_styles_1 = __webpack_require__(2);\nvar styles = {\n    root: 'root_c567c213',\n    rootIsChecked: 'rootIsChecked_c567c213',\n    background: 'background_c567c213',\n    check: 'check_c567c213',\n};\nload_themed_styles_1.loadStyles([{ \"rawString\": \".root_c567c213{line-height:1;width:24px;height:24px;vertical-align:top;position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.root_c567c213.rootIsChecked_c567c213 .background_c567c213:before{color:\" }, { \"theme\": \"themePrimary\", \"defaultValue\": \"#0078d7\" }, { \"rawString\": \"}.root_c567c213.rootIsChecked_c567c213 .background_c567c213:after{color:\" }, { \"theme\": \"white\", \"defaultValue\": \"#ffffff\" }, { \"rawString\": \"}.root_c567c213.rootIsChecked_c567c213 .check_c567c213{opacity:1;color:\" }, { \"theme\": \"white\", \"defaultValue\": \"#ffffff\" }, { \"rawString\": \";font-weight:900;font-size:12px}.root_c567c213:hover .check_c567c213{opacity:1}.check_c567c213{left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);position:absolute;color:\" }, { \"theme\": \"neutralTertiaryAlt\", \"defaultValue\": \"#c8c8c8\" }, { \"rawString\": \";opacity:0}.background_c567c213{position:relative;height:24px;width:24px}.background_c567c213:before{content:'\\\\E91F';color:\" }, { \"theme\": \"white\", \"defaultValue\": \"#ffffff\" }, { \"rawString\": \"}.background_c567c213:after{content:'\\\\EA3A';color:\" }, { \"theme\": \"neutralTertiaryAlt\", \"defaultValue\": \"#c8c8c8\" }, { \"rawString\": \"}.background_c567c213:after,.background_c567c213:before{left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);font-size:24px;height:24px;width:24px;position:absolute}\" }]);\nmodule.exports = styles;\n/* tslint:enable */ \n\n\n\n/***/ }),\n/* 64 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(62));\n\n\n\n/***/ }),\n/* 65 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar DetailsList_Props_1 = __webpack_require__(7);\nvar FocusZone_1 = __webpack_require__(8);\nvar Check_1 = __webpack_require__(12);\nvar Icon_1 = __webpack_require__(23);\nvar Layer_1 = __webpack_require__(60);\nvar GroupSpacer_1 = __webpack_require__(9);\nvar interfaces_1 = __webpack_require__(3);\nvar styles = __webpack_require__(66);\nvar MOUSEDOWN_PRIMARY_BUTTON = 0; // for mouse down event we are using ev.button property, 0 means left button\nvar MOUSEMOVE_PRIMARY_BUTTON = 1; // for mouse move event we are using ev.buttons property, 1 means left button\nvar INNER_PADDING = 16;\nvar SelectAllVisibility;\n(function (SelectAllVisibility) {\n    SelectAllVisibility[SelectAllVisibility[\"none\"] = 0] = \"none\";\n    SelectAllVisibility[SelectAllVisibility[\"hidden\"] = 1] = \"hidden\";\n    SelectAllVisibility[SelectAllVisibility[\"visible\"] = 2] = \"visible\";\n})(SelectAllVisibility = exports.SelectAllVisibility || (exports.SelectAllVisibility = {}));\nvar DetailsHeader = (function (_super) {\n    __extends(DetailsHeader, _super);\n    function DetailsHeader(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = {\n            columnResizeDetails: null,\n            groupNestingDepth: _this.props.groupNestingDepth,\n            isAllCollapsed: _this.props.isAllCollapsed\n        };\n        _this._onToggleCollapseAll = _this._onToggleCollapseAll.bind(_this);\n        _this._onSelectAllClicked = _this._onSelectAllClicked.bind(_this);\n        return _this;\n    }\n    DetailsHeader.prototype.componentDidMount = function () {\n        var selection = this.props.selection;\n        this._events.on(selection, interfaces_1.SELECTION_CHANGE, this._onSelectionChanged);\n        // We need to use native on this to avoid MarqueeSelection from handling the event before us.\n        this._events.on(this.refs.root, 'mousedown', this._onRootMouseDown);\n    };\n    DetailsHeader.prototype.componentWillReceiveProps = function (newProps) {\n        var groupNestingDepth = this.state.groupNestingDepth;\n        if (newProps.groupNestingDepth !== groupNestingDepth) {\n            this.setState({ groupNestingDepth: newProps.groupNestingDepth });\n        }\n    };\n    DetailsHeader.prototype.render = function () {\n        var _this = this;\n        var _a = this.props, columns = _a.columns, ariaLabel = _a.ariaLabel, ariaLabelForSelectAllCheckbox = _a.ariaLabelForSelectAllCheckbox, selectAllVisibility = _a.selectAllVisibility;\n        var _b = this.state, isAllSelected = _b.isAllSelected, columnResizeDetails = _b.columnResizeDetails, isSizing = _b.isSizing, groupNestingDepth = _b.groupNestingDepth, isAllCollapsed = _b.isAllCollapsed;\n        return (React.createElement(\"div\", { role: 'row', \"aria-label\": ariaLabel, className: Utilities_1.css('ms-DetailsHeader', styles.root, (_c = {},\n                _c['is-allSelected ' + styles.rootIsAllSelected] = isAllSelected,\n                _c['is-selectAllHidden ' + styles.rootIsSelectAllHidden] = selectAllVisibility === SelectAllVisibility.hidden,\n                _c['is-resizingColumn'] = !!columnResizeDetails && isSizing,\n                _c)), ref: 'root', onMouseMove: this._onRootMouseMove, \"data-automationid\": 'DetailsHeader' },\n            React.createElement(FocusZone_1.FocusZone, { ref: 'focusZone', direction: FocusZone_1.FocusZoneDirection.horizontal },\n                React.createElement(\"div\", { className: Utilities_1.css('ms-DetailsHeader-cellWrapper', styles.cellWrapper), role: 'columnheader' }, (selectAllVisibility === SelectAllVisibility.visible) ? (React.createElement(\"button\", { type: 'button', className: Utilities_1.css('ms-DetailsHeader-cell is-check', styles.cell, styles.cellIsCheck), onClick: this._onSelectAllClicked, \"aria-label\": ariaLabelForSelectAllCheckbox, \"aria-pressed\": isAllSelected },\n                    React.createElement(Check_1.Check, { checked: isAllSelected }))) : null),\n                groupNestingDepth > 0 ? (React.createElement(\"button\", { type: 'button', className: Utilities_1.css('ms-DetailsHeader-cell', styles.cell), onClick: this._onToggleCollapseAll },\n                    React.createElement(Icon_1.Icon, { className: Utilities_1.css('ms-DetailsHeader-collapseButton', styles.collapseButton, isAllCollapsed && ('is-collapsed ' + styles.collapseButtonIsCollapsed)), iconName: 'ChevronDown' }))) : (null),\n                GroupSpacer_1.GroupSpacer({ count: groupNestingDepth - 1 }),\n                columns.map(function (column, columnIndex) {\n                    return (React.createElement(\"div\", { key: column.key, className: Utilities_1.css('ms-DetailsHeader-cellWrapper', styles.cellWrapper), role: 'columnheader', \"aria-sort\": column.isSorted ? (column.isSortedDescending ? 'descending' : 'ascending') : 'none' },\n                        React.createElement(\"button\", { type: 'button', key: column.fieldName, disabled: column.columnActionsMode === DetailsList_Props_1.ColumnActionsMode.disabled, className: Utilities_1.css('ms-DetailsHeader-cell', styles.cell, column.headerClassName, (_a = {},\n                                _a['is-actionable ' + styles.cellIsActionable] = column.columnActionsMode !== DetailsList_Props_1.ColumnActionsMode.disabled,\n                                _a['is-empty ' + styles.cellIsEmpty] = !column.name,\n                                _a['is-icon-visible'] = column.isSorted || column.isGrouped || column.isFiltered,\n                                _a)), style: { width: column.calculatedWidth + INNER_PADDING }, onClick: _this._onColumnClick.bind(_this, column), onContextMenu: _this._onColumnContextMenu.bind(_this, column), \"aria-haspopup\": column.columnActionsMode === DetailsList_Props_1.ColumnActionsMode.hasDropdown, \"aria-label\": column.ariaLabel || column.name, \"data-automationid\": 'ColumnsHeaderColumn', \"data-item-key\": column.key },\n                            column.isFiltered && (React.createElement(Icon_1.Icon, { className: styles.nearIcon, iconName: 'Filter' })),\n                            column.isSorted && (React.createElement(Icon_1.Icon, { className: styles.nearIcon, iconName: column.isSortedDescending ? 'SortDown' : 'SortUp' })),\n                            column.isGrouped && (React.createElement(Icon_1.Icon, { className: styles.nearIcon, iconName: 'GroupedDescending' })),\n                            column.iconClassName && (React.createElement(Icon_1.Icon, { className: Utilities_1.css(styles.nearIcon, column.iconClassName), iconName: column.iconName })),\n                            column.name,\n                            column.columnActionsMode === DetailsList_Props_1.ColumnActionsMode.hasDropdown && (React.createElement(Icon_1.Icon, { className: Utilities_1.css('ms-DetailsHeader-filterChevron', styles.filterChevron), iconName: 'ChevronDown' }))),\n                        (column.isResizable) && (React.createElement(\"div\", { \"data-sizer-index\": columnIndex, className: Utilities_1.css('ms-DetailsHeader-cell is-sizer', styles.cell, styles.cellIsSizer, (_b = {},\n                                _b['is-resizing ' + styles.cellIsResizing] = isSizing && columnResizeDetails.columnIndex === columnIndex,\n                                _b)), onDoubleClick: _this._onSizerDoubleClick.bind(_this, columnIndex) }))));\n                    var _a, _b;\n                })),\n            isSizing && (React.createElement(Layer_1.Layer, null,\n                React.createElement(\"div\", { className: Utilities_1.css(isSizing && styles.sizingOverlay), onMouseMove: this._onSizerMouseMove, onMouseUp: this._onSizerMouseUp })))));\n        var _c;\n    };\n    /** Set focus to the active thing in the focus area. */\n    DetailsHeader.prototype.focus = function () {\n        return this.refs.focusZone.focus();\n    };\n    /**\n     * double click on the column sizer will auto ajust column width\n     * to fit the longest content among current rendered rows.\n     *\n     * @private\n     * @param {number} columnIndex (index of the column user double clicked)\n     * @param {React.MouseEvent} ev (mouse double click event)\n     */\n    DetailsHeader.prototype._onSizerDoubleClick = function (columnIndex, ev) {\n        var _a = this.props, onColumnAutoResized = _a.onColumnAutoResized, columns = _a.columns;\n        if (onColumnAutoResized) {\n            onColumnAutoResized(columns[columnIndex], columnIndex);\n        }\n    };\n    /**\n     * Called when the select all toggle is clicked.\n     */\n    DetailsHeader.prototype._onSelectAllClicked = function () {\n        var selection = this.props.selection;\n        selection.toggleAllSelected();\n    };\n    DetailsHeader.prototype._onRootMouseDown = function (ev) {\n        var columnIndexAttr = ev.target.getAttribute('data-sizer-index');\n        var columnIndex = Number(columnIndexAttr);\n        var columns = this.props.columns;\n        if (columnIndexAttr === null || ev.button !== MOUSEDOWN_PRIMARY_BUTTON) {\n            // Ignore anything except the primary button.\n            return;\n        }\n        this.setState({\n            columnResizeDetails: {\n                columnIndex: columnIndex,\n                columnMinWidth: columns[columnIndex].calculatedWidth,\n                originX: ev.clientX\n            }\n        });\n        ev.preventDefault();\n        ev.stopPropagation();\n    };\n    DetailsHeader.prototype._onRootMouseMove = function (ev) {\n        var _a = this.state, columnResizeDetails = _a.columnResizeDetails, isSizing = _a.isSizing;\n        if (columnResizeDetails && !isSizing && ev.clientX !== columnResizeDetails.originX) {\n            this.setState({ isSizing: true });\n        }\n    };\n    /**\n     * mouse move event handler in the header\n     * it will set isSizing state to true when user clicked on the sizer and move the mouse.\n     *\n     * @private\n     * @param {React.MouseEvent} ev (mouse move event)\n     */\n    DetailsHeader.prototype._onSizerMouseMove = function (ev) {\n        var \n        // use buttons property here since ev.button in some edge case is not upding well during the move.\n        // but firefox doesn't support it, so we set the default value when it is not defined.\n        buttons = ev.buttons;\n        var _a = this.props, onColumnIsSizingChanged = _a.onColumnIsSizingChanged, onColumnResized = _a.onColumnResized, columns = _a.columns;\n        var columnResizeDetails = this.state.columnResizeDetails;\n        if (buttons !== undefined && buttons !== MOUSEMOVE_PRIMARY_BUTTON) {\n            // cancel mouse down event and return early when the primary button is not pressed\n            this._onSizerMouseUp(ev);\n            return;\n        }\n        if (ev.clientX !== columnResizeDetails.originX) {\n            if (onColumnIsSizingChanged) {\n                onColumnIsSizingChanged(columns[columnResizeDetails.columnIndex], true);\n            }\n        }\n        if (onColumnResized) {\n            var movement = ev.clientX - columnResizeDetails.originX;\n            if (Utilities_1.getRTL()) {\n                movement = -movement;\n            }\n            onColumnResized(columns[columnResizeDetails.columnIndex], columnResizeDetails.columnMinWidth + movement);\n        }\n    };\n    /**\n     * mouse up event handler in the header\n     * clear the resize related state.\n     * This is to ensure we can catch double click event\n     *\n     * @private\n     * @param {React.MouseEvent} ev (mouse up event)\n     */\n    DetailsHeader.prototype._onSizerMouseUp = function (ev) {\n        var _a = this.props, columns = _a.columns, onColumnIsSizingChanged = _a.onColumnIsSizingChanged;\n        var columnResizeDetails = this.state.columnResizeDetails;\n        this.setState({\n            columnResizeDetails: null,\n            isSizing: false\n        });\n        if (onColumnIsSizingChanged) {\n            onColumnIsSizingChanged(columns[columnResizeDetails.columnIndex], false);\n        }\n    };\n    DetailsHeader.prototype._onSelectionChanged = function () {\n        var isAllSelected = this.props.selection.isAllSelected();\n        if (this.state.isAllSelected !== isAllSelected) {\n            this.setState({\n                isAllSelected: isAllSelected\n            });\n        }\n    };\n    DetailsHeader.prototype._onColumnClick = function (column, ev) {\n        var onColumnClick = this.props.onColumnClick;\n        if (column.onColumnClick) {\n            column.onColumnClick(ev, column);\n        }\n        if (onColumnClick) {\n            onColumnClick(ev, column);\n        }\n    };\n    DetailsHeader.prototype._onColumnContextMenu = function (column, ev) {\n        var onColumnContextMenu = this.props.onColumnContextMenu;\n        if (column.onContextMenu) {\n            column.onColumnContextMenu(column, ev);\n        }\n        if (onColumnContextMenu) {\n            onColumnContextMenu(column, ev);\n        }\n    };\n    DetailsHeader.prototype._onToggleCollapseAll = function () {\n        var onToggleCollapseAll = this.props.onToggleCollapseAll;\n        var newCollapsed = !this.state.isAllCollapsed;\n        this.setState({\n            isAllCollapsed: newCollapsed\n        });\n        if (onToggleCollapseAll) {\n            onToggleCollapseAll(newCollapsed);\n        }\n    };\n    return DetailsHeader;\n}(Utilities_1.BaseComponent));\nDetailsHeader.defaultProps = {\n    isSelectAllVisible: SelectAllVisibility.visible\n};\n__decorate([\n    Utilities_1.autobind\n], DetailsHeader.prototype, \"_onSelectAllClicked\", null);\n__decorate([\n    Utilities_1.autobind\n], DetailsHeader.prototype, \"_onRootMouseDown\", null);\n__decorate([\n    Utilities_1.autobind\n], DetailsHeader.prototype, \"_onRootMouseMove\", null);\n__decorate([\n    Utilities_1.autobind\n], DetailsHeader.prototype, \"_onSizerMouseMove\", null);\n__decorate([\n    Utilities_1.autobind\n], DetailsHeader.prototype, \"_onSizerMouseUp\", null);\nexports.DetailsHeader = DetailsHeader;\n\n\n\n/***/ }),\n/* 66 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/* tslint:disable */\nvar load_themed_styles_1 = __webpack_require__(2);\nvar styles = {\n    root: 'root_87783ec3',\n    rootIsSelectAllHidden: 'rootIsSelectAllHidden_87783ec3',\n    cell: 'cell_87783ec3',\n    cellIsCheck: 'cellIsCheck_87783ec3',\n    rootIsAllSelected: 'rootIsAllSelected_87783ec3',\n    cellWrapper: 'cellWrapper_87783ec3',\n    cellIsActionable: 'cellIsActionable_87783ec3',\n    cellIsSizer: 'cellIsSizer_87783ec3',\n    cellIsEmpty: 'cellIsEmpty_87783ec3',\n    cellIsResizing: 'cellIsResizing_87783ec3',\n    collapseButton: 'collapseButton_87783ec3',\n    collapseButtonIsCollapsed: 'collapseButtonIsCollapsed_87783ec3',\n    nearIcon: 'nearIcon_87783ec3',\n    filterChevron: 'filterChevron_87783ec3',\n    sizingOverlay: 'sizingOverlay_87783ec3',\n};\nload_themed_styles_1.loadStyles([{ \"rawString\": \".root_87783ec3{display:inline-block;min-width:100%;height:36px;line-height:36px;white-space:nowrap;padding-bottom:1px;border-bottom:1px solid \" }, { \"theme\": \"neutralLight\", \"defaultValue\": \"#eaeaea\" }, { \"rawString\": \";cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html[dir=ltr] .root_87783ec3.rootIsSelectAllHidden_87783ec3{padding-left:36px}html[dir=rtl] .root_87783ec3.rootIsSelectAllHidden_87783ec3{padding-right:36px}.cell_87783ec3.cellIsCheck_87783ec3 .ms-Check-background{opacity:0}.cell_87783ec3.cellIsCheck_87783ec3:hover .ms-Check-background,.root_87783ec3.rootIsAllSelected_87783ec3 .ms-Check-background{opacity:1}.cellWrapper_87783ec3{display:inline-block;position:relative}.cell_87783ec3{font-family:\\\"Segoe UI WestEuropean\\\",\\\"Segoe UI\\\",-apple-system,BlinkMacSystemFont,Roboto,\\\"Helvetica Neue\\\",sans-serif;-webkit-font-smoothing:antialiased;font-size:12px;font-weight:400;background:0 0;color:\" }, { \"theme\": \"neutralTertiaryAlt\", \"defaultValue\": \"#c8c8c8\" }, { \"rawString\": \";font-weight:400;position:relative;display:inline-block;box-sizing:border-box;padding:0 8px;border:none;line-height:inherit;margin:0;height:36px;vertical-align:top;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.cell_87783ec3::-moz-focus-inner{border:0}.cell_87783ec3{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .cell_87783ec3:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid \" }, { \"theme\": \"neutralSecondary\", \"defaultValue\": \"#666666\" }, { \"rawString\": \"}html[dir=ltr] .cell_87783ec3{text-align:left}html[dir=rtl] .cell_87783ec3{text-align:right}html[dir=ltr] .cell_87783ec3{text-align:left}html[dir=rtl] .cell_87783ec3{text-align:right}.cell_87783ec3.cellIsCheck_87783ec3{position:relative;padding:6px;margin:0}.cell_87783ec3.cellIsActionable_87783ec3{color:\" }, { \"theme\": \"neutralSecondary\", \"defaultValue\": \"#666666\" }, { \"rawString\": \"}.cell_87783ec3.cellIsActionable_87783ec3:hover{color:\" }, { \"theme\": \"neutralPrimary\", \"defaultValue\": \"#333333\" }, { \"rawString\": \";background:\" }, { \"theme\": \"neutralLighterAlt\", \"defaultValue\": \"#f8f8f8\" }, { \"rawString\": \"}.cell_87783ec3.cellIsActionable_87783ec3:active{background:\" }, { \"theme\": \"neutralLight\", \"defaultValue\": \"#eaeaea\" }, { \"rawString\": \"}.cell_87783ec3.cellIsSizer_87783ec3{position:absolute;width:16px;cursor:ew-resize;bottom:0;top:0;height:inherit;background:0 0}html[dir=ltr] .cell_87783ec3.cellIsSizer_87783ec3{margin-left:-10px}html[dir=rtl] .cell_87783ec3.cellIsSizer_87783ec3{margin-right:-10px}.cell_87783ec3.cellIsEmpty_87783ec3{text-overflow:clip}.cell_87783ec3.cellIsSizer_87783ec3:after{content:'';position:absolute;left:50%;top:0;bottom:0;width:1px;background:\" }, { \"theme\": \"neutralTertiaryAlt\", \"defaultValue\": \"#c8c8c8\" }, { \"rawString\": \";opacity:0}.cell_87783ec3.cellIsSizer_87783ec3.cellIsResizing_87783ec3:after,.cell_87783ec3.cellIsSizer_87783ec3:hover:after{opacity:1;-webkit-transition:opacity .3s linear;transition:opacity .3s linear}.collapseButton_87783ec3{text-align:center;-webkit-transform:rotate(-180deg);transform:rotate(-180deg);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transition:-webkit-transform .1s linear;transition:-webkit-transform .1s linear;transition:transform .1s linear;transition:transform .1s linear,-webkit-transform .1s linear;width:20px;outline:0}.collapseButton_87783ec3.collapseButtonIsCollapsed_87783ec3{-webkit-transform:rotate(0);transform:rotate(0)}.cell_87783ec3 .nearIcon_87783ec3{color:\" }, { \"theme\": \"neutralSecondary\", \"defaultValue\": \"#666666\" }, { \"rawString\": \";opacity:1}html[dir=ltr] .cell_87783ec3 .nearIcon_87783ec3{padding-right:4px}html[dir=rtl] .cell_87783ec3 .nearIcon_87783ec3{padding-left:4px}.cell_87783ec3 .filterChevron_87783ec3{color:\" }, { \"theme\": \"neutralTertiary\", \"defaultValue\": \"#a6a6a6\" }, { \"rawString\": \";vertical-align:middle}html[dir=ltr] .cell_87783ec3 .filterChevron_87783ec3{padding-left:4px}html[dir=rtl] .cell_87783ec3 .filterChevron_87783ec3{padding-right:4px}.sizingOverlay_87783ec3{position:absolute;left:0;top:0;right:0;bottom:0;cursor:ew-resize;background:rgba(255,255,255,0)}html[dir=ltr] .cell_87783ec3 .collapseButton_87783ec3{padding-right:0}html[dir=rtl] .cell_87783ec3 .collapseButton_87783ec3{padding-left:0}\" }]);\nmodule.exports = styles;\n/* tslint:enable */ \n\n\n\n/***/ }),\n/* 67 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar DetailsList_Props_1 = __webpack_require__(7);\nvar DetailsHeader_1 = __webpack_require__(65);\nvar DetailsRow_1 = __webpack_require__(25);\nvar FocusZone_1 = __webpack_require__(8);\nvar GroupedList_1 = __webpack_require__(59);\nvar List_1 = __webpack_require__(13);\nvar withViewport_1 = __webpack_require__(100);\nvar index_1 = __webpack_require__(6);\nvar DragDropHelper_1 = __webpack_require__(101);\nvar styles = __webpack_require__(68);\nvar MIN_COLUMN_WIDTH = 100; // this is the global min width\nvar CHECKBOX_WIDTH = 36;\nvar GROUP_EXPAND_WIDTH = 36;\nvar DEFAULT_INNER_PADDING = 16;\nvar DEFAULT_RENDERED_WINDOWS_AHEAD = 2;\nvar DEFAULT_RENDERED_WINDOWS_BEHIND = 2;\nvar DetailsList = (function (_super) {\n    __extends(DetailsList, _super);\n    function DetailsList(props) {\n        var _this = _super.call(this, props) || this;\n        _this._activeRows = {};\n        _this._columnOverrides = {};\n        _this._onColumnIsSizingChanged = _this._onColumnIsSizingChanged.bind(_this);\n        _this._onColumnResized = _this._onColumnResized.bind(_this);\n        _this._onColumnAutoResized = _this._onColumnAutoResized.bind(_this);\n        _this._onRowDidMount = _this._onRowDidMount.bind(_this);\n        _this._onRowWillUnmount = _this._onRowWillUnmount.bind(_this);\n        _this._onToggleCollapse = _this._onToggleCollapse.bind(_this);\n        _this._onActiveRowChanged = _this._onActiveRowChanged.bind(_this);\n        _this._onHeaderKeyDown = _this._onHeaderKeyDown.bind(_this);\n        _this._onContentKeyDown = _this._onContentKeyDown.bind(_this);\n        _this._onRenderCell = _this._onRenderCell.bind(_this);\n        _this._onGroupExpandStateChanged = _this._onGroupExpandStateChanged.bind(_this);\n        _this.state = {\n            lastWidth: 0,\n            adjustedColumns: _this._getAdjustedColumns(props),\n            layoutMode: props.layoutMode,\n            isSizing: false,\n            isDropping: false,\n            isCollapsed: props.groupProps && props.groupProps.isAllGroupsCollapsed,\n            isSomeGroupExpanded: props.groupProps && !props.groupProps.isAllGroupsCollapsed\n        };\n        _this._events = new Utilities_1.EventGroup(_this);\n        _this._selection = props.selection || new index_1.Selection({ onSelectionChanged: null, getKey: props.getKey });\n        _this._selection.setItems(props.items, false);\n        _this._dragDropHelper = props.dragDropEvents ? new DragDropHelper_1.DragDropHelper({ selection: _this._selection }) : null;\n        _this._initialFocusedIndex = props.initialFocusedIndex;\n        return _this;\n    }\n    DetailsList.prototype.componentWillUnmount = function () {\n        this._events.dispose();\n        if (this._dragDropHelper) {\n            this._dragDropHelper.dispose();\n        }\n    };\n    DetailsList.prototype.componentDidUpdate = function (prevProps, prevState) {\n        if (this.props.onDidUpdate) {\n            this.props.onDidUpdate(this);\n        }\n    };\n    DetailsList.prototype.componentWillReceiveProps = function (newProps) {\n        var _a = this.props, checkboxVisibility = _a.checkboxVisibility, items = _a.items, setKey = _a.setKey, selectionMode = _a.selectionMode, columns = _a.columns, viewport = _a.viewport;\n        var layoutMode = this.state.layoutMode;\n        var shouldResetSelection = (newProps.setKey !== setKey) || newProps.setKey === undefined;\n        var shouldForceUpdates = false;\n        if (newProps.layoutMode !== this.props.layoutMode) {\n            layoutMode = newProps.layoutMode;\n            this.setState({ layoutMode: layoutMode });\n            shouldForceUpdates = true;\n        }\n        if (shouldResetSelection) {\n            this._initialFocusedIndex = newProps.initialFocusedIndex;\n        }\n        if (newProps.items !== items) {\n            this._selection.setItems(newProps.items, shouldResetSelection);\n        }\n        if (newProps.checkboxVisibility !== checkboxVisibility ||\n            newProps.columns !== columns ||\n            newProps.viewport.width !== viewport.width) {\n            shouldForceUpdates = true;\n        }\n        this._adjustColumns(newProps, true, layoutMode);\n        if (newProps.selectionMode !== selectionMode) {\n            shouldForceUpdates = true;\n        }\n        if (shouldForceUpdates) {\n            this._forceListUpdates();\n        }\n    };\n    DetailsList.prototype.render = function () {\n        var _this = this;\n        var _a = this.props, ariaLabelForListHeader = _a.ariaLabelForListHeader, ariaLabelForSelectAllCheckbox = _a.ariaLabelForSelectAllCheckbox, className = _a.className, checkboxVisibility = _a.checkboxVisibility, constrainMode = _a.constrainMode, dragDropEvents = _a.dragDropEvents, groups = _a.groups, groupProps = _a.groupProps, items = _a.items, isHeaderVisible = _a.isHeaderVisible, onItemInvoked = _a.onItemInvoked, onItemContextMenu = _a.onItemContextMenu, onColumnHeaderClick = _a.onColumnHeaderClick, onColumnHeaderContextMenu = _a.onColumnHeaderContextMenu, selectionMode = _a.selectionMode, selectionPreservedOnEmptyClick = _a.selectionPreservedOnEmptyClick, ariaLabel = _a.ariaLabel, ariaLabelForGrid = _a.ariaLabelForGrid, rowElementEventMap = _a.rowElementEventMap, _b = _a.shouldApplyApplicationRole, shouldApplyApplicationRole = _b === void 0 ? false : _b, getKey = _a.getKey;\n        var _c = this.state, adjustedColumns = _c.adjustedColumns, isCollapsed = _c.isCollapsed, layoutMode = _c.layoutMode, isSizing = _c.isSizing, isSomeGroupExpanded = _c.isSomeGroupExpanded;\n        var _d = this, selection = _d._selection, dragDropHelper = _d._dragDropHelper;\n        var groupNestingDepth = this._getGroupNestingDepth();\n        var additionalListProps = {\n            renderedWindowsAhead: isSizing ? 0 : DEFAULT_RENDERED_WINDOWS_AHEAD,\n            renderedWindowsBehind: isSizing ? 0 : DEFAULT_RENDERED_WINDOWS_BEHIND,\n            getKey: getKey\n        };\n        var selectAllVisibility = DetailsHeader_1.SelectAllVisibility.none; // for SelectionMode.none\n        if (selectionMode === index_1.SelectionMode.single) {\n            selectAllVisibility = DetailsHeader_1.SelectAllVisibility.hidden;\n        }\n        if (selectionMode === index_1.SelectionMode.multiple) {\n            // if isCollapsedGroupSelectVisible is false, disable select all when the list has all collapsed groups\n            var isCollapsedGroupSelectVisible = groupProps && groupProps.headerProps && groupProps.headerProps.isCollapsedGroupSelectVisible;\n            if (isCollapsedGroupSelectVisible === undefined) {\n                isCollapsedGroupSelectVisible = true;\n            }\n            var isSelectAllVisible = isCollapsedGroupSelectVisible || !groups || isSomeGroupExpanded;\n            selectAllVisibility = isSelectAllVisible ? DetailsHeader_1.SelectAllVisibility.visible : DetailsHeader_1.SelectAllVisibility.hidden;\n        }\n        if (checkboxVisibility === DetailsList_Props_1.CheckboxVisibility.hidden) {\n            selectAllVisibility = DetailsHeader_1.SelectAllVisibility.none;\n        }\n        return (\n        // If shouldApplyApplicationRole is true, role application will be applied to make arrow keys work\n        // with JAWS.\n        React.createElement(\"div\", __assign({ ref: 'root', className: Utilities_1.css('ms-DetailsList', styles.root, className, (_e = {\n                    'is-fixed': layoutMode === DetailsList_Props_1.DetailsListLayoutMode.fixedColumns\n                },\n                _e['is-horizontalConstrained ' + styles.rootIsHorizontalConstrained] = constrainMode === DetailsList_Props_1.ConstrainMode.horizontalConstrained,\n                _e)), \"data-automationid\": 'DetailsList', \"data-is-scrollable\": 'false', \"aria-label\": ariaLabel }, (shouldApplyApplicationRole ? { role: 'application' } : {})),\n            React.createElement(\"div\", { role: 'grid', \"aria-label\": ariaLabelForGrid },\n                React.createElement(\"div\", { onKeyDown: this._onHeaderKeyDown, role: 'presentation' }, isHeaderVisible && (React.createElement(DetailsHeader_1.DetailsHeader, { ref: 'header', selectionMode: selectionMode, layoutMode: layoutMode, selection: selection, columns: adjustedColumns, onColumnClick: onColumnHeaderClick, onColumnContextMenu: onColumnHeaderContextMenu, onColumnResized: this._onColumnResized, onColumnIsSizingChanged: this._onColumnIsSizingChanged, onColumnAutoResized: this._onColumnAutoResized, groupNestingDepth: groupNestingDepth, isAllCollapsed: isCollapsed, onToggleCollapseAll: this._onToggleCollapse, ariaLabel: ariaLabelForListHeader, ariaLabelForSelectAllCheckbox: ariaLabelForSelectAllCheckbox, selectAllVisibility: selectAllVisibility }))),\n                React.createElement(\"div\", { ref: 'contentContainer', onKeyDown: this._onContentKeyDown, role: 'presentation' },\n                    React.createElement(FocusZone_1.FocusZone, { ref: 'focusZone', className: styles.focusZone, direction: FocusZone_1.FocusZoneDirection.vertical, isInnerZoneKeystroke: function (ev) { return (ev.which === Utilities_1.getRTLSafeKeyCode(Utilities_1.KeyCodes.right)); }, onActiveElementChanged: this._onActiveRowChanged },\n                        React.createElement(index_1.SelectionZone, { ref: 'selectionZone', selection: selection, selectionPreservedOnEmptyClick: selectionPreservedOnEmptyClick, selectionMode: selectionMode, onItemInvoked: onItemInvoked, onItemContextMenu: onItemContextMenu }, groups ? (React.createElement(GroupedList_1.GroupedList, { groups: groups, groupProps: groupProps, items: items, onRenderCell: this._onRenderCell, selection: selection, selectionMode: selectionMode, dragDropEvents: dragDropEvents, dragDropHelper: dragDropHelper, eventsToRegister: rowElementEventMap, listProps: additionalListProps, onGroupExpandStateChanged: this._onGroupExpandStateChanged, ref: 'groupedList' })) : (React.createElement(List_1.List, __assign({ role: null, items: items, onRenderCell: function (item, itemIndex) { return _this._onRenderCell(0, item, itemIndex); } }, additionalListProps, { ref: 'list' })))))))));\n        var _e;\n    };\n    DetailsList.prototype.forceUpdate = function () {\n        _super.prototype.forceUpdate.call(this);\n        this._forceListUpdates();\n    };\n    DetailsList.prototype._onRenderRow = function (props, defaultRender) {\n        return React.createElement(DetailsRow_1.DetailsRow, __assign({}, props));\n    };\n    DetailsList.prototype._onRenderCell = function (nestingDepth, item, index) {\n        var _a = this.props, dragDropEvents = _a.dragDropEvents, eventsToRegister = _a.rowElementEventMap, onRenderMissingItem = _a.onRenderMissingItem, onRenderItemColumn = _a.onRenderItemColumn, _b = _a.onRenderRow, onRenderRow = _b === void 0 ? this._onRenderRow : _b, selectionMode = _a.selectionMode, viewport = _a.viewport, checkboxVisibility = _a.checkboxVisibility, getRowAriaLabel = _a.getRowAriaLabel, checkButtonAriaLabel = _a.checkButtonAriaLabel;\n        var selection = this._selection;\n        var dragDropHelper = this._dragDropHelper;\n        var columns = this.state.adjustedColumns;\n        if (!item) {\n            if (onRenderMissingItem) {\n                onRenderMissingItem(index);\n            }\n            return null;\n        }\n        return onRenderRow({\n            item: item,\n            itemIndex: index,\n            columns: columns,\n            groupNestingDepth: nestingDepth,\n            selectionMode: selectionMode,\n            selection: selection,\n            onDidMount: this._onRowDidMount,\n            onWillUnmount: this._onRowWillUnmount,\n            onRenderItemColumn: onRenderItemColumn,\n            eventsToRegister: eventsToRegister,\n            dragDropEvents: dragDropEvents,\n            dragDropHelper: dragDropHelper,\n            viewport: viewport,\n            checkboxVisibility: checkboxVisibility,\n            getRowAriaLabel: getRowAriaLabel,\n            checkButtonAriaLabel: checkButtonAriaLabel\n        }, this._onRenderRow);\n    };\n    DetailsList.prototype._onGroupExpandStateChanged = function (isSomeGroupExpanded) {\n        this.setState({ isSomeGroupExpanded: isSomeGroupExpanded });\n    };\n    DetailsList.prototype._onColumnIsSizingChanged = function (column, isSizing) {\n        this.setState({ isSizing: isSizing });\n    };\n    DetailsList.prototype._onHeaderKeyDown = function (ev) {\n        if (ev.which === Utilities_1.KeyCodes.down) {\n            if (this.refs.focusZone && this.refs.focusZone.focus()) {\n                ev.preventDefault();\n                ev.stopPropagation();\n            }\n        }\n    };\n    DetailsList.prototype._onContentKeyDown = function (ev) {\n        if (ev.which === Utilities_1.KeyCodes.up) {\n            if (this.refs.header && this.refs.header.focus()) {\n                ev.preventDefault();\n                ev.stopPropagation();\n            }\n        }\n    };\n    DetailsList.prototype._getGroupNestingDepth = function () {\n        var groups = this.props.groups;\n        var level = 0;\n        var groupsInLevel = groups;\n        while (groupsInLevel && groupsInLevel.length > 0) {\n            level++;\n            groupsInLevel = groupsInLevel[0].children;\n        }\n        return level;\n    };\n    DetailsList.prototype._onRowDidMount = function (row) {\n        var onRowDidMount = this.props.onRowDidMount;\n        var index = row.props.itemIndex;\n        this._activeRows[index] = row; // this is used for column auto resize\n        // Set focus to the row if it should receive focus.\n        if (this._initialFocusedIndex !== undefined && index === this._initialFocusedIndex) {\n            if (this.refs.selectionZone) {\n                this.refs.selectionZone.ignoreNextFocus();\n            }\n            row.focus();\n            delete this._initialFocusedIndex;\n        }\n        if (onRowDidMount) {\n            onRowDidMount(row.props.item, index);\n        }\n    };\n    DetailsList.prototype._onRowWillUnmount = function (row) {\n        var onRowWillUnmount = this.props.onRowWillUnmount;\n        var index = row.props.itemIndex;\n        delete this._activeRows[index];\n        this._events.off(row.refs.root);\n        if (onRowWillUnmount) {\n            onRowWillUnmount(row.props.item, index);\n        }\n    };\n    DetailsList.prototype._onToggleCollapse = function (collapsed) {\n        this.setState({\n            isCollapsed: collapsed\n        });\n        if (this.refs.groupedList) {\n            this.refs.groupedList.toggleCollapseAll(collapsed);\n        }\n    };\n    DetailsList.prototype._forceListUpdates = function () {\n        if (this.refs.groupedList) {\n            this.refs.groupedList.forceUpdate();\n        }\n        if (this.refs.list) {\n            this.refs.list.forceUpdate();\n        }\n    };\n    DetailsList.prototype._adjustColumns = function (newProps, forceUpdate, layoutMode) {\n        var adjustedColumns = this._getAdjustedColumns(newProps, forceUpdate, layoutMode);\n        var viewportWidth = this.props.viewport.width;\n        if (adjustedColumns) {\n            this.setState({\n                adjustedColumns: adjustedColumns,\n                lastWidth: viewportWidth,\n                layoutMode: layoutMode\n            });\n        }\n    };\n    /** Returns adjusted columns, given the viewport size and layout mode. */\n    DetailsList.prototype._getAdjustedColumns = function (newProps, forceUpdate, layoutMode) {\n        var _this = this;\n        var newColumns = newProps.columns, newItems = newProps.items, viewportWidth = newProps.viewport.width, selectionMode = newProps.selectionMode;\n        if (layoutMode === undefined) {\n            layoutMode = newProps.layoutMode;\n        }\n        var columns = this.props ? this.props.columns : [];\n        var lastWidth = this.state ? this.state.lastWidth : -1;\n        var lastSelectionMode = this.state ? this.state.lastSelectionMode : undefined;\n        if (viewportWidth !== undefined) {\n            if (!forceUpdate &&\n                lastWidth === viewportWidth &&\n                lastSelectionMode === selectionMode &&\n                (!columns || newColumns === columns)) {\n                return;\n            }\n        }\n        else {\n            viewportWidth = this.props.viewport.width;\n        }\n        newColumns = newColumns || buildColumns(newItems, true);\n        var adjustedColumns;\n        if (layoutMode === DetailsList_Props_1.DetailsListLayoutMode.fixedColumns) {\n            adjustedColumns = this._getFixedColumns(newColumns);\n        }\n        else {\n            adjustedColumns = this._getJustifiedColumns(newColumns, viewportWidth);\n        }\n        // Preserve adjusted column calculated widths.\n        adjustedColumns.forEach(function (column) {\n            var overrides = _this._columnOverrides[column.key] = _this._columnOverrides[column.key] || {};\n            overrides.calculatedWidth = column.calculatedWidth;\n        });\n        return adjustedColumns;\n    };\n    /** Builds a set of columns based on the given columns mixed with the current overrides. */\n    DetailsList.prototype._getFixedColumns = function (newColumns) {\n        var _this = this;\n        return newColumns.map(function (column) {\n            var newColumn = Utilities_1.assign({}, column, _this._columnOverrides[column.key]);\n            if (!newColumn.calculatedWidth) {\n                newColumn.calculatedWidth = newColumn.maxWidth || newColumn.minWidth || MIN_COLUMN_WIDTH;\n            }\n            return newColumn;\n        });\n    };\n    /** Builds a set of columns to fix within the viewport width. */\n    DetailsList.prototype._getJustifiedColumns = function (newColumns, viewportWidth) {\n        var _a = this.props, selectionMode = _a.selectionMode, groups = _a.groups;\n        var outerPadding = DEFAULT_INNER_PADDING;\n        var rowCheckWidth = (selectionMode !== index_1.SelectionMode.none) ? CHECKBOX_WIDTH : 0;\n        var groupExpandWidth = groups ? GROUP_EXPAND_WIDTH : 0;\n        var totalWidth = 0; // offset because we have one less inner padding.\n        var availableWidth = viewportWidth - outerPadding - rowCheckWidth - groupExpandWidth;\n        var adjustedColumns = newColumns.map(function (column, i) {\n            var newColumn = Utilities_1.assign({}, column, {\n                calculatedWidth: column.minWidth || MIN_COLUMN_WIDTH\n            });\n            totalWidth += newColumn.calculatedWidth + (i > 0 ? DEFAULT_INNER_PADDING : 0);\n            return newColumn;\n        });\n        var lastIndex = adjustedColumns.length - 1;\n        // Remove collapsable columns.\n        while (lastIndex > 1 && totalWidth > availableWidth) {\n            var column = adjustedColumns[lastIndex];\n            if (column.isCollapsable) {\n                totalWidth -= column.calculatedWidth + DEFAULT_INNER_PADDING;\n                adjustedColumns.splice(lastIndex, 1);\n            }\n            lastIndex--;\n        }\n        // Then expand columns starting at the beginning, until we've filled the width.\n        for (var i = 0; i < adjustedColumns.length && totalWidth < availableWidth; i++) {\n            var column = adjustedColumns[i];\n            var maxWidth = column.maxWidth;\n            var minWidth = column.minWidth || maxWidth || MIN_COLUMN_WIDTH;\n            var spaceLeft = availableWidth - totalWidth;\n            var increment = maxWidth ? Math.min(spaceLeft, maxWidth - minWidth) : spaceLeft;\n            // Add remaining space to the last column.\n            if (i === (adjustedColumns.length - 1)) {\n                increment = spaceLeft;\n            }\n            column.calculatedWidth += increment;\n            totalWidth += increment;\n        }\n        // Mark the last column as not resizable to avoid extra scrolling issues.\n        if (adjustedColumns.length) {\n            adjustedColumns[adjustedColumns.length - 1].isResizable = false;\n        }\n        return adjustedColumns;\n    };\n    DetailsList.prototype._onColumnResized = function (resizingColumn, newWidth) {\n        var newCalculatedWidth = Math.max(resizingColumn.minWidth || MIN_COLUMN_WIDTH, newWidth);\n        if (this.props.onColumnResize) {\n            this.props.onColumnResize(resizingColumn, newCalculatedWidth);\n        }\n        this._columnOverrides[resizingColumn.key].calculatedWidth = newCalculatedWidth;\n        this._adjustColumns(this.props, true, DetailsList_Props_1.DetailsListLayoutMode.fixedColumns);\n        this._forceListUpdates();\n    };\n    /**\n     * Callback function when double clicked on the details header column resizer\n     * which will measure the column cells of all the active rows and resize the\n     * column to the max cell width.\n     *\n     * @private\n     * @param {IColumn} column (double clicked column definition)\n     * @param {number} columnIndex (double clicked column index)\n     * @todo min width 100 should be changed to const value and should be consistent with the value used on _onSizerMove method in DetailsHeader\n     */\n    DetailsList.prototype._onColumnAutoResized = function (column, columnIndex) {\n        var _this = this;\n        var max = 0;\n        var count = 0;\n        var totalCount = Object.keys(this._activeRows).length;\n        for (var key in this._activeRows) {\n            if (this._activeRows.hasOwnProperty(key)) {\n                var currentRow = this._activeRows[key];\n                currentRow.measureCell(columnIndex, function (width) {\n                    max = Math.max(max, width);\n                    count++;\n                    if (count === totalCount) {\n                        _this._onColumnResized(column, max);\n                    }\n                });\n            }\n        }\n    };\n    /**\n     * Call back function when an element in FocusZone becomes active. It will transalate it into item\n     * and call onActiveItemChanged callback if specified.\n     *\n     * @private\n     * @param {el} row element that became active in Focus Zone\n     * @param {ev} focus event from Focus Zone\n     */\n    DetailsList.prototype._onActiveRowChanged = function (el, ev) {\n        var _a = this.props, items = _a.items, onActiveItemChanged = _a.onActiveItemChanged;\n        if (!onActiveItemChanged || !el) {\n            return;\n        }\n        var index = Number(el.getAttribute('data-item-index'));\n        if (index >= 0) {\n            onActiveItemChanged(items[index], index, ev);\n        }\n    };\n    ;\n    return DetailsList;\n}(React.Component));\nDetailsList.defaultProps = {\n    layoutMode: DetailsList_Props_1.DetailsListLayoutMode.justified,\n    selectionMode: index_1.SelectionMode.multiple,\n    constrainMode: DetailsList_Props_1.ConstrainMode.horizontalConstrained,\n    checkboxVisibility: DetailsList_Props_1.CheckboxVisibility.onHover,\n    isHeaderVisible: true\n};\n__decorate([\n    Utilities_1.autobind\n], DetailsList.prototype, \"_onRenderRow\", null);\nDetailsList = __decorate([\n    withViewport_1.withViewport\n], DetailsList);\nexports.DetailsList = DetailsList;\nfunction buildColumns(items, canResizeColumns, onColumnClick, sortedColumnKey, isSortedDescending, groupedColumnKey, isMultiline) {\n    var columns = [];\n    if (items && items.length) {\n        var firstItem = items[0];\n        var isFirstColumn = true;\n        for (var propName in firstItem) {\n            if (firstItem.hasOwnProperty(propName)) {\n                columns.push({\n                    key: propName,\n                    name: propName,\n                    fieldName: propName,\n                    minWidth: MIN_COLUMN_WIDTH,\n                    maxWidth: 300,\n                    isCollapsable: !!columns.length,\n                    isMultiline: (isMultiline === undefined) ? false : isMultiline,\n                    isSorted: sortedColumnKey === propName,\n                    isSortedDescending: !!isSortedDescending,\n                    isRowHeader: false,\n                    columnActionsMode: DetailsList_Props_1.ColumnActionsMode.clickable,\n                    isResizable: canResizeColumns,\n                    onColumnClick: onColumnClick,\n                    isGrouped: groupedColumnKey === propName\n                });\n                isFirstColumn = false;\n            }\n        }\n    }\n    return columns;\n}\nexports.buildColumns = buildColumns;\n\n\n\n/***/ }),\n/* 68 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/* tslint:disable */\nvar load_themed_styles_1 = __webpack_require__(2);\nvar styles = {\n    root: 'root_999ed1e7',\n    focusZone: 'focusZone_999ed1e7',\n    rootIsHorizontalConstrained: 'rootIsHorizontalConstrained_999ed1e7',\n};\nload_themed_styles_1.loadStyles([{ \"rawString\": \".root_999ed1e7{position:relative;font-size:12px}.focusZone_999ed1e7{display:inline-block;vertical-align:top;min-width:1px;min-height:1px}.rootIsHorizontalConstrained_999ed1e7{overflow-x:auto;overflow-y:visible;-webkit-overflow-scrolling:touch}.root_999ed1e7 .ms-List-cell{min-height:38px;word-break:break-word}\" }]);\nmodule.exports = styles;\n/* tslint:enable */ \n\n\n\n/***/ }),\n/* 69 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar styles = __webpack_require__(14);\nvar DetailsRowFields = (function (_super) {\n    __extends(DetailsRowFields, _super);\n    function DetailsRowFields(props) {\n        var _this = _super.call(this) || this;\n        _this.state = _this._getState(props);\n        return _this;\n    }\n    DetailsRowFields.prototype.componentWillReceiveProps = function (newProps) {\n        this.setState(this._getState(newProps));\n    };\n    DetailsRowFields.prototype.render = function () {\n        var columns = this.props.columns;\n        var cellContent = this.state.cellContent;\n        return (React.createElement(\"div\", { className: Utilities_1.css('ms-DetailsRow-fields', styles.fields), \"data-automationid\": 'DetailsRowFields' }, columns.map(function (column, columnIndex) {\n            return (React.createElement(\"div\", { key: columnIndex, role: column.isRowHeader ? 'rowheader' : 'gridcell', className: Utilities_1.css('ms-DetailsRow-cell', styles.cell, column.className, (_a = {\n                        'is-multiline': column.isMultiline\n                    },\n                    _a[styles.isMultiline] = column.isMultiline,\n                    _a)), style: { width: column.calculatedWidth }, \"data-automationid\": 'DetailsRowCell', \"data-automation-key\": column.key }, cellContent[columnIndex]));\n            var _a;\n        })));\n    };\n    DetailsRowFields.prototype._getState = function (props) {\n        var _this = this;\n        var item = props.item, itemIndex = props.itemIndex, onRenderItemColumn = props.onRenderItemColumn;\n        return {\n            cellContent: props.columns.map(function (column) {\n                var cellContent;\n                try {\n                    var render = column.onRender || onRenderItemColumn;\n                    cellContent = render ? render(item, itemIndex, column) : _this._getCellText(item, column);\n                }\n                catch (e) { }\n                return cellContent;\n            })\n        };\n    };\n    DetailsRowFields.prototype._getCellText = function (item, column) {\n        var value = (item && column && column.fieldName) ? item[column.fieldName] : '';\n        if (value === null || value === undefined) {\n            value = '';\n        }\n        return value;\n    };\n    return DetailsRowFields;\n}(React.Component));\nexports.DetailsRowFields = DetailsRowFields;\n\n\n\n/***/ }),\n/* 70 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(6));\n__export(__webpack_require__(67));\n__export(__webpack_require__(7));\n__export(__webpack_require__(25));\n__export(__webpack_require__(26));\n\n\n\n/***/ }),\n/* 71 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar DIRECTIONAL_KEY_CODES = [\n    Utilities_1.KeyCodes.up,\n    Utilities_1.KeyCodes.down,\n    Utilities_1.KeyCodes.left,\n    Utilities_1.KeyCodes.right,\n    Utilities_1.KeyCodes.home,\n    Utilities_1.KeyCodes.end,\n    Utilities_1.KeyCodes.tab,\n    Utilities_1.KeyCodes.pageUp,\n    Utilities_1.KeyCodes.pageDown\n];\n// We will track the last focus visibility state so that if we tear down and recreate\n// the Fabric component, we will use the last known value as the default.\nvar _lastIsFocusVisible = false;\n// Ensure that the HTML element has a dir specified. This helps to ensure RTL/LTR macros in css for all components will work.\nif (typeof (document) === 'object' && document.documentElement && !document.documentElement.getAttribute('dir')) {\n    document.documentElement.setAttribute('dir', 'ltr');\n}\nvar Fabric = (function (_super) {\n    __extends(Fabric, _super);\n    function Fabric() {\n        var _this = _super.call(this) || this;\n        _this.state = {\n            isFocusVisible: _lastIsFocusVisible\n        };\n        _this._events = new Utilities_1.EventGroup(_this);\n        return _this;\n    }\n    Fabric.prototype.componentDidMount = function () {\n        this._events.on(document.body, 'mousedown', this._onMouseDown, true);\n        this._events.on(document.body, 'keydown', this._onKeyDown, true);\n    };\n    Fabric.prototype.componentWillUnmount = function () {\n        this._events.dispose();\n    };\n    Fabric.prototype.render = function () {\n        var isFocusVisible = this.state.isFocusVisible;\n        var rootClass = Utilities_1.css('ms-Fabric ms-font-m', this.props.className, {\n            'is-focusVisible': isFocusVisible\n        });\n        return (React.createElement(\"div\", __assign({}, this.props, { className: rootClass, ref: 'root' })));\n    };\n    Fabric.prototype._onMouseDown = function () {\n        if (this.state.isFocusVisible) {\n            this.setState({\n                isFocusVisible: false\n            });\n            _lastIsFocusVisible = false;\n        }\n    };\n    Fabric.prototype._onKeyDown = function (ev) {\n        if (!this.state.isFocusVisible && DIRECTIONAL_KEY_CODES.indexOf(ev.which) > -1) {\n            this.setState({\n                isFocusVisible: true\n            });\n            _lastIsFocusVisible = true;\n        }\n    };\n    return Fabric;\n}(React.Component));\nexports.Fabric = Fabric;\n\n\n\n/***/ }),\n/* 72 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(71));\n\n\n\n/***/ }),\n/* 73 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar FocusZone_Props_1 = __webpack_require__(16);\nvar Utilities_1 = __webpack_require__(1);\nvar IS_FOCUSABLE_ATTRIBUTE = 'data-is-focusable';\nvar IS_ENTER_DISABLED_ATTRIBUTE = 'data-disable-click-on-enter';\nvar FOCUSZONE_ID_ATTRIBUTE = 'data-focuszone-id';\nvar TABINDEX = 'tabindex';\nvar _allInstances = {};\nvar ALLOWED_INPUT_TYPES = ['text', 'number', 'password', 'email', 'tel', 'url', 'search'];\nvar FocusZone = (function (_super) {\n    __extends(FocusZone, _super);\n    function FocusZone(props) {\n        var _this = _super.call(this, props, { 'rootProps': null }) || this;\n        _this._id = Utilities_1.getId('FocusZone');\n        _allInstances[_this._id] = _this;\n        _this._focusAlignment = {\n            left: 0,\n            top: 0\n        };\n        return _this;\n    }\n    FocusZone.prototype.componentDidMount = function () {\n        var windowElement = this.refs.root.ownerDocument.defaultView;\n        var parentElement = Utilities_1.getParent(this.refs.root);\n        while (parentElement &&\n            parentElement !== document.body &&\n            parentElement.nodeType === 1) {\n            if (Utilities_1.isElementFocusZone(parentElement)) {\n                this._isInnerZone = true;\n                break;\n            }\n            parentElement = Utilities_1.getParent(parentElement);\n        }\n        this._events.on(windowElement, 'keydown', this._onKeyDownCapture, true);\n        // Assign initial tab indexes so that we can set initial focus as appropriate.\n        this._updateTabIndexes();\n        if (this.props.defaultActiveElement) {\n            this._activeElement = Utilities_1.getDocument().querySelector(this.props.defaultActiveElement);\n            this.focus();\n        }\n    };\n    FocusZone.prototype.componentWillUnmount = function () {\n        delete _allInstances[this._id];\n    };\n    FocusZone.prototype.render = function () {\n        var _a = this.props, rootProps = _a.rootProps, ariaLabelledBy = _a.ariaLabelledBy, className = _a.className;\n        var divProps = Utilities_1.getNativeProps(this.props, Utilities_1.divProperties);\n        return (React.createElement(\"div\", __assign({}, divProps, rootProps, { className: Utilities_1.css('ms-FocusZone', className), ref: 'root', \"data-focuszone-id\": this._id, \"aria-labelledby\": ariaLabelledBy, onKeyDown: this._onKeyDown, onFocus: this._onFocus }, { onMouseDownCapture: this._onMouseDown }), this.props.children));\n    };\n    /**\n     * Sets focus to the first tabbable item in the zone.\n     * @returns True if focus could be set to an active element, false if no operation was taken.\n     */\n    FocusZone.prototype.focus = function () {\n        if (this._activeElement && Utilities_1.elementContains(this.refs.root, this._activeElement)) {\n            this._activeElement.focus();\n            return true;\n        }\n        else {\n            var firstChild = this.refs.root.firstChild;\n            return this.focusElement(Utilities_1.getNextElement(this.refs.root, firstChild, true));\n        }\n    };\n    /**\n     * Sets focus to a specific child element within the zone. This can be used in conjunction with\n     * onBeforeFocus to created delayed focus scenarios (like animate the scroll position to the correct\n     * location and then focus.)\n     * @param {HTMLElement} element The child element within the zone to focus.\n     * @returns True if focus could be set to an active element, false if no operation was taken.\n     */\n    FocusZone.prototype.focusElement = function (element) {\n        var onBeforeFocus = this.props.onBeforeFocus;\n        if (onBeforeFocus && !onBeforeFocus(element)) {\n            return false;\n        }\n        if (element) {\n            if (this._activeElement) {\n                this._activeElement.tabIndex = -1;\n            }\n            this._activeElement = element;\n            if (element) {\n                if (!this._focusAlignment) {\n                    this._setFocusAlignment(element, true, true);\n                }\n                this._activeElement.tabIndex = 0;\n                element.focus();\n                return true;\n            }\n        }\n        return false;\n    };\n    FocusZone.prototype._onFocus = function (ev) {\n        var onActiveElementChanged = this.props.onActiveElementChanged;\n        if (this._isImmediateDescendantOfZone(ev.target)) {\n            this._activeElement = ev.target;\n            this._setFocusAlignment(this._activeElement);\n        }\n        else {\n            var parentElement = ev.target;\n            while (parentElement && parentElement !== this.refs.root) {\n                if (Utilities_1.isElementTabbable(parentElement) && this._isImmediateDescendantOfZone(parentElement)) {\n                    this._activeElement = parentElement;\n                    break;\n                }\n                parentElement = Utilities_1.getParent(parentElement);\n            }\n        }\n        if (onActiveElementChanged) {\n            onActiveElementChanged(this._activeElement, ev);\n        }\n    };\n    /**\n     * Handle global tab presses so that we can patch tabindexes on the fly.\n     */\n    FocusZone.prototype._onKeyDownCapture = function (ev) {\n        if (ev.which === Utilities_1.KeyCodes.tab) {\n            this._updateTabIndexes();\n        }\n    };\n    FocusZone.prototype._onMouseDown = function (ev) {\n        var disabled = this.props.disabled;\n        if (disabled) {\n            return;\n        }\n        var target = ev.target;\n        var path = [];\n        while (target && target !== this.refs.root) {\n            path.push(target);\n            target = Utilities_1.getParent(target);\n        }\n        while (path.length) {\n            target = path.pop();\n            if (Utilities_1.isElementFocusZone(target)) {\n                break;\n            }\n            else if (target && Utilities_1.isElementTabbable(target)) {\n                target.tabIndex = 0;\n                this._setFocusAlignment(target, true, true);\n            }\n        }\n    };\n    /**\n     * Handle the keystrokes.\n     */\n    FocusZone.prototype._onKeyDown = function (ev) {\n        var _a = this.props, direction = _a.direction, disabled = _a.disabled, isInnerZoneKeystroke = _a.isInnerZoneKeystroke;\n        if (disabled) {\n            return;\n        }\n        if (this.props.onKeyDown) {\n            this.props.onKeyDown(ev);\n            if (ev.isDefaultPrevented()) {\n                return;\n            }\n        }\n        if (isInnerZoneKeystroke &&\n            this._isImmediateDescendantOfZone(ev.target) &&\n            isInnerZoneKeystroke(ev)) {\n            // Try to focus\n            var innerZone = this._getFirstInnerZone();\n            if (!innerZone || !innerZone.focus()) {\n                return;\n            }\n        }\n        else if (ev.altKey) {\n            return;\n        }\n        else {\n            switch (ev.which) {\n                case Utilities_1.KeyCodes.space:\n                    if (this._tryInvokeClickForFocusable(ev.target)) {\n                        break;\n                    }\n                    return;\n                case Utilities_1.KeyCodes.left:\n                    if (direction !== FocusZone_Props_1.FocusZoneDirection.vertical && this._moveFocusLeft()) {\n                        break;\n                    }\n                    return;\n                case Utilities_1.KeyCodes.right:\n                    if (direction !== FocusZone_Props_1.FocusZoneDirection.vertical && this._moveFocusRight()) {\n                        break;\n                    }\n                    return;\n                case Utilities_1.KeyCodes.up:\n                    if (direction !== FocusZone_Props_1.FocusZoneDirection.horizontal && this._moveFocusUp()) {\n                        break;\n                    }\n                    return;\n                case Utilities_1.KeyCodes.down:\n                    if (direction !== FocusZone_Props_1.FocusZoneDirection.horizontal && this._moveFocusDown()) {\n                        break;\n                    }\n                    return;\n                case Utilities_1.KeyCodes.home:\n                    var firstChild = this.refs.root.firstChild;\n                    if (this.focusElement(Utilities_1.getNextElement(this.refs.root, firstChild, true))) {\n                        break;\n                    }\n                    return;\n                case Utilities_1.KeyCodes.end:\n                    var lastChild = this.refs.root.lastChild;\n                    if (this.focusElement(Utilities_1.getPreviousElement(this.refs.root, lastChild, true, true, true))) {\n                        break;\n                    }\n                    return;\n                case Utilities_1.KeyCodes.enter:\n                    if (this._tryInvokeClickForFocusable(ev.target)) {\n                        break;\n                    }\n                    return;\n                default:\n                    return;\n            }\n        }\n        ev.preventDefault();\n        ev.stopPropagation();\n    };\n    /**\n     * Walk up the dom try to find a focusable element.\n     */\n    FocusZone.prototype._tryInvokeClickForFocusable = function (target) {\n        do {\n            if (target.tagName === 'BUTTON' || target.tagName === 'A') {\n                return false;\n            }\n            if (this._isImmediateDescendantOfZone(target) &&\n                target.getAttribute(IS_FOCUSABLE_ATTRIBUTE) === 'true' &&\n                target.getAttribute(IS_ENTER_DISABLED_ATTRIBUTE) !== 'true') {\n                Utilities_1.EventGroup.raise(target, 'click', null, true);\n                return true;\n            }\n            target = Utilities_1.getParent(target);\n        } while (target !== this.refs.root);\n        return false;\n    };\n    /**\n     * Traverse to find first child zone.\n     */\n    FocusZone.prototype._getFirstInnerZone = function (rootElement) {\n        rootElement = rootElement || this._activeElement || this.refs.root;\n        var child = rootElement.firstElementChild;\n        while (child) {\n            if (Utilities_1.isElementFocusZone(child)) {\n                return _allInstances[child.getAttribute(FOCUSZONE_ID_ATTRIBUTE)];\n            }\n            var match = this._getFirstInnerZone(child);\n            if (match) {\n                return match;\n            }\n            child = child.nextElementSibling;\n        }\n        return null;\n    };\n    FocusZone.prototype._moveFocus = function (isForward, getDistanceFromCenter, ev) {\n        var element = this._activeElement;\n        var candidateDistance = -1;\n        var candidateElement;\n        var changedFocus = false;\n        var isBidirectional = this.props.direction === FocusZone_Props_1.FocusZoneDirection.bidirectional;\n        if (!element) {\n            return false;\n        }\n        if (this._isElementInput(element)) {\n            if (!this._shouldInputLoseFocus(element, isForward)) {\n                return false;\n            }\n        }\n        var activeRect = isBidirectional ? element.getBoundingClientRect() : null;\n        do {\n            element = isForward ?\n                Utilities_1.getNextElement(this.refs.root, element) :\n                Utilities_1.getPreviousElement(this.refs.root, element);\n            if (isBidirectional) {\n                if (element) {\n                    var targetRect = element.getBoundingClientRect();\n                    var elementDistance = getDistanceFromCenter(activeRect, targetRect);\n                    if (elementDistance > -1 && (candidateDistance === -1 || elementDistance < candidateDistance)) {\n                        candidateDistance = elementDistance;\n                        candidateElement = element;\n                    }\n                    if (candidateDistance >= 0 && elementDistance < 0) {\n                        break;\n                    }\n                }\n            }\n            else {\n                candidateElement = element;\n                break;\n            }\n        } while (element);\n        // Focus the closest candidate\n        if (candidateElement && candidateElement !== this._activeElement) {\n            changedFocus = true;\n            this.focusElement(candidateElement);\n        }\n        else if (this.props.isCircularNavigation) {\n            if (isForward) {\n                return this.focusElement(Utilities_1.getNextElement(this.refs.root, this.refs.root.firstElementChild, true));\n            }\n            else {\n                return this.focusElement(Utilities_1.getPreviousElement(this.refs.root, this.refs.root.lastElementChild, true, true, true));\n            }\n        }\n        return changedFocus;\n    };\n    FocusZone.prototype._moveFocusDown = function () {\n        var targetTop = -1;\n        var leftAlignment = this._focusAlignment.left;\n        if (this._moveFocus(true, function (activeRect, targetRect) {\n            var distance = -1;\n            // ClientRect values can be floats that differ by very small fractions of a decimal.\n            // If the difference between top and bottom are within a pixel then we should treat\n            // them as equivalent by using Math.floor. For instance 5.2222 and 5.222221 should be equivalent,\n            // but without Math.Floor they will be handled incorrectly.\n            var targetRectTop = Math.floor(targetRect.top);\n            var activeRectBottom = Math.floor(activeRect.bottom);\n            if ((targetTop === -1 && targetRectTop >= activeRectBottom) ||\n                (targetRectTop === targetTop)) {\n                targetTop = targetRectTop;\n                if (leftAlignment >= targetRect.left && leftAlignment <= (targetRect.left + targetRect.width)) {\n                    distance = 0;\n                }\n                else {\n                    distance = Math.abs((targetRect.left + (targetRect.width / 2)) - leftAlignment);\n                }\n            }\n            return distance;\n        })) {\n            this._setFocusAlignment(this._activeElement, false, true);\n            return true;\n        }\n        return false;\n    };\n    FocusZone.prototype._moveFocusUp = function () {\n        var targetTop = -1;\n        var leftAlignment = this._focusAlignment.left;\n        if (this._moveFocus(false, function (activeRect, targetRect) {\n            var distance = -1;\n            // ClientRect values can be floats that differ by very small fractions of a decimal.\n            // If the difference between top and bottom are within a pixel then we should treat\n            // them as equivalent by using Math.floor. For instance 5.2222 and 5.222221 should be equivalent,\n            // but without Math.Floor they will be handled incorrectly.\n            var targetRectBottom = Math.floor(targetRect.bottom);\n            var targetRectTop = Math.floor(targetRect.top);\n            var activeRectTop = Math.floor(activeRect.top);\n            if ((targetTop === -1 && targetRectBottom <= activeRectTop) ||\n                (targetRectTop === targetTop)) {\n                targetTop = targetRectTop;\n                if (leftAlignment >= targetRect.left && leftAlignment <= (targetRect.left + targetRect.width)) {\n                    distance = 0;\n                }\n                else {\n                    distance = Math.abs((targetRect.left + (targetRect.width / 2)) - leftAlignment);\n                }\n            }\n            return distance;\n        })) {\n            this._setFocusAlignment(this._activeElement, false, true);\n            return true;\n        }\n        return false;\n    };\n    FocusZone.prototype._moveFocusLeft = function () {\n        var _this = this;\n        var targetTop = -1;\n        var topAlignment = this._focusAlignment.top;\n        if (this._moveFocus(Utilities_1.getRTL(), function (activeRect, targetRect) {\n            var distance = -1;\n            if ((targetTop === -1 &&\n                targetRect.right <= activeRect.right &&\n                (_this.props.direction === FocusZone_Props_1.FocusZoneDirection.horizontal || targetRect.top === activeRect.top)) ||\n                (targetRect.top === targetTop)) {\n                targetTop = targetRect.top;\n                distance = Math.abs((targetRect.top + (targetRect.height / 2)) - topAlignment);\n            }\n            return distance;\n        })) {\n            this._setFocusAlignment(this._activeElement, true, false);\n            return true;\n        }\n        return false;\n    };\n    FocusZone.prototype._moveFocusRight = function () {\n        var _this = this;\n        var targetTop = -1;\n        var topAlignment = this._focusAlignment.top;\n        if (this._moveFocus(!Utilities_1.getRTL(), function (activeRect, targetRect) {\n            var distance = -1;\n            if ((targetTop === -1 &&\n                targetRect.left >= activeRect.left &&\n                (_this.props.direction === FocusZone_Props_1.FocusZoneDirection.horizontal || targetRect.top === activeRect.top)) ||\n                (targetRect.top === targetTop)) {\n                targetTop = targetRect.top;\n                distance = Math.abs((targetRect.top + (targetRect.height / 2)) - topAlignment);\n            }\n            return distance;\n        })) {\n            this._setFocusAlignment(this._activeElement, true, false);\n            return true;\n        }\n        return false;\n    };\n    FocusZone.prototype._setFocusAlignment = function (element, isHorizontal, isVertical) {\n        if (this.props.direction === FocusZone_Props_1.FocusZoneDirection.bidirectional &&\n            (!this._focusAlignment || isHorizontal || isVertical)) {\n            var rect = element.getBoundingClientRect();\n            var left = rect.left + (rect.width / 2);\n            var top_1 = rect.top + (rect.height / 2);\n            if (!this._focusAlignment) {\n                this._focusAlignment = { left: left, top: top_1 };\n            }\n            if (isHorizontal) {\n                this._focusAlignment.left = left;\n            }\n            if (isVertical) {\n                this._focusAlignment.top = top_1;\n            }\n        }\n    };\n    FocusZone.prototype._isImmediateDescendantOfZone = function (element) {\n        var parentElement = Utilities_1.getParent(element);\n        while (parentElement && parentElement !== this.refs.root && parentElement !== document.body) {\n            if (Utilities_1.isElementFocusZone(parentElement)) {\n                return false;\n            }\n            parentElement = Utilities_1.getParent(parentElement);\n        }\n        return true;\n    };\n    FocusZone.prototype._updateTabIndexes = function (element) {\n        if (!element) {\n            element = this.refs.root;\n            if (this._activeElement && !Utilities_1.elementContains(element, this._activeElement)) {\n                this._activeElement = null;\n            }\n        }\n        var childNodes = element.children;\n        for (var childIndex = 0; childNodes && childIndex < childNodes.length; childIndex++) {\n            var child = childNodes[childIndex];\n            if (!Utilities_1.isElementFocusZone(child)) {\n                // If the item is explicitly set to not be focusable then TABINDEX needs to be set to -1.\n                if (child.getAttribute && child.getAttribute(IS_FOCUSABLE_ATTRIBUTE) === 'false') {\n                    child.setAttribute(TABINDEX, '-1');\n                }\n                if (Utilities_1.isElementTabbable(child)) {\n                    if (this.props.disabled) {\n                        child.setAttribute(TABINDEX, '-1');\n                    }\n                    else if (!this._isInnerZone && (!this._activeElement || this._activeElement === child)) {\n                        this._activeElement = child;\n                        if (child.getAttribute(TABINDEX) !== '0') {\n                            child.setAttribute(TABINDEX, '0');\n                        }\n                    }\n                    else if (child.getAttribute(TABINDEX) !== '-1') {\n                        child.setAttribute(TABINDEX, '-1');\n                    }\n                }\n                else if (child.tagName === 'svg' && child.getAttribute('focusable') !== 'false') {\n                    // Disgusting IE hack. Sad face.\n                    child.setAttribute('focusable', 'false');\n                }\n                this._updateTabIndexes(child);\n            }\n        }\n    };\n    FocusZone.prototype._isElementInput = function (element) {\n        if (element && element.tagName && element.tagName.toLowerCase() === 'input') {\n            return true;\n        }\n        return false;\n    };\n    FocusZone.prototype._shouldInputLoseFocus = function (element, isForward) {\n        if (element &&\n            element.type &&\n            ALLOWED_INPUT_TYPES.indexOf(element.type.toLowerCase()) > -1) {\n            var selectionStart = element.selectionStart;\n            var selectionEnd = element.selectionEnd;\n            var isRangeSelected = selectionStart !== selectionEnd;\n            var inputValue = element.value;\n            // We shouldn't lose focus in the following cases:\n            // 1. There is range selected.\n            // 2. When selection start is larger than 0 and it is backward.\n            // 3. when selection start is not the end of lenght and it is forward.\n            if (isRangeSelected ||\n                (selectionStart > 0 && !isForward) ||\n                (selectionStart !== inputValue.length && isForward)) {\n                return false;\n            }\n        }\n        return true;\n    };\n    return FocusZone;\n}(Utilities_1.BaseComponent));\nFocusZone.defaultProps = {\n    isCircularNavigation: false,\n    direction: FocusZone_Props_1.FocusZoneDirection.bidirectional\n};\n__decorate([\n    Utilities_1.autobind\n], FocusZone.prototype, \"_onFocus\", null);\n__decorate([\n    Utilities_1.autobind\n], FocusZone.prototype, \"_onMouseDown\", null);\n__decorate([\n    Utilities_1.autobind\n], FocusZone.prototype, \"_onKeyDown\", null);\nexports.FocusZone = FocusZone;\n\n\n\n/***/ }),\n/* 74 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(73));\n__export(__webpack_require__(16));\n\n\n\n/***/ }),\n/* 75 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar Link_1 = __webpack_require__(24);\nvar GroupSpacer_1 = __webpack_require__(9);\nvar styles = __webpack_require__(76);\nvar GroupFooter = (function (_super) {\n    __extends(GroupFooter, _super);\n    function GroupFooter() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    GroupFooter.prototype.render = function () {\n        var _a = this.props, group = _a.group, groupLevel = _a.groupLevel, showAllLinkText = _a.showAllLinkText;\n        return group && (React.createElement(\"div\", { className: Utilities_1.css('ms-groupFooter', styles.root) },\n            GroupSpacer_1.GroupSpacer({ count: groupLevel }),\n            React.createElement(Link_1.Link, { onClick: this._onSummarizeClick }, showAllLinkText)));\n    };\n    GroupFooter.prototype._onSummarizeClick = function (ev) {\n        this.props.onToggleSummarize(this.props.group);\n        ev.stopPropagation();\n        ev.preventDefault();\n    };\n    return GroupFooter;\n}(Utilities_1.BaseComponent));\n__decorate([\n    Utilities_1.autobind\n], GroupFooter.prototype, \"_onSummarizeClick\", null);\nexports.GroupFooter = GroupFooter;\n\n\n\n/***/ }),\n/* 76 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/* tslint:disable */\nvar load_themed_styles_1 = __webpack_require__(2);\nvar styles = {\n    root: 'root_53787d98',\n};\nload_themed_styles_1.loadStyles([{ \"rawString\": \".root_53787d98{position:relative;padding:10px 84px;cursor:pointer}.root_53787d98 .ms-Link{font-family:\\\"Segoe UI WestEuropean\\\",\\\"Segoe UI\\\",-apple-system,BlinkMacSystemFont,Roboto,\\\"Helvetica Neue\\\",sans-serif;-webkit-font-smoothing:antialiased;font-size:12px}\" }]);\nmodule.exports = styles;\n/* tslint:enable */ \n\n\n\n/***/ }),\n/* 77 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar index_1 = __webpack_require__(6);\nvar Check_1 = __webpack_require__(12);\nvar Icon_1 = __webpack_require__(23);\nvar GroupSpacer_1 = __webpack_require__(9);\nvar Spinner_1 = __webpack_require__(61);\nvar FocusZone_1 = __webpack_require__(8);\nvar styles = __webpack_require__(78);\nvar GroupHeader = (function (_super) {\n    __extends(GroupHeader, _super);\n    function GroupHeader(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = {\n            isCollapsed: _this.props.group && _this.props.group.isCollapsed,\n            isLoadingVisible: false\n        };\n        return _this;\n    }\n    GroupHeader.prototype.componentWillReceiveProps = function (newProps) {\n        if (newProps.group) {\n            var newCollapsed = newProps.group.isCollapsed;\n            var isGroupLoading = newProps.headerProps && newProps.headerProps.isGroupLoading;\n            var newLoadingVisible = !newCollapsed && isGroupLoading && isGroupLoading(newProps.group);\n            this.setState({\n                isCollapsed: newCollapsed,\n                isLoadingVisible: newLoadingVisible\n            });\n        }\n    };\n    GroupHeader.prototype.render = function () {\n        var _a = this.props, group = _a.group, groupLevel = _a.groupLevel, viewport = _a.viewport, selectionMode = _a.selectionMode, loadingText = _a.loadingText, isSelected = _a.isSelected, selected = _a.selected, isCollapsedGroupSelectVisible = _a.isCollapsedGroupSelectVisible;\n        var _b = this.state, isCollapsed = _b.isCollapsed, isLoadingVisible = _b.isLoadingVisible;\n        if (isCollapsedGroupSelectVisible === undefined) {\n            isCollapsedGroupSelectVisible = true;\n        }\n        var canSelectGroup = selectionMode === index_1.SelectionMode.multiple;\n        var isSelectionCheckVisible = canSelectGroup && (isCollapsedGroupSelectVisible || !(group && group.isCollapsed));\n        var currentlySelected = isSelected || selected;\n        return group && (React.createElement(\"div\", { className: Utilities_1.css('ms-GroupHeader', styles.root, (_c = {},\n                _c['is-selected ' + styles.rootIsSelected] = currentlySelected,\n                _c)), style: viewport ? { minWidth: viewport.width } : {}, onClick: this._onHeaderClick, \"aria-label\": group.ariaLabel || group.name, \"data-is-focusable\": true },\n            React.createElement(FocusZone_1.FocusZone, { direction: FocusZone_1.FocusZoneDirection.horizontal },\n                isSelectionCheckVisible ? (React.createElement(\"button\", { type: 'button', className: Utilities_1.css('ms-GroupHeader-check', styles.check), \"data-selection-toggle\": true, onClick: this._onToggleSelectGroupClick },\n                    React.createElement(Check_1.Check, { checked: currentlySelected }))) : (selectionMode !== index_1.SelectionMode.none ? GroupSpacer_1.GroupSpacer({ count: 1 }) : null),\n                GroupSpacer_1.GroupSpacer({ count: groupLevel }),\n                React.createElement(\"div\", { className: Utilities_1.css('ms-GroupHeader-dropIcon', styles.dropIcon) },\n                    React.createElement(Icon_1.Icon, { iconName: 'Tag' })),\n                React.createElement(\"button\", { type: 'button', className: Utilities_1.css('ms-GroupHeader-expand', styles.expand), onClick: this._onToggleCollapse },\n                    React.createElement(Icon_1.Icon, { className: Utilities_1.css(isCollapsed && ('is-collapsed ' + styles.expandIsCollapsed)), iconName: 'ChevronDown' })),\n                React.createElement(\"div\", { className: Utilities_1.css('ms-GroupHeader-title ms-font-xl', styles.title) },\n                    React.createElement(\"span\", null, group.name),\n                    React.createElement(\"span\", null,\n                        \"(\",\n                        group.count,\n                        group.hasMoreData && '+',\n                        \")\")),\n                React.createElement(\"div\", { className: Utilities_1.css('ms-GroupHeader-loading', styles.loading, isLoadingVisible && ('is-loading ' + styles.loadingIsVisible)) },\n                    React.createElement(Spinner_1.Spinner, { label: loadingText })))));\n        var _c;\n    };\n    GroupHeader.prototype._onToggleCollapse = function (ev) {\n        var _a = this.props, group = _a.group, onToggleCollapse = _a.onToggleCollapse, isGroupLoading = _a.isGroupLoading;\n        var isCollapsed = this.state.isCollapsed;\n        var newCollapsed = !isCollapsed;\n        var newLoadingVisible = !newCollapsed && isGroupLoading && isGroupLoading(group);\n        this.setState({\n            isCollapsed: newCollapsed,\n            isLoadingVisible: newLoadingVisible\n        });\n        if (onToggleCollapse) {\n            onToggleCollapse(group);\n        }\n        ev.stopPropagation();\n        ev.preventDefault();\n    };\n    GroupHeader.prototype._onToggleSelectGroupClick = function (ev) {\n        var _a = this.props, onToggleSelectGroup = _a.onToggleSelectGroup, group = _a.group;\n        if (onToggleSelectGroup) {\n            onToggleSelectGroup(group);\n        }\n        ev.preventDefault();\n        ev.stopPropagation();\n    };\n    GroupHeader.prototype._onHeaderClick = function () {\n        var _a = this.props, group = _a.group, onGroupHeaderClick = _a.onGroupHeaderClick, onToggleSelectGroup = _a.onToggleSelectGroup;\n        if (onGroupHeaderClick) {\n            onGroupHeaderClick(group);\n        }\n        else if (onToggleSelectGroup) {\n            onToggleSelectGroup(group);\n        }\n    };\n    return GroupHeader;\n}(React.Component));\n__decorate([\n    Utilities_1.autobind\n], GroupHeader.prototype, \"_onToggleCollapse\", null);\n__decorate([\n    Utilities_1.autobind\n], GroupHeader.prototype, \"_onToggleSelectGroupClick\", null);\n__decorate([\n    Utilities_1.autobind\n], GroupHeader.prototype, \"_onHeaderClick\", null);\nexports.GroupHeader = GroupHeader;\n\n\n\n/***/ }),\n/* 78 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/* tslint:disable */\nvar load_themed_styles_1 = __webpack_require__(2);\nvar styles = {\n    root: 'root_c02d6efa',\n    rootIsSelected: 'rootIsSelected_c02d6efa',\n    check: 'check_c02d6efa',\n    expand: 'expand_c02d6efa',\n    title: 'title_c02d6efa',\n    expandIsCollapsed: 'expandIsCollapsed_c02d6efa',\n    loading: 'loading_c02d6efa',\n    loadingIsVisible: 'loadingIsVisible_c02d6efa',\n    dropIcon: 'dropIcon_c02d6efa',\n};\nload_themed_styles_1.loadStyles([{ \"rawString\": \".root_c02d6efa{cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.root_c02d6efa::-moz-focus-inner{border:0}.root_c02d6efa{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .root_c02d6efa:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid \" }, { \"theme\": \"neutralSecondary\", \"defaultValue\": \"#666666\" }, { \"rawString\": \"}.root_c02d6efa:hover{background:\" }, { \"theme\": \"themeLighterAlt\", \"defaultValue\": \"#eff6fc\" }, { \"rawString\": \"}.root_c02d6efa.rootIsSelected_c02d6efa{background:\" }, { \"theme\": \"themeLighter\", \"defaultValue\": \"#deecf9\" }, { \"rawString\": \"}.root_c02d6efa.rootIsSelected_c02d6efa:hover{background:\" }, { \"theme\": \"themeLight\", \"defaultValue\": \"#c7e0f4\" }, { \"rawString\": \"}.check_c02d6efa,.expand_c02d6efa{display:inline-block;cursor:default;padding:6px;-webkit-transform:translateY(50%);transform:translateY(50%);margin-top:-12px;box-sizing:border-box;vertical-align:top;background:0 0;border:none;font-size:12px;top:4px}.check_c02d6efa::-moz-focus-inner,.expand_c02d6efa::-moz-focus-inner{border:0}.check_c02d6efa,.expand_c02d6efa{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .check_c02d6efa:focus:after,.ms-Fabric.is-focusVisible .expand_c02d6efa:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid \" }, { \"theme\": \"neutralSecondary\", \"defaultValue\": \"#666666\" }, { \"rawString\": \"}.check_c02d6efa{opacity:0;margin-top:-10px}.check_c02d6efa:focus{opacity:1}.root_c02d6efa.rootIsSelected_c02d6efa .check_c02d6efa,.root_c02d6efa:hover .check_c02d6efa{opacity:1}.title_c02d6efa{padding:14px 6px;display:inline-block;cursor:pointer;outline:0}.expand_c02d6efa{width:36px;height:40px;color:\" }, { \"theme\": \"neutralSecondary\", \"defaultValue\": \"#666666\" }, { \"rawString\": \"}.expand_c02d6efa .ms-Icon{-webkit-transform:rotate(-180deg);transform:rotate(-180deg);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transition:-webkit-transform .1s linear;transition:-webkit-transform .1s linear;transition:transform .1s linear;transition:transform .1s linear,-webkit-transform .1s linear}.expand_c02d6efa .ms-Icon.expandIsCollapsed_c02d6efa{-webkit-transform:rotate(0);transform:rotate(0)}.loading_c02d6efa{display:inline-block;visibility:hidden;opacity:0;padding:0 16px;vertical-align:middle;-webkit-transition:visibility 367ms,opacity 367ms;transition:visibility 367ms,opacity 367ms}.loading_c02d6efa.loadingIsVisible_c02d6efa{visibility:visible;opacity:1}.dropIcon_c02d6efa{display:inline-block;position:relative;top:-16px;font-size:20px;color:\" }, { \"theme\": \"neutralSecondaryAlt\", \"defaultValue\": \"#767676\" }, { \"rawString\": \";-webkit-transition:opacity 467ms cubic-bezier(.39,.575,.565,1),-webkit-transform 267ms cubic-bezier(.6,-.28,.735,.045);transition:opacity 467ms cubic-bezier(.39,.575,.565,1),-webkit-transform 267ms cubic-bezier(.6,-.28,.735,.045);transition:transform 267ms cubic-bezier(.6,-.28,.735,.045),opacity 467ms cubic-bezier(.39,.575,.565,1);transition:transform 267ms cubic-bezier(.6,-.28,.735,.045),opacity 467ms cubic-bezier(.39,.575,.565,1),-webkit-transform 267ms cubic-bezier(.6,-.28,.735,.045);opacity:0;-webkit-transform:rotate(.2deg) scale(.65);transform:rotate(.2deg) scale(.65);-webkit-transform-origin:10px 10px;transform-origin:10px 10px}html[dir=ltr] .dropIcon_c02d6efa{left:-26px}html[dir=rtl] .dropIcon_c02d6efa{right:-26px}.dropIcon_c02d6efa .ms-Icon--Tag{position:absolute}.ms-GroupedList-group.is-dropping>.root_c02d6efa .dropIcon_c02d6efa{-webkit-transition:opacity 167ms cubic-bezier(.39,.575,.565,1),-webkit-transform 467ms cubic-bezier(.075,.82,.165,1);transition:opacity 167ms cubic-bezier(.39,.575,.565,1),-webkit-transform 467ms cubic-bezier(.075,.82,.165,1);transition:transform 467ms cubic-bezier(.075,.82,.165,1),opacity 167ms cubic-bezier(.39,.575,.565,1);transition:transform 467ms cubic-bezier(.075,.82,.165,1),opacity 167ms cubic-bezier(.39,.575,.565,1),-webkit-transform 467ms cubic-bezier(.075,.82,.165,1);-webkit-transition-delay:367ms;transition-delay:367ms;opacity:1;-webkit-transform:rotate(.2deg) scale(1);transform:rotate(.2deg) scale(1)}.ms-GroupedList-group.is-dropping .check_c02d6efa{opacity:0}\" }]);\nmodule.exports = styles;\n/* tslint:enable */ \n\n\n\n/***/ }),\n/* 79 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/* tslint:disable */\nvar load_themed_styles_1 = __webpack_require__(2);\nvar styles = {\n    root: 'root_195d11b1',\n};\nload_themed_styles_1.loadStyles([{ \"rawString\": \".root_195d11b1{display:inline-block}\" }]);\nmodule.exports = styles;\n/* tslint:enable */ \n\n\n\n/***/ }),\n/* 80 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar GroupedListSection_1 = __webpack_require__(81);\nvar List_1 = __webpack_require__(13);\nvar index_1 = __webpack_require__(6);\nvar styles = __webpack_require__(27);\nvar GroupedList = (function (_super) {\n    __extends(GroupedList, _super);\n    function GroupedList(props) {\n        var _this = _super.call(this, props) || this;\n        _this._isSomeGroupExpanded = _this._computeIsSomeGroupExpanded(props.groups);\n        _this.state = {\n            lastWidth: 0,\n            groups: props.groups\n        };\n        return _this;\n    }\n    GroupedList.prototype.componentWillReceiveProps = function (newProps) {\n        var _a = this.props, groups = _a.groups, selectionMode = _a.selectionMode;\n        var shouldForceUpdates = false;\n        if (newProps.groups !== groups) {\n            this.setState({ groups: newProps.groups });\n            shouldForceUpdates = true;\n        }\n        if (newProps.selectionMode !== selectionMode) {\n            shouldForceUpdates = true;\n        }\n        if (shouldForceUpdates) {\n            this._forceListUpdates();\n        }\n    };\n    GroupedList.prototype.render = function () {\n        var className = this.props.className;\n        var groups = this.state.groups;\n        return (React.createElement(\"div\", { ref: 'root', className: Utilities_1.css('ms-GroupedList', styles.root, className), \"data-automationid\": 'GroupedList', \"data-is-scrollable\": 'false', role: 'grid' }, !groups ?\n            this._renderGroup(null, 0) : (React.createElement(List_1.List, { ref: 'list', items: groups, onRenderCell: this._renderGroup, getItemCountForPage: function () { return 1; } }))));\n    };\n    GroupedList.prototype.forceUpdate = function () {\n        _super.prototype.forceUpdate.call(this);\n        this._forceListUpdates();\n    };\n    GroupedList.prototype.toggleCollapseAll = function (allCollapsed) {\n        var groups = this.state.groups;\n        var groupProps = this.props.groupProps;\n        var onToggleCollapseAll = groupProps && groupProps.onToggleCollapseAll;\n        if (groups) {\n            if (onToggleCollapseAll) {\n                onToggleCollapseAll(allCollapsed);\n            }\n            for (var groupIndex = 0; groupIndex < groups.length; groupIndex++) {\n                groups[groupIndex].isCollapsed = allCollapsed;\n            }\n            this._updateIsSomeGroupExpanded();\n            this.forceUpdate();\n        }\n    };\n    GroupedList.prototype._renderGroup = function (group, groupIndex) {\n        var _a = this.props, dragDropEvents = _a.dragDropEvents, dragDropHelper = _a.dragDropHelper, eventsToRegister = _a.eventsToRegister, groupProps = _a.groupProps, items = _a.items, listProps = _a.listProps, onRenderCell = _a.onRenderCell, selectionMode = _a.selectionMode, selection = _a.selection, viewport = _a.viewport;\n        // override group header/footer props as needed\n        var dividerProps = {\n            onToggleSelectGroup: this._onToggleSelectGroup,\n            onToggleCollapse: this._onToggleCollapse,\n            onToggleSummarize: this._onToggleSummarize\n        };\n        var headerProps = Utilities_1.assign({}, groupProps.headerProps, dividerProps);\n        var footerProps = Utilities_1.assign({}, groupProps.footerProps, dividerProps);\n        var groupNestingDepth = this._getGroupNestingDepth();\n        return (!group || group.count > 0) ? (React.createElement(GroupedListSection_1.GroupedListSection, { ref: 'group_' + groupIndex, key: this._getGroupKey(group, groupIndex), dragDropEvents: dragDropEvents, dragDropHelper: dragDropHelper, eventsToRegister: eventsToRegister, footerProps: footerProps, getGroupItemLimit: groupProps && groupProps.getGroupItemLimit, group: group, groupIndex: groupIndex, groupNestingDepth: groupNestingDepth, headerProps: headerProps, listProps: listProps, items: items, onRenderCell: onRenderCell, onRenderGroupHeader: groupProps.onRenderHeader, onRenderGroupFooter: groupProps.onRenderFooter, selectionMode: selectionMode, selection: selection, viewport: viewport })) : null;\n    };\n    GroupedList.prototype._getGroupKey = function (group, index) {\n        return 'group-' + ((group && group.key) ? group.key : String(index));\n    };\n    GroupedList.prototype._getGroupNestingDepth = function () {\n        var groups = this.state.groups;\n        var level = 0;\n        var groupsInLevel = groups;\n        while (groupsInLevel && groupsInLevel.length > 0) {\n            level++;\n            groupsInLevel = groupsInLevel[0].children;\n        }\n        return level;\n    };\n    GroupedList.prototype._onToggleCollapse = function (group) {\n        var groupProps = this.props.groupProps;\n        var onToggleCollapse = groupProps && groupProps.headerProps && groupProps.headerProps.onToggleCollapse;\n        if (group) {\n            if (onToggleCollapse) {\n                onToggleCollapse(group);\n            }\n            group.isCollapsed = !group.isCollapsed;\n            this._updateIsSomeGroupExpanded();\n            this.forceUpdate();\n        }\n    };\n    GroupedList.prototype._onToggleSelectGroup = function (group) {\n        if (group) {\n            this.props.selection.toggleRangeSelected(group.startIndex, group.count);\n        }\n    };\n    GroupedList.prototype._forceListUpdates = function (groups) {\n        groups = groups || this.state.groups;\n        var groupCount = groups ? groups.length : 1;\n        if (this.refs.list) {\n            this.refs.list.forceUpdate();\n            for (var i = 0; i < groupCount; i++) {\n                var group = this.refs.list.refs['group_' + String(i)];\n                if (group) {\n                    group.forceListUpdate();\n                }\n            }\n        }\n        else {\n            var group = this.refs['group_' + String(0)];\n            if (group) {\n                group.forceListUpdate();\n            }\n        }\n    };\n    GroupedList.prototype._onToggleSummarize = function (group) {\n        var groupProps = this.props.groupProps;\n        var onToggleSummarize = groupProps && groupProps.footerProps && groupProps.footerProps.onToggleSummarize;\n        if (onToggleSummarize) {\n            onToggleSummarize(group);\n        }\n        else {\n            if (group) {\n                group.isShowingAll = !group.isShowingAll;\n            }\n            this.forceUpdate();\n        }\n    };\n    GroupedList.prototype._computeIsSomeGroupExpanded = function (groups) {\n        var _this = this;\n        return groups && groups.some(function (group) { return group.children ? _this._computeIsSomeGroupExpanded(group.children) : !group.isCollapsed; });\n    };\n    GroupedList.prototype._updateIsSomeGroupExpanded = function () {\n        var groups = this.state.groups;\n        var onGroupExpandStateChanged = this.props.onGroupExpandStateChanged;\n        var newIsSomeGroupExpanded = this._computeIsSomeGroupExpanded(groups);\n        if (this._isSomeGroupExpanded !== newIsSomeGroupExpanded) {\n            if (onGroupExpandStateChanged) {\n                onGroupExpandStateChanged(newIsSomeGroupExpanded);\n            }\n            this._isSomeGroupExpanded = newIsSomeGroupExpanded;\n        }\n    };\n    return GroupedList;\n}(Utilities_1.BaseComponent));\nGroupedList.defaultProps = {\n    selectionMode: index_1.SelectionMode.multiple,\n    isHeaderVisible: true,\n    groupProps: {}\n};\n__decorate([\n    Utilities_1.autobind\n], GroupedList.prototype, \"_renderGroup\", null);\n__decorate([\n    Utilities_1.autobind\n], GroupedList.prototype, \"_onToggleCollapse\", null);\n__decorate([\n    Utilities_1.autobind\n], GroupedList.prototype, \"_onToggleSelectGroup\", null);\n__decorate([\n    Utilities_1.autobind\n], GroupedList.prototype, \"_onToggleSummarize\", null);\nexports.GroupedList = GroupedList;\n\n\n\n/***/ }),\n/* 81 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar index_1 = __webpack_require__(6);\nvar GroupFooter_1 = __webpack_require__(75);\nvar GroupHeader_1 = __webpack_require__(77);\nvar List_1 = __webpack_require__(13);\nvar Utilities_2 = __webpack_require__(1);\nvar styles = __webpack_require__(27);\nvar DEFAULT_DROPPING_CSS_CLASS = 'is-dropping';\nvar GroupedListSection = (function (_super) {\n    __extends(GroupedListSection, _super);\n    function GroupedListSection(props) {\n        var _this = _super.call(this, props) || this;\n        var selection = props.selection, group = props.group;\n        _this._subGroups = {};\n        _this.state = {\n            isDropping: false,\n            isSelected: (selection && group) ? selection.isRangeSelected(group.startIndex, group.count) : false\n        };\n        return _this;\n    }\n    GroupedListSection.prototype.componentDidMount = function () {\n        var _a = this.props, dragDropHelper = _a.dragDropHelper, selection = _a.selection;\n        if (dragDropHelper) {\n            this._dragDropSubscription = dragDropHelper.subscribe(this.refs.root, this._events, this._getGroupDragDropOptions());\n        }\n        if (selection) {\n            this._events.on(selection, index_1.SELECTION_CHANGE, this._onSelectionChange);\n        }\n    };\n    GroupedListSection.prototype.componentWillUnmount = function () {\n        if (this._dragDropSubscription) {\n            this._dragDropSubscription.dispose();\n        }\n    };\n    GroupedListSection.prototype.componentDidUpdate = function (previousProps) {\n        if (this.props.group !== previousProps.group ||\n            this.props.groupIndex !== previousProps.groupIndex ||\n            this.props.dragDropHelper !== previousProps.dragDropHelper) {\n            if (this._dragDropSubscription) {\n                this._dragDropSubscription.dispose();\n                delete this._dragDropSubscription;\n            }\n            if (this.props.dragDropHelper) {\n                this._dragDropSubscription = this.props.dragDropHelper.subscribe(this.refs.root, this._events, this._getGroupDragDropOptions());\n            }\n        }\n    };\n    GroupedListSection.prototype.render = function () {\n        var _a = this.props, getGroupItemLimit = _a.getGroupItemLimit, group = _a.group, groupIndex = _a.groupIndex, headerProps = _a.headerProps, footerProps = _a.footerProps, viewport = _a.viewport, selectionMode = _a.selectionMode, _b = _a.onRenderGroupHeader, onRenderGroupHeader = _b === void 0 ? this._onRenderGroupHeader : _b, _c = _a.onRenderGroupFooter, onRenderGroupFooter = _c === void 0 ? this._onRenderGroupFooter : _c;\n        var isSelected = this.state.isSelected;\n        var renderCount = group && getGroupItemLimit ? getGroupItemLimit(group) : Infinity;\n        var isFooterVisible = group && !group.children && !group.isCollapsed && !group.isShowingAll &&\n            (group.count > renderCount || group.hasMoreData);\n        var hasNestedGroups = group && group.children && group.children.length > 0;\n        var dividerProps = {\n            group: group,\n            groupIndex: groupIndex,\n            groupLevel: group ? group.level : 0,\n            isSelected: isSelected,\n            viewport: viewport,\n            selectionMode: selectionMode\n        };\n        var groupHeaderProps = Utilities_2.assign({}, headerProps, dividerProps);\n        var groupFooterProps = Utilities_2.assign({}, footerProps, dividerProps);\n        return (React.createElement(\"div\", { ref: 'root', className: Utilities_2.css('ms-GroupedList-group', styles.group, this._getDroppingClassName()) },\n            onRenderGroupHeader(groupHeaderProps, this._onRenderGroupHeader),\n            group && group.isCollapsed ?\n                null :\n                (hasNestedGroups ?\n                    (React.createElement(List_1.List, { ref: 'list', items: group.children, onRenderCell: this._renderSubGroup, getItemCountForPage: function () { return 1; } })) :\n                    this._onRenderGroup(renderCount)),\n            isFooterVisible && onRenderGroupFooter(groupFooterProps, this._onRenderGroupFooter)));\n    };\n    GroupedListSection.prototype.forceUpdate = function () {\n        _super.prototype.forceUpdate.call(this);\n        this.forceListUpdate();\n    };\n    GroupedListSection.prototype.forceListUpdate = function () {\n        var group = this.props.group;\n        if (this.refs.list) {\n            this.refs.list.forceUpdate();\n            if (group && group.children && group.children.length > 0) {\n                var subGroupCount = group.children.length;\n                for (var i = 0; i < subGroupCount; i++) {\n                    var subGroup = this.refs.list.refs['subGroup_' + String(i)];\n                    if (subGroup) {\n                        subGroup.forceListUpdate();\n                    }\n                }\n            }\n        }\n        else {\n            var subGroup = this.refs['subGroup_' + String(0)];\n            if (subGroup) {\n                subGroup.forceListUpdate();\n            }\n        }\n    };\n    GroupedListSection.prototype._onRenderGroupHeader = function (props) {\n        return React.createElement(GroupHeader_1.GroupHeader, __assign({}, props));\n    };\n    GroupedListSection.prototype._onRenderGroupFooter = function (props) {\n        return React.createElement(GroupFooter_1.GroupFooter, __assign({}, props));\n    };\n    GroupedListSection.prototype._onSelectionChange = function () {\n        var _a = this.props, group = _a.group, selection = _a.selection;\n        var isSelected = selection.isRangeSelected(group.startIndex, group.count);\n        if (isSelected !== this.state.isSelected) {\n            this.setState({ isSelected: isSelected });\n        }\n    };\n    GroupedListSection.prototype._onRenderGroup = function (renderCount) {\n        var _a = this.props, group = _a.group, items = _a.items, onRenderCell = _a.onRenderCell, listProps = _a.listProps, groupNestingDepth = _a.groupNestingDepth;\n        var count = group ? group.count : items.length;\n        var startIndex = group ? group.startIndex : 0;\n        return (React.createElement(List_1.List, __assign({ items: items, onRenderCell: function (item, itemIndex) { return onRenderCell(groupNestingDepth, item, itemIndex); }, ref: 'list', renderCount: Math.min(count, renderCount), startIndex: startIndex }, listProps)));\n    };\n    GroupedListSection.prototype._renderSubGroup = function (subGroup, subGroupIndex) {\n        var _a = this.props, dragDropEvents = _a.dragDropEvents, dragDropHelper = _a.dragDropHelper, eventsToRegister = _a.eventsToRegister, getGroupItemLimit = _a.getGroupItemLimit, groupNestingDepth = _a.groupNestingDepth, items = _a.items, headerProps = _a.headerProps, footerProps = _a.footerProps, listProps = _a.listProps, onRenderCell = _a.onRenderCell, selection = _a.selection, selectionMode = _a.selectionMode, viewport = _a.viewport;\n        return (!subGroup || subGroup.count > 0) ? (React.createElement(GroupedListSection, { ref: 'subGroup_' + subGroupIndex, key: this._getGroupKey(subGroup, subGroupIndex), dragDropEvents: dragDropEvents, dragDropHelper: dragDropHelper, eventsToRegister: eventsToRegister, footerProps: footerProps, getGroupItemLimit: getGroupItemLimit, group: subGroup, groupIndex: subGroupIndex, groupNestingDepth: groupNestingDepth, headerProps: headerProps, items: items, listProps: listProps, onRenderCell: onRenderCell, selection: selection, selectionMode: selectionMode, viewport: viewport })) : null;\n    };\n    GroupedListSection.prototype._getGroupKey = function (group, index) {\n        return 'group-' + ((group && group.key) ? group.key : String(group.level) + String(index));\n    };\n    /**\n     * collect all the data we need to enable drag/drop for a group\n     */\n    GroupedListSection.prototype._getGroupDragDropOptions = function () {\n        var _a = this.props, group = _a.group, groupIndex = _a.groupIndex, dragDropEvents = _a.dragDropEvents, eventsToRegister = _a.eventsToRegister;\n        var options = {\n            eventMap: eventsToRegister,\n            selectionIndex: -1,\n            context: { data: group, index: groupIndex, isGroup: true },\n            canDrag: function () { return false; },\n            canDrop: dragDropEvents.canDrop,\n            onDragStart: null,\n            updateDropState: this._updateDroppingState\n        };\n        return options;\n    };\n    /**\n     * update groupIsDropping state based on the input value, which is used to change style during drag and drop\n     *\n     * @private\n     * @param {boolean} newValue (new isDropping state value)\n     * @param {DragEvent} event (the event trigger dropping state change which can be dragenter, dragleave etc)\n     */\n    GroupedListSection.prototype._updateDroppingState = function (newIsDropping, event) {\n        var isDropping = this.state.isDropping;\n        var dragDropEvents = this.props.dragDropEvents;\n        if (!isDropping) {\n            if (dragDropEvents.onDragLeave) {\n                dragDropEvents.onDragLeave(event, null);\n            }\n        }\n        else {\n            if (dragDropEvents.onDragEnter) {\n                dragDropEvents.onDragEnter(event, null);\n            }\n        }\n        if (isDropping !== newIsDropping) {\n            this.setState({ isDropping: newIsDropping });\n        }\n    };\n    /**\n     * get the correct css class to reflect the dropping state for a given group\n     *\n     * If the group is the current drop target, return the default dropping class name\n     * Otherwise, return '';\n     *\n     */\n    GroupedListSection.prototype._getDroppingClassName = function () {\n        var isDropping = this.state.isDropping;\n        var group = this.props.group;\n        isDropping = !!(group && isDropping);\n        return Utilities_2.css(isDropping && DEFAULT_DROPPING_CSS_CLASS, isDropping && styles.groupIsDropping);\n    };\n    return GroupedListSection;\n}(Utilities_1.BaseComponent));\n__decorate([\n    Utilities_1.autobind\n], GroupedListSection.prototype, \"_onRenderGroupHeader\", null);\n__decorate([\n    Utilities_1.autobind\n], GroupedListSection.prototype, \"_onRenderGroupFooter\", null);\n__decorate([\n    Utilities_1.autobind\n], GroupedListSection.prototype, \"_renderSubGroup\", null);\n__decorate([\n    Utilities_1.autobind\n], GroupedListSection.prototype, \"_getGroupDragDropOptions\", null);\n__decorate([\n    Utilities_1.autobind\n], GroupedListSection.prototype, \"_updateDroppingState\", null);\nexports.GroupedListSection = GroupedListSection;\n\n\n\n/***/ }),\n/* 82 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(80));\n\n\n\n/***/ }),\n/* 83 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/* tslint:disable */\nvar React = __webpack_require__(0);\nvar styles = __webpack_require__(84);\nvar IconType_1 = __webpack_require__(28);\nvar Image_1 = __webpack_require__(86);\nvar Utilities_1 = __webpack_require__(1);\nexports.Icon = function (props) {\n    var customIcon = props.iconName === 'None';\n    var iconClassName = props.iconName ? ('ms-Icon--' + props.iconName) : '';\n    if (props.iconType === IconType_1.IconType.Image) {\n        var containerClassName = Utilities_1.css('ms-Icon', 'ms-Icon-imageContainer', styles.imageContainer, props.className);\n        return (React.createElement(\"div\", { className: containerClassName },\n            React.createElement(Image_1.Image, __assign({}, props.imageProps))));\n    }\n    else {\n        var className = Utilities_1.css('ms-Icon', customIcon ? '' : iconClassName, props.className);\n        return React.createElement(\"i\", __assign({}, Utilities_1.getNativeProps(props, Utilities_1.htmlElementProperties), { className: className }));\n    }\n};\n\n\n\n/***/ }),\n/* 84 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/* tslint:disable */\nvar load_themed_styles_1 = __webpack_require__(2);\nvar styles = {\n    imageContainer: 'imageContainer_a4860255',\n};\nload_themed_styles_1.loadStyles([{ \"rawString\": \".imageContainer_a4860255{overflow:hidden}\" }]);\nmodule.exports = styles;\n/* tslint:enable */ \n\n\n\n/***/ }),\n/* 85 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(83));\n__export(__webpack_require__(28));\n\n\n\n/***/ }),\n/* 86 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/* tslint:disable:no-unused-variable */\nvar React = __webpack_require__(0);\n/* tslint:enable:no-unused-variable */\nvar Utilities_1 = __webpack_require__(1);\nvar Image_Props_1 = __webpack_require__(33);\nvar styles = __webpack_require__(87);\nvar CoverStyle;\n(function (CoverStyle) {\n    CoverStyle[CoverStyle[\"landscape\"] = 0] = \"landscape\";\n    CoverStyle[CoverStyle[\"portrait\"] = 1] = \"portrait\";\n})(CoverStyle = exports.CoverStyle || (exports.CoverStyle = {}));\nexports.CoverStyleMap = (_a = {},\n    _a[CoverStyle.landscape] = 'ms-Image-image--landscape ' + styles.imageIsLandscape,\n    _a[CoverStyle.portrait] = 'ms-Image-image--portrait ' + styles.imageIsPortrait,\n    _a);\nexports.ImageFitMap = (_b = {},\n    _b[Image_Props_1.ImageFit.center] = 'ms-Image-image--center ' + styles.imageIsCenter,\n    _b[Image_Props_1.ImageFit.contain] = 'ms-Image-image--contain ' + styles.imageIsContain,\n    _b[Image_Props_1.ImageFit.cover] = 'ms-Image-image--cover ' + styles.imageIsCover,\n    _b[Image_Props_1.ImageFit.none] = 'ms-Image-image--none ' + styles.imageIsNone,\n    _b);\nvar KEY_PREFIX = 'fabricImage';\nvar Image = (function (_super) {\n    __extends(Image, _super);\n    function Image(props) {\n        var _this = _super.call(this, props) || this;\n        // Make an initial assumption about the image layout until we can\n        // check the rendered element. The value here only takes effect when\n        // shouldStartVisible is true.\n        _this._coverStyle = CoverStyle.portrait;\n        _this.state = {\n            loadState: Image_Props_1.ImageLoadState.notLoaded\n        };\n        return _this;\n    }\n    Image.prototype.componentWillReceiveProps = function (nextProps) {\n        if (nextProps.src !== this.props.src) {\n            this.setState({\n                loadState: Image_Props_1.ImageLoadState.notLoaded\n            });\n        }\n        else if (this.state.loadState === Image_Props_1.ImageLoadState.loaded) {\n            this._computeCoverStyle(nextProps);\n        }\n    };\n    Image.prototype.componentDidUpdate = function (prevProps, prevState) {\n        this._checkImageLoaded();\n        if (this.props.onLoadingStateChange\n            && prevState.loadState !== this.state.loadState) {\n            this.props.onLoadingStateChange(this.state.loadState);\n        }\n    };\n    Image.prototype.render = function () {\n        var imageProps = Utilities_1.getNativeProps(this.props, Utilities_1.imageProperties, ['width', 'height']);\n        var _a = this.props, src = _a.src, alt = _a.alt, width = _a.width, height = _a.height, shouldFadeIn = _a.shouldFadeIn, className = _a.className, imageFit = _a.imageFit, role = _a.role, maximizeFrame = _a.maximizeFrame;\n        var loadState = this.state.loadState;\n        var coverStyle = this._coverStyle;\n        var loaded = loadState === Image_Props_1.ImageLoadState.loaded || (loadState === Image_Props_1.ImageLoadState.notLoaded && this.props.shouldStartVisible);\n        // If image dimensions aren't specified, the natural size of the image is used.\n        return (React.createElement(\"div\", { className: Utilities_1.css('ms-Image', styles.root, className, (_b = {},\n                _b['ms-Image--maximizeFrame ' + styles.rootIsMaximizeFrame] = maximizeFrame,\n                _b)), style: { width: width, height: height }, ref: this._resolveRef('_frameElement') },\n            React.createElement(\"img\", __assign({}, imageProps, { onLoad: this._onImageLoaded, onError: this._onImageError, key: KEY_PREFIX + this.props.src || '', className: Utilities_1.css('ms-Image-image', styles.image, exports.CoverStyleMap[coverStyle], (imageFit !== undefined) && exports.ImageFitMap[imageFit], (_c = {\n                        'is-fadeIn': shouldFadeIn,\n                        'is-notLoaded': !loaded\n                    },\n                    _c['is-loaded ' + styles.imageIsLoaded] = loaded,\n                    _c['ms-u-fadeIn400'] = loaded && shouldFadeIn,\n                    _c['is-error'] = loadState === Image_Props_1.ImageLoadState.error,\n                    _c['ms-Image-image--scaleWidth ' + styles.imageIsScaleWidth] = (imageFit === undefined && !!width && !height),\n                    _c['ms-Image-image--scaleHeight ' + styles.imageIsScaleHeight] = (imageFit === undefined && !width && !!height),\n                    _c['ms-Image-image--scaleWidthHeight ' + styles.imageIsScaleWidthHeight] = (imageFit === undefined && !!width && !!height),\n                    _c)), ref: this._resolveRef('_imageElement'), src: src, alt: alt, role: role }))));\n        var _b, _c;\n    };\n    Image.prototype._onImageLoaded = function (ev) {\n        var _a = this.props, src = _a.src, onLoad = _a.onLoad;\n        if (onLoad) {\n            onLoad(ev);\n        }\n        this._computeCoverStyle(this.props);\n        if (src) {\n            this.setState({\n                loadState: Image_Props_1.ImageLoadState.loaded\n            });\n        }\n    };\n    Image.prototype._checkImageLoaded = function () {\n        var src = this.props.src;\n        var loadState = this.state.loadState;\n        if (loadState === Image_Props_1.ImageLoadState.notLoaded) {\n            // testing if naturalWidth and naturalHeight are greater than zero is better than checking\n            // .complete, because .complete will also be set to true if the image breaks. However,\n            // for some browsers, SVG images do not have a naturalWidth or naturalHeight, so fall back\n            // to checking .complete for these images.\n            var isLoaded = src && (this._imageElement.naturalWidth > 0 && this._imageElement.naturalHeight > 0) ||\n                (this._imageElement.complete && Image._svgRegex.test(src));\n            if (isLoaded) {\n                this._computeCoverStyle(this.props);\n                this.setState({\n                    loadState: Image_Props_1.ImageLoadState.loaded\n                });\n            }\n        }\n    };\n    Image.prototype._computeCoverStyle = function (props) {\n        var imageFit = props.imageFit, width = props.width, height = props.height;\n        if (imageFit === Image_Props_1.ImageFit.cover || imageFit === Image_Props_1.ImageFit.contain) {\n            if (this._imageElement) {\n                // Determine the desired ratio using the width and height props.\n                // If those props aren't available, measure measure the frame.\n                var desiredRatio = void 0;\n                if (!!width && !!height) {\n                    desiredRatio = width / height;\n                }\n                else {\n                    desiredRatio = this._frameElement.clientWidth / this._frameElement.clientHeight;\n                }\n                // Examine the source image to determine its original ratio.\n                var naturalRatio = this._imageElement.naturalWidth / this._imageElement.naturalHeight;\n                // Should we crop from the top or the sides?\n                if (naturalRatio > desiredRatio) {\n                    this._coverStyle = CoverStyle.landscape;\n                }\n                else {\n                    this._coverStyle = CoverStyle.portrait;\n                }\n            }\n        }\n    };\n    Image.prototype._onImageError = function (ev) {\n        if (this.props.onError) {\n            this.props.onError(ev);\n        }\n        this.setState({\n            loadState: Image_Props_1.ImageLoadState.error\n        });\n    };\n    return Image;\n}(Utilities_1.BaseComponent));\nImage.defaultProps = {\n    shouldFadeIn: true\n};\nImage._svgRegex = /\\.svg$/i;\n__decorate([\n    Utilities_1.autobind\n], Image.prototype, \"_onImageLoaded\", null);\n__decorate([\n    Utilities_1.autobind\n], Image.prototype, \"_onImageError\", null);\nexports.Image = Image;\nvar _a, _b;\n\n\n\n/***/ }),\n/* 87 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/* tslint:disable */\nvar load_themed_styles_1 = __webpack_require__(2);\nvar styles = {\n    root: 'root_c274dbaf',\n    rootIsMaximizeFrame: 'rootIsMaximizeFrame_c274dbaf',\n    image: 'image_c274dbaf',\n    imageIsLoaded: 'imageIsLoaded_c274dbaf',\n    imageIsCenter: 'imageIsCenter_c274dbaf',\n    imageIsContain: 'imageIsContain_c274dbaf',\n    imageIsCover: 'imageIsCover_c274dbaf',\n    imageIsLandscape: 'imageIsLandscape_c274dbaf',\n    imageIsPortrait: 'imageIsPortrait_c274dbaf',\n    imageIsNone: 'imageIsNone_c274dbaf',\n    imageIsScaleWidthHeight: 'imageIsScaleWidthHeight_c274dbaf',\n    imageIsScaleWidth: 'imageIsScaleWidth_c274dbaf',\n    imageIsScaleHeight: 'imageIsScaleHeight_c274dbaf',\n};\nload_themed_styles_1.loadStyles([{ \"rawString\": \".root_c274dbaf{overflow:hidden}.rootIsMaximizeFrame_c274dbaf{height:100%;width:100%}.image_c274dbaf{display:block;opacity:0}.image_c274dbaf.imageIsLoaded_c274dbaf{opacity:1}.imageIsCenter_c274dbaf,.imageIsContain_c274dbaf,.imageIsCover_c274dbaf{position:relative;top:50%}html[dir=ltr] .imageIsCenter_c274dbaf,html[dir=ltr] .imageIsContain_c274dbaf,html[dir=ltr] .imageIsCover_c274dbaf{left:50%}html[dir=rtl] .imageIsCenter_c274dbaf,html[dir=rtl] .imageIsContain_c274dbaf,html[dir=rtl] .imageIsCover_c274dbaf{right:50%}html[dir=ltr] .imageIsCenter_c274dbaf,html[dir=ltr] .imageIsContain_c274dbaf,html[dir=ltr] .imageIsCover_c274dbaf{-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}html[dir=rtl] .imageIsCenter_c274dbaf,html[dir=rtl] .imageIsContain_c274dbaf,html[dir=rtl] .imageIsCover_c274dbaf{-webkit-transform:translate(50%,-50%);transform:translate(50%,-50%)}.imageIsContain_c274dbaf.imageIsLandscape_c274dbaf{width:100%;height:auto}.imageIsContain_c274dbaf.imageIsPortrait_c274dbaf{height:100%;width:auto}.imageIsCover_c274dbaf.imageIsLandscape_c274dbaf{height:100%;width:auto}.imageIsCover_c274dbaf.imageIsPortrait_c274dbaf{width:100%;height:auto}.imageIsNone_c274dbaf{height:auto;width:auto}.imageIsScaleWidthHeight_c274dbaf{height:100%;width:100%}.imageIsScaleWidth_c274dbaf{height:auto;width:100%}.imageIsScaleHeight_c274dbaf{height:100%;width:auto}\" }]);\nmodule.exports = styles;\n/* tslint:enable */ \n\n\n\n/***/ }),\n/* 88 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/* tslint:disable */\nvar load_themed_styles_1 = __webpack_require__(2);\nvar styles = {\n    rootIsFixed: 'rootIsFixed_421ed432',\n    content: 'content_421ed432',\n};\nload_themed_styles_1.loadStyles([{ \"rawString\": \".rootIsFixed_421ed432{position:fixed;z-index:1000000;top:0;left:0;width:100vw;height:100vh;visibility:hidden}.content_421ed432{visibility:visible}\" }]);\nmodule.exports = styles;\n/* tslint:enable */ \n\n\n\n/***/ }),\n/* 89 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar Layer_1 = __webpack_require__(29);\nvar LayerHost = (function (_super) {\n    __extends(LayerHost, _super);\n    function LayerHost() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    LayerHost.prototype.shouldComponentUpdate = function () {\n        return false;\n    };\n    LayerHost.prototype.componentDidMount = function () {\n        Layer_1.Layer.notifyHostChanged(this.props.id);\n    };\n    LayerHost.prototype.componentWillUnmount = function () {\n        Layer_1.Layer.notifyHostChanged(this.props.id);\n    };\n    LayerHost.prototype.render = function () {\n        return (React.createElement(\"div\", __assign({}, this.props, { className: Utilities_1.css('ms-LayerHost', this.props.className) })));\n    };\n    return LayerHost;\n}(Utilities_1.BaseComponent));\nexports.LayerHost = LayerHost;\n\n\n\n/***/ }),\n/* 90 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(29));\n__export(__webpack_require__(89));\n\n\n\n/***/ }),\n/* 91 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar styles = __webpack_require__(92);\nvar Link = (function (_super) {\n    __extends(Link, _super);\n    function Link() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Link.prototype.render = function () {\n        var _a = this.props, disabled = _a.disabled, children = _a.children, className = _a.className, href = _a.href;\n        return (href ? (React.createElement(\"a\", __assign({}, Utilities_1.getNativeProps(this.props, Utilities_1.anchorProperties), { className: Utilities_1.css('ms-Link', styles.root, className, (_b = {\n                    'is-disabled': disabled\n                },\n                _b[styles.isDisabled] = disabled,\n                _b[styles.isEnabled] = !disabled,\n                _b)), onClick: this._onClick, ref: this._resolveRef('_link'), target: this.props.target }), children)) : (React.createElement(\"button\", __assign({}, Utilities_1.getNativeProps(this.props, Utilities_1.buttonProperties), { className: Utilities_1.css('ms-Link', styles.root, className, (_c = {\n                    'is-disabled': disabled\n                },\n                _c[styles.isDisabled] = disabled,\n                _c)), onClick: this._onClick, ref: this._resolveRef('_link') }), children)));\n        var _b, _c;\n    };\n    Link.prototype.focus = function () {\n        if (this._link) {\n            this._link.focus();\n        }\n    };\n    Link.prototype._onClick = function (ev) {\n        var onClick = this.props.onClick;\n        if (onClick) {\n            onClick(ev);\n        }\n    };\n    return Link;\n}(Utilities_1.BaseComponent));\n__decorate([\n    Utilities_1.autobind\n], Link.prototype, \"_onClick\", null);\nexports.Link = Link;\n\n\n\n/***/ }),\n/* 92 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/* tslint:disable */\nvar load_themed_styles_1 = __webpack_require__(2);\nvar styles = {\n    root: 'root_5a9f2fae',\n    isEnabled: 'isEnabled_5a9f2fae',\n    isDisabled: 'isDisabled_5a9f2fae',\n};\nload_themed_styles_1.loadStyles([{ \"rawString\": \".root_5a9f2fae{font-family:\\\"Segoe UI WestEuropean\\\",\\\"Segoe UI\\\",-apple-system,BlinkMacSystemFont,Roboto,\\\"Helvetica Neue\\\",sans-serif;-webkit-font-smoothing:antialiased;color:\" }, { \"theme\": \"themePrimary\", \"defaultValue\": \"#0078d7\" }, { \"rawString\": \";margin:0;overflow:inherit;padding:0;text-overflow:inherit}.isEnabled_5a9f2fae:focus,.isEnabled_5a9f2fae:hover{color:\" }, { \"theme\": \"themeDarker\", \"defaultValue\": \"#004578\" }, { \"rawString\": \"}.isEnabled_5a9f2fae:active{color:\" }, { \"theme\": \"themePrimary\", \"defaultValue\": \"#0078d7\" }, { \"rawString\": \"}.isDisabled_5a9f2fae{color:\" }, { \"theme\": \"neutralTertiary\", \"defaultValue\": \"#a6a6a6\" }, { \"rawString\": \";pointer-events:none;cursor:default}button.root_5a9f2fae{background:0 0;border:none;cursor:pointer;display:inline;font-size:inherit}button.root_5a9f2fae::-moz-focus-inner{border:0}button.root_5a9f2fae{outline:transparent;position:relative}.ms-Fabric.is-focusVisible button.root_5a9f2fae:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid \" }, { \"theme\": \"neutralSecondary\", \"defaultValue\": \"#666666\" }, { \"rawString\": \"}html[dir=ltr] button.root_5a9f2fae{text-align:left}html[dir=rtl] button.root_5a9f2fae{text-align:right}a.root_5a9f2fae{text-decoration:none}.ms-Fabric.is-focusVisible a.root_5a9f2fae:focus{outline:1px solid \" }, { \"theme\": \"neutralSecondary\", \"defaultValue\": \"#666666\" }, { \"rawString\": \"}\" }]);\nmodule.exports = styles;\n/* tslint:enable */ \n\n\n\n/***/ }),\n/* 93 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(91));\n\n\n\n/***/ }),\n/* 94 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar RESIZE_DELAY = 16;\nvar MIN_SCROLL_UPDATE_DELAY = 100;\nvar MAX_SCROLL_UPDATE_DELAY = 500;\nvar IDLE_DEBOUNCE_DELAY = 200;\nvar DEFAULT_ITEMS_PER_PAGE = 10;\nvar DEFAULT_PAGE_HEIGHT = 30;\nvar DEFAULT_RENDERED_WINDOWS_BEHIND = 2;\nvar DEFAULT_RENDERED_WINDOWS_AHEAD = 2;\nvar EMPTY_RECT = {\n    top: -1,\n    bottom: -1,\n    left: -1,\n    right: -1,\n    width: 0,\n    height: 0\n};\n// Naming expensive measures so that they're named in profiles.\nvar _measurePageRect = function (element) { return element.getBoundingClientRect(); };\nvar _measureSurfaceRect = _measurePageRect;\nvar _measureScrollRect = _measurePageRect;\n/**\n * The List renders virtualized pages of items. Each page's item count is determined by the getItemCountForPage callback if\n * provided by the caller, or 10 as default. Each page's height is determined by the getPageHeight callback if provided by\n * the caller, or by cached measurements if available, or by a running average, or a default fallback.\n *\n * The algorithm for rendering pages works like this:\n *\n * 1. Predict visible pages based on \"current measure data\" (page heights, surface position, visible window)\n * 2. If changes are necessary, apply changes (add/remove pages)\n * 3. For pages that are added, measure the page heights if we need to using getBoundingClientRect\n * 4. If measurements don't match predictions, update measure data and goto step 1 asynchronously\n *\n * Measuring too frequently can pull performance down significantly. To compensate, we cache measured values so that\n * we can avoid re-measuring during operations that should not alter heights, like scrolling.\n *\n * However, certain operations can make measure data stale. For example, resizing the list, or passing in new props,\n * or forcing an update change cause pages to shrink/grow. When these operations occur, we increment a measureVersion\n * number, which we associate with cached measurements and use to determine if a remeasure should occur.\n */\nvar List = (function (_super) {\n    __extends(List, _super);\n    function List(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = {\n            pages: []\n        };\n        _this._estimatedPageHeight = 0;\n        _this._totalEstimates = 0;\n        _this._requiredWindowsAhead = 0;\n        _this._requiredWindowsBehind = 0;\n        // Track the measure version for everything.\n        _this._measureVersion = 0;\n        // Ensure that scrolls are lazy updated.\n        _this._onAsyncScroll = _this._async.debounce(_this._onAsyncScroll, MIN_SCROLL_UPDATE_DELAY, {\n            leading: false,\n            maxWait: MAX_SCROLL_UPDATE_DELAY\n        });\n        _this._onAsyncIdle = _this._async.debounce(_this._onAsyncIdle, IDLE_DEBOUNCE_DELAY, {\n            leading: false\n        });\n        _this._onAsyncResize = _this._async.debounce(_this._onAsyncResize, RESIZE_DELAY, {\n            leading: false\n        });\n        _this._cachedPageHeights = {};\n        _this._estimatedPageHeight = 0;\n        _this._focusedIndex = -1;\n        _this._scrollingToIndex = -1;\n        return _this;\n    }\n    /**\n     * Scroll to the given index. By default will bring the page the specified item is on into the view. If a callback\n     * to measure the height of an individual item is specified, will only scroll to bring the specific item into view.\n     *\n     * Note: with items of variable height and no passed in `getPageHeight` method, the list might jump after scrolling\n     * when windows before/ahead are being rendered, and the estimated height is replaced using actual elements.\n     *\n     * @param index Index of item to scroll to\n     * @param measureItem Optional callback to measure the height of an individual item\n     */\n    List.prototype.scrollToIndex = function (index, measureItem) {\n        var startIndex = this.props.startIndex;\n        var renderCount = this._getRenderCount();\n        var endIndex = startIndex + renderCount;\n        var scrollTop = 0;\n        var itemsPerPage = 1;\n        for (var itemIndex = startIndex; itemIndex < endIndex; itemIndex += itemsPerPage) {\n            itemsPerPage = this._getItemCountForPage(itemIndex, this._allowedRect);\n            var requestedIndexIsInPage = itemIndex <= index && (itemIndex + itemsPerPage) > index;\n            if (requestedIndexIsInPage) {\n                // We have found the page. If the user provided a way to measure an individual item, we will try to scroll in just\n                // the given item, otherwise we'll only bring the page into view\n                if (measureItem) {\n                    // Adjust for actual item position within page\n                    var itemPositionWithinPage = index - itemIndex;\n                    for (var itemIndexInPage = 0; itemIndexInPage < itemPositionWithinPage; ++itemIndexInPage) {\n                        scrollTop += measureItem(itemIndex + itemIndexInPage);\n                    }\n                    var scrollBottom = scrollTop + measureItem(index);\n                    var scrollRect = _measureScrollRect(this._scrollElement);\n                    var scrollWindow = {\n                        top: this._scrollElement.scrollTop,\n                        bottom: this._scrollElement.scrollTop + scrollRect.height\n                    };\n                    var itemIsFullyVisible = scrollTop >= scrollWindow.top && scrollBottom <= scrollWindow.bottom;\n                    if (itemIsFullyVisible) {\n                        // Item is already visible, do nothing.\n                        return;\n                    }\n                    var itemIsPartiallyAbove = scrollTop < scrollWindow.top;\n                    var itemIsPartiallyBelow = scrollBottom > scrollWindow.bottom;\n                    if (itemIsPartiallyAbove) {\n                        // We will just scroll to 'scrollTop'\n                        //  ______\n                        // |Item  |   - scrollTop\n                        // |  ____|_\n                        // |_|____| | - scrollWindow.top\n                        //   |      |\n                        //   |______|\n                    }\n                    else if (itemIsPartiallyBelow) {\n                        // Adjust scrollTop position to just bring in the element\n                        //  ______   - scrollTop\n                        // |      |\n                        // |  ____|_  - scrollWindow.bottom\n                        // |_|____| |\n                        //   | Item |\n                        //   |______| - scrollBottom\n                        scrollTop = this._scrollElement.scrollTop + (scrollBottom - scrollWindow.bottom);\n                    }\n                }\n                this._scrollElement.scrollTop = scrollTop;\n                break;\n            }\n            scrollTop += this._getPageHeight(itemIndex, itemsPerPage, this._surfaceRect);\n        }\n    };\n    List.prototype.componentDidMount = function () {\n        this._updatePages();\n        this._measureVersion++;\n        this._scrollElement = Utilities_1.findScrollableParent(this.refs.root);\n        this._events.on(window, 'resize', this._onAsyncResize);\n        this._events.on(this.refs.root, 'focus', this._onFocus, true);\n        if (this._scrollElement) {\n            this._events.on(this._scrollElement, 'scroll', this._onScroll);\n            this._events.on(this._scrollElement, 'scroll', this._onAsyncScroll);\n        }\n    };\n    List.prototype.componentWillReceiveProps = function (newProps) {\n        if (newProps.items !== this.props.items ||\n            newProps.renderCount !== this.props.renderCount ||\n            newProps.startIndex !== this.props.startIndex) {\n            this._measureVersion++;\n            this._updatePages(newProps);\n        }\n    };\n    List.prototype.shouldComponentUpdate = function (newProps, newState) {\n        var _a = this.props, renderedWindowsAhead = _a.renderedWindowsAhead, renderedWindowsBehind = _a.renderedWindowsBehind;\n        var oldPages = this.state.pages;\n        var newPages = newState.pages, measureVersion = newState.measureVersion;\n        var shouldComponentUpdate = false;\n        if (this._measureVersion === measureVersion &&\n            newProps.renderedWindowsAhead === renderedWindowsAhead,\n            newProps.renderedWindowsBehind === renderedWindowsBehind,\n            newProps.items === this.props.items &&\n                oldPages.length === newPages.length) {\n            for (var i = 0; i < oldPages.length; i++) {\n                var oldPage = oldPages[i];\n                var newPage = newPages[i];\n                if ((oldPage.key !== newPage.key ||\n                    oldPage.itemCount !== newPage.itemCount)) {\n                    shouldComponentUpdate = true;\n                    break;\n                }\n            }\n        }\n        else {\n            shouldComponentUpdate = true;\n        }\n        return shouldComponentUpdate;\n    };\n    List.prototype.forceUpdate = function () {\n        // Ensure that when the list is force updated we update the pages first before render.\n        this._updateRenderRects(this.props, true);\n        this._updatePages();\n        this._measureVersion++;\n        _super.prototype.forceUpdate.call(this);\n    };\n    List.prototype.render = function () {\n        var _a = this.props, className = _a.className, role = _a.role;\n        var pages = this.state.pages;\n        var pageElements = [];\n        var divProps = Utilities_1.getNativeProps(this.props, Utilities_1.divProperties);\n        // assign list if no role\n        role = (role === undefined) ? 'list' : role;\n        for (var i = 0; i < pages.length; i++) {\n            pageElements.push(this._renderPage(pages[i]));\n        }\n        return (React.createElement(\"div\", __assign({ ref: 'root' }, divProps, { role: role, className: Utilities_1.css('ms-List', className) }),\n            React.createElement(\"div\", { ref: 'surface', className: 'ms-List-surface' }, pageElements)));\n    };\n    List.prototype._renderPage = function (page) {\n        var _a = this.props, onRenderCell = _a.onRenderCell, role = _a.role;\n        var cells = [];\n        var pageStyle = this._getPageStyle(page);\n        // only assign list item role if no role is assigned\n        role = (role === undefined) ? 'listitem' : null;\n        for (var i = 0; page.items && i < page.items.length; i++) {\n            var item = page.items[i];\n            var index = page.startIndex + i;\n            var itemKey = this.props.getKey\n                ? this.props.getKey(item, index)\n                : item && item.key;\n            if (itemKey === null || itemKey === undefined) {\n                itemKey = index;\n            }\n            cells.push(React.createElement(\"div\", { role: role, className: 'ms-List-cell', key: itemKey, \"data-list-index\": i + page.startIndex, \"data-automationid\": 'ListCell' }, onRenderCell(item, page.startIndex + i)));\n        }\n        return (React.createElement(\"div\", { className: 'ms-List-page', key: page.key, ref: page.key, style: pageStyle }, cells));\n    };\n    /** Generate the style object for the page. */\n    List.prototype._getPageStyle = function (page) {\n        var style;\n        var getPageStyle = this.props.getPageStyle;\n        if (getPageStyle) {\n            style = getPageStyle(page);\n        }\n        if (!page.items) {\n            style = style || {};\n            style.height = page.height;\n        }\n        return style;\n    };\n    /** Track the last item index focused so that we ensure we keep it rendered. */\n    List.prototype._onFocus = function (ev) {\n        var target = ev.target;\n        while (target !== this.refs.surface) {\n            var indexString = target.getAttribute('data-list-index');\n            if (indexString) {\n                this._focusedIndex = Number(indexString);\n                break;\n            }\n            target = Utilities_1.getParent(target);\n        }\n    };\n    /**\n     * Called synchronously to reset the required render range to 0 on scrolling. After async scroll has executed,\n     * we will call onAsyncIdle which will reset it back to it's correct value.\n     */\n    List.prototype._onScroll = function () {\n        this._requiredWindowsAhead = 0;\n        this._requiredWindowsBehind = 0;\n    };\n    /**\n     * Debounced method to asynchronously update the visible region on a scroll event.\n     */\n    List.prototype._onAsyncScroll = function () {\n        this._updateRenderRects();\n        // Only update pages when the visible rect falls outside of the materialized rect.\n        if (!this._materializedRect || !_isContainedWithin(this._requiredRect, this._materializedRect)) {\n            this._updatePages();\n        }\n        else {\n            // console.log('requiredRect contained in materialized', this._requiredRect, this._materializedRect);\n        }\n    };\n    /**\n     * This is an async debounced method that will try and increment the windows we render. If we can increment\n     * either, we increase the amount we render and re-evaluate.\n     */\n    List.prototype._onAsyncIdle = function () {\n        var _a = this.props, renderedWindowsAhead = _a.renderedWindowsAhead, renderedWindowsBehind = _a.renderedWindowsBehind;\n        var _b = this, requiredWindowsAhead = _b._requiredWindowsAhead, requiredWindowsBehind = _b._requiredWindowsBehind;\n        var windowsAhead = Math.min(renderedWindowsAhead, requiredWindowsAhead + 1);\n        var windowsBehind = Math.min(renderedWindowsBehind, requiredWindowsBehind + 1);\n        if (windowsAhead !== requiredWindowsAhead || windowsBehind !== requiredWindowsBehind) {\n            // console.log('idling', windowsBehind, windowsAhead);\n            this._requiredWindowsAhead = windowsAhead;\n            this._requiredWindowsBehind = windowsBehind;\n            this._updateRenderRects();\n            this._updatePages();\n        }\n        if (renderedWindowsAhead > windowsAhead || renderedWindowsBehind > windowsBehind) {\n            // Async increment on next tick.\n            this._onAsyncIdle();\n        }\n    };\n    List.prototype._onAsyncResize = function () {\n        this.forceUpdate();\n    };\n    List.prototype._updatePages = function (props) {\n        var _this = this;\n        var _a = (props || this.props), items = _a.items, startIndex = _a.startIndex, renderCount = _a.renderCount;\n        renderCount = this._getRenderCount(props);\n        // console.log('updating pages');\n        if (!this._requiredRect) {\n            this._updateRenderRects(props);\n        }\n        var newListState = this._buildPages(items, startIndex, renderCount);\n        var oldListPages = this.state.pages;\n        this.setState(newListState, function () {\n            // If measured version is invalid since we've updated the DOM\n            var heightsChanged = _this._updatePageMeasurements(oldListPages, newListState.pages);\n            // On first render, we should re-measure so that we don't get a visual glitch.\n            if (heightsChanged) {\n                _this._materializedRect = null;\n                if (!_this._hasCompletedFirstRender) {\n                    _this._hasCompletedFirstRender = true;\n                    _this._updatePages();\n                }\n                else {\n                    _this._onAsyncScroll();\n                }\n            }\n            else {\n                // Enqueue an idle bump.\n                _this._onAsyncIdle();\n            }\n        });\n    };\n    List.prototype._updatePageMeasurements = function (oldPages, newPages) {\n        var renderedIndexes = {};\n        var heightChanged = false;\n        var renderCount = this._getRenderCount();\n        for (var i = 0; i < oldPages.length; i++) {\n            var page = oldPages[i];\n            if (page.items) {\n                renderedIndexes[page.startIndex] = page;\n            }\n        }\n        for (var i = 0; i < newPages.length; i++) {\n            var page = newPages[i];\n            if (page.items) {\n                // Only evaluate page height if the page contains less items than total.\n                if (page.items.length < renderCount) {\n                    heightChanged = this._measurePage(page) || heightChanged;\n                }\n                if (!renderedIndexes[page.startIndex]) {\n                    this._onPageAdded(page);\n                }\n                else {\n                    delete renderedIndexes[page.startIndex];\n                }\n            }\n        }\n        for (var index in renderedIndexes) {\n            if (renderedIndexes.hasOwnProperty(index)) {\n                this._onPageRemoved(renderedIndexes[index]);\n            }\n        }\n        return heightChanged;\n    };\n    /**\n     * Given a page, measure its dimensions, update cache.\n     * @returns True if the height has changed.\n     */\n    List.prototype._measurePage = function (page) {\n        var hasChangedHeight = false;\n        var pageElement = this.refs[page.key];\n        var cachedHeight = this._cachedPageHeights[page.startIndex];\n        // console.log('   * measure attempt', page.startIndex, cachedHeight);\n        if (pageElement && (!cachedHeight || cachedHeight.measureVersion !== this._measureVersion)) {\n            var newClientRect = _measurePageRect(pageElement);\n            hasChangedHeight = page.height !== newClientRect.height;\n            // console.warn(' *** expensive page measure', page.startIndex, page.height, newClientRect.height);\n            page.height = newClientRect.height;\n            this._cachedPageHeights[page.startIndex] = {\n                height: newClientRect.height,\n                measureVersion: this._measureVersion\n            };\n            this._estimatedPageHeight = Math.round(((this._estimatedPageHeight * this._totalEstimates) + newClientRect.height) /\n                (this._totalEstimates + 1));\n            this._totalEstimates++;\n        }\n        return hasChangedHeight;\n    };\n    /** Called when a page has been added to the DOM. */\n    List.prototype._onPageAdded = function (page) {\n        var onPageAdded = this.props.onPageAdded;\n        // console.log('page added', page.startIndex, this.state.pages.map(page=>page.key).join(', '));\n        if (onPageAdded) {\n            onPageAdded(page);\n        }\n    };\n    /** Called when a page has been removed from the DOM. */\n    List.prototype._onPageRemoved = function (page) {\n        var onPageRemoved = this.props.onPageRemoved;\n        // console.log('  --- page removed', page.startIndex, this.state.pages.map(page=>page.key).join(', '));\n        if (onPageRemoved) {\n            onPageRemoved(page);\n        }\n    };\n    /** Build up the pages that should be rendered. */\n    List.prototype._buildPages = function (items, startIndex, renderCount) {\n        var materializedRect = Utilities_1.assign({}, EMPTY_RECT);\n        var itemsPerPage = 1;\n        var pages = [];\n        var pageTop = 0;\n        var currentSpacer = null;\n        var focusedIndex = this._focusedIndex;\n        var endIndex = startIndex + renderCount;\n        // First render is very important to track; when we render cells, we have no idea of estimated page height.\n        // So we should default to rendering only the first page so that we can get information.\n        // However if the user provides a measure function, let's just assume they know the right heights.\n        var isFirstRender = this._estimatedPageHeight === 0 && !this.props.getPageHeight;\n        var _loop_1 = function (itemIndex) {\n            itemsPerPage = this_1._getItemCountForPage(itemIndex, this_1._allowedRect);\n            var pageHeight = this_1._getPageHeight(itemIndex, itemsPerPage, this_1._surfaceRect);\n            var pageBottom = pageTop + pageHeight - 1;\n            var isPageRendered = Utilities_1.findIndex(this_1.state.pages, function (page) { return page.items && page.startIndex === itemIndex; }) > -1;\n            var isPageInAllowedRange = pageBottom >= this_1._allowedRect.top && pageTop <= this_1._allowedRect.bottom;\n            var isPageInRequiredRange = pageBottom >= this_1._requiredRect.top && pageTop <= this_1._requiredRect.bottom;\n            var isPageVisible = !isFirstRender && (isPageInRequiredRange || (isPageInAllowedRange && isPageRendered));\n            var isPageFocused = focusedIndex >= itemIndex && focusedIndex < (itemIndex + itemsPerPage);\n            var isFirstPage = itemIndex === startIndex;\n            // console.log('building page', itemIndex, 'pageTop: ' + pageTop, 'inAllowed: ' + isPageInAllowedRange, 'inRequired: ' + isPageInRequiredRange);\n            // Only render whats visible, focused, or first page.\n            if (isPageVisible || isPageFocused || isFirstPage) {\n                if (currentSpacer) {\n                    pages.push(currentSpacer);\n                    currentSpacer = null;\n                }\n                var itemsInPage = Math.min(itemsPerPage, endIndex - itemIndex);\n                var newPage = this_1._createPage(null, items.slice(itemIndex, itemIndex + itemsInPage), itemIndex);\n                newPage.top = pageTop;\n                newPage.height = pageHeight;\n                pages.push(newPage);\n                if (isPageInRequiredRange) {\n                    _mergeRect(materializedRect, {\n                        top: pageTop,\n                        bottom: pageBottom,\n                        height: pageHeight,\n                        left: this_1._allowedRect.left,\n                        right: this_1._allowedRect.right,\n                        width: this_1._allowedRect.width\n                    });\n                }\n            }\n            else {\n                if (!currentSpacer) {\n                    currentSpacer = this_1._createPage('spacer-' + itemIndex, null, itemIndex, 0);\n                }\n                currentSpacer.height = (currentSpacer.height || 0) + (pageBottom - pageTop) + 1;\n                currentSpacer.itemCount += itemsPerPage;\n            }\n            pageTop += (pageBottom - pageTop + 1);\n            if (isFirstRender) {\n                return \"break\";\n            }\n        };\n        var this_1 = this;\n        for (var itemIndex = startIndex; itemIndex < endIndex; itemIndex += itemsPerPage) {\n            var state_1 = _loop_1(itemIndex);\n            if (state_1 === \"break\")\n                break;\n        }\n        if (currentSpacer) {\n            currentSpacer.key = 'spacer-end';\n            pages.push(currentSpacer);\n        }\n        this._materializedRect = materializedRect;\n        // console.log('materialized: ', materializedRect);\n        return {\n            pages: pages,\n            measureVersion: this._measureVersion\n        };\n    };\n    /**\n     * Get the pixel height of a give page. Will use the props getPageHeight first, and if not provided, fallback to\n     * cached height, or estimated page height, or default page height.\n     */\n    List.prototype._getPageHeight = function (itemIndex, itemsPerPage, visibleRect) {\n        if (this.props.getPageHeight) {\n            return this.props.getPageHeight(itemIndex, visibleRect);\n        }\n        else {\n            var cachedHeight = (this._cachedPageHeights[itemIndex]);\n            return cachedHeight ? cachedHeight.height : (this._estimatedPageHeight || DEFAULT_PAGE_HEIGHT);\n        }\n    };\n    List.prototype._getItemCountForPage = function (itemIndex, visibileRect) {\n        var itemsPerPage = this.props.getItemCountForPage ? this.props.getItemCountForPage(itemIndex, visibileRect) : DEFAULT_ITEMS_PER_PAGE;\n        return itemsPerPage ? itemsPerPage : DEFAULT_ITEMS_PER_PAGE;\n    };\n    List.prototype._createPage = function (pageKey, items, startIndex, count, style) {\n        pageKey = pageKey || ('page-' + startIndex);\n        // Fill undefined cells because array.map will ignore undefined cells.\n        if (items) {\n            for (var i = 0; i < items.length; i++) {\n                items[i] = items[i] || null;\n            }\n        }\n        return {\n            key: pageKey,\n            startIndex: startIndex === undefined ? -1 : startIndex,\n            itemCount: (count === undefined) ? (items ? items.length : 0) : count,\n            items: items,\n            style: style || {},\n            top: 0,\n            height: 0\n        };\n    };\n    List.prototype._getRenderCount = function (props) {\n        var _a = props || this.props, items = _a.items, startIndex = _a.startIndex, renderCount = _a.renderCount;\n        return (renderCount === undefined ? (items ? items.length - startIndex : 0) : renderCount);\n    };\n    /** Calculate the visible rect within the list where top: 0 and left: 0 is the top/left of the list. */\n    List.prototype._updateRenderRects = function (props, forceUpdate) {\n        var _a = (props || this.props), renderedWindowsAhead = _a.renderedWindowsAhead, renderedWindowsBehind = _a.renderedWindowsBehind;\n        var pages = this.state.pages;\n        var renderCount = this._getRenderCount(props);\n        var surfaceRect = this._surfaceRect;\n        // WARNING: EXPENSIVE CALL! We need to know the surface top relative to the window.\n        if (forceUpdate ||\n            !pages ||\n            !this._surfaceRect ||\n            (pages.length > 0 && pages[0].items && pages[0].items.length < renderCount)) {\n            surfaceRect = this._surfaceRect = _measureSurfaceRect(this.refs.surface);\n        }\n        // If the surface is above the container top or below the container bottom, or if this is not the first\n        // render return empty rect.\n        // The first time the list gets rendered we need to calculate the rectangle. The width of the list is\n        // used to calculate the width of the list items.\n        var visibleTop = Math.max(0, -surfaceRect.top);\n        var visibleRect = {\n            top: visibleTop,\n            left: surfaceRect.left,\n            bottom: visibleTop + window.innerHeight,\n            right: surfaceRect.right,\n            width: surfaceRect.width,\n            height: window.innerHeight\n        };\n        // The required/allowed rects are adjusted versions of the visible rect.\n        this._requiredRect = _expandRect(visibleRect, this._requiredWindowsBehind, this._requiredWindowsAhead);\n        this._allowedRect = _expandRect(visibleRect, renderedWindowsBehind, renderedWindowsAhead);\n    };\n    return List;\n}(Utilities_1.BaseComponent));\nList.defaultProps = {\n    startIndex: 0,\n    onRenderCell: function (item, index, containsFocus) { return (React.createElement(\"div\", null, (item && item.name) || '')); },\n    renderedWindowsAhead: DEFAULT_RENDERED_WINDOWS_AHEAD,\n    renderedWindowsBehind: DEFAULT_RENDERED_WINDOWS_BEHIND\n};\nexports.List = List;\nfunction _expandRect(rect, pagesBefore, pagesAfter) {\n    var top = rect.top - (pagesBefore * rect.height);\n    var height = rect.height + ((pagesBefore + pagesAfter) * rect.height);\n    return {\n        top: top,\n        bottom: top + height,\n        height: height,\n        left: rect.left,\n        right: rect.right,\n        width: rect.width\n    };\n}\nfunction _isContainedWithin(innerRect, outerRect) {\n    return (innerRect.top >= outerRect.top &&\n        innerRect.left >= outerRect.left &&\n        innerRect.bottom <= outerRect.bottom &&\n        innerRect.right <= outerRect.right);\n}\nfunction _mergeRect(targetRect, newRect) {\n    targetRect.top = (newRect.top < targetRect.top || targetRect.top === -1) ? newRect.top : targetRect.top;\n    targetRect.left = (newRect.left < targetRect.left || targetRect.left === -1) ? newRect.left : targetRect.left;\n    targetRect.bottom = (newRect.bottom > targetRect.bottom || targetRect.bottom === -1) ? newRect.bottom : targetRect.bottom;\n    targetRect.right = (newRect.right > targetRect.right || targetRect.right === -1) ? newRect.right : targetRect.right;\n    targetRect.width = targetRect.right - targetRect.left + 1;\n    targetRect.height = targetRect.bottom - targetRect.top + 1;\n    return targetRect;\n}\n\n\n\n/***/ }),\n/* 95 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(94));\n\n\n\n/***/ }),\n/* 96 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar Spinner_Props_1 = __webpack_require__(17);\nvar styles = __webpack_require__(97);\nvar Spinner = (function (_super) {\n    __extends(Spinner, _super);\n    function Spinner() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Spinner.prototype.render = function () {\n        var _a = this.props, type = _a.type, size = _a.size, label = _a.label, className = _a.className; // TODO remove deprecated type property at >= 2.0.0\n        return (React.createElement(\"div\", { className: Utilities_1.css('ms-Spinner', styles.root, className) },\n            React.createElement(\"div\", { className: Utilities_1.css('ms-Spinner-circle', styles.circle, (_b = {},\n                    _b['ms-Spinner--xSmall ' + styles.circleIsXSmall] = size === Spinner_Props_1.SpinnerSize.xSmall,\n                    _b['ms-Spinner--small ' + styles.circleIsSmall] = size === Spinner_Props_1.SpinnerSize.small,\n                    _b['ms-Spinner--medium ' + styles.circleIsMedium] = size === Spinner_Props_1.SpinnerSize.medium,\n                    _b['ms-Spinner--large ' + styles.circleIsLarge] = size === Spinner_Props_1.SpinnerSize.large,\n                    _b['ms-Spinner--normal ' + styles.circleIsTypeMedium] = type === Spinner_Props_1.SpinnerType.normal,\n                    _b['ms-Spinner--large ' + styles.circleIsTypeLarge] = type === Spinner_Props_1.SpinnerType.large // TODO remove deprecated value at >= 2.0.0\n                ,\n                    _b)) }),\n            label && (React.createElement(\"div\", { className: Utilities_1.css('ms-Spinner-label', styles.label) }, label))));\n        var _b;\n    };\n    return Spinner;\n}(React.Component));\nSpinner.defaultProps = {\n    size: Spinner_Props_1.SpinnerSize.medium\n};\nexports.Spinner = Spinner;\n\n\n\n/***/ }),\n/* 97 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/* tslint:disable */\nvar load_themed_styles_1 = __webpack_require__(2);\nvar styles = {\n    root: 'root_3e7f0799',\n    circle: 'circle_3e7f0799',\n    spinAnimation: 'spinAnimation_3e7f0799',\n    circleIsXSmall: 'circleIsXSmall_3e7f0799',\n    circleIsSmall: 'circleIsSmall_3e7f0799',\n    circleIsTypeMedium: 'circleIsTypeMedium_3e7f0799',\n    circleIsMedium: 'circleIsMedium_3e7f0799',\n    circleIsTypeLarge: 'circleIsTypeLarge_3e7f0799',\n    circleIsLarge: 'circleIsLarge_3e7f0799',\n    label: 'label_3e7f0799',\n};\nload_themed_styles_1.loadStyles([{ \"rawString\": \"@-webkit-keyframes spinAnimation_3e7f0799{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinAnimation_3e7f0799{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.root_3e7f0799>.circle_3e7f0799{margin:auto;box-sizing:border-box;border-radius:50%;width:100%;height:100%;border:1.5px solid \" }, { \"theme\": \"themeLight\", \"defaultValue\": \"#c7e0f4\" }, { \"rawString\": \";border-top-color:\" }, { \"theme\": \"themePrimary\", \"defaultValue\": \"#0078d7\" }, { \"rawString\": \";-webkit-animation:spinAnimation_3e7f0799 1.3s infinite cubic-bezier(.53,.21,.29,.67);animation:spinAnimation_3e7f0799 1.3s infinite cubic-bezier(.53,.21,.29,.67)}.root_3e7f0799>.circle_3e7f0799.circleIsXSmall_3e7f0799{width:12px;height:12px}.root_3e7f0799>.circle_3e7f0799.circleIsSmall_3e7f0799{width:16px;height:16px}.root_3e7f0799>.circle_3e7f0799.circleIsMedium_3e7f0799,.root_3e7f0799>.circle_3e7f0799.circleIsTypeMedium_3e7f0799{width:20px;height:20px}.root_3e7f0799>.circle_3e7f0799.circleIsLarge_3e7f0799,.root_3e7f0799>.circle_3e7f0799.circleIsTypeLarge_3e7f0799{width:28px;height:28px}.root_3e7f0799>.label_3e7f0799{color:\" }, { \"theme\": \"themePrimary\", \"defaultValue\": \"#0078d7\" }, { \"rawString\": \";margin-top:10px;text-align:center}@media screen and (-ms-high-contrast:active){.root_3e7f0799>.circle_3e7f0799{border-top-style:none}}\" }]);\nmodule.exports = styles;\n/* tslint:enable */ \n\n\n\n/***/ }),\n/* 98 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(96));\n__export(__webpack_require__(17));\n\n\n\n/***/ }),\n/* 99 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Utilities_1 = __webpack_require__(1);\nvar BaseDecorator = (function (_super) {\n    __extends(BaseDecorator, _super);\n    function BaseDecorator() {\n        var _this = _super.call(this) || this;\n        _this._updateComposedComponentRef = _this._updateComposedComponentRef.bind(_this);\n        return _this;\n    }\n    /**\n     * Updates the ref to the component composed by the decorator, which will also take care of hoisting\n     * (and unhoisting as appropriate) methods from said component.\n     *\n     * Pass this method as the argument to the 'ref' property of the composed component.\n     */\n    BaseDecorator.prototype._updateComposedComponentRef = function (composedComponentInstance) {\n        this._composedComponentInstance = composedComponentInstance;\n        if (composedComponentInstance) {\n            this._hoisted = Utilities_1.hoistMethods(this, composedComponentInstance);\n        }\n        else if (this._hoisted) {\n            Utilities_1.unhoistMethods(this, this._hoisted);\n        }\n    };\n    return BaseDecorator;\n}(Utilities_1.BaseComponent));\nexports.BaseDecorator = BaseDecorator;\n\n\n\n/***/ }),\n/* 100 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar BaseDecorator_1 = __webpack_require__(99);\nvar Utilities_1 = __webpack_require__(1);\nvar RESIZE_DELAY = 500;\nfunction withViewport(ComposedComponent) {\n    return (function (_super) {\n        __extends(WithViewportComponent, _super);\n        function WithViewportComponent() {\n            var _this = _super.call(this) || this;\n            _this.state = {\n                viewport: {\n                    width: 0,\n                    height: 0\n                }\n            };\n            return _this;\n        }\n        WithViewportComponent.prototype.componentDidMount = function () {\n            this._onAsyncResize = this._async.debounce(this._onAsyncResize, RESIZE_DELAY, {\n                leading: false\n            });\n            this._events.on(window, 'resize', this._onAsyncResize);\n            this._updateViewport();\n        };\n        WithViewportComponent.prototype.componentWillUnmount = function () {\n            this._events.dispose();\n        };\n        WithViewportComponent.prototype.render = function () {\n            var viewport = this.state.viewport;\n            var isViewportVisible = viewport.width > 0 && viewport.height > 0;\n            return (React.createElement(\"div\", { className: 'ms-Viewport', ref: 'root', style: { minWidth: 1, minHeight: 1 } }, isViewportVisible && (React.createElement(ComposedComponent, __assign({ ref: this._updateComposedComponentRef, viewport: viewport }, this.props)))));\n        };\n        WithViewportComponent.prototype.forceUpdate = function () {\n            this._updateViewport(true);\n        };\n        WithViewportComponent.prototype._onAsyncResize = function () {\n            this._updateViewport();\n        };\n        WithViewportComponent.prototype._updateViewport = function (withForceUpdate) {\n            var _this = this;\n            var viewport = this.state.viewport;\n            var viewportElement = this.refs.root;\n            var scrollElement = Utilities_1.findScrollableParent(viewportElement);\n            var scrollRect = Utilities_1.getRect(scrollElement);\n            var clientRect = Utilities_1.getRect(viewportElement);\n            var updateComponent = function () {\n                if (withForceUpdate && _this._composedComponentInstance) {\n                    _this._composedComponentInstance.forceUpdate();\n                }\n            };\n            var isSizeChanged = (clientRect.width !== viewport.width ||\n                scrollRect.height !== viewport.height);\n            if (isSizeChanged) {\n                this.setState({\n                    viewport: {\n                        width: clientRect.width,\n                        height: scrollRect.height\n                    }\n                }, updateComponent);\n            }\n            else {\n                updateComponent();\n            }\n        };\n        return WithViewportComponent;\n    }(BaseDecorator_1.BaseDecorator));\n}\nexports.withViewport = withViewport;\n\n\n\n/***/ }),\n/* 101 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ReactDOM = __webpack_require__(10);\nvar Utilities_1 = __webpack_require__(1);\nvar DISTANCE_FOR_DRAG_SQUARED = 25; // the minimum mouse move distance to treat it as drag event\nvar MOUSEDOWN_PRIMARY_BUTTON = 0; // for mouse down event we are using ev.button property, 0 means left button\nvar MOUSEMOVE_PRIMARY_BUTTON = 1; // for mouse move event we are using ev.buttons property, 1 means left button\nvar DragDropHelper = (function () {\n    function DragDropHelper(params) {\n        this._selection = params.selection;\n        this._dragEnterCounts = {};\n        this._activeTargets = {};\n        this._lastId = 0;\n        this._events = new Utilities_1.EventGroup(this);\n        // clear drag data when mouse up, use capture event to ensure it will be run\n        this._events.on(document.body, 'mouseup', this._onMouseUp.bind(this), true);\n        this._events.on(document, 'mouseup', this._onDocumentMouseUp.bind(this), true);\n    }\n    DragDropHelper.prototype.dispose = function () {\n        this._events.dispose();\n    };\n    DragDropHelper.prototype.subscribe = function (root, events, dragDropOptions) {\n        var _this = this;\n        var _a = dragDropOptions.key, key = _a === void 0 ? \"\" + ++this._lastId : _a;\n        var handlers = [];\n        var onDragLeave;\n        var onDragEnter;\n        var onDragEnd;\n        var onDrop;\n        var onDragOver;\n        var onMouseDown;\n        var isDraggable;\n        var isDroppable;\n        var activeTarget;\n        if (dragDropOptions && root) {\n            var eventMap = dragDropOptions.eventMap, context_1 = dragDropOptions.context, updateDropState_1 = dragDropOptions.updateDropState;\n            var dragDropTarget = {\n                root: root,\n                options: dragDropOptions,\n                key: key\n            };\n            isDraggable = this._isDraggable(dragDropTarget);\n            isDroppable = this._isDroppable(dragDropTarget);\n            if (isDraggable || isDroppable) {\n                if (eventMap) {\n                    for (var _i = 0, eventMap_1 = eventMap; _i < eventMap_1.length; _i++) {\n                        var event_1 = eventMap_1[_i];\n                        var handler = {\n                            callback: event_1.callback.bind(null, context_1),\n                            eventName: event_1.eventName\n                        };\n                        handlers.push(handler);\n                        this._events.on(root, handler.eventName, handler.callback);\n                    }\n                }\n            }\n            if (isDroppable) {\n                // If the target is droppable, wire up global event listeners to track drop-related events.\n                onDragLeave = function (event) {\n                    if (!event.isHandled) {\n                        event.isHandled = true;\n                        _this._dragEnterCounts[key]--;\n                        if (_this._dragEnterCounts[key] === 0) {\n                            updateDropState_1(false /* isDropping */, event);\n                        }\n                    }\n                };\n                onDragEnter = function (event) {\n                    event.preventDefault(); // needed for IE\n                    if (!event.isHandled) {\n                        event.isHandled = true;\n                        _this._dragEnterCounts[key]++;\n                        if (_this._dragEnterCounts[key] === 1) {\n                            updateDropState_1(true /* isDropping */, event);\n                        }\n                    }\n                };\n                onDragEnd = function (event) {\n                    _this._dragEnterCounts[key] = 0;\n                    updateDropState_1(false /* isDropping */, event);\n                };\n                onDrop = function (event) {\n                    _this._dragEnterCounts[key] = 0;\n                    updateDropState_1(false /* isDropping */, event);\n                    if (dragDropOptions.onDrop) {\n                        dragDropOptions.onDrop(dragDropOptions.context.data, event);\n                    }\n                };\n                onDragOver = function (event) {\n                    event.preventDefault();\n                };\n                this._dragEnterCounts[key] = 0;\n                // dragenter and dragleave will be fired when hover to the child element\n                // but we only want to change state when enter or leave the current element\n                // use the count to ensure it.\n                events.on(root, 'dragenter', onDragEnter);\n                events.on(root, 'dragleave', onDragLeave);\n                events.on(root, 'dragend', onDragEnd);\n                events.on(root, 'drop', onDrop);\n                events.on(root, 'dragover', onDragOver);\n            }\n            if (isDraggable) {\n                // If the target is draggable, wire up local event listeners for mouse events.\n                onMouseDown = this._onMouseDown.bind(this, dragDropTarget);\n                onDragEnd = this._onDragEnd.bind(this, dragDropTarget);\n                events.on(root, 'mousedown', onMouseDown);\n                events.on(root, 'dragend', onDragEnd);\n            }\n            activeTarget = {\n                target: dragDropTarget,\n                dispose: function () {\n                    if (_this._activeTargets[key] === activeTarget) {\n                        delete _this._activeTargets[key];\n                    }\n                    if (root) {\n                        for (var _i = 0, handlers_1 = handlers; _i < handlers_1.length; _i++) {\n                            var handler = handlers_1[_i];\n                            _this._events.off(root, handler.eventName, handler.callback);\n                        }\n                        if (isDroppable) {\n                            events.off(root, 'dragenter', onDragEnter);\n                            events.off(root, 'dragleave', onDragLeave);\n                            events.off(root, 'dragend', onDragEnd);\n                            events.off(root, 'dragover', onDragOver);\n                            events.off(root, 'drop', onDrop);\n                        }\n                        if (isDraggable) {\n                            events.off(root, 'mousedown', onMouseDown);\n                            events.off(root, 'dragend', onDragEnd);\n                        }\n                    }\n                }\n            };\n            this._activeTargets[key] = activeTarget;\n        }\n        return {\n            key: key,\n            dispose: function () {\n                if (activeTarget) {\n                    activeTarget.dispose();\n                }\n            }\n        };\n    };\n    DragDropHelper.prototype.unsubscribe = function (root, key) {\n        var activeTarget = this._activeTargets[key];\n        if (activeTarget) {\n            activeTarget.dispose();\n        }\n    };\n    DragDropHelper.prototype._onDragEnd = function (target, event) {\n        var options = target.options;\n        if (options.onDragEnd) {\n            options.onDragEnd(options.context.data, event);\n        }\n    };\n    /**\n     * clear drag data when mouse up on body\n     */\n    DragDropHelper.prototype._onMouseUp = function (event) {\n        this._isDragging = false;\n        if (this._dragData) {\n            for (var _i = 0, _a = Object.keys(this._activeTargets); _i < _a.length; _i++) {\n                var key = _a[_i];\n                var activeTarget = this._activeTargets[key];\n                if (activeTarget.target.root) {\n                    this._events.off(activeTarget.target.root, 'mousemove');\n                    this._events.off(activeTarget.target.root, 'mouseleave');\n                }\n            }\n            if (this._dragData.dropTarget) {\n                // raise dragleave event to let dropTarget know it need to remove dropping style\n                Utilities_1.EventGroup.raise(this._dragData.dropTarget.root, 'dragleave');\n                Utilities_1.EventGroup.raise(this._dragData.dropTarget.root, 'drop');\n            }\n        }\n        this._dragData = null;\n    };\n    /**\n     * clear drag data when mouse up outside of the document\n     */\n    DragDropHelper.prototype._onDocumentMouseUp = function (event) {\n        if (event.target === document.documentElement) {\n            this._onMouseUp(event);\n        }\n    };\n    /**\n     * when mouse move over a new drop target while dragging some items,\n     * fire dragleave on the old target and fire dragenter to the new target\n     * The target will handle style change on dragenter and dragleave events.\n     */\n    DragDropHelper.prototype._onMouseMove = function (target, event) {\n        var \n        // use buttons property here since ev.button in some edge case is not updating well during the move.\n        // but firefox doesn't support it, so we set the default value when it is not defined.\n        _a = event.buttons, \n        // use buttons property here since ev.button in some edge case is not updating well during the move.\n        // but firefox doesn't support it, so we set the default value when it is not defined.\n        buttons = _a === void 0 ? MOUSEMOVE_PRIMARY_BUTTON : _a;\n        if (this._dragData && buttons !== MOUSEMOVE_PRIMARY_BUTTON) {\n            // cancel mouse down event and return early when the primary button is not pressed\n            this._onMouseUp(event);\n            return;\n        }\n        var root = target.root, options = target.options, key = target.key;\n        if (this._isDragging) {\n            if (this._isDroppable(target)) {\n                // we can have nested drop targets in the DOM, like a folder inside a group. In that case, when we drag into\n                // the inner target (folder), we first set dropTarget to the inner element. But the same event is bubbled to the\n                // outer target too, and we need to prevent the outer one from taking over.\n                // So, check if the last dropTarget is not a child of the current.\n                if (this._dragData.dropTarget &&\n                    this._dragData.dropTarget.key !== key &&\n                    !this._isChild(root, this._dragData.dropTarget.root)) {\n                    Utilities_1.EventGroup.raise(this._dragData.dropTarget.root, 'dragleave');\n                    this._dragData.dropTarget = null;\n                }\n                if (!this._dragData.dropTarget) {\n                    Utilities_1.EventGroup.raise(root, 'dragenter');\n                    this._dragData.dropTarget = target;\n                }\n            }\n        }\n        else if (this._dragData) {\n            if (this._isDraggable(target)) {\n                var xDiff = this._dragData.clientX - event.clientX;\n                var yDiff = this._dragData.clientY - event.clientY;\n                if (xDiff * xDiff + yDiff * yDiff >= DISTANCE_FOR_DRAG_SQUARED) {\n                    if (this._dragData.dragTarget) {\n                        this._isDragging = true;\n                        if (options.onDragStart) {\n                            options.onDragStart(options.context.data, options.context.index, this._selection.getSelection(), event);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * when mouse leave a target while dragging some items, fire dragleave to the target\n     */\n    DragDropHelper.prototype._onMouseLeave = function (target, event) {\n        if (this._isDragging) {\n            if (this._dragData && this._dragData.dropTarget && this._dragData.dropTarget.key === target.key) {\n                Utilities_1.EventGroup.raise(target.root, 'dragleave');\n                this._dragData.dropTarget = null;\n            }\n        }\n    };\n    /**\n     * when mouse down on a draggable item, we start to track dragdata.\n     */\n    DragDropHelper.prototype._onMouseDown = function (target, event) {\n        if (event.button !== MOUSEDOWN_PRIMARY_BUTTON) {\n            // Ignore anything except the primary button.\n            return;\n        }\n        if (this._isDraggable(target)) {\n            this._dragData = {\n                clientX: event.clientX,\n                clientY: event.clientY,\n                eventTarget: event.target,\n                dragTarget: target\n            };\n            for (var _i = 0, _a = Object.keys(this._activeTargets); _i < _a.length; _i++) {\n                var key = _a[_i];\n                var activeTarget = this._activeTargets[key];\n                if (activeTarget.target.root) {\n                    this._events.on(activeTarget.target.root, 'mousemove', this._onMouseMove.bind(this, activeTarget.target));\n                    this._events.on(activeTarget.target.root, 'mouseleave', this._onMouseLeave.bind(this, activeTarget.target));\n                }\n            }\n        }\n        else {\n            this._dragData = null;\n        }\n    };\n    /**\n     * determine whether the child target is a descendant of the parent\n     */\n    DragDropHelper.prototype._isChild = function (parent, child) {\n        var parentElement = ReactDOM.findDOMNode(parent);\n        var childElement = ReactDOM.findDOMNode(child);\n        while (childElement && childElement.parentElement) {\n            if (childElement.parentElement === parentElement) {\n                return true;\n            }\n            childElement = childElement.parentElement;\n        }\n        return false;\n    };\n    DragDropHelper.prototype._isDraggable = function (target) {\n        var options = target.options;\n        return options.canDrag && options.canDrag(options.context.data);\n    };\n    DragDropHelper.prototype._isDroppable = function (target) {\n        // TODO: take the drag item into consideration to prevent dragging an item into the same group\n        var options = target.options;\n        var dragContext = this._dragData && this._dragData.dragTarget ? this._dragData.dragTarget.options.context : null;\n        return options.canDrop && options.canDrop(options.context, dragContext);\n    };\n    return DragDropHelper;\n}());\nexports.DragDropHelper = DragDropHelper;\n\n\n\n/***/ }),\n/* 102 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar interfaces_1 = __webpack_require__(3);\nvar Utilities_1 = __webpack_require__(1);\nvar Selection = (function () {\n    function Selection(options) {\n        if (options === void 0) { options = {}; }\n        var onSelectionChanged = options.onSelectionChanged, getKey = options.getKey, _a = options.canSelectItem, canSelectItem = _a === void 0 ? function (item) { return true; } : _a;\n        this.getKey = getKey || (function (item, index) { return (item ? item.key : String(index)); });\n        this._changeEventSuppressionCount = 0;\n        this._exemptedCount = 0;\n        this._anchoredIndex = 0;\n        this._unselectableCount = 0;\n        this.setItems([], true);\n        this._onSelectionChanged = onSelectionChanged;\n        this.canSelectItem = canSelectItem;\n    }\n    Selection.prototype.setChangeEvents = function (isEnabled, suppressChange) {\n        this._changeEventSuppressionCount += isEnabled ? -1 : 1;\n        if (this._changeEventSuppressionCount === 0 && this._hasChanged) {\n            this._hasChanged = false;\n            if (!suppressChange) {\n                this._change();\n            }\n        }\n    };\n    /**\n     * Selection needs the items, call this method to set them. If the set\n     * of items is the same, this will re-evaluate selection and index maps.\n     * Otherwise, shouldClear should be set to true, so that selection is\n     * cleared.\n     */\n    Selection.prototype.setItems = function (items, shouldClear) {\n        if (shouldClear === void 0) { shouldClear = true; }\n        var newKeyToIndexMap = {};\n        var newUnselectableIndices = {};\n        var hasSelectionChanged = false;\n        this.setChangeEvents(false);\n        // Reset the unselectable count.\n        this._unselectableCount = 0;\n        // Build lookup table for quick selection evaluation.\n        for (var i = 0; i < items.length; i++) {\n            var item = items[i];\n            if (item) {\n                newKeyToIndexMap[this.getKey(item, i)] = i;\n            }\n            newUnselectableIndices[i] = item && !this.canSelectItem(item);\n            if (newUnselectableIndices[i]) {\n                this._unselectableCount++;\n            }\n        }\n        if (shouldClear) {\n            this.setAllSelected(false);\n        }\n        // Check the exemption list for discrepencies.\n        var newExemptedIndicies = {};\n        for (var indexProperty in this._exemptedIndices) {\n            if (this._exemptedIndices.hasOwnProperty(indexProperty)) {\n                var index = Number(indexProperty);\n                var item = this._items[index];\n                var exemptKey = item ? this.getKey(item, Number(index)) : undefined;\n                var newIndex = exemptKey ? newKeyToIndexMap[exemptKey] : index;\n                if (newIndex === undefined) {\n                    // We don't know the index of the item any more so it's either moved or removed.\n                    // In this case we reset the entire selection.\n                    this.setAllSelected(false);\n                    break;\n                }\n                else {\n                    // We know the new index of the item. update the existing exemption table.\n                    newExemptedIndicies[newIndex] = true;\n                    hasSelectionChanged = hasSelectionChanged || (newIndex !== index);\n                }\n            }\n        }\n        this._exemptedIndices = newExemptedIndicies;\n        this._keyToIndexMap = newKeyToIndexMap;\n        this._unselectableIndices = newUnselectableIndices;\n        this._items = items || [];\n        if (hasSelectionChanged) {\n            this._change();\n        }\n        this.setChangeEvents(true);\n    };\n    Selection.prototype.getItems = function () {\n        return this._items;\n    };\n    Selection.prototype.getSelection = function () {\n        if (!this._selectedItems) {\n            this._selectedItems = [];\n            for (var i = 0; i < this._items.length; i++) {\n                if (this.isIndexSelected(i)) {\n                    this._selectedItems.push(this._items[i]);\n                }\n            }\n        }\n        return this._selectedItems;\n    };\n    Selection.prototype.getSelectedCount = function () {\n        return this._isAllSelected ? (this._items.length - this._exemptedCount - this._unselectableCount) : (this._exemptedCount);\n    };\n    Selection.prototype.isRangeSelected = function (fromIndex, count) {\n        var endIndex = fromIndex + count;\n        for (var i = fromIndex; i < endIndex; i++) {\n            if (!this.isIndexSelected(i)) {\n                return false;\n            }\n        }\n        return true;\n    };\n    Selection.prototype.isAllSelected = function () {\n        var selectableCount = this._items.length - this._unselectableCount;\n        return ((this.count > 0) &&\n            (this._isAllSelected && this._exemptedCount === 0) ||\n            (!this._isAllSelected && (this._exemptedCount === selectableCount) && selectableCount > 0));\n    };\n    Selection.prototype.isKeySelected = function (key) {\n        var index = this._keyToIndexMap[key];\n        return this.isIndexSelected(index);\n    };\n    Selection.prototype.isIndexSelected = function (index) {\n        return !!((this.count > 0) &&\n            (this._isAllSelected && !this._exemptedIndices[index] && !this._unselectableIndices[index]) ||\n            (!this._isAllSelected && this._exemptedIndices[index]));\n    };\n    Selection.prototype.setAllSelected = function (isAllSelected) {\n        var selectableCount = this._items ? (this._items.length - this._unselectableCount) : 0;\n        if (selectableCount > 0 && (this._exemptedCount > 0 || isAllSelected !== this._isAllSelected)) {\n            this._exemptedIndices = {};\n            this._exemptedCount = 0;\n            this._isAllSelected = isAllSelected;\n            this._updateCount();\n        }\n    };\n    Selection.prototype.setKeySelected = function (key, isSelected, shouldAnchor) {\n        var index = this._keyToIndexMap[key];\n        if (index >= 0) {\n            this.setIndexSelected(index, isSelected, shouldAnchor);\n        }\n    };\n    Selection.prototype.setIndexSelected = function (index, isSelected, shouldAnchor) {\n        // Clamp the index.\n        index = Math.min(Math.max(0, index), this._items.length - 1);\n        // No-op on out of bounds selections.\n        if (index < 0 || index >= this._items.length) {\n            return;\n        }\n        var isExempt = this._exemptedIndices[index];\n        var hasChanged = false;\n        var canSelect = !this._unselectableIndices[index];\n        if (canSelect) {\n            // Determine if we need to remove the exemption.\n            if (isExempt && ((isSelected && this._isAllSelected) ||\n                (!isSelected && !this._isAllSelected))) {\n                hasChanged = true;\n                delete this._exemptedIndices[index];\n                this._exemptedCount--;\n            }\n            // Determine if we need to add the exemption.\n            if (!isExempt && ((isSelected && !this._isAllSelected) ||\n                (!isSelected && this._isAllSelected))) {\n                hasChanged = true;\n                this._exemptedIndices[index] = true;\n                this._exemptedCount++;\n            }\n            if (shouldAnchor) {\n                this._anchoredIndex = index;\n            }\n        }\n        if (hasChanged) {\n            this._updateCount();\n        }\n    };\n    Selection.prototype.selectToKey = function (key, clearSelection) {\n        this.selectToIndex(this._keyToIndexMap[key], clearSelection);\n    };\n    Selection.prototype.selectToIndex = function (index, clearSelection) {\n        var anchorIndex = this._anchoredIndex || 0;\n        var startIndex = Math.min(index, anchorIndex);\n        var endIndex = Math.max(index, anchorIndex);\n        this.setChangeEvents(false);\n        if (clearSelection) {\n            this.setAllSelected(false);\n        }\n        for (; startIndex <= endIndex; startIndex++) {\n            this.setIndexSelected(startIndex, true, false);\n        }\n        this.setChangeEvents(true);\n    };\n    Selection.prototype.toggleAllSelected = function () {\n        this.setAllSelected(!this.isAllSelected());\n    };\n    Selection.prototype.toggleKeySelected = function (key) {\n        this.setKeySelected(key, !this.isKeySelected(key), true);\n    };\n    Selection.prototype.toggleIndexSelected = function (index) {\n        this.setIndexSelected(index, !this.isIndexSelected(index), true);\n    };\n    Selection.prototype.toggleRangeSelected = function (fromIndex, count) {\n        var isRangeSelected = this.isRangeSelected(fromIndex, count);\n        var endIndex = fromIndex + count;\n        this.setChangeEvents(false);\n        for (var i = fromIndex; i < endIndex; i++) {\n            this.setIndexSelected(i, !isRangeSelected, false);\n        }\n        this.setChangeEvents(true);\n    };\n    Selection.prototype._updateCount = function () {\n        this.count = this.getSelectedCount();\n        this._change();\n    };\n    Selection.prototype._change = function () {\n        if (this._changeEventSuppressionCount === 0) {\n            this._selectedItems = null;\n            Utilities_1.EventGroup.raise(this, interfaces_1.SELECTION_CHANGE);\n            if (this._onSelectionChanged) {\n                this._onSelectionChanged();\n            }\n        }\n        else {\n            this._hasChanged = true;\n        }\n    };\n    return Selection;\n}());\nexports.Selection = Selection;\n\n\n\n/***/ }),\n/* 103 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = __webpack_require__(0);\nvar Utilities_1 = __webpack_require__(1);\nvar SelectionLayout_1 = __webpack_require__(30);\nvar interfaces_1 = __webpack_require__(3);\n// Selection definitions:\n//\n// Anchor index: the point from which a range selection starts.\n// Focus index: the point from which layout movement originates from.\n//\n// These two can differ. Tests:\n//\n// If you start at index 5\n// Shift click to index 10\n//    The focus is 10, the anchor is 5.\n// If you shift click at index 0\n//    The anchor remains at 5, the items between 0 and 5 are selected and everything else is cleared.\n// If you click index 8\n//    The anchor and focus are set to 8.\nvar SELECTION_DISABLED_ATTRIBUTE_NAME = 'data-selection-disabled';\nvar SELECTION_INDEX_ATTRIBUTE_NAME = 'data-selection-index';\nvar SELECTION_TOGGLE_ATTRIBUTE_NAME = 'data-selection-toggle';\nvar SELECTION_INVOKE_ATTRIBUTE_NAME = 'data-selection-invoke';\nvar SELECTALL_TOGGLE_ALL_ATTRIBUTE_NAME = 'data-selection-all-toggle';\nvar SelectionZone = (function (_super) {\n    __extends(SelectionZone, _super);\n    function SelectionZone() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SelectionZone.prototype.componentDidMount = function () {\n        var win = Utilities_1.getWindow(this.refs.root);\n        var scrollElement = Utilities_1.findScrollableParent(this.refs.root);\n        // Track the latest modifier keys globally.\n        this._events.on(win, 'keydown keyup', this._updateModifiers);\n        this._events.on(scrollElement, 'click', this._tryClearOnEmptyClick);\n    };\n    SelectionZone.prototype.render = function () {\n        return (React.createElement(\"div\", __assign({ className: 'ms-SelectionZone', ref: 'root', onKeyDown: this._onKeyDown, onMouseDown: this._onMouseDown, onClick: this._onClick, onDoubleClick: this._onDoubleClick, onContextMenu: this._onContextMenu }, {\n            onMouseDownCapture: this._onMouseDownCapture,\n            onFocusCapture: this._onFocus\n        }), this.props.children));\n    };\n    /**\n     * In some cases, the consuming scenario requires to set focus on a row without having SelectionZone\n     * react to the event. Note that focus events in IE <= 11 will occur asynchronously after .focus() has\n     * been called on an element, so we need a flag to store the idea that we will bypass the \"next\"\n     * focus event that occurs. This method does that.\n     */\n    SelectionZone.prototype.ignoreNextFocus = function () {\n        this._shouldHandleFocus = false;\n    };\n    SelectionZone.prototype._onMouseDownCapture = function (ev) {\n        if (document.activeElement !== ev.target && !Utilities_1.elementContains(document.activeElement, ev.target)) {\n            this.ignoreNextFocus();\n        }\n    };\n    /**\n     * When we focus an item, for single/multi select scenarios, we should try to select it immediately\n     * as long as the focus did not originate from a mouse down/touch event. For those cases, we handle them\n     * specially.\n     */\n    SelectionZone.prototype._onFocus = function (ev) {\n        var target = ev.target;\n        var _a = this.props, selection = _a.selection, selectionMode = _a.selectionMode;\n        var isToggleModifierPressed = this._isCtrlPressed || this._isMetaPressed;\n        if (this._shouldHandleFocus && selectionMode !== interfaces_1.SelectionMode.none) {\n            var isToggle = this._hasAttribute(target, SELECTION_TOGGLE_ATTRIBUTE_NAME);\n            var itemRoot = this._findItemRoot(target);\n            if (!isToggle && itemRoot) {\n                var index = this._getItemIndex(itemRoot);\n                if (isToggleModifierPressed) {\n                    // set anchor only.\n                    selection.setIndexSelected(index, selection.isIndexSelected(index), true);\n                }\n                else {\n                    this._onItemSurfaceClick(ev, index);\n                }\n            }\n        }\n        this._shouldHandleFocus = false;\n    };\n    SelectionZone.prototype._onMouseDown = function (ev) {\n        this._updateModifiers(ev);\n        var target = ev.target;\n        var itemRoot = this._findItemRoot(target);\n        while (target !== this.refs.root) {\n            if (this._hasAttribute(target, SELECTALL_TOGGLE_ALL_ATTRIBUTE_NAME)) {\n                break;\n            }\n            else if (itemRoot) {\n                if (this._hasAttribute(target, SELECTION_TOGGLE_ATTRIBUTE_NAME)) {\n                    break;\n                }\n                else if (this._hasAttribute(target, SELECTION_INVOKE_ATTRIBUTE_NAME)) {\n                    this._onInvokeMouseDown(ev, this._getItemIndex(itemRoot));\n                    break;\n                }\n                else if (target === itemRoot) {\n                    break;\n                }\n            }\n            target = Utilities_1.getParent(target);\n        }\n    };\n    SelectionZone.prototype._onClick = function (ev) {\n        this._updateModifiers(ev);\n        var target = ev.target;\n        var itemRoot = this._findItemRoot(target);\n        // No-op if selection is disabled\n        if (this._isSelectionDisabled(target)) {\n            return;\n        }\n        while (target !== this.refs.root) {\n            if (this._hasAttribute(target, SELECTALL_TOGGLE_ALL_ATTRIBUTE_NAME)) {\n                this._onToggleAllClick(ev);\n                break;\n            }\n            else if (itemRoot) {\n                var index = this._getItemIndex(itemRoot);\n                if (this._hasAttribute(target, SELECTION_TOGGLE_ATTRIBUTE_NAME)) {\n                    if (this._isShiftPressed) {\n                        this._onItemSurfaceClick(ev, index);\n                    }\n                    else {\n                        this._onToggleClick(ev, index);\n                    }\n                    break;\n                }\n                else if (this._hasAttribute(target, SELECTION_INVOKE_ATTRIBUTE_NAME)) {\n                    this._onInvokeClick(ev, index);\n                    break;\n                }\n                else if (target === itemRoot) {\n                    this._onItemSurfaceClick(ev, index);\n                    break;\n                }\n            }\n            target = Utilities_1.getParent(target);\n        }\n    };\n    SelectionZone.prototype._onContextMenu = function (ev) {\n        var target = ev.target;\n        var _a = this.props, onItemContextMenu = _a.onItemContextMenu, selection = _a.selection;\n        if (onItemContextMenu) {\n            var itemRoot = this._findItemRoot(target);\n            if (itemRoot) {\n                var index = this._getItemIndex(itemRoot);\n                onItemContextMenu(selection.getItems()[index], index, ev.nativeEvent);\n                ev.preventDefault();\n            }\n        }\n    };\n    SelectionZone.prototype._isSelectionDisabled = function (target) {\n        while (target !== this.refs.root) {\n            if (this._hasAttribute(target, SELECTION_DISABLED_ATTRIBUTE_NAME)) {\n                return true;\n            }\n            target = Utilities_1.getParent(target);\n        }\n        return false;\n    };\n    /**\n     * In multi selection, if you double click within an item's root (but not within the invoke element or input elements),\n     * we should execute the invoke handler.\n     */\n    SelectionZone.prototype._onDoubleClick = function (ev) {\n        var target = ev.target;\n        if (this._isSelectionDisabled(target)) {\n            return;\n        }\n        var _a = this.props, selectionMode = _a.selectionMode, onItemInvoked = _a.onItemInvoked;\n        var itemRoot = this._findItemRoot(target);\n        if (itemRoot && onItemInvoked && selectionMode !== interfaces_1.SelectionMode.none && !this._isInputElement(target)) {\n            var index = this._getItemIndex(itemRoot);\n            while (target !== this.refs.root) {\n                if (this._hasAttribute(target, SELECTION_TOGGLE_ATTRIBUTE_NAME) ||\n                    this._hasAttribute(target, SELECTION_INVOKE_ATTRIBUTE_NAME)) {\n                    break;\n                }\n                else if (target === itemRoot) {\n                    this._onInvokeClick(ev, index);\n                    break;\n                }\n                target = Utilities_1.getParent(target);\n            }\n            target = Utilities_1.getParent(target);\n        }\n    };\n    SelectionZone.prototype._onKeyDown = function (ev) {\n        this._updateModifiers(ev);\n        var target = ev.target;\n        if (this._isSelectionDisabled(target)) {\n            return;\n        }\n        var _a = this.props, selection = _a.selection, selectionMode = _a.selectionMode;\n        var isSelectAllKey = ev.which === Utilities_1.KeyCodes.a && (this._isCtrlPressed || this._isMetaPressed);\n        var isClearSelectionKey = ev.which === Utilities_1.KeyCodes.escape;\n        // Ignore key downs from input elements.\n        if (this._isInputElement(target)) {\n            return;\n        }\n        // If ctrl-a is pressed, select all (if all are not already selected.)\n        if (isSelectAllKey && selectionMode === interfaces_1.SelectionMode.multiple && !selection.isAllSelected()) {\n            selection.setAllSelected(true);\n            ev.stopPropagation();\n            ev.preventDefault();\n            return;\n        }\n        // If escape is pressed, clear selection (if any are selected.)\n        if (isClearSelectionKey && selection.getSelectedCount() > 0) {\n            selection.setAllSelected(false);\n            ev.stopPropagation();\n            ev.preventDefault();\n            return;\n        }\n        var itemRoot = this._findItemRoot(target);\n        // If a key was pressed within an item, we should treat \"enters\" as invokes and \"space\" as toggle\n        if (itemRoot) {\n            var index = this._getItemIndex(itemRoot);\n            while (target !== this.refs.root) {\n                if (this._hasAttribute(target, SELECTION_TOGGLE_ATTRIBUTE_NAME)) {\n                    // For toggle elements, assuming they are rendered as buttons, they will generate a click event,\n                    // so we can no-op for any keydowns in this case.\n                    break;\n                }\n                else if (target === itemRoot) {\n                    if (ev.which === Utilities_1.KeyCodes.enter) {\n                        this._onInvokeClick(ev, index);\n                        ev.preventDefault();\n                        return;\n                    }\n                    else if (ev.which === Utilities_1.KeyCodes.space) {\n                        this._onToggleClick(ev, index);\n                        ev.preventDefault();\n                        return;\n                    }\n                    break;\n                }\n                target = Utilities_1.getParent(target);\n            }\n            // A key was pressed while an item in this zone was focused.\n            this._shouldHandleFocus = true;\n        }\n    };\n    SelectionZone.prototype._onToggleAllClick = function (ev) {\n        var _a = this.props, selection = _a.selection, selectionMode = _a.selectionMode;\n        if (selectionMode === interfaces_1.SelectionMode.multiple) {\n            selection.toggleAllSelected();\n            ev.stopPropagation();\n            ev.preventDefault();\n        }\n    };\n    SelectionZone.prototype._onToggleClick = function (ev, index) {\n        var _a = this.props, selection = _a.selection, selectionMode = _a.selectionMode;\n        if (selectionMode === interfaces_1.SelectionMode.multiple) {\n            selection.toggleIndexSelected(index);\n        }\n        else if (selectionMode === interfaces_1.SelectionMode.single) {\n            var isSelected = selection.isIndexSelected(index);\n            selection.setChangeEvents(false);\n            selection.setAllSelected(false);\n            selection.setIndexSelected(index, !isSelected, true);\n            selection.setChangeEvents(true);\n        }\n        else {\n            return;\n        }\n        ev.stopPropagation();\n        // NOTE: ev.preventDefault is not called for toggle clicks, because this will kill the browser behavior\n        // for checkboxes if you use a checkbox for the toggle.\n    };\n    SelectionZone.prototype._onInvokeClick = function (ev, index) {\n        var _a = this.props, selection = _a.selection, onItemInvoked = _a.onItemInvoked;\n        if (onItemInvoked) {\n            onItemInvoked(selection.getItems()[index], index, ev.nativeEvent);\n            ev.preventDefault();\n            ev.stopPropagation();\n        }\n    };\n    SelectionZone.prototype._onItemSurfaceClick = function (ev, index) {\n        var _a = this.props, selection = _a.selection, selectionMode = _a.selectionMode;\n        var isToggleModifierPressed = this._isCtrlPressed || this._isMetaPressed;\n        if (selectionMode === interfaces_1.SelectionMode.multiple) {\n            if (this._isShiftPressed) {\n                selection.selectToIndex(index, !isToggleModifierPressed);\n            }\n            else if (isToggleModifierPressed) {\n                selection.toggleIndexSelected(index);\n            }\n            else {\n                this._clearAndSelectIndex(index);\n            }\n        }\n        else if (selectionMode === interfaces_1.SelectionMode.single) {\n            this._clearAndSelectIndex(index);\n        }\n    };\n    SelectionZone.prototype._onInvokeMouseDown = function (ev, index) {\n        var selection = this.props.selection;\n        // Only do work if item is not selected.\n        if (selection.isIndexSelected(index)) {\n            return;\n        }\n        this._clearAndSelectIndex(index);\n    };\n    SelectionZone.prototype._tryClearOnEmptyClick = function (ev) {\n        if (!this.props.selectionPreservedOnEmptyClick &&\n            this._isNonHandledClick(ev.target)) {\n            this.props.selection.setAllSelected(false);\n        }\n    };\n    SelectionZone.prototype._clearAndSelectIndex = function (index) {\n        var selection = this.props.selection;\n        var isAlreadySingleSelected = selection.getSelectedCount() === 1 && selection.isIndexSelected(index);\n        if (!isAlreadySingleSelected) {\n            selection.setChangeEvents(false);\n            selection.setAllSelected(false);\n            selection.setIndexSelected(index, true, true);\n            selection.setChangeEvents(true);\n        }\n    };\n    /**\n     * We need to track the modifier key states so that when focus events occur, which do not contain\n     * modifier states in the Event object, we know how to behave.\n     */\n    SelectionZone.prototype._updateModifiers = function (ev) {\n        this._isShiftPressed = ev.shiftKey;\n        this._isCtrlPressed = ev.ctrlKey;\n        this._isMetaPressed = ev.metaKey;\n    };\n    SelectionZone.prototype._findItemRoot = function (target) {\n        var selection = this.props.selection;\n        while (target !== this.refs.root) {\n            var indexValue = target.getAttribute(SELECTION_INDEX_ATTRIBUTE_NAME);\n            var index = Number(indexValue);\n            if (indexValue !== null && index >= 0 && index < selection.getItems().length) {\n                break;\n            }\n            target = Utilities_1.getParent(target);\n        }\n        if (target === this.refs.root) {\n            return undefined;\n        }\n        return target;\n    };\n    SelectionZone.prototype._getItemIndex = function (itemRoot) {\n        return Number(itemRoot.getAttribute(SELECTION_INDEX_ATTRIBUTE_NAME));\n    };\n    SelectionZone.prototype._hasAttribute = function (element, attributeName) {\n        var isToggle = false;\n        while (!isToggle && element !== this.refs.root) {\n            isToggle = element.getAttribute(attributeName) === 'true';\n            element = Utilities_1.getParent(element);\n        }\n        return isToggle;\n    };\n    SelectionZone.prototype._isInputElement = function (element) {\n        return element.tagName === 'INPUT' || element.tagName === 'TEXTAREA';\n    };\n    SelectionZone.prototype._isNonHandledClick = function (element) {\n        var doc = Utilities_1.getDocument();\n        if (doc && element) {\n            while (element && element !== doc.documentElement) {\n                if (Utilities_1.isElementTabbable(element)) {\n                    return false;\n                }\n                element = Utilities_1.getParent(element);\n            }\n        }\n        return true;\n    };\n    return SelectionZone;\n}(Utilities_1.BaseComponent));\nSelectionZone.defaultProps = {\n    layout: new SelectionLayout_1.SelectionLayout(interfaces_1.SelectionDirection.vertical),\n    isMultiSelectEnabled: true,\n    isSelectedOnFocus: true,\n    selectionMode: interfaces_1.SelectionMode.multiple\n};\n__decorate([\n    Utilities_1.autobind\n], SelectionZone.prototype, \"ignoreNextFocus\", null);\n__decorate([\n    Utilities_1.autobind\n], SelectionZone.prototype, \"_onMouseDownCapture\", null);\n__decorate([\n    Utilities_1.autobind\n], SelectionZone.prototype, \"_onFocus\", null);\n__decorate([\n    Utilities_1.autobind\n], SelectionZone.prototype, \"_onMouseDown\", null);\n__decorate([\n    Utilities_1.autobind\n], SelectionZone.prototype, \"_onClick\", null);\n__decorate([\n    Utilities_1.autobind\n], SelectionZone.prototype, \"_onContextMenu\", null);\n__decorate([\n    Utilities_1.autobind\n], SelectionZone.prototype, \"_onDoubleClick\", null);\n__decorate([\n    Utilities_1.autobind\n], SelectionZone.prototype, \"_onKeyDown\", null);\nexports.SelectionZone = SelectionZone;\n\n\n\n/***/ }),\n/* 104 */\n/***/ (function(module, exports) {\n\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n/***/ }),\n/* 105 */\n/***/ (function(module, exports) {\n\nvar g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// bundle.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 39);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2843a05effcba0c5c0e9","module.exports = React;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"React\"\n// module id = 0\n// module chunks = 0","export * from '@uifabric/utilities/lib/index';\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/Utilities.ts","/**\n * An IThemingInstruction can specify a rawString to be preserved or a theme slot and a default value\n * to use if that slot is not specified by the theme.\n */\n\n// Declaring a global here in case that the execution environment is Node.js (without importing the\n// entire node.js d.ts for now)\ndeclare var global: any; // tslint:disable-line:no-any\n\nexport interface IThemingInstruction {\n  theme?: string;\n  defaultValue?: string;\n  rawString?: string;\n}\n\nexport type ThemableArray = Array<IThemingInstruction>;\n\nexport interface ITheme {\n  [key: string]: string;\n}\n\ninterface IStyleSheet {\n  cssText: string;\n}\n\ninterface IExtendedHtmlStyleElement extends HTMLStyleElement {\n  styleSheet: IStyleSheet;\n}\n\ninterface IThemeState {\n  theme: ITheme;\n  lastStyleElement: IExtendedHtmlStyleElement;\n  registeredStyles: IStyleRecord[];\n  loadStyles: (styles: string) => void;\n}\n\ninterface IStyleRecord {\n  styleElement: Element;\n  themableStyle: ThemableArray;\n}\n\n// IE needs to inject styles using cssText. However, we need to evaluate this lazily, so this\n// value will initialize as undefined, and later will be set once on first loadStyles injection.\nlet _injectStylesWithCssText: boolean;\n\n// Store the theming state in __themeState__ global scope for reuse in the case of duplicate\n// load-themed-styles hosted on the page.\nconst _root: any = (typeof window === 'undefined') ? global : window; // tslint:disable-line:no-any\n\nconst _themeState: IThemeState = _root.__themeState__ = _root.__themeState__ || {\n  theme: undefined,\n  lastStyleElement: undefined,\n  registeredStyles: []\n};\n\n/**\n * Matches theming tokens. For example, \"[theme: themeSlotName, default: #FFF]\" (including the quotes).\n */\n/* tslint:disable: max-line-length */\nconst _themeTokenRegex: RegExp = /[\\'\\\"]\\[theme:\\s*(\\w+)\\s*(?:\\,\\s*default:\\s*([\\\\\"\\']?[\\.\\,\\(\\)\\#\\-\\s\\w]*[\\.\\,\\(\\)\\#\\-\\w][\\\"\\']?))?\\s*\\][\\'\\\"]/g;\n/* tslint:enable: max-line-length */\n\n/** Maximum style text length, for supporting IE style restrictions. */\nconst MAX_STYLE_CONTENT_SIZE: number = 10000;\n\n/**\n * Loads a set of style text. If it is registered too early, we will register it when the window.load\n * event is fired.\n * @param {string | ThemableArray} styles Themable style text to register.\n */\nexport function loadStyles(styles: string | ThemableArray): void {\n  const styleParts: ThemableArray = Array.isArray(styles) ? styles : splitStyles(styles);\n\n  if (_injectStylesWithCssText === undefined) {\n    _injectStylesWithCssText = shouldUseCssText();\n  }\n\n  applyThemableStyles(styleParts);\n}\n\n/**\n * Allows for customizable loadStyles logic. e.g. for server side rendering application\n * @param {(styles: string) => void} a loadStyles callback that gets called when styles are loaded or reloaded\n */\nexport function configureLoadStyles(callback: (styles: string) => void): void {\n  _themeState.loadStyles = callback;\n}\n\n/**\n * Loads a set of style text. If it is registered too early, we will register it when the window.load event\n * is fired.\n * @param {string} styleText Style to register.\n * @param {IStyleRecord} styleRecord Existing style record to re-apply.\n */\nfunction applyThemableStyles(stylesArray: ThemableArray, styleRecord?: IStyleRecord): void {\n  if (_themeState.loadStyles) {\n    const styles: string = resolveThemableArray(stylesArray);\n    _themeState.loadStyles(styles);\n  } else {\n    _injectStylesWithCssText ?\n      registerStylesIE(stylesArray, styleRecord) :\n      registerStyles(stylesArray, styleRecord);\n  }\n}\n\n/**\n * Registers a set theme tokens to find and replace. If styles were already registered, they will be\n * replaced.\n * @param {theme} theme JSON object of theme tokens to values.\n */\nexport function loadTheme(theme: ITheme): void {\n  _themeState.theme = theme;\n\n  // reload styles.\n  reloadStyles();\n}\n\n/**\n * Reloads styles.\n */\nfunction reloadStyles(): void {\n  if (_themeState.theme) {\n    for (const styleRecord of _themeState.registeredStyles) {\n      applyThemableStyles(styleRecord.themableStyle, styleRecord);\n    }\n  }\n}\n\n/**\n * Find theme tokens and replaces them with provided theme values.\n * @param {string} styles Tokenized styles to fix.\n */\nexport function detokenize(styles: string): string {\n  if (styles) {\n    styles = resolveThemableArray(splitStyles(styles));\n  }\n\n  return styles;\n}\n\n/**\n * Resolves ThemingInstruction objects in an array and joins the result into a string.\n * @param {ThemableArray} splitStyleArray ThemableArray to resolve and join.\n */\nfunction resolveThemableArray(splitStyleArray: ThemableArray): string {\n  const { theme }: IThemeState = _themeState;\n  let resolvedCss: string;\n  if (splitStyleArray) {\n    // Resolve the array of theming instructions to an array of strings.\n    // Then join the array to produce the final CSS string.\n    const resolvedArray: string[] = splitStyleArray.map((currentValue: IThemingInstruction) => {\n      const themeSlot: string = currentValue.theme;\n      if (themeSlot) {\n        // A theming annotation. Resolve it.\n        const themedValue: string = theme ? theme[themeSlot] : undefined;\n        const defaultValue: string = currentValue.defaultValue;\n\n        // Warn to console if we hit an unthemed value even when themes are provided.\n        // Allow the themedValue to be undefined to explicitly request the default value.\n        if (theme && !themedValue && console && !(themeSlot in theme)) {\n          /* tslint:disable: max-line-length */\n          console.warn(`Theming value not provided for \"${themeSlot}\". Falling back to \"${defaultValue || 'inherit'}\".`);\n          /* tslint:enable: max-line-length */\n        }\n\n        return themedValue || defaultValue || 'inherit';\n      } else {\n        // A non-themable string. Preserve it.\n        return currentValue.rawString;\n      }\n    });\n\n    resolvedCss = resolvedArray.join('');\n  }\n\n  return resolvedCss;\n}\n\n/**\n * Split tokenized CSS into an array of strings and theme specification objects\n * @param {string} styles Tokenized styles to split.\n */\nexport function splitStyles(styles: string): ThemableArray {\n  const result: ThemableArray = [];\n  if (styles) {\n    let pos: number = 0; // Current position in styles.\n    let tokenMatch: RegExpExecArray;\n    while (tokenMatch = _themeTokenRegex.exec(styles)) {\n      const matchIndex: number = tokenMatch.index;\n      if (matchIndex > pos) {\n        result.push({\n          rawString: styles.substring(pos, matchIndex)\n        });\n      }\n\n      result.push({\n        theme: tokenMatch[1],\n        defaultValue: tokenMatch[2] // May be undefined\n      });\n\n      // index of the first character after the current match\n      pos = _themeTokenRegex.lastIndex;\n    }\n\n    // Push the rest of the string after the last match.\n    result.push({\n      rawString: styles.substring(pos)\n    });\n  }\n\n  return result;\n}\n\n/**\n * Registers a set of style text. If it is registered too early, we will register it when the\n * window.load event is fired.\n * @param {ThemableArray} styleArray Array of IThemingInstruction objects to register.\n * @param {IStyleRecord} styleRecord May specify a style Element to update.\n */\nfunction registerStyles(styleArray: ThemableArray, styleRecord?: IStyleRecord): void {\n  const head: HTMLHeadElement = document.getElementsByTagName('head')[0];\n  const styleElement: HTMLStyleElement = document.createElement('style');\n\n  styleElement.type = 'text/css';\n  styleElement.appendChild(document.createTextNode(resolveThemableArray(styleArray)));\n\n  if (styleRecord) {\n    head.replaceChild(styleElement, styleRecord.styleElement);\n    styleRecord.styleElement = styleElement;\n  } else {\n    head.appendChild(styleElement);\n  }\n\n  if (!styleRecord) {\n    _themeState.registeredStyles.push({\n      styleElement: styleElement,\n      themableStyle: styleArray\n    });\n  }\n}\n\n/**\n * Registers a set of style text, for IE 9 and below, which has a ~30 style element limit so we need\n * to register slightly differently.\n * @param {ThemableArray} styleArray Array of IThemingInstruction objects to register.\n * @param {IStyleRecord} styleRecord May specify a style Element to update.\n */\nfunction registerStylesIE(styleArray: ThemableArray, styleRecord?: IStyleRecord): void {\n  const head: HTMLHeadElement = document.getElementsByTagName('head')[0];\n  let { lastStyleElement, registeredStyles }: IThemeState = _themeState;\n\n  const stylesheet: IStyleSheet = lastStyleElement ? lastStyleElement.styleSheet : undefined;\n  const lastStyleContent: string = stylesheet ? stylesheet.cssText : '';\n  let lastRegisteredStyle: IStyleRecord = registeredStyles[registeredStyles.length - 1];\n  const resolvedStyleText: string = resolveThemableArray(styleArray);\n\n  if (!lastStyleElement || (lastStyleContent.length + resolvedStyleText.length) > MAX_STYLE_CONTENT_SIZE) {\n    lastStyleElement = document.createElement('style') as IExtendedHtmlStyleElement;\n    lastStyleElement.type = 'text/css';\n\n    if (styleRecord) {\n      head.replaceChild(lastStyleElement, styleRecord.styleElement);\n      styleRecord.styleElement = lastStyleElement;\n    } else {\n      head.appendChild(lastStyleElement);\n    }\n\n    if (!styleRecord) {\n      lastRegisteredStyle = {\n        styleElement: lastStyleElement,\n        themableStyle: styleArray\n      };\n      registeredStyles.push(lastRegisteredStyle);\n    }\n  }\n\n  lastStyleElement.styleSheet.cssText += detokenize(resolvedStyleText);\n  Array.prototype.push.apply(lastRegisteredStyle.themableStyle, styleArray); // concat in-place\n\n  // Preserve the theme state.\n  _themeState.lastStyleElement = lastStyleElement;\n}\n\n/**\n * Checks to see if styleSheet exists as a property off of a style element.\n * This will determine if style registration should be done via cssText (<= IE9) or not\n */\nfunction shouldUseCssText(): boolean {\n  let useCSSText: boolean = false;\n\n  if (typeof document !== 'undefined') {\n    const emptyStyle: IExtendedHtmlStyleElement = document.createElement('style') as IExtendedHtmlStyleElement;\n\n    emptyStyle.type = 'text/css';\n    useCSSText = !!emptyStyle.styleSheet;\n  }\n\n  return useCSSText;\n}\n\n\n\n// WEBPACK FOOTER //\n// /src/index.ts","export interface IObjectWithKey {\r\n  key?: string;\r\n}\r\n\r\nexport const SELECTION_CHANGE = 'change';\r\n\r\nexport enum SelectionMode {\r\n  none = 0,\r\n  single = 1,\r\n  multiple = 2\r\n}\r\n\r\nexport interface ISelection {\r\n  count: number;\r\n  canSelectItem?: (item: IObjectWithKey) => boolean;\r\n\r\n  // Obesrvable methods.\r\n  setChangeEvents(isEnabled: boolean, suppressChange?: boolean);\r\n\r\n  // Initialization methods.\r\n\r\n  setItems(items: IObjectWithKey[], shouldClear: boolean);\r\n  getItems(): IObjectWithKey[];\r\n\r\n  // Read selection methods.\r\n\r\n  getSelection(): IObjectWithKey[];\r\n  getSelectedCount(): number;\r\n  isRangeSelected(fromIndex: number, count: number): boolean;\r\n\r\n  isAllSelected(): boolean;\r\n  isKeySelected(key: string): boolean;\r\n  isIndexSelected(index: number): boolean;\r\n\r\n  // Write selection methods.\r\n\r\n  setAllSelected(isAllSelected: boolean);\r\n  setKeySelected(key: string, isSelected: boolean, shouldAnchor: boolean);\r\n  setIndexSelected(index: number, isSelected: boolean, shouldAnchor: boolean);\r\n\r\n  // Write range selection methods.\r\n\r\n  selectToKey(key: string, clearSelection?: boolean);\r\n  selectToIndex(index: number, clearSelection?: boolean);\r\n\r\n  // Toggle helpers.\r\n\r\n  toggleAllSelected();\r\n  toggleKeySelected(key: string);\r\n  toggleIndexSelected(index: number);\r\n  toggleRangeSelected(fromIndex: number, count: number);\r\n}\r\n\r\nexport interface ISelectionLayout {\r\n  getItemIndexAbove(index: number, items: any[]): number;\r\n  getItemIndexBelow(index: number, items: any[]): number;\r\n  getItemIndexLeft(index: number, items: any[]): number;\r\n  getItemIndexRight(index: number, items: any[]): number;\r\n}\r\n\r\nexport enum SelectionDirection {\r\n  horizontal = 0,\r\n  vertical = 1\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/utilities/selection/interfaces.ts","export module Data {\r\n    export interface Message {\r\n        Id: string;\r\n        BodyPreview: string;\r\n        Sender: string;\r\n        ToRecipients: string;\r\n        ParentFolderId: string;\r\n    }\r\n\r\n    export interface Folder {\r\n        Id: string;\r\n        DisplayName: string;\r\n    }\r\n\r\n    export interface Match {\r\n        message: Message;\r\n        folder: Folder;\r\n    }\r\n\r\n    export enum Progress {\r\n        GetCallbackToken,\r\n        GetConversation,\r\n        GetExcludedFolders,\r\n        GetFolderNames,\r\n        Success,\r\n        NotFound,\r\n        Error\r\n    }\r\n\r\n    export interface IModel {\r\n        getItemsAsync(onLoadComplete: (results: Match[]) => void, onProgress: (progress: Progress) => void, onError: (message: string) => void): void;\r\n        moveItemsAsync(folderId: string, onMoveComplete: (count: number) => void, onError: (message: string) => void): void;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Data/Model.ts","import { IRectangle } from './IRectangle';\r\n\r\n/**\r\n * Attached interface for elements which support virtual references.\r\n * Used internally by the virtual hierarchy methods.\r\n *\r\n * @interface IVirtualElement\r\n * @extends {HTMLElement}\r\n */\r\ninterface IVirtualElement extends HTMLElement {\r\n  _virtual: {\r\n    parent?: IVirtualElement;\r\n    children: IVirtualElement[];\r\n  };\r\n}\r\n\r\n/**\r\n * Sets the virtual parent of an element.\r\n * Pass `undefined` as the `parent` to clear the virtual parent.\r\n *\r\n * @export\r\n * @param {HTMLElement} child\r\n * @param {HTMLElement} parent\r\n */\r\nexport function setVirtualParent(child: HTMLElement, parent: HTMLElement) {\r\n  let virtualChild = <IVirtualElement>child;\r\n  let virtualParent = <IVirtualElement>parent;\r\n\r\n  if (!virtualChild._virtual) {\r\n    virtualChild._virtual = {\r\n      children: []\r\n    };\r\n  }\r\n\r\n  let oldParent = virtualChild._virtual.parent;\r\n\r\n  if (oldParent && oldParent !== parent) {\r\n    // Remove the child from its old parent.\r\n    let index = oldParent._virtual.children.indexOf(virtualChild);\r\n\r\n    if (index > -1) {\r\n      oldParent._virtual.children.splice(index, 1);\r\n    }\r\n  }\r\n\r\n  virtualChild._virtual.parent = virtualParent || undefined;\r\n\r\n  if (virtualParent) {\r\n    if (!virtualParent._virtual) {\r\n      virtualParent._virtual = {\r\n        children: []\r\n      };\r\n    }\r\n\r\n    virtualParent._virtual.children.push(virtualChild);\r\n  }\r\n}\r\n\r\nexport function getVirtualParent(child: HTMLElement): HTMLElement {\r\n  let parent: HTMLElement;\r\n\r\n  if (child && isVirtualElement(child)) {\r\n    parent = child._virtual.parent;\r\n  }\r\n\r\n  return parent;\r\n}\r\n\r\n/**\r\n * Gets the element which is the parent of a given element.\r\n * If `allowVirtuaParents` is `true`, this method prefers the virtual parent over\r\n * real DOM parent when present.\r\n *\r\n * @export\r\n * @param {HTMLElement} child\r\n * @param {boolean} [allowVirtualParents=true]\r\n * @returns {HTMLElement}\r\n */\r\nexport function getParent(child: HTMLElement, allowVirtualParents: boolean = true): HTMLElement {\r\n  return child && (\r\n    allowVirtualParents && getVirtualParent(child) ||\r\n    child.parentNode && child.parentNode as HTMLElement\r\n  );\r\n}\r\n\r\n/**\r\n * Determines whether or not a parent element contains a given child element.\r\n * If `allowVirtualParents` is true, this method may return `true` if the child\r\n * has the parent in its virtual element hierarchy.\r\n *\r\n * @export\r\n * @param {HTMLElement} parent\r\n * @param {HTMLElement} child\r\n * @param {boolean} [allowVirtualParents=true]\r\n * @returns {boolean}\r\n */\r\nexport function elementContains(parent: HTMLElement, child: HTMLElement, allowVirtualParents: boolean = true): boolean {\r\n  let isContained: boolean = false;\r\n\r\n  if (parent && child) {\r\n    if (allowVirtualParents) {\r\n      isContained = false;\r\n\r\n      while (child) {\r\n        let nextParent = getParent(child);\r\n\r\n        if (nextParent === parent) {\r\n          isContained = true;\r\n          break;\r\n        }\r\n\r\n        child = nextParent;\r\n      }\r\n    } else if (parent.contains) {\r\n      isContained = parent.contains(child);\r\n    }\r\n  }\r\n\r\n  return isContained;\r\n}\r\n\r\nlet _isSSR = false;\r\n\r\n/** Helper to set ssr mode to simulate no window object returned from getWindow helper. */\r\nexport function setSSR(isEnabled) {\r\n  _isSSR = isEnabled;\r\n}\r\n\r\n/** Helper to get the window object. */\r\nexport function getWindow(rootElement?: HTMLElement) {\r\n  if (_isSSR) {\r\n    return undefined;\r\n  } else {\r\n    return (\r\n      rootElement &&\r\n        rootElement.ownerDocument &&\r\n        rootElement.ownerDocument.defaultView ?\r\n        rootElement.ownerDocument.defaultView :\r\n        window\r\n    );\r\n  }\r\n}\r\n\r\n/** Helper to get the document object. */\r\nexport function getDocument(rootElement?: HTMLElement) {\r\n  if (_isSSR) {\r\n    return undefined;\r\n  } else {\r\n    return rootElement && rootElement.ownerDocument ? rootElement.ownerDocument : document;\r\n  }\r\n}\r\n\r\n/** Helper to get bounding client rect, works with window. */\r\nexport function getRect(element: HTMLElement | Window): IRectangle {\r\n  let rect: IRectangle;\r\n\r\n  if (element) {\r\n    if (element === window) {\r\n      rect = {\r\n        left: 0,\r\n        top: 0,\r\n        width: window.innerWidth,\r\n        height: window.innerHeight,\r\n        right: window.innerWidth,\r\n        bottom: window.innerHeight\r\n      };\r\n    } else if ((element as HTMLElement).getBoundingClientRect) {\r\n      rect = (element as HTMLElement).getBoundingClientRect();\r\n    }\r\n  }\r\n\r\n  return rect;\r\n}\r\n\r\n/**\r\n * Determines whether or not an element has the virtual hierarchy extension.\r\n *\r\n * @param {(HTMLElement | IVirtualElement)} element\r\n * @returns {element is IVirtualElement}\r\n */\r\nfunction isVirtualElement(element: HTMLElement | IVirtualElement): element is IVirtualElement {\r\n  return element && !!(<IVirtualElement>element)._virtual;\r\n}\n\n\n// WEBPACK FOOTER //\n// ../src/dom.ts","export * from './interfaces';\r\nexport * from './Selection';\r\nexport * from './SelectionLayout';\r\nexport * from './SelectionZone';\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/utilities/selection/index.ts","import * as React from 'react';\r\nimport { DetailsList } from './DetailsList';\r\nimport {\r\n  ISelection,\r\n  SelectionMode\r\n} from '../../utilities/selection/index';\r\nimport { IRenderFunction } from '../../Utilities';\r\nimport {\r\n  IDragDropEvents,\r\n  IDragDropContext,\r\n} from './../../utilities/dragdrop/index';\r\nimport { IconName } from '../../Icon';\r\nimport {\r\n  IGroup,\r\n  IGroupRenderProps\r\n} from '../GroupedList/index';\r\nimport { IDetailsRowProps } from '../DetailsList/DetailsRow';\r\nimport { IViewport } from '../../utilities/decorators/withViewport';\r\n\r\nexport interface IDetailsList {\r\n  /**\r\n   * Ensures that the list content is updated. Call this in cases where the list prop updates don't change, but the list\r\n   * still needs to be re-evaluated. For example, if a sizer bar is adjusted and causes the list width to change, you can\r\n   * call this to force a re-evaluation. Be aware that this can be an expensive operation and should be done sparingly.\r\n   */\r\n  forceUpdate: () => void;\r\n}\r\n\r\nexport interface IDetailsListProps extends React.Props<DetailsList> {\r\n  /** A key that uniquely identifies the given items. If provided, the selection will be reset when the key changes. */\r\n  setKey?: string;\r\n\r\n  /** The items to render. */\r\n  items: any[];\r\n\r\n  /**\r\n   * Optional default focused index to set focus to once the items have rendered and the index exists.\r\n   */\r\n  initialFocusedIndex?: number;\r\n\r\n  /** Optional class name to add to the root element. */\r\n  className?: string;\r\n\r\n  /** Optional grouping instructions. The definition for IGroup can be found under the GroupedList component. */\r\n  groups?: IGroup[];\r\n\r\n  /** Optional override properties to render groups. The definition for IGroupRenderProps can be found under the GroupedList component. */\r\n  groupProps?: IGroupRenderProps;\r\n\r\n  /** Optional selection model to track selection state.  */\r\n  selection?: ISelection;\r\n\r\n  /** Controls how/if the details list manages selection. */\r\n  selectionMode?: SelectionMode;\r\n\r\n  /**\r\n   * By default, selection is cleared when clicking on an empty (non-focusable) section of the screen. Setting this value to true\r\n   * overrides that behavior and maintains selection.\r\n   * @default false\r\n   **/\r\n  selectionPreservedOnEmptyClick?: boolean;\r\n\r\n  /** Controls how the columns are adjusted. */\r\n  layoutMode?: DetailsListLayoutMode;\r\n\r\n  /**\r\n   * Controls the visibility of selection check box.\r\n   * @default CheckboxVisibility.onHover\r\n   */\r\n  checkboxVisibility?: CheckboxVisibility;\r\n\r\n  /**\r\n   * Controls the visibility of the details header.\r\n   * @default true\r\n   */\r\n  isHeaderVisible?: boolean;\r\n\r\n  /** Given column defitions. If none are provided, default columns will be created based on the item's properties. */\r\n  columns?: IColumn[];\r\n\r\n  /** Controls how the list contrains overflow. */\r\n  constrainMode?: ConstrainMode;\r\n\r\n  /** Event names and corresponding callbacks that will be registered to rendered row elements. */\r\n  rowElementEventMap?: { eventName: string, callback: (context: IDragDropContext, event?: any) => void }[];\r\n\r\n  /** Callback for when the details list has been updated. Useful for telemetry tracking externally. */\r\n  onDidUpdate?: (detailsList?: DetailsList) => any;\r\n\r\n  /** Callback for when a given row has been mounted. Useful for identifying when a row has been rendered on the page. */\r\n  onRowDidMount?: (item?: any, index?: number) => void;\r\n\r\n  /** Callback for when a given row has been mounted. Useful for identifying when a row has been removed from the page. */\r\n  onRowWillUnmount?: (item?: any, index?: number) => void;\r\n\r\n  /** Callback for when the user clicks on the column header. */\r\n  onColumnHeaderClick?: (ev?: React.MouseEvent<HTMLElement>, column?: IColumn) => void;\r\n\r\n  /** Callback for when the user asks for a contextual menu (usually via right click) from a column header. */\r\n  onColumnHeaderContextMenu?: (column?: IColumn, ev?: Event) => void;\r\n\r\n  /** Callback fired on column resize */\r\n  onColumnResize?: (column?: IColumn, newWidth?: number) => void;\r\n\r\n  /** Callback for when a given row has been invoked (by pressing enter while it is selected.) */\r\n  onItemInvoked?: (item?: any, index?: number, ev?: Event) => void;\r\n\r\n  /** Callback for when the context menu of an item has been accessed. */\r\n  onItemContextMenu?: (item?: any, index?: number, ev?: Event) => void;\r\n\r\n  /**\r\n   *  If provided, will allow the caller to override the default row rendering.\r\n   */\r\n  onRenderRow?: IRenderFunction<IDetailsRowProps>;\r\n\r\n  /**\r\n   * If provided, will be the \"default\" item column renderer method. This affects cells within the rows; not the rows themselves.\r\n   * If a column definition provides its own onRender method, that will be used instead of this.\r\n   */\r\n  onRenderItemColumn?: (item?: any, index?: number, column?: IColumn) => any;\r\n\r\n  /** Map of callback functions related to drag and drop functionality. */\r\n  dragDropEvents?: IDragDropEvents;\r\n\r\n  /** Callback for what to render when the item is missing. */\r\n  onRenderMissingItem?: (index?: number) => React.ReactNode;\r\n\r\n  /** Viewport, provided by the withViewport decorator. */\r\n  viewport?: IViewport;\r\n\r\n  /** Callback for when an item in the list becomes active by clicking anywhere inside the row or navigating to it with keyboard. */\r\n  onActiveItemChanged?: (item?: any, index?: number, ev?: React.FocusEvent<HTMLElement>) => void;\r\n\r\n  /** The aria-label attribute to stamp out on the list header */\r\n  ariaLabelForListHeader?: string;\r\n\r\n  /** The aria-label attribute to stamp out on select all checkbox for the list */\r\n  ariaLabelForSelectAllCheckbox?: string;\r\n\r\n  /** Optional callback to get the aria-label string for a given item. */\r\n  getRowAriaLabel?: (item: any) => string;\r\n\r\n  /** Optional callback to get the item key, to be used in the selection and on render. */\r\n  getKey?: (item: any, index?: number) => string;\r\n\r\n  /** A text summary of the table set via aria-label. */\r\n  ariaLabel?: string;\r\n\r\n  /** Check button aria label for details list. */\r\n  checkButtonAriaLabel?: string;\r\n\r\n  /** Aria label for grid in details list. */\r\n  ariaLabelForGrid?: string;\r\n\r\n  /** Boolean value to indicate if the role application should be applied on details list. Set to false by default */\r\n  shouldApplyApplicationRole?: boolean;\r\n}\r\n\r\nexport interface IColumn {\r\n  /**\r\n   * A unique key for identifying the column.\r\n   */\r\n  key: string;\r\n\r\n  /**\r\n   * Name to render on the column header.\r\n   */\r\n  name: string;\r\n\r\n  /**\r\n   * The field to pull the text value from for the column. This can be null if a custom\r\n   * onRender method is provided.\r\n   */\r\n  fieldName: string;\r\n\r\n  /**\r\n   * An optional class name to stick on the column cell within each row.\r\n   */\r\n  className?: string;\r\n\r\n  /**\r\n   * Minimum width for the column.\r\n   */\r\n  minWidth: number;\r\n\r\n  /**\r\n   * Optional accessibility label (aria-label) attribute that will be stamped on to the element.\r\n   * If none is specified, the arai-label attribute will contain the column name\r\n   */\r\n  ariaLabel?: string;\r\n\r\n  /**\r\n   * Optional flag on whether the column is a header for the given row. There should be only one column with\r\n   * row header set to true.\r\n   * @default false\r\n   */\r\n  isRowHeader?: boolean;\r\n\r\n  /**\r\n   * Maximum width for the column, if stretching is allowed in justified scenarios.\r\n   */\r\n  maxWidth?: number;\r\n\r\n  /**\r\n   * Defines how the column's header should render.\r\n   * @default ColumnActionsMode.clickable */\r\n  columnActionsMode?: ColumnActionsMode;\r\n\r\n  /**\r\n   * Optional iconName to use for the column header.\r\n   */\r\n  iconName?: IconName;\r\n\r\n  /**\r\n   * Class name to add to the Icon component.\r\n   */\r\n  iconClassName?: string;\r\n\r\n  /**\r\n   * If specified will allow the column to be collapsed when rendered in justified layout.\r\n   */\r\n  isCollapsable?: boolean;\r\n\r\n  /**\r\n   * Determines if the column is currently sorted. Renders a sort arrow in the column header.\r\n   */\r\n  isSorted?: boolean;\r\n\r\n  /**\r\n   * Determines if the arrow is pointed down (descending) or up.\r\n   */\r\n  isSortedDescending?: boolean;\r\n\r\n  /**\r\n   * Determines if the column can be resized.\r\n   */\r\n  isResizable?: boolean;\r\n\r\n  /**\r\n   * Determines if the column can render multi-line text.\r\n   */\r\n  isMultiline?: boolean;\r\n\r\n  /**\r\n   * If provided uses this method to render custom cell content, rather than the default text rendering.\r\n   */\r\n  onRender?: (item?: any, index?: number, column?: IColumn) => any;\r\n\r\n  /**\r\n   * Determines if the column is filtered, and if so shows a filter icon.\r\n   */\r\n  isFiltered?: boolean;\r\n\r\n  /**\r\n   * If provided, will be executed when the user clicks on the column header.\r\n   */\r\n  onColumnClick?: (ev?: React.MouseEvent<HTMLElement>, column?: IColumn) => any;\r\n\r\n  /**\r\n   * If provided, will be executed when the user accesses the contextmenu on a column header.\r\n   */\r\n  onColumnContextMenu?: (column?: IColumn, ev?: React.MouseEvent<HTMLElement>) => any;\r\n\r\n  /**\r\n   * If set will show a grouped icon next to the column header name.\r\n   */\r\n  isGrouped?: boolean;\r\n\r\n  /**\r\n   * Arbitrary data passthrough which can be used by the caller.\r\n   */\r\n  data?: any;\r\n\r\n  /**\r\n   * Internal only value.\r\n   */\r\n  calculatedWidth?: number;\r\n\r\n  /**\r\n   * An optional class name to stick on the column cell within each header.\r\n   */\r\n  headerClassName?: string;\r\n}\r\n\r\n/**\r\n * Enum to describe how a particular column header behaves.... This enum is used to\r\n * to specify the property IColumn:columnActionsMode.\r\n * If IColumn:columnActionsMode is undefined, then it's equivalent to ColumnActionsMode.clickable\r\n */\r\nexport enum ColumnActionsMode {\r\n  /**\r\n   * Renders the column header as disabled.\r\n   */\r\n  disabled = 0,\r\n\r\n  /**\r\n   * Renders the column header is clickable.\r\n   */\r\n  clickable = 1,\r\n\r\n  /**\r\n   * Renders the column header ias clickable and displays the dropdown cheveron.\r\n   */\r\n  hasDropdown = 2\r\n}\r\n\r\nexport enum ConstrainMode {\r\n  /** If specified, lets the content grow which allows the page to manage scrolling. */\r\n  unconstrained = 0,\r\n\r\n  /**\r\n   * If specified, constrains the list to the given layout space.\r\n   */\r\n  horizontalConstrained = 1\r\n}\r\n\r\nexport enum DetailsListLayoutMode {\r\n  /**\r\n   * Lets the user resize columns and makes not attempt to fit them.\r\n   */\r\n  fixedColumns = 0,\r\n\r\n  /**\r\n   * Manages which columns are visible, tries to size them according to their min/max rules and drops\r\n   * off columns that can't fit and have isCollapsable set.\r\n   */\r\n  justified = 1\r\n}\r\n\r\nexport enum CheckboxVisibility {\r\n  /**\r\n   * Visible on hover.\r\n   */\r\n  onHover = 0,\r\n\r\n  /**\r\n   * Visible always.\r\n   */\r\n  always = 1,\r\n\r\n  /**\r\n   * Hide checkboxes.\r\n   */\r\n  hidden = 2\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/office-ui-fabric-react/lib/components/DetailsList/DetailsList.Props.ts","export * from './components/FocusZone/index';\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/FocusZone.ts","/* tslint:disable:no-unused-variable */\r\nimport * as React from 'react';\r\n/* tslint:enable:no-unused-variable */\r\nimport {\r\n  css\r\n} from '../../Utilities';\r\nimport styles = require('./GroupSpacer.scss');\r\n\r\nexport interface IGroupSpacerProps {\r\n  count: number;\r\n}\r\n\r\nconst SPACER_WIDTH = 36;\r\n\r\nexport const GroupSpacer = (props: IGroupSpacerProps) =>\r\n  props.count > 0 && (\r\n    <span\r\n      className={ css(\r\n        'ms-GroupSpacer',\r\n        styles.root\r\n      ) }\r\n      style={ { width: props.count * SPACER_WIDTH } }\r\n    />\r\n  );\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/GroupedList/GroupSpacer.tsx","module.exports = ReactDOM;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ReactDOM\"\n// module id = 10\n// module chunks = 0","/* tslint:disable:no-string-literal */\r\n\r\nexport interface IEventRecord {\r\n  target: any;\r\n  eventName: string;\r\n  parent: any;\r\n  callback: (args?: any) => void;\r\n  elementCallback: (...args: any[]) => void;\r\n  objectCallback: (args?: any) => void;\r\n  useCapture: boolean;\r\n}\r\n\r\nexport interface IEventRecordsByName {\r\n  [eventName: string]: IEventRecordList;\r\n}\r\n\r\nexport interface IEventRecordList {\r\n  [id: string]: IEventRecord[] | number;\r\n  count: number;\r\n}\r\n\r\nexport interface IDeclaredEventsByName {\r\n  [eventName: string]: boolean;\r\n}\r\n\r\n/** An instance of EventGroup allows anything with a handle to it to trigger events on it.\r\n *  If the target is an HTMLElement, the event will be attached to the element and can be\r\n *  triggered as usual (like clicking for onclick).\r\n *  The event can be triggered by calling EventGroup.raise() here. If the target is an\r\n *  HTMLElement, the event gets raised and is handled by the browser. Otherwise, it gets\r\n *  handled here in EventGroup, and the handler is called in the context of the parent\r\n *  (which is passed in in the constructor).\r\n */\r\nexport class EventGroup {\r\n  private static _uniqueId = 0;\r\n  private _parent;\r\n  private _eventRecords: IEventRecord[];\r\n  private _id = EventGroup._uniqueId++;\r\n  private _isDisposed: boolean;\r\n\r\n  /** For IE8, bubbleEvent is ignored here and must be dealt with by the handler.\r\n   *  Events raised here by default have bubbling set to false and cancelable set to true.\r\n   *  This applies also to built-in events being raised manually here on HTMLElements,\r\n   *  which may lead to unexpected behavior if it differs from the defaults.\r\n   */\r\n  public static raise(\r\n    target: any,\r\n    eventName: string,\r\n    eventArgs?: any,\r\n    bubbleEvent?: boolean\r\n  ) {\r\n    let retVal;\r\n\r\n    if (EventGroup._isElement(target)) {\r\n      if (document.createEvent) {\r\n        let ev = document.createEvent('HTMLEvents');\r\n\r\n        ev.initEvent(eventName, bubbleEvent, true);\r\n        ev['args'] = eventArgs;\r\n        retVal = target.dispatchEvent(ev);\r\n      } else if (document['createEventObject']) { // IE8\r\n        let evObj = document['createEventObject'](eventArgs);\r\n        // cannot set cancelBubble on evObj, fireEvent will overwrite it\r\n        target.fireEvent('on' + eventName, evObj);\r\n      }\r\n    } else {\r\n      while (target && retVal !== false) {\r\n        let events = <IEventRecordsByName>target.__events__;\r\n        let eventRecords = events ? events[eventName] : null;\r\n\r\n        for (let id in eventRecords) {\r\n          if (eventRecords.hasOwnProperty(id)) {\r\n            let eventRecordList = <IEventRecord[]>eventRecords[id];\r\n\r\n            for (let listIndex = 0; retVal !== false && listIndex < eventRecordList.length; listIndex++) {\r\n              let record = eventRecordList[listIndex];\r\n\r\n              if (record.objectCallback) {\r\n                retVal = record.objectCallback.call(record.parent, eventArgs);\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        // If the target has a parent, bubble the event up.\r\n        target = bubbleEvent ? target.parent : null;\r\n      }\r\n    }\r\n\r\n    return retVal;\r\n  }\r\n\r\n  public static isObserved(target: any, eventName: string): boolean {\r\n    let events = target && <IEventRecordsByName>target.__events__;\r\n\r\n    return !!events && !!events[eventName];\r\n  }\r\n\r\n  /** Check to see if the target has declared support of the given event. */\r\n  public static isDeclared(target: any, eventName: string): boolean {\r\n    let declaredEvents = target && <IDeclaredEventsByName>target.__declaredEvents;\r\n\r\n    return !!declaredEvents && !!declaredEvents[eventName];\r\n  }\r\n\r\n  public static stopPropagation(event: any) {\r\n    if (event.stopPropagation) {\r\n      event.stopPropagation();\r\n    } else { // IE8\r\n      event.cancelBubble = true;\r\n    }\r\n  }\r\n\r\n  private static _isElement(target: HTMLElement) {\r\n    return !!target && (target.addEventListener || target instanceof HTMLElement);\r\n  }\r\n\r\n  /** parent: the context in which events attached to non-HTMLElements are called */\r\n  public constructor(parent: any) {\r\n    this._parent = parent;\r\n    this._eventRecords = [];\r\n  }\r\n\r\n  public dispose() {\r\n    if (!this._isDisposed) {\r\n      this._isDisposed = true;\r\n\r\n      this.off();\r\n      this._parent = null;\r\n    }\r\n  }\r\n\r\n  /** On the target, attach a set of events, where the events object is a name to function mapping. */\r\n  public onAll(target: any, events: { [key: string]: (args?: any) => void; }, useCapture?: boolean) {\r\n    for (let eventName in events) {\r\n      if (events.hasOwnProperty(eventName)) {\r\n        this.on(target, eventName, events[eventName], useCapture);\r\n      }\r\n    }\r\n  }\r\n\r\n  /** On the target, attach an event whose handler will be called in the context of the parent\r\n   * of this instance of EventGroup.\r\n   */\r\n  public on(target: any, eventName: string, callback: (args?: any) => void, useCapture?: boolean) {\r\n    if (eventName.indexOf(',') > -1) {\r\n      let events = eventName.split(/[ ,]+/);\r\n\r\n      for (let i = 0; i < events.length; i++) {\r\n        this.on(target, events[i], callback, useCapture);\r\n      }\r\n    } else {\r\n      let parent = this._parent;\r\n      let eventRecord: IEventRecord = {\r\n        target: target,\r\n        eventName: eventName,\r\n        parent: parent,\r\n        callback: callback,\r\n        objectCallback: null,\r\n        elementCallback: null,\r\n        useCapture: useCapture\r\n      };\r\n\r\n      // Initialize and wire up the record on the target, so that it can call the callback if the event fires.\r\n      let events = <IEventRecordsByName>(target.__events__ = target.__events__ || {});\r\n      events[eventName] = events[eventName] || <IEventRecordList>{\r\n        count: 0\r\n      };\r\n      events[eventName][this._id] = events[eventName][this._id] || [];\r\n      (<IEventRecord[]>events[eventName][this._id]).push(eventRecord);\r\n      events[eventName].count++;\r\n\r\n      if (EventGroup._isElement(target)) {\r\n        let processElementEvent = (...args: any[]) => {\r\n          if (this._isDisposed) {\r\n            return;\r\n          }\r\n\r\n          let result;\r\n          try {\r\n            result = callback.apply(parent, args);\r\n            if (result === false && args[0]) {\r\n              let e = args[0];\r\n\r\n              if (e.preventDefault) {\r\n                e.preventDefault();\r\n              }\r\n\r\n              if (e.stopPropagation) {\r\n                e.stopPropagation();\r\n              }\r\n\r\n              e.cancelBubble = true;\r\n            }\r\n          } catch (e) {\r\n            /* ErrorHelper.log(e); */\r\n          }\r\n\r\n          return result;\r\n        };\r\n\r\n        eventRecord.elementCallback = processElementEvent;\r\n\r\n        if (target.addEventListener) {\r\n          /* tslint:disable:ban-native-functions */\r\n          (<EventTarget>target).addEventListener(eventName, processElementEvent, useCapture);\r\n          /* tslint:enable:ban-native-functions */\r\n        } else if (target.attachEvent) { // IE8\r\n          target.attachEvent('on' + eventName, processElementEvent);\r\n        }\r\n      } else {\r\n        let processObjectEvent = (...args: any[]) => {\r\n          if (this._isDisposed) {\r\n            return;\r\n          }\r\n\r\n          return callback.apply(parent, args);\r\n        };\r\n\r\n        eventRecord.objectCallback = processObjectEvent;\r\n      }\r\n\r\n      // Remember the record locally, so that it can be removed.\r\n      this._eventRecords.push(eventRecord);\r\n    }\r\n  }\r\n\r\n  public off(target?: any, eventName?: string, callback?: (args?: any) => void, useCapture?: boolean) {\r\n    for (let i = 0; i < this._eventRecords.length; i++) {\r\n      let eventRecord = this._eventRecords[i];\r\n      if ((!target || target === eventRecord.target) &&\r\n        (!eventName || eventName === eventRecord.eventName) &&\r\n        (!callback || callback === eventRecord.callback) &&\r\n        ((typeof useCapture !== 'boolean') || useCapture === eventRecord.useCapture)) {\r\n        let events = <IEventRecordsByName>eventRecord.target.__events__;\r\n        let targetArrayLookup = events[eventRecord.eventName];\r\n        let targetArray = targetArrayLookup ? <IEventRecord[]>targetArrayLookup[this._id] : null;\r\n\r\n        // We may have already target's entries, so check for null.\r\n        if (targetArray) {\r\n          if (targetArray.length === 1 || !callback) {\r\n            targetArrayLookup.count -= targetArray.length;\r\n            delete events[eventRecord.eventName][this._id];\r\n          } else {\r\n            targetArrayLookup.count--;\r\n            targetArray.splice(targetArray.indexOf(eventRecord), 1);\r\n          }\r\n\r\n          if (!targetArrayLookup.count) {\r\n            delete events[eventRecord.eventName];\r\n          }\r\n        }\r\n\r\n        if (eventRecord.elementCallback) {\r\n          if (eventRecord.target.removeEventListener) {\r\n            eventRecord.target.removeEventListener(eventRecord.eventName, eventRecord.elementCallback, eventRecord.useCapture);\r\n          } else if (eventRecord.target.detachEvent) { // IE8\r\n            eventRecord.target.detachEvent('on' + eventRecord.eventName, eventRecord.elementCallback);\r\n          }\r\n        }\r\n\r\n        this._eventRecords.splice(i--, 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  /** Trigger the given event in the context of this instance of EventGroup. */\r\n  public raise(eventName: string, eventArgs?: any, bubbleEvent?: boolean): any {\r\n    return EventGroup.raise(this._parent, eventName, eventArgs, bubbleEvent);\r\n  }\r\n\r\n  /** Declare an event as being supported by this instance of EventGroup. */\r\n  public declare(event: any) {\r\n    let declaredEvents = this._parent.__declaredEvents = this._parent.__declaredEvents || {};\r\n\r\n    if (typeof event === 'string') {\r\n      declaredEvents[event] = true;\r\n    } else {\r\n      for (let i = 0; i < event.length; i++) {\r\n        declaredEvents[event[i]] = true;\r\n      }\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/EventGroup.ts","export * from './components/Check/index';\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/Check.ts","export * from './components/List/index';\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/List.ts","/* tslint:disable */\r\nimport { loadStyles } from '@microsoft/load-themed-styles';\r\n\r\nconst styles = {\r\n  root: 'root_05ed2f61',\r\n  rootIsSelected: 'rootIsSelected_05ed2f61',\r\n  rootIsContentUnselectable: 'rootIsContentUnselectable_05ed2f61',\r\n  cell: 'cell_05ed2f61',\r\n  isMultiline: 'isMultiline_05ed2f61',\r\n  fields: 'fields_05ed2f61',\r\n  check: 'check_05ed2f61',\r\n  rootIsCheckVisible: 'rootIsCheckVisible_05ed2f61',\r\n  cellMeasurer: 'cellMeasurer_05ed2f61',\r\n  checkSpacer: 'checkSpacer_05ed2f61',\r\n};\r\n\r\nexport = styles;\r\n\r\nloadStyles([{\"rawString\":\".root_05ed2f61{display:inline-block;min-width:100%;min-height:36px;margin:1px 0;vertical-align:top;white-space:nowrap;padding:0;box-sizing:border-box;background:0 0;border:none;vertical-align:top;line-height:16px}.root_05ed2f61::-moz-focus-inner{border:0}.root_05ed2f61{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .root_05ed2f61:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid \"},{\"theme\":\"neutralSecondary\",\"defaultValue\":\"#666666\"},{\"rawString\":\"}html[dir=ltr] .root_05ed2f61{text-align:left}html[dir=rtl] .root_05ed2f61{text-align:right}.root_05ed2f61:hover{background:\"},{\"theme\":\"neutralLighter\",\"defaultValue\":\"#f4f4f4\"},{\"rawString\":\"}.rootIsSelected_05ed2f61{background:\"},{\"theme\":\"neutralQuaternary\",\"defaultValue\":\"#d0d0d0\"},{\"rawString\":\"}.rootIsSelected_05ed2f61:hover{background:\"},{\"theme\":\"neutralQuaternaryAlt\",\"defaultValue\":\"#dadada\"},{\"rawString\":\"}.rootIsContentUnselectable_05ed2f61{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.cell_05ed2f61{display:inline-block;position:relative;box-sizing:border-box;padding:10px 0;margin:0 8px;min-height:36px;vertical-align:top;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.isMultiline_05ed2f61{white-space:normal;word-break:break-word;text-overflow:clip}.fields_05ed2f61{display:inline-block}.check_05ed2f61{display:inline-block;cursor:default;padding:6px;box-sizing:border-box;vertical-align:top;background:0 0;border:none;opacity:0}.check_05ed2f61::-moz-focus-inner{border:0}.check_05ed2f61{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .check_05ed2f61:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid \"},{\"theme\":\"neutralSecondary\",\"defaultValue\":\"#666666\"},{\"rawString\":\"}.rootIsCheckVisible_05ed2f61 .check_05ed2f61,.rootIsSelected_05ed2f61 .check_05ed2f61,.root_05ed2f61:hover .check_05ed2f61{opacity:1}.cellMeasurer_05ed2f61 .cell_05ed2f61{overflow:visible;white-space:nowrap}.checkSpacer_05ed2f61{display:inline-block;height:20px;width:20px}\"}]);\r\n/* tslint:enable */\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/DetailsList/DetailsRow.scss.ts","/// <reference path=\"../node_modules/@types/office-js/index.d.ts\" />\r\n\r\nimport { Data } from \"./Data/Model\";\r\n\r\nexport module Pages {\r\n    const functionsRegex = /\\/functions\\.html(\\?.*)?$/i;\r\n    const dialogRegex = /\\/dialog\\.html(\\?.*)?$/i;\r\n    const storageKey = \"conversationFilerMatches\";\r\n\r\n    export function shouldHaveUI(): boolean {\r\n        return !functionsRegex.test(window.location.pathname);\r\n    }\r\n\r\n    export function getDialogUrl(): string {\r\n        return window.location.href.replace(functionsRegex, \"/dialog.html\");\r\n    }\r\n\r\n    export function populateDialog(storedResults: Data.Match[]) {\r\n        window.localStorage.setItem(storageKey, JSON.stringify(storedResults));\r\n    }\r\n\r\n    export function resetDialog() {\r\n        window.localStorage.removeItem(storageKey);\r\n    }\r\n\r\n    export interface UIParameters {\r\n        mailbox?: Office.Mailbox,\r\n        onComplete?: (folderId: string) => void;\r\n        storedResults?: Data.Match[];\r\n    }\r\n\r\n    export function getUIParameters(): UIParameters {\r\n        if (dialogRegex.test(window.location.pathname)) {\r\n            return {\r\n                onComplete: folderId => { Office.context.ui.messageParent(folderId); },\r\n                storedResults: <Data.Match[]>JSON.parse(window.localStorage.getItem(storageKey))\r\n            };\r\n        }\r\n        else {\r\n            return {\r\n                mailbox: Office.context.mailbox,\r\n            };\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages.ts","import * as React from 'react';\r\nimport { FocusZone } from './FocusZone';\r\n\r\n/**\r\n * FocusZone component class interface.\r\n */\r\nexport interface IFocusZone {\r\n  /**\r\n   * Sets focus to the first tabbable item in the zone.\r\n   * @returns True if focus could be set to an active element, false if no operation was taken.\r\n   */\r\n  focus(): boolean;\r\n\r\n  /**\r\n   * Sets focus to a specific child element within the zone. This can be used in conjunction with\r\n   * onBeforeFocus to created delayed focus scenarios (like animate the scroll position to the correct\r\n   * location and then focus.)\r\n   * @param {HTMLElement} element The child element within the zone to focus.\r\n   * @returns True if focus could be set to an active element, false if no operation was taken.\r\n   */\r\n  focusElement(childElement?: HTMLElement): boolean;\r\n}\r\n\r\n/**\r\n * FocusZone component props.\r\n */\r\nexport interface IFocusZoneProps extends React.HTMLProps<HTMLElement | FocusZone> {\r\n  /**\r\n   * Additional class name to provide on the root element, in addition to the ms-FocusZone class.\r\n   */\r\n  className?: string;\r\n\r\n  /**\r\n   * Defines which arrows to react to.\r\n   * @default FocusZoneDirection.bidriectional\r\n   */\r\n  direction?: FocusZoneDirection;\r\n\r\n  /**\r\n   * Optionally provide a selector for identifying the intial active element.\r\n   */\r\n  defaultActiveElement?: string;\r\n\r\n  /**\r\n   * If set, the FocusZone will not be tabbable and keyboard navigation will be disabled.\r\n   * This does not affect disabled attribute of any child.\r\n   */\r\n  disabled?: boolean;\r\n\r\n  /**\r\n   * If set, will cycle to the beginning of the targets once the user navigates to the\r\n   * next target while at the end, and to the end when navigate to the previous at the beginning.\r\n   */\r\n  isCircularNavigation?: boolean;\r\n\r\n  /**\r\n   * If provided, this callback will be executed on keypresses to determine if the user\r\n   * intends to navigate into the inner zone. Returning true will ask the first inner zone to\r\n   * set focus.\r\n   */\r\n  isInnerZoneKeystroke?: (ev: React.KeyboardEvent<HTMLElement>) => boolean;\r\n\r\n  /**\r\n   * Sets the aria-labelledby attribute.\r\n   */\r\n  ariaLabelledBy?: string;\r\n\r\n  /**\r\n   * Callback for when one of immediate children elements gets active by getting focused\r\n   * or by having one of its respective children elements focused.\r\n   */\r\n  onActiveElementChanged?: (element?: HTMLElement, ev?: React.FocusEvent<HTMLElement>) => void;\r\n\r\n  /**\r\n   * Root props to mix into the root element.\r\n   * @deprecated\r\n   * Deprecated at v1.12.1, to be removed at >= v2.0.0. Use specific button component instead\r\n   */\r\n  rootProps?: React.HTMLProps<HTMLDivElement>;\r\n\r\n  /**\r\n   * Callback method for determining if focus should indeed be set on the given element.\r\n   * @param {HTMLElement} element The child element within the zone to focus.\r\n   * @returns True if focus should be set to the given element, false to avoid setting focus.\r\n   */\r\n  onBeforeFocus?: (childElement?: HTMLElement) => boolean;\r\n}\r\n\r\nexport enum FocusZoneDirection {\r\n  /** Only react to up/down arrows. */\r\n  vertical = 0,\r\n\r\n  /** Only react to left/right arrows. */\r\n  horizontal = 1,\r\n\r\n  /** React to all arrows. */\r\n  bidirectional = 2\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/office-ui-fabric-react/lib/components/FocusZone/FocusZone.Props.ts","import * as React from 'react';\r\nimport { Spinner } from './Spinner';\r\n\r\nexport interface ISpinnerProps extends React.Props<Spinner> {\r\n\r\n  /**\r\n   * @deprecated\r\n   * Deprecated and will be removed at >= 2.0.0. Use SpinnerSize instead.\r\n   */\r\n  type?: SpinnerType;\r\n\r\n  /**\r\n  * The size of Spinner to render. { extraSmall, small, medium, large }\r\n  * @default SpinnerType.medium\r\n  */\r\n  size?: SpinnerSize;\r\n\r\n  /**\r\n  * The label to show next to the Spinner.\r\n  */\r\n  label?: string;\r\n\r\n  /**\r\n   * Additional CSS class(es) to apply to the Spinner.\r\n   */\r\n  className?: string;\r\n}\r\n\r\nexport enum SpinnerSize {\r\n  /**\r\n   * 12px Spinner diameter\r\n   */\r\n  xSmall = 0,\r\n\r\n  /**\r\n   * 16px Spinner diameter\r\n   */\r\n  small = 1,\r\n\r\n  /**\r\n   * 20px Spinner diameter\r\n   */\r\n  medium = 2,\r\n\r\n  /**\r\n   * 28px Spinner diameter\r\n   */\r\n  large = 3\r\n}\r\n\r\n/**\r\n * @deprecated\r\n * Deprecated and will be removed at >= 2.0.0. Use SpinnerSize instead.\r\n */\r\nexport enum SpinnerType {\r\n  /**\r\n   * Deprecated and will be removed at >= 2.0.0. Use SpinnerSize.medium instead.\r\n   */\r\n  normal = 0,\r\n\r\n  /**\r\n   * Deprecated and will be removed at >= 2.0.0. Use SpinnerSize.large instead.\r\n   */\r\n  large = 1\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/office-ui-fabric-react/lib/components/Spinner/Spinner.Props.ts","/// <reference path=\"../../node_modules/@types/office-js/index.d.ts\" />\r\n\r\nimport { Data } from \"./Model\";\r\nimport { RESTData } from \"./RESTData\";\r\nimport { EWSData } from \"./EWSData\";\r\n\r\nexport module Factory {\r\n    // Use the RESTData provider if possible, but if it's not supported, fallback to the EWSData provider\r\n    export function getData(mailbox: Office.Mailbox): Data.IModel {\r\n        return mailbox.restUrl\r\n            ? new RESTData.Model(mailbox)\r\n            : new EWSData.Model(mailbox);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Data/Factory.ts","/**\r\n * Bugs often appear in async code when stuff gets disposed, but async operations don't get canceled.\r\n * This Async helper class solves these issues by tying async code to the lifetime of a disposable object.\r\n *\r\n * Usage: Anything class extending from BaseModel can access this helper via this.async. Otherwise create a\r\n * new instance of the class and remember to call dispose() during your code's dispose handler.\r\n */\r\n\r\ndeclare function setTimeout(cb: Function, delay: number): number;\r\ndeclare function setInterval(cb: Function, delay: number): number;\r\n\r\nexport class Async {\r\n  private _timeoutIds = null;\r\n  private _immediateIds = null;\r\n  private _intervalIds = null;\r\n  private _animationFrameIds: { [id: number]: boolean } = null;\r\n  private _isDisposed = false;\r\n  private _parent: any;\r\n  private _onErrorHandler: (e: any) => void;\r\n  private _noop: any;\r\n\r\n  constructor(parent?: any, onError?: (e: any) => void) {\r\n    this._parent = parent || null;\r\n    this._onErrorHandler = onError;\r\n    this._noop = () => { /* do nothing */ };\r\n  }\r\n\r\n  /**\r\n   * Dispose function, clears all async operations.\r\n   */\r\n  public dispose() {\r\n    let id;\r\n\r\n    this._isDisposed = true;\r\n    this._parent = null;\r\n\r\n    // Clear timeouts.\r\n    if (this._timeoutIds) {\r\n      for (id in this._timeoutIds) {\r\n        if (this._timeoutIds.hasOwnProperty(id)) {\r\n          this.clearTimeout(id);\r\n        }\r\n      }\r\n\r\n      this._timeoutIds = null;\r\n    }\r\n\r\n    // Clear immediates.\r\n    if (this._immediateIds) {\r\n      for (id in this._immediateIds) {\r\n        if (this._immediateIds.hasOwnProperty(id)) {\r\n          this.clearImmediate(id);\r\n        }\r\n      }\r\n\r\n      this._immediateIds = null;\r\n    }\r\n\r\n    // Clear intervals.\r\n    if (this._intervalIds) {\r\n      for (id in this._intervalIds) {\r\n        if (this._intervalIds.hasOwnProperty(id)) {\r\n          this.clearInterval(id);\r\n        }\r\n      }\r\n      this._intervalIds = null;\r\n    }\r\n\r\n    // Clear animation frames.\r\n    if (this._animationFrameIds) {\r\n      for (id in this._animationFrameIds) {\r\n        if (this._animationFrameIds.hasOwnProperty(id)) {\r\n          this.cancelAnimationFrame(id);\r\n        }\r\n      }\r\n\r\n      this._animationFrameIds = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * SetTimeout override, which will auto cancel the timeout during dispose.\r\n   * @param callback Callback to execute.\r\n   * @param duration Duration in milliseconds.\r\n   * @return The setTimeout id.\r\n   */\r\n  public setTimeout(callback: () => void, duration: number): number {\r\n\r\n    let timeoutId = 0;\r\n\r\n    if (!this._isDisposed) {\r\n      if (!this._timeoutIds) {\r\n        this._timeoutIds = {};\r\n      }\r\n\r\n      /* tslint:disable:ban-native-functions */\r\n      timeoutId = setTimeout(\r\n        () => {\r\n          // Time to execute the timeout, enqueue it as a foreground task to be executed.\r\n\r\n          try {\r\n            // Now delete the record and call the callback.\r\n            delete this._timeoutIds[timeoutId];\r\n            callback.apply(this._parent);\r\n          } catch (e) {\r\n            if (this._onErrorHandler) {\r\n              this._onErrorHandler(e);\r\n            }\r\n          }\r\n        },\r\n        duration);\r\n      /* tslint:enable:ban-native-functions */\r\n\r\n      this._timeoutIds[timeoutId] = true;\r\n    }\r\n\r\n    return timeoutId;\r\n  }\r\n\r\n  /**\r\n   * Clears the timeout.\r\n   * @param id Id to cancel.\r\n   */\r\n  public clearTimeout(id: number) {\r\n\r\n    if (this._timeoutIds && this._timeoutIds[id]) {\r\n      /* tslint:disable:ban-native-functions */\r\n      clearTimeout(id);\r\n      delete this._timeoutIds[id];\r\n      /* tslint:enable:ban-native-functions */\r\n    }\r\n  }\r\n\r\n  /**\r\n   * SetImmediate override, which will auto cancel the immediate during dispose.\r\n   * @param callback Callback to execute.\r\n   * @return The setTimeout id.\r\n   */\r\n  public setImmediate(callback: () => void): number {\r\n\r\n    let immediateId = 0;\r\n\r\n    if (!this._isDisposed) {\r\n      if (!this._immediateIds) {\r\n        this._immediateIds = {};\r\n      }\r\n\r\n      /* tslint:disable:ban-native-functions */\r\n      let setImmediateCallback = () => {\r\n        // Time to execute the timeout, enqueue it as a foreground task to be executed.\r\n\r\n        try {\r\n          // Now delete the record and call the callback.\r\n          delete this._immediateIds[immediateId];\r\n          callback.apply(this._parent);\r\n        } catch (e) {\r\n          this._logError(e);\r\n        }\r\n      };\r\n\r\n      immediateId = window.setImmediate ? window.setImmediate(setImmediateCallback) : window.setTimeout(setImmediateCallback, 0);\r\n      /* tslint:enable:ban-native-functions */\r\n\r\n      this._immediateIds[immediateId] = true;\r\n    }\r\n\r\n    return immediateId;\r\n  }\r\n\r\n  /**\r\n   * Clears the immediate.\r\n   * @param id Id to cancel.\r\n   */\r\n  public clearImmediate(id: number) {\r\n\r\n    if (this._immediateIds && this._immediateIds[id]) {\r\n      /* tslint:disable:ban-native-functions */\r\n      window.clearImmediate ? window.clearImmediate(id) : window.clearTimeout(id);\r\n      delete this._immediateIds[id];\r\n      /* tslint:enable:ban-native-functions */\r\n    }\r\n  }\r\n\r\n  /**\r\n   * SetInterval override, which will auto cancel the timeout during dispose.\r\n   * @param callback Callback to execute.\r\n   * @param duration Duration in milliseconds.\r\n   * @return The setTimeout id.\r\n   */\r\n  public setInterval(callback: () => void, duration: number): number {\r\n    let intervalId = 0;\r\n\r\n    if (!this._isDisposed) {\r\n      if (!this._intervalIds) {\r\n        this._intervalIds = {};\r\n      }\r\n\r\n      /* tslint:disable:ban-native-functions */\r\n      intervalId = setInterval(\r\n        () => {\r\n          // Time to execute the interval callback, enqueue it as a foreground task to be executed.\r\n          try {\r\n            callback.apply(this._parent);\r\n          } catch (e) {\r\n            this._logError(e);\r\n          }\r\n        },\r\n        duration);\r\n      /* tslint:enable:ban-native-functions */\r\n\r\n      this._intervalIds[intervalId] = true;\r\n    }\r\n\r\n    return intervalId;\r\n  }\r\n\r\n  /**\r\n   * Clears the interval.\r\n   * @param id Id to cancel.\r\n   */\r\n  public clearInterval(id: number) {\r\n    if (this._intervalIds && this._intervalIds[id]) {\r\n      /* tslint:disable:ban-native-functions */\r\n      clearInterval(id);\r\n      delete this._intervalIds[id];\r\n      /* tslint:enable:ban-native-functions */\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Creates a function that, when executed, will only call the func function at most once per\r\n   * every wait milliseconds. Provide an options object to indicate that func should be invoked\r\n   * on the leading and/or trailing edge of the wait timeout. Subsequent calls to the throttled\r\n   * function will return the result of the last func call.\r\n   *\r\n   * Note: If leading and trailing options are true func will be called on the trailing edge of\r\n   * the timeout only if the the throttled function is invoked more than once during the wait timeout.\r\n   *\r\n   * @param func The function to throttle.\r\n   * @param wait The number of milliseconds to throttle executions to. Defaults to 0.\r\n   * @param options The options object.\r\n   * @param options.leading Specify execution on the leading edge of the timeout.\r\n   * @param options.trailing Specify execution on the trailing edge of the timeout.\r\n   * @return The new throttled function.\r\n   */\r\n  public throttle<T extends Function>(func: T, wait?: number, options?: {\r\n    leading?: boolean;\r\n    trailing?: boolean;\r\n  }): T {\r\n\r\n    if (this._isDisposed) {\r\n      return this._noop;\r\n    }\r\n\r\n    let waitMS = wait || 0;\r\n    let leading = true;\r\n    let trailing = true;\r\n    let lastExecuteTime = 0;\r\n    let lastResult;\r\n    let lastArgs: any[];\r\n    let timeoutId: number = null;\r\n\r\n    if (options && typeof (options.leading) === 'boolean') {\r\n      leading = options.leading;\r\n    }\r\n\r\n    if (options && typeof (options.trailing) === 'boolean') {\r\n      trailing = options.trailing;\r\n    }\r\n\r\n    let callback = (userCall?: boolean) => {\r\n      let now = (new Date).getTime();\r\n      let delta = now - lastExecuteTime;\r\n      let waitLength = leading ? waitMS - delta : waitMS;\r\n      if (delta >= waitMS && (!userCall || leading)) {\r\n        lastExecuteTime = now;\r\n        if (timeoutId) {\r\n          this.clearTimeout(timeoutId);\r\n          timeoutId = null;\r\n        }\r\n        lastResult = func.apply(this._parent, lastArgs);\r\n      } else if (timeoutId === null && trailing) {\r\n        timeoutId = this.setTimeout(callback, waitLength);\r\n      }\r\n\r\n      return lastResult;\r\n    };\r\n\r\n    let resultFunction: any = (...args: any[]) => {\r\n      lastArgs = args;\r\n      return callback(true);\r\n    };\r\n\r\n    return resultFunction;\r\n  }\r\n\r\n  /**\r\n   * Creates a function that will delay the execution of func until after wait milliseconds have\r\n   * elapsed since the last time it was invoked. Provide an options object to indicate that func\r\n   * should be invoked on the leading and/or trailing edge of the wait timeout. Subsequent calls\r\n   * to the debounced function will return the result of the last func call.\r\n   *\r\n   * Note: If leading and trailing options are true func will be called on the trailing edge of\r\n   * the timeout only if the the debounced function is invoked more than once during the wait\r\n   * timeout.\r\n   *\r\n   * @param func The function to debounce.\r\n   * @param wait The number of milliseconds to delay.\r\n   * @param options The options object.\r\n   * @param options.leading Specify execution on the leading edge of the timeout.\r\n   * @param options.maxWait The maximum time func is allowed to be delayed before it's called.\r\n   * @param options.trailing Specify execution on the trailing edge of the timeout.\r\n   * @return The new debounced function.\r\n   */\r\n  public debounce<T extends Function>(func: T, wait?: number, options?: {\r\n    leading?: boolean;\r\n    maxWait?: number;\r\n    trailing?: boolean;\r\n  }): T {\r\n\r\n    if (this._isDisposed) {\r\n      return this._noop;\r\n    }\r\n\r\n    let waitMS = wait || 0;\r\n    let leading = false;\r\n    let trailing = true;\r\n    let maxWait = null;\r\n    let lastCallTime = 0;\r\n    let lastExecuteTime = (new Date).getTime();\r\n    let lastResult;\r\n    let lastArgs: any[];\r\n    let timeoutId: number = null;\r\n\r\n    if (options && typeof (options.leading) === 'boolean') {\r\n      leading = options.leading;\r\n    }\r\n\r\n    if (options && typeof (options.trailing) === 'boolean') {\r\n      trailing = options.trailing;\r\n    }\r\n\r\n    if (options && typeof (options.maxWait) === 'number' && !isNaN(options.maxWait)) {\r\n      maxWait = options.maxWait;\r\n    }\r\n\r\n    let callback = (userCall?: boolean) => {\r\n      let now = (new Date).getTime();\r\n      let executeImmediately = false;\r\n      if (userCall) {\r\n        if (leading && now - lastCallTime >= waitMS) {\r\n          executeImmediately = true;\r\n        }\r\n        lastCallTime = now;\r\n      }\r\n      let delta = now - lastCallTime;\r\n      let waitLength = waitMS - delta;\r\n      let maxWaitDelta = now - lastExecuteTime;\r\n      let maxWaitExpired = false;\r\n\r\n      if (maxWait !== null) {\r\n        // maxWait only matters when there is a pending callback\r\n        if (maxWaitDelta >= maxWait && timeoutId) {\r\n          maxWaitExpired = true;\r\n        } else {\r\n          waitLength = Math.min(waitLength, maxWait - maxWaitDelta);\r\n        }\r\n      }\r\n\r\n      if (delta >= waitMS || maxWaitExpired || executeImmediately) {\r\n        if (timeoutId) {\r\n          this.clearTimeout(timeoutId);\r\n          timeoutId = null;\r\n        }\r\n        lastExecuteTime = now;\r\n        lastResult = func.apply(this._parent, lastArgs);\r\n      } else if ((timeoutId === null || !userCall) && trailing) {\r\n        timeoutId = this.setTimeout(callback, waitLength);\r\n      }\r\n\r\n      return lastResult;\r\n    };\r\n\r\n    let resultFunction: any = (...args: any[]) => {\r\n      lastArgs = args;\r\n      return callback(true);\r\n    };\r\n\r\n    return resultFunction;\r\n  }\r\n\r\n  public requestAnimationFrame(callback: () => void): number {\r\n    let animationFrameId = 0;\r\n\r\n    if (!this._isDisposed) {\r\n      if (!this._animationFrameIds) {\r\n        this._animationFrameIds = {};\r\n      }\r\n\r\n      /* tslint:disable:ban-native-functions */\r\n      let animationFrameCallback = () => {\r\n        try {\r\n          // Now delete the record and call the callback.\r\n          delete this._animationFrameIds[animationFrameId];\r\n          callback.apply(this._parent);\r\n        } catch (e) {\r\n          this._logError(e);\r\n        }\r\n      };\r\n\r\n      animationFrameId = window.requestAnimationFrame ?\r\n        window.requestAnimationFrame(animationFrameCallback) :\r\n        window.setTimeout(animationFrameCallback, 0);\r\n      /* tslint:enable:ban-native-functions */\r\n\r\n      this._animationFrameIds[animationFrameId] = true;\r\n    }\r\n\r\n    return animationFrameId;\r\n  }\r\n\r\n  public cancelAnimationFrame(id: number) {\r\n    if (this._animationFrameIds && this._animationFrameIds[id]) {\r\n      /* tslint:disable:ban-native-functions */\r\n      window.cancelAnimationFrame ? window.cancelAnimationFrame(id) : window.clearTimeout(id);\r\n      /* tslint:enable:ban-native-functions */\r\n      delete this._animationFrameIds[id];\r\n    }\r\n  }\r\n\r\n  protected _logError(e: any) {\r\n    if (this._onErrorHandler) {\r\n      this._onErrorHandler(e);\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/Async.ts","export enum KeyCodes {\r\n  a = 65,\r\n  backspace = 8,\r\n  comma = 188,\r\n  del = 46,\r\n  down = 40,\r\n  end = 35,\r\n  enter = 13,\r\n  escape = 27,\r\n  home = 36,\r\n  left = 37,\r\n  pageDown = 34,\r\n  pageUp = 33,\r\n  right = 39,\r\n  semicolon = 186,\r\n  space = 32,\r\n  tab = 9,\r\n  up = 38\r\n}\n\n\n// WEBPACK FOOTER //\n// ../src/KeyCodes.ts","// Initialize global window id.\r\nconst CURRENT_ID_PROPERTY = '__currentId__';\r\n\r\ndeclare const process: any;\r\n\r\nlet _global = (typeof window !== 'undefined' && window) || process;\r\n\r\nif (_global[CURRENT_ID_PROPERTY] === undefined) {\r\n  _global[CURRENT_ID_PROPERTY] = 0;\r\n}\r\n\r\nfunction checkProperties(a, b) {\r\n  for (let propName in a) {\r\n    if (a.hasOwnProperty(propName)) {\r\n      if (!b.hasOwnProperty(propName) || (b[propName] !== a[propName])) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\n// Compare a to b and b to a\r\nexport function shallowCompare(a, b) {\r\n  return checkProperties(a, b) && checkProperties(b, a);\r\n}\r\n\r\n/**\r\n * Makes a resulting merge of a bunch of objects. Pass in the target object followed by 1 or more\r\n * objects as arguments and they will be merged sequentially into the target. Note that this will\r\n * shallow merge; it will not create new cloned values for target members.\r\n *\r\n * @params target {Object} Target object to merge following object arguments into.\r\n * @params args {Object} One or more objects that will be mixed into the target in the order they are provided.\r\n * @returns Resulting merged target.\r\n */\r\nexport function assign(target: any, ...args): any {\r\n  return filteredAssign.apply(this, [null, target].concat(args));\r\n}\r\n\r\n/**\r\n * Makes a resulting merge of a bunch of objects, but allows a filter function to be passed in to filter\r\n * the resulting merges. This allows for scenarios where you want to merge \"everything except that one thing\"\r\n * or \"properties that start with data-\". Note that this will shallow merge; it will not create new cloned\r\n * values for target members.\r\n *\r\n * @params filteredAssign {Function} A callback function that tests if the property should be assigned.\r\n * @params target {Object} Target object to merge following object arguments into.\r\n * @params args {Object} One or more objects that will be mixed into the target in the order they are provided.\r\n * @returns Resulting merged target.\r\n */\r\nexport function filteredAssign(isAllowed: (propName: string) => boolean, target: any, ...args) {\r\n  target = target || {};\r\n\r\n  for (let sourceObject of args) {\r\n    if (sourceObject) {\r\n      for (let propName in sourceObject) {\r\n        if (sourceObject.hasOwnProperty(propName) &&\r\n          !isAllowed || isAllowed(propName)) {\r\n          target[propName] = sourceObject[propName];\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return target;\r\n}\r\n\r\n/** Generates a unique id in the global scope (this spans across duplicate copies of the same library.) */\r\nexport function getId(prefix?: string): string {\r\n  let index = _global[CURRENT_ID_PROPERTY]++;\r\n\r\n  return (prefix || '') + index;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/object.ts","import { getDocument } from './dom';\r\nimport styles from './scroll.scss';\r\n\r\nlet _scrollbarWidth: number;\r\nlet _bodyScrollDisabledCount = 0;\r\n\r\nexport const DATA_IS_SCROLLABLE_ATTRIBUTE = 'data-is-scrollable';\r\n\r\nexport function disableBodyScroll() {\r\n  let doc = getDocument();\r\n\r\n  if (doc && doc.body && !_bodyScrollDisabledCount) {\r\n    doc.body.classList.add(styles.msFabricScrollDisabled);\r\n  }\r\n\r\n  _bodyScrollDisabledCount++;\r\n}\r\n\r\nexport function enableBodyScroll() {\r\n  if (_bodyScrollDisabledCount > 0) {\r\n    let doc = getDocument();\r\n\r\n    if (doc && doc.body && _bodyScrollDisabledCount === 1) {\r\n      doc.body.classList.remove(styles.msFabricScrollDisabled);\r\n    }\r\n\r\n    _bodyScrollDisabledCount--;\r\n  }\r\n}\r\n\r\n/** Calculates the width of a scrollbar for the browser/os. */\r\nexport function getScrollbarWidth(): number {\r\n  if (_scrollbarWidth === undefined) {\r\n    let scrollDiv: HTMLElement = document.createElement('div');\r\n    scrollDiv.style.setProperty('width', '100px');\r\n    scrollDiv.style.setProperty('height', '100px');\r\n    scrollDiv.style.setProperty('overflow', 'scroll');\r\n    scrollDiv.style.setProperty('position', 'absolute');\r\n    scrollDiv.style.setProperty('top', '-9999px');\r\n    document.body.appendChild(scrollDiv);\r\n    // Get the scrollbar width\r\n    _scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\r\n\r\n    // Delete the DIV\r\n    document.body.removeChild(scrollDiv);\r\n  }\r\n\r\n  return _scrollbarWidth;\r\n}\r\n\r\n/**\r\n * Traverses up the DOM for the element with the data-is-scrollable=true attribute, or returns\r\n * document.body.\r\n */\r\nexport function findScrollableParent(startingElement: HTMLElement): HTMLElement {\r\n  let el = startingElement;\r\n\r\n  // First do a quick scan for the scrollable attribute.\r\n  while (el && el !== document.body) {\r\n    if (el.getAttribute(DATA_IS_SCROLLABLE_ATTRIBUTE) === 'true') {\r\n      return el;\r\n    }\r\n    el = el.parentElement;\r\n  }\r\n\r\n  // If we haven't found it, the use the slower method: compute styles to evaluate if overflow is set.\r\n  el = startingElement;\r\n\r\n  while (el && el !== document.body) {\r\n    if (el.getAttribute(DATA_IS_SCROLLABLE_ATTRIBUTE) !== 'false') {\r\n      const styles = getComputedStyle(el);\r\n      let overflowY = styles ? styles.getPropertyValue('overflow-y') : '';\r\n\r\n      if (overflowY && (overflowY === 'scroll' || overflowY === 'auto')) {\r\n        return el;\r\n      }\r\n    }\r\n\r\n    el = el.parentElement;\r\n  }\r\n\r\n  // Fall back to window scroll.\r\n  if (!el || el === document.body) {\r\n    el = window as any;\r\n  }\r\n\r\n  return el;\r\n}\n\n\n// WEBPACK FOOTER //\n// ../src/scroll.ts","export * from './components/Icon/index';\n\n\n// WEBPACK FOOTER //\n// ../src/Icon.ts","export * from './components/Link/index';\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/Link.ts","import * as React from 'react';\r\nimport {\r\n  EventGroup,\r\n  assign,\r\n  css,\r\n  shallowCompare\r\n} from '../../Utilities';\r\nimport { IColumn, CheckboxVisibility } from './DetailsList.Props';\r\nimport { DetailsRowCheck, IDetailsRowCheckProps } from './DetailsRowCheck';\r\nimport { GroupSpacer } from '../GroupedList/GroupSpacer';\r\nimport { DetailsRowFields } from './DetailsRowFields';\r\nimport { FocusZone, FocusZoneDirection } from '../../FocusZone';\r\nimport { ISelection, SelectionMode, SELECTION_CHANGE } from '../../utilities/selection/interfaces';\r\nimport {\r\n  IDragDropHelper,\r\n  IDragDropEvents,\r\n  IDragDropOptions,\r\n} from './../../utilities/dragdrop/interfaces';\r\nimport { IViewport } from '../../utilities/decorators/withViewport';\r\nimport styles = require('./DetailsRow.scss');\r\nimport { IDisposable } from '@uifabric/utilities';\r\n\r\nexport interface IDetailsRowProps extends React.Props<DetailsRow> {\r\n  item: any;\r\n  itemIndex: number;\r\n  columns: IColumn[];\r\n  selectionMode: SelectionMode;\r\n  selection: ISelection;\r\n  eventsToRegister?: { eventName: string, callback: (item?: any, index?: number, event?: any) => void }[];\r\n  onDidMount?: (row?: DetailsRow) => void;\r\n  onWillUnmount?: (row?: DetailsRow) => void;\r\n  onRenderCheck?: (props: IDetailsRowCheckProps) => JSX.Element;\r\n  onRenderItemColumn?: (item?: any, index?: number, column?: IColumn) => any;\r\n  dragDropEvents?: IDragDropEvents;\r\n  dragDropHelper?: IDragDropHelper;\r\n  groupNestingDepth?: number;\r\n  viewport?: IViewport;\r\n  checkboxVisibility?: CheckboxVisibility;\r\n  getRowAriaLabel?: (item: any) => string;\r\n  checkButtonAriaLabel?: string;\r\n}\r\n\r\nexport interface IDetailsRowSelectionState {\r\n  isSelected: boolean;\r\n  anySelected: boolean;\r\n}\r\n\r\nexport interface IDetailsRowState {\r\n  selectionState?: IDetailsRowSelectionState;\r\n  columnMeasureInfo?: {\r\n    index: number;\r\n    column: IColumn;\r\n    onMeasureDone: (measuredWidth: number) => void;\r\n  };\r\n  isDropping?: boolean;\r\n  groupNestingDepth?: number;\r\n}\r\n\r\nconst DEFAULT_DROPPING_CSS_CLASS = 'is-dropping';\r\n\r\nexport class DetailsRow extends React.Component<IDetailsRowProps, IDetailsRowState> {\r\n  public refs: {\r\n    [key: string]: React.ReactInstance,\r\n    root: HTMLElement,\r\n    cellMeasurer: HTMLElement\r\n  };\r\n\r\n  private _events: EventGroup;\r\n  private _hasSetFocus: boolean;\r\n  private _droppingClassNames: string;\r\n  private _hasMounted: boolean;\r\n  private _dragDropSubscription: IDisposable;\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      selectionState: this._getSelectionState(props),\r\n      columnMeasureInfo: null,\r\n      isDropping: false,\r\n      groupNestingDepth: props.groupNestingDepth\r\n    };\r\n\r\n    this._hasSetFocus = false;\r\n\r\n    this._events = new EventGroup(this);\r\n    this._droppingClassNames = '';\r\n    this._updateDroppingState = this._updateDroppingState.bind(this);\r\n  }\r\n\r\n  public componentDidMount() {\r\n    let { dragDropHelper } = this.props;\r\n\r\n    if (dragDropHelper) {\r\n      this._dragDropSubscription = dragDropHelper.subscribe(this.refs.root, this._events, this._getRowDragDropOptions());\r\n    }\r\n\r\n    this._events.on(this.props.selection, SELECTION_CHANGE, this._onSelectionChanged);\r\n\r\n    if (this.props.onDidMount && this.props.item) {\r\n      // If the item appears later, we should wait for it before calling this method.\r\n      this._hasMounted = true;\r\n      this.props.onDidMount(this);\r\n    }\r\n  }\r\n\r\n  public componentDidUpdate(previousProps: IDetailsRowProps) {\r\n    let state = this.state;\r\n    let { item, onDidMount } = this.props;\r\n    let { columnMeasureInfo } = state;\r\n\r\n    if (this.props.itemIndex !== previousProps.itemIndex ||\r\n      this.props.item !== previousProps.item ||\r\n      this.props.dragDropHelper !== previousProps.dragDropHelper) {\r\n      if (this._dragDropSubscription) {\r\n        this._dragDropSubscription.dispose();\r\n        delete this._dragDropSubscription;\r\n      }\r\n\r\n      if (this.props.dragDropHelper) {\r\n        this._dragDropSubscription = this.props.dragDropHelper.subscribe(this.refs.root, this._events, this._getRowDragDropOptions());\r\n      }\r\n    }\r\n\r\n    if (columnMeasureInfo && columnMeasureInfo.index >= 0) {\r\n      let newWidth = this.refs.cellMeasurer.getBoundingClientRect().width;\r\n\r\n      columnMeasureInfo.onMeasureDone(newWidth);\r\n\r\n      this.setState({\r\n        columnMeasureInfo: null\r\n      });\r\n    }\r\n\r\n    if (item && onDidMount && !this._hasMounted) {\r\n      this._hasMounted = true;\r\n      onDidMount(this);\r\n    }\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    let { item, onWillUnmount } = this.props;\r\n\r\n    this._events.dispose();\r\n\r\n    // Only call the onWillUnmount callback if we have an item.\r\n    if (onWillUnmount && item) {\r\n      onWillUnmount(this);\r\n    }\r\n\r\n    if (this._dragDropSubscription) {\r\n      this._dragDropSubscription.dispose();\r\n      delete this._dragDropSubscription;\r\n    }\r\n  }\r\n\r\n  public componentWillReceiveProps(newProps: IDetailsRowProps) {\r\n    this.setState({\r\n      selectionState: this._getSelectionState(newProps),\r\n      groupNestingDepth: newProps.groupNestingDepth\r\n    });\r\n  }\r\n\r\n  public render() {\r\n    const {\r\n      columns,\r\n      dragDropEvents,\r\n      item,\r\n      itemIndex,\r\n      onRenderCheck = this._onRenderCheck,\r\n      onRenderItemColumn,\r\n      selectionMode,\r\n      viewport,\r\n      checkboxVisibility,\r\n      getRowAriaLabel,\r\n      checkButtonAriaLabel,\r\n      selection\r\n    } = this.props;\r\n    const { selectionState: { isSelected, anySelected }, columnMeasureInfo, isDropping, groupNestingDepth } = this.state;\r\n    const isDraggable = Boolean(dragDropEvents && dragDropEvents.canDrag && dragDropEvents.canDrag(item));\r\n    const droppingClassName = isDropping ? (this._droppingClassNames ? this._droppingClassNames : DEFAULT_DROPPING_CSS_CLASS) : '';\r\n    const ariaLabel = getRowAriaLabel ? getRowAriaLabel(item) : null;\r\n    const canSelect = selection.canSelectItem(item);\r\n    const isContentUnselectable = selectionMode === SelectionMode.multiple;\r\n\r\n    return (\r\n      <div\r\n        ref='root'\r\n        role='row'\r\n        aria-label={ ariaLabel }\r\n        className={ css('ms-DetailsRow ms-u-fadeIn400', styles.root, droppingClassName, {\r\n          ['is-contentUnselectable ' + styles.rootIsContentUnselectable]: isContentUnselectable,\r\n          ['is-selected ' + styles.rootIsSelected]: isSelected,\r\n          ['is-check-visible ' + styles.rootIsCheckVisible]: checkboxVisibility === CheckboxVisibility.always\r\n        }) }\r\n        data-is-focusable={ true }\r\n        data-selection-index={ itemIndex }\r\n        data-item-index={ itemIndex }\r\n        data-is-draggable={ isDraggable }\r\n        draggable= { isDraggable }\r\n        data-automationid='DetailsRow'\r\n        style={ { minWidth: viewport ? viewport.width : 0 } }\r\n        aria-selected={ isSelected }\r\n      >\r\n        <FocusZone direction={ FocusZoneDirection.horizontal }>\r\n          { (selectionMode !== SelectionMode.none && checkboxVisibility !== CheckboxVisibility.hidden) && (\r\n            <span role='gridcell'>\r\n              { onRenderCheck({\r\n                isSelected,\r\n                anySelected,\r\n                ariaLabel: checkButtonAriaLabel,\r\n                canSelect\r\n              }) }\r\n            </span>\r\n          ) }\r\n\r\n          { GroupSpacer({ count: groupNestingDepth }) }\r\n\r\n          { item && (\r\n            <DetailsRowFields\r\n              columns={ columns }\r\n              item={ item }\r\n              itemIndex={ itemIndex }\r\n              onRenderItemColumn={ onRenderItemColumn } />\r\n          ) }\r\n\r\n          { columnMeasureInfo && (\r\n            <span\r\n              className={ css('ms-DetailsRow-cellMeasurer ms-DetailsRow-cell', styles.cellMeasurer, styles.cell) }\r\n              ref='cellMeasurer'\r\n            >\r\n              <DetailsRowFields\r\n                columns={ [columnMeasureInfo.column] }\r\n                item={ item }\r\n                itemIndex={ itemIndex }\r\n                onRenderItemColumn={ onRenderItemColumn } />\r\n            </span>\r\n          ) }\r\n        </FocusZone>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * measure cell at index. and call the call back with the measured cell width when finish measure\r\n   *\r\n   * @param {number} index (the cell index)\r\n   * @param {(width: number) => void} onMeasureDone (the call back function when finish measure)\r\n   */\r\n  public measureCell(index: number, onMeasureDone: (width: number) => void) {\r\n    let column = assign({}, this.props.columns[index]) as IColumn;\r\n\r\n    column.minWidth = 0;\r\n    column.maxWidth = 999999;\r\n\r\n    delete column.calculatedWidth;\r\n\r\n    this.setState({\r\n      columnMeasureInfo: {\r\n        index,\r\n        column,\r\n        onMeasureDone\r\n      }\r\n    });\r\n  }\r\n\r\n  public focus() {\r\n    if (this.refs && this.refs.root) {\r\n      this.refs.root.tabIndex = 0;\r\n      this.refs.root.focus();\r\n    }\r\n  }\r\n\r\n  protected _onRenderCheck(props: IDetailsRowCheckProps) {\r\n    return <DetailsRowCheck { ...props } />;\r\n  }\r\n\r\n  private _getSelectionState(props: IDetailsRowProps): IDetailsRowSelectionState {\r\n    let { itemIndex, selection } = props;\r\n\r\n    return {\r\n      isSelected: selection.isIndexSelected(itemIndex),\r\n      anySelected: selection.getSelectedCount() > 0\r\n    };\r\n  }\r\n\r\n  private _onSelectionChanged() {\r\n    let selectionState = this._getSelectionState(this.props);\r\n\r\n    if (!shallowCompare(selectionState, this.state.selectionState)) {\r\n      this.setState({\r\n        selectionState: selectionState\r\n      });\r\n    }\r\n  }\r\n\r\n  private _getRowDragDropOptions(): IDragDropOptions {\r\n    const {\r\n      item,\r\n      itemIndex,\r\n      dragDropEvents,\r\n      eventsToRegister\r\n    } = this.props;\r\n    let options = {\r\n      eventMap: eventsToRegister,\r\n      selectionIndex: itemIndex,\r\n      context: { data: item, index: itemIndex },\r\n      canDrag: dragDropEvents.canDrag,\r\n      canDrop: dragDropEvents.canDrop,\r\n      onDragStart: dragDropEvents.onDragStart,\r\n      updateDropState: this._updateDroppingState,\r\n      onDrop: dragDropEvents.onDrop,\r\n      onDragEnd: dragDropEvents.onDragEnd,\r\n    };\r\n\r\n    return options;\r\n  }\r\n\r\n  /**\r\n   * update isDropping state based on the input value, which is used to change style during drag and drop\r\n   *\r\n   * when change to true, that means drag enter. we will add default dropping class name\r\n   * or the custom dropping class name (return result from onDragEnter) to the root elemet.\r\n   *\r\n   * when change to false, that means drag leave. we will remove the dropping class name from root element.\r\n   *\r\n   * @private\r\n   * @param {boolean} newValue (new isDropping state value)\r\n   * @param {DragEvent} event (the event trigger dropping state change which can be dragenter, dragleave etc)\r\n   */\r\n  private _updateDroppingState(newValue: boolean, event: DragEvent) {\r\n    let { selectionState, isDropping } = this.state;\r\n    let { dragDropEvents, item } = this.props;\r\n\r\n    if (!newValue) {\r\n      if (dragDropEvents.onDragLeave) {\r\n        dragDropEvents.onDragLeave(item, event);\r\n      }\r\n    } else {\r\n      if (dragDropEvents.onDragEnter) {\r\n        this._droppingClassNames = dragDropEvents.onDragEnter(item, event);\r\n      }\r\n    }\r\n\r\n    if (isDropping !== newValue) {\r\n      this.setState({ selectionState: selectionState, isDropping: newValue });\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/DetailsList/DetailsRow.tsx","/* tslint:disable:no-unused-variable */\r\nimport * as React from 'react';\r\n/* tslint:enable:no-unused-variable */\r\nimport { css } from '../../Utilities';\r\nimport { Check } from '../../Check';\r\nimport styles = require('./DetailsRow.scss');\r\n\r\nexport interface IDetailsRowCheckProps {\r\n  selected?: boolean;\r\n  /**\r\n   * @deprecated\r\n   * Deprecated at v.65.1 and will be removed by v 1.0. Use 'selected' instead.\r\n   */\r\n  isSelected?: boolean;\r\n  anySelected: boolean;\r\n  ariaLabel: string;\r\n  canSelect: boolean;\r\n}\r\n\r\nexport const DetailsRowCheck = (props: IDetailsRowCheckProps) => {\r\n  let selected = props.isSelected || props.selected;\r\n  return (\r\n    <button\r\n      type='button'\r\n      className={ css('ms-DetailsRow-check', styles.check) }\r\n      role='button'\r\n      aria-pressed={ selected }\r\n      data-selection-toggle={ true }\r\n      data-automationid='DetailsRowCheck'\r\n      aria-label={ props.ariaLabel }\r\n    >\r\n      { props.canSelect ?\r\n        <Check checked={ selected } /> :\r\n        <div className={ css('ms-DetailsRow-checkSpacer', styles.checkSpacer) } />\r\n      }\r\n    </button>\r\n  );\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/DetailsList/DetailsRowCheck.tsx","/* tslint:disable */\r\nimport { loadStyles } from '@microsoft/load-themed-styles';\r\n\r\nconst styles = {\r\n  root: 'root_1d9f9602',\r\n  group: 'group_1d9f9602',\r\n  groupIsDropping: 'groupIsDropping_1d9f9602',\r\n};\r\n\r\nexport = styles;\r\n\r\nloadStyles([{\"rawString\":\".root_1d9f9602{position:relative;font-size:12px}.root_1d9f9602 BUTTON{font-family:inherit;background-color:transparent}.group_1d9f9602{-webkit-transition:background-color 267ms cubic-bezier(.445,.05,.55,.95);transition:background-color 267ms cubic-bezier(.445,.05,.55,.95)}.groupIsDropping_1d9f9602{background-color:\"},{\"theme\":\"neutralLight\",\"defaultValue\":\"#eaeaea\"},{\"rawString\":\"}.root_1d9f9602 .ms-List-cell{min-height:38px}\"}]);\r\n/* tslint:enable */\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/GroupedList/GroupedList.scss.ts","// Please keep alphabetized\r\nexport enum IconType {\r\n  Default = 0,\r\n  Image = 1\r\n}\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Icon/IconType.ts","/* tslint:disable:no-unused-variable */\r\nimport * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\n/* tslint:enable:no-unused-variable */\r\n\r\nimport { Fabric } from '../../Fabric';\r\nimport { ILayerProps } from './Layer.Props';\r\nimport { css, BaseComponent, getDocument, setVirtualParent } from '../../Utilities';\r\nimport styles = require('./Layer.scss');\r\n\r\nlet _layersByHostId: { [hostId: string]: Layer[] } = {};\r\n\r\nexport class Layer extends BaseComponent<ILayerProps, {}> {\r\n\r\n  public static defaultProps = {\r\n    onLayerDidMount: () => undefined,\r\n    onLayerWillUnmount: () => undefined\r\n  };\r\n\r\n  private _rootElement: HTMLElement;\r\n  private _host: Node;\r\n  private _layerElement: HTMLElement;\r\n  private _hasMounted: boolean;\r\n  /**\r\n   * Used for notifying applicable Layers that a host is available/unavailable and to re-evaluate Layers that\r\n   * care about the specific host.\r\n   */\r\n  public static notifyHostChanged(id: string) {\r\n    if (_layersByHostId[id]) {\r\n      _layersByHostId[id].forEach(layer => layer.forceUpdate());\r\n    }\r\n  }\r\n\r\n  constructor(props: ILayerProps) {\r\n    super(props, {\r\n      // Make sure to deprecate old properties.\r\n      'onLayerMounted': 'onLayerDidMount'\r\n    });\r\n\r\n    if (this.props.hostId) {\r\n      if (!_layersByHostId[this.props.hostId]) {\r\n        _layersByHostId[this.props.hostId] = [];\r\n      }\r\n\r\n      _layersByHostId[this.props.hostId].push(this);\r\n    }\r\n  }\r\n\r\n  public componentDidMount() {\r\n    this.componentDidUpdate();\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    this._removeLayerElement();\r\n\r\n    if (this.props.hostId) {\r\n      _layersByHostId[this.props.hostId] = _layersByHostId[this.props.hostId].filter(layer => layer !== this);\r\n      if (!_layersByHostId[this.props.hostId].length) {\r\n        delete _layersByHostId[this.props.hostId];\r\n      }\r\n    }\r\n  }\r\n\r\n  public componentDidUpdate() {\r\n    let host = this._getHost();\r\n\r\n    if (host !== this._host) {\r\n      this._removeLayerElement();\r\n    }\r\n\r\n    if (host) {\r\n      this._host = host;\r\n\r\n      if (!this._layerElement) {\r\n        let doc = getDocument(this._rootElement);\r\n\r\n        this._layerElement = doc.createElement('div');\r\n        this._layerElement.className = css('ms-Layer', {\r\n          ['ms-Layer--fixed ' + styles.rootIsFixed]: !this.props.hostId\r\n        });\r\n\r\n        host.appendChild(this._layerElement);\r\n        setVirtualParent(this._layerElement, this._rootElement);\r\n      }\r\n\r\n      // Using this 'unstable' method allows us to retain the React context across the layer projection.\r\n      ReactDOM.unstable_renderSubtreeIntoContainer(\r\n        this,\r\n        <Fabric className={ css('ms-Layer-content', styles.content) }>\r\n          { this.props.children }\r\n        </Fabric>,\r\n        this._layerElement,\r\n        () => {\r\n          if (!this._hasMounted) {\r\n            this._hasMounted = true;\r\n\r\n            // TODO: @deprecated cleanup required.\r\n            if (this.props.onLayerMounted) {\r\n              this.props.onLayerMounted();\r\n            }\r\n\r\n            this.props.onLayerDidMount();\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <span\r\n        className='ms-Layer'\r\n        ref={ this._resolveRef('_rootElement') }\r\n      />\r\n    );\r\n  }\r\n\r\n  private _removeLayerElement() {\r\n    if (this._layerElement) {\r\n      this.props.onLayerWillUnmount();\r\n\r\n      ReactDOM.unmountComponentAtNode(this._layerElement);\r\n      let parentNode = this._layerElement.parentNode;\r\n      if (parentNode) {\r\n        parentNode.removeChild(this._layerElement);\r\n      }\r\n      this._layerElement = undefined;\r\n      this._hasMounted = false;\r\n    }\r\n  }\r\n\r\n  private _getHost(): Node {\r\n    let { hostId } = this.props;\r\n    let doc = getDocument(this._rootElement);\r\n\r\n    if (hostId) {\r\n      return doc.getElementById(hostId);\r\n    } else {\r\n      return doc.body;\r\n    }\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Layer/Layer.tsx","import {\r\n  ISelectionLayout,\r\n  SelectionDirection\r\n} from './interfaces';\r\n\r\nexport class SelectionLayout implements ISelectionLayout {\r\n  private _direction: SelectionDirection;\r\n\r\n  constructor(direction: SelectionDirection) {\r\n    this._direction = direction;\r\n  }\r\n\r\n  public getItemIndexAbove(focusIndex: number, items: any[]): number {\r\n    return (this._direction === SelectionDirection.vertical) ? Math.max(0, focusIndex - 1) : focusIndex;\r\n  }\r\n\r\n  public getItemIndexBelow(focusIndex: number, items: any[]): number {\r\n    return (this._direction === SelectionDirection.vertical) ? Math.min(items.length - 1, focusIndex + 1) : focusIndex;\r\n  }\r\n\r\n  public getItemIndexLeft(focusIndex: number, items: any[]): number {\r\n    return (this._direction === SelectionDirection.vertical) ? focusIndex : Math.max(0, focusIndex - 1);\r\n  }\r\n\r\n  public getItemIndexRight(focusIndex: number, items: any[]): number {\r\n    return (this._direction === SelectionDirection.vertical) ? focusIndex : Math.min(items.length - 1, focusIndex + 1);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/utilities/selection/SelectionLayout.ts","/// <reference path=\"../../node_modules/@types/office-js/index.d.ts\" />\r\n\r\nimport * as React from \"react\";\r\nimport * as JQuery from \"jquery\";\r\n\r\nimport { Data } from \"../Data/Model\"\r\nimport { Factory } from \"../Data/Factory\";\r\n\r\nimport { StatusMessage } from \"./StatusMessage\";\r\nimport { SearchResults } from \"./SearchResults\";\r\nimport { Feedback } from \"./Feedback\";\r\n\r\nexport interface ConversationFilerProps {\r\n    mailbox: Office.Mailbox;\r\n    storedResults?: Data.Match[];\r\n    onComplete?: (folderId: string) => void;\r\n}\r\n\r\ninterface ConversationFilerState {\r\n    progress: Data.Progress;\r\n    data?: Data.IModel;\r\n    error?: string;\r\n    matches?: Data.Match[];\r\n}\r\n\r\nexport class ConversationFiler extends React.Component<ConversationFilerProps, ConversationFilerState> {\r\n    constructor(props: ConversationFilerProps) {\r\n        super(props);\r\n        this.onSelection = this.onSelection.bind(this);\r\n\r\n        if (this.props.storedResults) {\r\n            if (this.props.storedResults.length > 0) {\r\n                this.state = { progress: Data.Progress.Success, matches: this.props.storedResults };\r\n            } else {\r\n                this.state = { progress: Data.Progress.NotFound };\r\n            }\r\n        } else {\r\n            this.state = { progress: Data.Progress.GetCallbackToken };\r\n        }\r\n    }\r\n\r\n    // Start the chain of requests by getting a callback token.\r\n    componentDidMount() {\r\n        if (!this.props.mailbox) {\r\n            return;\r\n        }\r\n\r\n        const data = Factory.getData(this.props.mailbox);\r\n\r\n        this.setState({ data: data });\r\n\r\n        data.getItemsAsync((results) => {\r\n            if (results.length > 0) {\r\n                this.setState({ progress: Data.Progress.Success, matches: results });\r\n            } else {\r\n                this.setState({ progress: Data.Progress.NotFound });\r\n            }\r\n        }, (progress) => {\r\n            this.setState({ progress: progress });\r\n        }, (message) => {\r\n            this.setState({ progress: Data.Progress.Error, error: message });\r\n        });\r\n    }\r\n\r\n    private onSelection(folderId: string) {\r\n        console.log(`Selected a folder: ${folderId}`);\r\n\r\n        if (!this.state.data) {\r\n            // Handle the dialog or test case by just notifying the client\r\n            if (this.props.onComplete) {\r\n                this.props.onComplete(folderId);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        this.state.data.moveItemsAsync(folderId, (count) => {\r\n            if (this.props.onComplete) {\r\n                this.props.onComplete(folderId);\r\n            }\r\n        }, (message) => {\r\n            this.setState({ progress: Data.Progress.Error, error: message });\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (<div>\r\n            <StatusMessage progress={this.state.progress} message={this.state.error} />\r\n            <SearchResults matches={this.state.matches} onSelection={this.onSelection} />\r\n            <Feedback />\r\n        </div>);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/ConversationFiler.tsx","/// <reference path=\"../node_modules/@types/office-js/index.d.ts\" />\r\n\r\nimport { Pages } from \"./pages\";\r\n\r\nimport { Data } from \"./Data/Model\";\r\nimport { Factory } from \"./Data/Factory\";\r\n\r\nexport module AppFunctions {\r\n    function fileDialog(event: any) {\r\n        const mailbox = Office.context.mailbox;\r\n        const data = Factory.getData(mailbox);\r\n        const notificationKey = 'conversationFilerNotification';\r\n\r\n        console.log('Starting to load the conversation...');\r\n\r\n        data.getItemsAsync((results) => {\r\n            console.log(`Loaded the conversation: ${results.length}`);\r\n\r\n            if (results.length === 0) {\r\n                // Special case for empty results\r\n                mailbox.item.notificationMessages.replaceAsync(notificationKey, {\r\n                    type: Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,\r\n                    message: `It looks like you haven't filed this conversation anywhere before.`\r\n                });\r\n                event.completed();\r\n\r\n                return;\r\n            }\r\n\r\n            console.log('Showing the dialog...');\r\n\r\n            mailbox.item.notificationMessages.removeAsync(notificationKey);\r\n            Pages.populateDialog(results);\r\n            Office.context.ui.displayDialogAsync(Pages.getDialogUrl(), { height: 25, width: 50, displayInIframe: true }, (result) => {\r\n                const dialog = <Office.DialogHandler>result.value;\r\n                const onDialogComplete = (closed: boolean) => {\r\n                    Pages.resetDialog();\r\n\r\n                    if (!closed) {\r\n                        dialog.close();\r\n                    }\r\n\r\n                    event.completed();\r\n                };\r\n\r\n                dialog.addEventHandler(Office.EventType.DialogMessageReceived, (dialogEvent: { message: string }) => {\r\n                    console.log('Moving the items...');\r\n\r\n                    data.moveItemsAsync(dialogEvent.message, (count) => {\r\n                        console.log(`Finished moving the items: ${count}`);\r\n\r\n                        onDialogComplete(false);\r\n                    }, (message) => {\r\n                        console.log(`Error moving the items: ${message}`);\r\n\r\n                        mailbox.item.notificationMessages.replaceAsync(notificationKey, {\r\n                            type: Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,\r\n                            message: `Something went wrong, I couldn't move the messages.`\r\n                        });\r\n                        onDialogComplete(false);\r\n                    });\r\n                });\r\n\r\n                dialog.addEventHandler(Office.EventType.DialogEventReceived, () => {\r\n                    onDialogComplete(true);\r\n                });\r\n            });\r\n        }, (progress) => {\r\n            console.log(`Progress loading the conversation: ${Data.Progress[progress]}`);\r\n\r\n            // Update the progress indicator\r\n            mailbox.item.notificationMessages.replaceAsync(notificationKey, {\r\n                type: Office.MailboxEnums.ItemNotificationMessageType.ProgressIndicator,\r\n                message: 'Finding the messages in this conversation...'\r\n            });\r\n        }, (message) => {\r\n            console.log(`Error loading the conversation: ${message}`);\r\n\r\n            // Display an error\r\n            mailbox.item.notificationMessages.replaceAsync(notificationKey, {\r\n                type: Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,\r\n                message: `Sorry, I couldn't figure out where this message should go.`\r\n            });\r\n\r\n            event.completed();\r\n        });\r\n    }\r\n\r\n    // Add the UI-less function callbacks to the window\r\n    export function register() {\r\n        (<any>window).fileDialog = fileDialog;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/functions.ts","import * as React from 'react';\r\n\r\nexport interface IImageProps extends React.HTMLProps<HTMLImageElement> {\r\n  /**\r\n   * If true, fades the image in when loaded.\r\n   * @defaultvalue false;\r\n   */\r\n  shouldFadeIn?: boolean;\r\n\r\n  /**\r\n   * If true, the image starts as visible and is hidden on error. Otherwise, the image is hidden until\r\n   * it is successfully loaded. This disables shouldFadeIn.\r\n   * @defaultvalue false;\r\n   */\r\n  shouldStartVisible?: boolean;\r\n\r\n  /**\r\n   * If provided, adds the indicated css class to the image.\r\n   */\r\n  className?: string;\r\n\r\n  /**\r\n   * Used to determine how the image is scaled and cropped to fit the frame.\r\n   *\r\n   * @defaultvalue If both dimensions are provided, then the image is fit using ImageFit.scale. Otherwise, the\r\n   * image won't be scaled or cropped.\r\n   */\r\n  imageFit?: ImageFit;\r\n\r\n  /**\r\n   * @deprecated\r\n   * Deprecated at v1.3.6, to be removed at >= v2.0.0.\r\n   * To replace the src in case of errors, use onLoadingStateChange instead and rerender the Image with a\r\n   * difference src.\r\n   */\r\n  errorSrc?: string;\r\n\r\n  /**\r\n   * If true, the image frame will expand to fill its parent container.\r\n   */\r\n  maximizeFrame?: boolean;\r\n\r\n  /**\r\n   * Optional callback method for when the image load state has changed.\r\n   * The 'loadState' parameter indicates the current state of the Image.\r\n   */\r\n  onLoadingStateChange?: (loadState: ImageLoadState) => void;\r\n}\r\n\r\n/**\r\n * The possible methods that can be used to fit the image.\r\n */\r\nexport enum ImageFit {\r\n  /**\r\n   * The image is not scaled. The image is centered and cropped within the content box.\r\n   */\r\n  center = 0,\r\n\r\n  /**\r\n   * The image is scaled to maintain its aspect ratio while being fully contained within the frame. The image will\r\n   * be centered horizontally and vertically within the frame. The space in the top and bottom or in the sides of\r\n   * the frame will be empty depending on the difference in aspect ratio between the image and the frame.\r\n   */\r\n  contain = 1,\r\n\r\n  /**\r\n   * The image is scaled to maintain its aspect ratio while filling the frame. Portions of the image will be cropped from\r\n   * the top and bottom, or from the sides, depending on the difference in aspect ratio between the image and the frame.\r\n   */\r\n  cover = 2,\r\n\r\n  /**\r\n   * Neither the image nor the frame are scaled. If their sizes do not match, the image will either be cropped or the\r\n   * frame will have empty space.\r\n   */\r\n  none = 3\r\n}\r\n\r\nexport enum ImageLoadState {\r\n  /**\r\n   * The image has not yet been loaded, and there is no error yet.\r\n   */\r\n  notLoaded = 0,\r\n\r\n  /**\r\n   * The image has been loaded successfully.\r\n   */\r\n  loaded = 1,\r\n\r\n  /**\r\n   * An error has been encountered while loading the image.\r\n   */\r\n  error = 2,\r\n\r\n  /**\r\n   * @deprecated\r\n   * Deprecated at v1.3.6, to be removed at >= v2.0.0.\r\n   * To replace the src in case of errors, use onLoadingStateChange instead and rerender the Image with a\r\n   * difference src.\r\n   */\r\n  errorLoaded = 3\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./~/office-ui-fabric-react/lib/components/Image/Image.Props.ts","/// <reference path=\"../../node_modules/@types/office-js/index.d.ts\" />\r\n/// <reference path=\"../../node_modules/@types/jquery/index.d.ts\" />\r\n\r\nimport { Data } from \"./Model\";\r\n\r\nexport module EWSData {\r\n    interface ItemId {\r\n        id: string;\r\n        changeKey: string;\r\n    }\r\n\r\n    interface FolderData {\r\n        folderId: ItemId;\r\n        displayName?: string;\r\n    }\r\n\r\n    interface MessageData {\r\n        itemId: ItemId;\r\n        conversation: ConversationData;\r\n        folder?: FolderData;\r\n        body?: string;\r\n        from?: string;\r\n        to?: string;\r\n    }\r\n\r\n    interface ConversationData {\r\n        id: string;\r\n        items: MessageData[];\r\n        global: MessageData[];\r\n    }\r\n\r\n    class RequestBuilder {\r\n        private static beginRequest = [\r\n            '<?xml version=\"1.0\" encoding=\"utf-8\" ?>',\r\n            '<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"',\r\n            '    xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"',\r\n            '    xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"',\r\n            '    xmlns:t=\"http://schemas.microsoft.com/exchange/services/2006/types\"',\r\n            '    xmlns:m=\"http://schemas.microsoft.com/exchange/services/2006/messages\">',\r\n            '<soap:Header>',\r\n            '  <t:RequestServerVersion Version=\"Exchange2010_SP1\" />',\r\n            '</soap:Header>',\r\n            '<soap:Body>',\r\n        ].join('\\n');\r\n\r\n        private static endRequest = [\r\n            '</soap:Body>',\r\n            '</soap:Envelope>'\r\n        ].join('\\n');\r\n\r\n        static findConversationRequest = [\r\n            RequestBuilder.beginRequest,\r\n            '  <m:FindConversation>',\r\n            '    <m:IndexedPageItemView BasePoint=\"Beginning\" Offset=\"0\" MaxEntriesReturned=\"20\" />',\r\n            '    <m:ParentFolderId>',\r\n            '      <t:DistinguishedFolderId Id=\"inbox\"/>',\r\n            '    </m:ParentFolderId>',\r\n            '  </m:FindConversation>',\r\n            RequestBuilder.endRequest\r\n        ].join('\\n');\r\n\r\n        static getItemsRequest(messages: MessageData[]) {\r\n            var builder = [\r\n                RequestBuilder.beginRequest,\r\n                '  <m:GetItem>',\r\n                '    <m:ItemShape>',\r\n                '      <t:BaseShape>IdOnly</t:BaseShape>',\r\n                '      <t:BodyType>Text</t:BodyType>',\r\n                '      <t:AdditionalProperties>',\r\n                '        <t:FieldURI FieldURI=\"item:ParentFolderId\" />',\r\n                '        <t:FieldURI FieldURI=\"message:Sender\" />',\r\n                '        <t:FieldURI FieldURI=\"message:ToRecipients\" />',\r\n                '        <t:FieldURI FieldURI=\"item:Body\" />',\r\n                '      </t:AdditionalProperties>',\r\n                '    </m:ItemShape>',\r\n                '    <m:ItemIds>',\r\n            ];\r\n\r\n            messages.map(message => {\r\n                builder.push(`      <t:ItemId Id=\"${message.itemId.id}\" ChangeKey=\"${message.itemId.changeKey}\" />`);\r\n            });\r\n\r\n            builder.push(\r\n                '    </m:ItemIds>',\r\n                '  </m:GetItem>',\r\n                RequestBuilder.endRequest);\r\n\r\n            return builder.join('\\n');\r\n        }\r\n\r\n        static excludedFolderIdsRequest = [\r\n            RequestBuilder.beginRequest,\r\n            '  <m:GetFolder>',\r\n            '    <m:FolderShape>',\r\n            '      <t:BaseShape>IdOnly</t:BaseShape>',\r\n            '    </m:FolderShape>',\r\n            '    <m:FolderIds>',\r\n            '      <t:DistinguishedFolderId Id=\"inbox\"/>',\r\n            '      <t:DistinguishedFolderId Id=\"drafts\"/>',\r\n            '      <t:DistinguishedFolderId Id=\"sentitems\"/>',\r\n            '      <t:DistinguishedFolderId Id=\"deleteditems\"/>',\r\n            '    </m:FolderIds>',\r\n            '  </m:GetFolder >',\r\n            RequestBuilder.endRequest\r\n        ].join('\\n');\r\n\r\n        static getFolderNamesRequest(folders: FolderData[]) {\r\n            var builder = [\r\n                RequestBuilder.beginRequest,\r\n                '  <m:GetFolder>',\r\n                '    <m:FolderShape>',\r\n                '      <t:BaseShape>IdOnly</t:BaseShape>',\r\n                '      <t:AdditionalProperties>',\r\n                '        <t:FieldURI FieldURI=\"folder:DisplayName\" />',\r\n                '      </t:AdditionalProperties>',\r\n                '    </m:FolderShape>',\r\n                '    <m:FolderIds>'\r\n            ];\r\n\r\n            folders.map(folder => {\r\n                builder.push(`      <t:FolderId Id=\"${folder.folderId.id}\" ChangeKey=\"${folder.folderId.changeKey}\" />`);\r\n            });\r\n\r\n            builder.push(\r\n                '    </m:FolderIds>',\r\n                '  </m:GetFolder >',\r\n                RequestBuilder.endRequest);\r\n\r\n            return builder.join('\\n');\r\n        }\r\n\r\n        static moveItemsRequest(messages: MessageData[], folderId: string) {\r\n            var builder = [\r\n                RequestBuilder.beginRequest,\r\n                '  <m:MoveItem>',\r\n                '    <m:ToFolderId>',\r\n                '      <t:FolderId Id=\"' + folderId + '\"/>',\r\n                '    </m:ToFolderId>',\r\n                '    <m:ItemIds>',\r\n            ];\r\n\r\n            messages.map(message => {\r\n                builder.push(`      <t:ItemId Id=\"${message.itemId.id}\" ChangeKey=\"${message.itemId.changeKey}\" />`);\r\n            });\r\n\r\n            builder.push(\r\n                '    </m:ItemIds>',\r\n                '  </m:MoveItem>',\r\n                RequestBuilder.endRequest);\r\n\r\n            return builder.join('\\n');\r\n        }\r\n    }\r\n\r\n    class Context {\r\n        constructor(private mailbox: Office.Mailbox) {\r\n        }\r\n\r\n        private conversationXml?: XMLDocument;\r\n        private conversation?: ConversationData;\r\n        private excludedFolders?: FolderData[];\r\n        private itemsXml?: XMLDocument;\r\n        private folderNamesXml?: XMLDocument;\r\n\r\n        private onLoadComplete?: (results: Data.Match[]) => void;\r\n        private onProgress?: (progress: Data.Progress) => void;\r\n        private onError?: (message: string) => void;\r\n        private onMoveComplete?: (count: number) => void\r\n\r\n        loadItems(onLoadComplete: (results: Data.Match[]) => void, onProgress: (progress: Data.Progress) => void, onError: (message: string) => void): void {\r\n            this.onLoadComplete = onLoadComplete;\r\n            this.onProgress = onProgress;\r\n            this.onError = onError;\r\n\r\n            console.log('Finding the conversation with EWS...');\r\n            this.onProgress(Data.Progress.GetConversation);\r\n\r\n            this.mailbox.makeEwsRequestAsync(RequestBuilder.findConversationRequest, (result) => {\r\n                if (!result.value) {\r\n                    this.onError(result.error.message);\r\n                    return;\r\n                }\r\n\r\n                this.conversationXml = $.parseXML(result.value);\r\n                this.getConversation();\r\n            });\r\n        }\r\n\r\n        private getConversation() {\r\n            const $conversation = $(this.conversationXml.querySelectorAll('Conversation > GlobalItemIds > ItemId'))\r\n                .filter(`[Id=\"${(<Office.ItemRead>this.mailbox.item).itemId}\"]`)\r\n                .parents('Conversation');\r\n\r\n            if (!$conversation.length) {\r\n                this.onError(\"This conversation isn't in your inbox's top 20.\");\r\n                return;\r\n            }\r\n\r\n            const messageCount = parseInt($conversation.find('MessageCount').text());\r\n            const globalCount = parseInt($conversation.find('GlobalMessageCount').text());\r\n\r\n            if (messageCount >= globalCount) {\r\n                this.onLoadComplete([]);\r\n                return;\r\n            }\r\n\r\n            let sameFolderItemIds: ItemId[] = [];\r\n\r\n            $conversation.find('ItemIds > ItemId').each(function () {\r\n                const $this = $(this);\r\n\r\n                sameFolderItemIds.push({\r\n                    id: $this.attr('Id'),\r\n                    changeKey: $this.attr('ChangeKey')\r\n                });\r\n            });\r\n\r\n            let $otherFolderItemIds = $conversation.find('GlobalItemIds > ItemId');\r\n\r\n            sameFolderItemIds.map(itemId => {\r\n                $otherFolderItemIds = $otherFolderItemIds.filter(`[Id!=\"${itemId.id}\"]`);\r\n            });\r\n\r\n            let otherFolderItemIds: ItemId[] = [];\r\n\r\n            $otherFolderItemIds.each(function () {\r\n                const $this = $(this);\r\n\r\n                otherFolderItemIds.push({\r\n                    id: $this.attr('Id'),\r\n                    changeKey: $this.attr('ChangeKey')\r\n                });\r\n            });\r\n\r\n            if (!sameFolderItemIds.length || !otherFolderItemIds.length) {\r\n                this.onLoadComplete([]);\r\n                return;\r\n            }\r\n\r\n            this.conversation = {\r\n                id: (<Office.Message>this.mailbox.item).conversationId,\r\n                items: sameFolderItemIds.map(itemId => ({ itemId: itemId, conversation: this.conversation })),\r\n                global: otherFolderItemIds.map(itemId => ({ itemId: itemId, conversation: this.conversation }))\r\n            };\r\n\r\n            this.loadExcludedFolders();\r\n        }\r\n\r\n        private loadExcludedFolders() {\r\n            if (this.excludedFolders) {\r\n                this.loadMessages();\r\n            } else {\r\n                console.log('Getting the list of excluded folders');\r\n                this.onProgress(Data.Progress.GetExcludedFolders);\r\n\r\n                this.mailbox.makeEwsRequestAsync(RequestBuilder.excludedFolderIdsRequest, (result) => {\r\n                    if (!result.value) {\r\n                        this.onError(result.error.message);\r\n                        return;\r\n                    }\r\n\r\n                    let foldersXml = $.parseXML(result.value);\r\n                    let excludedFolders: FolderData[] = [];\r\n\r\n                    $(foldersXml.querySelectorAll('GetFolderResponseMessage > Folders > Folder > FolderId')).each(function () {\r\n                        var $this = $(this);\r\n                        excludedFolders.push({\r\n                            folderId: {\r\n                                id: $this.attr('Id'),\r\n                                changeKey: $this.attr('ChangeKey')\r\n                            }\r\n                        });\r\n                    });\r\n\r\n                    this.excludedFolders = excludedFolders;\r\n\r\n                    this.loadMessages();\r\n                });\r\n            }\r\n        }\r\n\r\n        private loadMessages() {\r\n            if (this.itemsXml) {\r\n                this.getMessages();\r\n            } else {\r\n                console.log(`Getting the messages in other folders: ${this.conversation.global.length}`);\r\n                this.onProgress(Data.Progress.GetConversation);\r\n\r\n                this.mailbox.makeEwsRequestAsync(RequestBuilder.getItemsRequest(this.conversation.global), (result) => {\r\n                    if (!result.value) {\r\n                        this.onError(result.error.message);\r\n                        return;\r\n                    }\r\n\r\n                    this.itemsXml = $.parseXML(result.value);\r\n                    this.getMessages();\r\n                });\r\n            }\r\n        }\r\n\r\n        private getMessages() {\r\n            let $messages = $(this.itemsXml.querySelectorAll('GetItemResponseMessage > Items > Message > ParentFolderId'));\r\n\r\n            this.excludedFolders.map(folder => {\r\n                $messages = $messages.filter(`[Id!=\"${folder.folderId.id}\"]`);\r\n            });\r\n\r\n            $messages = $messages.parent();\r\n\r\n            this.conversation.global.map(item => {\r\n                for (let i = 0; i < $messages.length; i++) {\r\n                    const msg = $messages[i];\r\n\r\n                    if (msg.querySelector(`ItemId[Id=\"${item.itemId.id}\"]`)) {\r\n                        let folderId = msg.querySelector('ParentFolderId');\r\n\r\n                        item.folder = {\r\n                            folderId: {\r\n                                id: folderId.getAttribute('Id'),\r\n                                changeKey: folderId.getAttribute('ChangeKey')\r\n                            }\r\n                        };\r\n                        item.from = msg.querySelector('Sender > Mailbox > Name').textContent;\r\n                        item.to = msg.querySelector('ToRecipients > Mailbox > Name').textContent;\r\n                        item.body = msg.querySelector('Body').textContent.slice(0, 200);\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n\r\n            this.loadFolderDisplayNames();\r\n        }\r\n\r\n        private loadFolderDisplayNames() {\r\n            if (this.folderNamesXml) {\r\n                this.getFolderDisplayNames();\r\n            } else {\r\n                let destinations: FolderData[] = [];\r\n\r\n                this.conversation.global.map(item => {\r\n                    if (item.folder) {\r\n                        destinations.push(item.folder);\r\n                    }\r\n                });\r\n\r\n                if (!destinations.length) {\r\n                    this.onLoadComplete([]);\r\n                    return;\r\n                }\r\n\r\n                console.log(`Getting the display names of the other folders: ${destinations.length}`);\r\n                this.onProgress(Data.Progress.GetFolderNames);\r\n\r\n                this.mailbox.makeEwsRequestAsync(RequestBuilder.getFolderNamesRequest(destinations), (result) => {\r\n                    if (!result.value) {\r\n                        this.onError(result.error.message);\r\n                        return;\r\n                    }\r\n\r\n                    this.folderNamesXml = $.parseXML(result.value);\r\n                    this.getFolderDisplayNames();\r\n                });\r\n            }\r\n        }\r\n\r\n        private getFolderDisplayNames() {\r\n            let matches: Data.Match[] = [];\r\n\r\n            this.conversation.global.map((item: MessageData) => {\r\n                if (!item.folder) {\r\n                    return;\r\n                }\r\n\r\n                const folder = this.folderNamesXml.querySelector(`GetFolderResponseMessage > Folders > Folder > FolderId[Id=\"${item.folder.folderId.id}\"]`).parentNode;\r\n                item.folder.displayName = (<Element>folder).querySelector('DisplayName').textContent;\r\n\r\n                matches.push({\r\n                    message: {\r\n                        Id: item.itemId.id,\r\n                        BodyPreview: item.body,\r\n                        Sender: item.from,\r\n                        ToRecipients: item.to,\r\n                        ParentFolderId: item.folder.folderId.id\r\n                    },\r\n                    folder: {\r\n                        Id: item.folder.folderId.id,\r\n                        DisplayName: item.folder.displayName\r\n                    }\r\n                });\r\n            });\r\n\r\n            console.log(`Finished loading items in other folders: ${matches.length}`);\r\n            this.onLoadComplete(matches);\r\n        }\r\n\r\n        moveItems(folderId: string, onMoveComplete: (count: number) => void, onError: (message: string) => void) {\r\n            this.onMoveComplete = onMoveComplete;\r\n            this.onError = onError;\r\n\r\n            console.log(`Moving items to folder: ${folderId}`);\r\n\r\n            this.mailbox.makeEwsRequestAsync(RequestBuilder.moveItemsRequest(this.conversation.items, folderId), (result) => {\r\n                if (!result.value) {\r\n                    this.onError(result.error.message);\r\n                    return;\r\n                }\r\n\r\n                console.log(`Finished moving items to other folder: ${this.conversation.items.length}`);\r\n                this.onMoveComplete(this.conversation.items.length);\r\n            });\r\n        }\r\n    }\r\n\r\n    export class Model implements Data.IModel {\r\n        private context?: Context;\r\n\r\n        constructor(mailbox: Office.Mailbox) {\r\n            this.context = new Context(mailbox);\r\n        }\r\n\r\n        getItemsAsync(onLoadComplete: (results: Data.Match[]) => void, onProgress: (progress: Data.Progress) => void, onError: (message: string) => void): void {\r\n            this.context.loadItems(onLoadComplete, onProgress, onError);\r\n        }\r\n\r\n        moveItemsAsync(folderId: string, onMoveComplete: (count: number) => void, onError: (message: string) => void): void {\r\n            this.context.moveItems(folderId, onMoveComplete, onError);\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Data/EWSData.ts","/// <reference path=\"../../node_modules/@types/office-js/index.d.ts\" />\r\n/// <reference path=\"../../node_modules/@types/jquery/index.d.ts\" />\r\n\r\nimport { Data } from \"./Model\";\r\n\r\nexport module RESTData {\r\n    const Endpoint = '/v2.0/me';\r\n\r\n    enum ExcludedFolders {\r\n        Inbox,\r\n        Drafts,\r\n        SentItems,\r\n        DeletedItems,\r\n\r\n        // Sentinel value for enumerating the folder names\r\n        Count\r\n    }\r\n\r\n    interface EmailAddressJson {\r\n        Name: string;\r\n        Address: string;\r\n    }\r\n\r\n    interface AddressJson {\r\n        EmailAddress: EmailAddressJson;\r\n    }\r\n\r\n    interface MessageJson {\r\n        Id: string;\r\n        BodyPreview: string;\r\n        Sender: AddressJson;\r\n        ToRecipients: AddressJson[];\r\n        ParentFolderId: string;\r\n    }\r\n\r\n    interface MessageJsonCollection {\r\n        value: MessageJson[];\r\n    }\r\n\r\n    interface FolderJson {\r\n        Id: string;\r\n        DisplayName?: string;\r\n    }\r\n\r\n    class Context {\r\n        constructor(private mailbox: Office.Mailbox) {\r\n        }\r\n\r\n        private token?: string;\r\n        private currentFolderId?: string;\r\n        private conversationMessages?: MessageJson[];\r\n        private excludedFolderIds?: string[];\r\n\r\n        private onLoadComplete?: (results: Data.Match[]) => void;\r\n        private onProgress?: (progress: Data.Progress) => void;\r\n        private onError?: (message: string) => void;\r\n        private onMoveComplete?: (count: number) => void\r\n\r\n        loadItems(onLoadComplete: (results: Data.Match[]) => void, onProgress: (progress: Data.Progress) => void, onError: (message: string) => void): void {\r\n            this.onLoadComplete = onLoadComplete;\r\n            this.onProgress = onProgress;\r\n            this.onError = onError;\r\n\r\n            console.log('Requesting the REST callback token...');\r\n            this.onProgress(Data.Progress.GetCallbackToken);\r\n\r\n            // Start the chain of requests by getting a callback token.\r\n            this.mailbox.getCallbackTokenAsync({ isRest: true },\r\n                (result: Office.AsyncResult) => {\r\n                    if (result.status === Office.AsyncResultStatus.Succeeded) {\r\n                        this.getConversation(result);\r\n                    } else {\r\n                        this.onError(result.error.message);\r\n                    }\r\n                });\r\n        }\r\n\r\n        // Sometimes we need to make separate REST requests for multiple items. Wait until they all complete and then\r\n        // invoke the callbacks all at once with an array of typed results.\r\n        private collateRequests<T>(requests: JQueryPromise<T>[], onDone: (results: T[]) => void, onFail: (message: string) => void): void {\r\n            if (requests.length > 1) {\r\n                $.when.apply($, requests)\r\n                    .done((...results: any[]) => {\r\n                        onDone(results.map(result => <T>result[0]));\r\n                    }).fail((message: string) => {\r\n                        this.onError(message);\r\n                    });\r\n            } else {\r\n                requests[0]\r\n                    .done((result: T) => {\r\n                        onDone([result]);\r\n                    }).fail((message: string) => {\r\n                        this.onError(message);\r\n                    });\r\n            }\r\n        }\r\n\r\n        // If we're on iOS, the IDs we get from Office.context.mailbox.item are already REST IDs. Otherwise we need\r\n        // to convert them from the EWS ID format to the REST ID format.\r\n        private getRestId(itemId: string) {\r\n            if (this.mailbox.diagnostics.hostName === 'OutlookIOS') {\r\n                return itemId;\r\n            }\r\n\r\n            return this.mailbox.convertToRestId(itemId, Office.MailboxEnums.RestVersion.v2_0);\r\n        }\r\n\r\n        // Send a REST request to retrieve a list of messages in this conversation.\r\n        private getConversation(result: Office.AsyncResult) {\r\n            this.token = <string>result.value;\r\n\r\n            const conversationId = (<Office.Message>this.mailbox.item).conversationId;\r\n            const restConversationId = this.getRestId(conversationId);\r\n            const restUrl = `${this.mailbox.restUrl}${Endpoint}/messages?$filter=ConversationId eq '${restConversationId}'&$select=Id,Subject,BodyPreview,Sender,ToRecipients,ParentFolderId`;\r\n\r\n            console.log(`Getting the list of items in the conversation: ${restUrl}`);\r\n            this.onProgress(Data.Progress.GetConversation);\r\n\r\n            $.ajax({\r\n                url: restUrl,\r\n                async: true,\r\n                dataType: 'json',\r\n                headers: { 'Authorization': `Bearer ${this.token}` }\r\n            }).done((result: MessageJsonCollection) => {\r\n                this.getExcludedFolders(result);\r\n            }).fail((message: string) => {\r\n                this.onError(message);\r\n            });\r\n        }\r\n\r\n        // Send a REST request to identify each of the folders we want to exclude in our results.\r\n        private getExcludedFolders(result: MessageJsonCollection) {\r\n            if (!result || !result.value || 0 === result.value.length) {\r\n                this.onLoadComplete([]);\r\n                return;\r\n            }\r\n\r\n            this.conversationMessages = result.value;\r\n\r\n            let currentFolderId: string;\r\n            let excludedFolderIds: string[] = [];\r\n\r\n            // We should ignore any messages in the same folder.\r\n            const itemId = (<Office.ItemRead>this.mailbox.item).itemId;\r\n            const restItemId = this.getRestId(itemId);\r\n\r\n            for (let i = 0; i < this.conversationMessages.length; ++i) {\r\n                if (this.conversationMessages[i].Id === restItemId) {\r\n                    currentFolderId = this.conversationMessages[i].ParentFolderId;\r\n                    excludedFolderIds.push(currentFolderId);\r\n                    break;\r\n                }\r\n            }\r\n\r\n            // We should also exclude some special folders, but we need to get their folderIds.\r\n            let requests: JQueryXHR[] = [];\r\n\r\n            for (let i = 0; i < ExcludedFolders.Count; ++i) {\r\n                const folderId = ExcludedFolders[i];\r\n                const restUrl = `${this.mailbox.restUrl}${Endpoint}/mailfolders/${folderId}?$select=Id`;\r\n\r\n                console.log(`Getting excluded folder ID: ${restUrl}`);\r\n\r\n                requests.push($.ajax({\r\n                    url: restUrl,\r\n                    async: true,\r\n                    dataType: 'json',\r\n                    headers: { 'Authorization': `Bearer ${this.token}` }\r\n                }));\r\n            }\r\n\r\n            this.onProgress(Data.Progress.GetExcludedFolders);\r\n\r\n            this.collateRequests(<JQueryPromise<FolderJson>[]>requests, (results) => {\r\n                results.map((value) => {\r\n                    excludedFolderIds.push(value.Id);\r\n                });\r\n\r\n                this.getFolderNames(currentFolderId, excludedFolderIds);\r\n            }, (message) => {\r\n                this.onError(message);\r\n            });\r\n        }\r\n\r\n        // Send REST requests to fill in the display names of all the folders we are not excluding.\r\n        private getFolderNames(currentFolderId: string, excludedFolderIds: string[]) {\r\n            let folderMap: {\r\n                folder: FolderJson;\r\n                messages: MessageJson[];\r\n            }[] = [];\r\n\r\n            this.conversationMessages.map((message: MessageJson) => {\r\n                for (let i = 0; i < excludedFolderIds.length; ++i) {\r\n                    if (excludedFolderIds[i] === message.ParentFolderId) {\r\n                        // Skip this message.\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                for (let i = 0; i < folderMap.length; ++i) {\r\n                    if (folderMap[i].folder.Id === message.ParentFolderId) {\r\n                        // Add this message to the existing entry.\r\n                        folderMap[i].messages.push(message);\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                // Create a new entry for this folder.\r\n                folderMap.push({ folder: { Id: message.ParentFolderId }, messages: [message] });\r\n            });\r\n\r\n            if (folderMap.length === 0) {\r\n                this.onLoadComplete([]);\r\n                return;\r\n            }\r\n\r\n            this.currentFolderId = currentFolderId;\r\n            this.excludedFolderIds = excludedFolderIds;\r\n\r\n            let requests = folderMap.map((entry) => {\r\n                const restUrl = `${this.mailbox.restUrl}${Endpoint}/mailfolders/${entry.folder.Id}?$select=Id,DisplayName`;\r\n\r\n                console.log(`Getting included folder name: ${restUrl}`);\r\n\r\n                return $.ajax({\r\n                    url: restUrl,\r\n                    async: true,\r\n                    dataType: 'json',\r\n                    headers: { 'Authorization': `Bearer ${this.token}` }\r\n                });\r\n            });\r\n\r\n            this.onProgress(Data.Progress.GetFolderNames);\r\n\r\n            this.collateRequests(<JQueryPromise<FolderJson>[]>requests, (results: FolderJson[]) => {\r\n                results.map((value) => {\r\n                    for (let i = 0; i < folderMap.length; ++i) {\r\n                        if (folderMap[i].folder.Id === value.Id) {\r\n                            folderMap[i].folder.DisplayName = value.DisplayName;\r\n                            break;\r\n                        }\r\n                    }\r\n                });\r\n\r\n                let matches: Data.Match[] = [];\r\n\r\n                folderMap.map((entry) => {\r\n                    entry.messages.map((message) => {\r\n                        matches.push({\r\n                            message: {\r\n                                Id: message.Id,\r\n                                BodyPreview: message.BodyPreview,\r\n                                Sender: message.Sender.EmailAddress.Name,\r\n                                ToRecipients: message.ToRecipients.map(address => address.EmailAddress.Name).join('; '),\r\n                                ParentFolderId: message.ParentFolderId\r\n                            },\r\n                            folder: {\r\n                                Id: entry.folder.Id,\r\n                                DisplayName: entry.folder.DisplayName\r\n                            }\r\n                        });\r\n                    });\r\n                });\r\n\r\n                console.log(`Finished loading items in other folders: ${matches.length}`);\r\n                this.onLoadComplete(matches);\r\n            }, (message: string) => {\r\n                this.onError(message);\r\n            });\r\n        }\r\n\r\n        moveItems(folderId: string, onMoveComplete: (count: number) => void, onError: (message: string) => void) {\r\n            this.onMoveComplete = onMoveComplete;\r\n            this.onError = onError;\r\n\r\n            console.log(`Moving items to folder: ${folderId}`);\r\n\r\n            let requests: JQueryXHR[] = [];\r\n\r\n            this.conversationMessages.map((message: MessageJson) => {\r\n                if (message.ParentFolderId !== this.currentFolderId) {\r\n                    // Skip any messages that are not in the current folder.\r\n                    return;\r\n                }\r\n\r\n                const restUrl = `${this.mailbox.restUrl}${Endpoint}/messages/${message.Id}/move`;\r\n\r\n                console.log(`Moving item: ${restUrl}`);\r\n\r\n                requests.push($.ajax({\r\n                    url: restUrl,\r\n                    async: true,\r\n                    method: 'POST',\r\n                    contentType: 'application/json',\r\n                    dataType: 'json',\r\n                    data: JSON.stringify({ DestinationId: folderId }),\r\n                    headers: { 'Authorization': `Bearer ${this.token}` }\r\n                }));\r\n            });\r\n\r\n            this.collateRequests(<JQueryPromise<MessageJson>[]>requests, (results: MessageJson[]) => {\r\n                console.log(`Finished moving items to other folder: ${results.length}`);\r\n                this.onMoveComplete(results.length);\r\n            }, (message: string) => {\r\n                this.onError(message);\r\n            });\r\n        }\r\n    }\r\n\r\n    export class Model implements Data.IModel {\r\n        private context?: Context;\r\n\r\n        constructor(mailbox: Office.Mailbox) {\r\n            this.context = new Context(mailbox);\r\n        }\r\n\r\n        getItemsAsync(onLoadComplete: (results: Data.Match[]) => void, onProgress: (progress: Data.Progress) => void, onError: (message: string) => void): void {\r\n            this.context.loadItems(onLoadComplete, onProgress, onError);\r\n        }\r\n\r\n        moveItemsAsync(folderId: string, onMoveComplete: (count: number) => void, onError: (message: string) => void): void {\r\n            this.context.moveItems(folderId, onMoveComplete, onError);\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Data/RESTData.ts","import * as React from \"react\";\r\n\r\nexport class Feedback extends React.Component<undefined, undefined> {\r\n    render() {\r\n        return (<div className=\"feedback\">\r\n            <a href=\"https://beandotnet.azurewebsites.net/\">about this app</a>\r\n            &nbsp;\r\n            <a href=\"mailto:wravery@hotmail.com?Subject=Conversation%20Filer%20v2.0%20App%20for%20Outlook\">send feedback</a>\r\n        </div>);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/components/Feedback.tsx","import * as React from \"react\";\r\n\r\nimport { Data } from \"../Data/Model\";\r\n\r\nimport { IColumn } from \"office-ui-fabric-react/lib/components/DetailsList/DetailsList.Props\";\r\nimport { DetailsList } from \"office-ui-fabric-react/lib/DetailsList\";\r\nimport { Link } from \"office-ui-fabric-react/lib/Link\";\r\n\r\nexport interface SearchResultsProps {\r\n    matches: Data.Match[];\r\n    onSelection: (folderId: string) => void;\r\n}\r\n\r\nexport class SearchResults extends React.Component<SearchResultsProps, undefined> {\r\n    constructor(props: SearchResultsProps) {\r\n        super(props);\r\n        this.onClickFolder = this.onClickFolder.bind(this);\r\n        this.onRenderLink = this.onRenderLink.bind(this);\r\n        this.onRenderColumn = this.onRenderColumn.bind(this);\r\n    }\r\n\r\n    render() {\r\n        if (!this.props.matches || this.props.matches.length === 0) {\r\n            return null;\r\n        }\r\n\r\n        const columns: IColumn[] = [{\r\n                key: 'DisplayName',\r\n                name: 'Folder',\r\n                fieldName: null,\r\n                onRender: this.onRenderLink,\r\n                minWidth: 5\r\n            }, {\r\n                key: 'Sender',\r\n                name: 'From',\r\n                fieldName: null,\r\n                onRender: this.onRenderColumn,\r\n                minWidth: 10\r\n            }, {\r\n                key: 'ToRecipients',\r\n                name: 'To',\r\n                fieldName: null,\r\n                onRender: this.onRenderColumn,\r\n                minWidth: 10\r\n            }, {\r\n                key: 'BodyPreview',\r\n                name: 'Preview',\r\n                fieldName: null,\r\n                onRender: this.onRenderColumn,\r\n                minWidth: 50\r\n            }];\r\n\r\n        return (<div>\r\n            <h3>\r\n                I found some items in this conversation filed in other folders. Click on one of the folders listed here to\r\n                automatically reunite this part of the conversation with the ones that came before:\r\n            </h3>\r\n            <DetailsList columns={columns} items={this.props.matches} />\r\n        </div>);\r\n    }\r\n\r\n    private onClickFolder(evt: React.MouseEvent<HTMLAnchorElement>) {\r\n        this.props.onSelection(evt.currentTarget.href);\r\n        evt.preventDefault();\r\n    }\r\n\r\n    private onRenderLink(item: Data.Match) {\r\n        return <Link onClick={this.onClickFolder} name={item.folder.Id}>{item.folder.DisplayName}</Link>;\r\n    }\r\n\r\n    private onRenderColumn(item: Data.Match, index: number, column: IColumn) {\r\n        return (item.message as any)[column.key] as string;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/SearchResults.tsx","import * as React from \"react\";\r\n\r\nimport { Data } from \"../Data/Model\";\r\n\r\nexport interface StatusMessageProps {\r\n    progress: Data.Progress;\r\n    message?: string;\r\n}\r\n\r\nexport class StatusMessage extends React.Component<StatusMessageProps, undefined> {\r\n    render() {\r\n        let className: string;\r\n        let status: string;\r\n\r\n        switch (this.props.progress) {\r\n            case Data.Progress.GetCallbackToken:\r\n            case Data.Progress.GetConversation:\r\n            case Data.Progress.GetExcludedFolders:\r\n            case Data.Progress.GetFolderNames:\r\n                return <h3>Looking for other messages in this conversation...</h3>;\r\n\r\n            case Data.Progress.Success:\r\n                return null;\r\n\r\n            case Data.Progress.NotFound:\r\n                return <h3>It looks like you haven't filed this conversation anywhere before.</h3>;\r\n\r\n            default:\r\n                return (<div>\r\n                    <h3>Sorry, I couldn't figure out where this message should go. :(</h3>\r\n                    <span>{this.props.message}</span>\r\n                </div>);\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/StatusMessage.tsx","import * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\n\r\nimport { Pages } from \"./pages\";\r\nimport { AppFunctions } from \"./functions\";\r\n\r\nimport { ConversationFiler } from \"./components/ConversationFiler\";\r\n\r\nOffice.initialize = function () {\r\n    if (Pages.shouldHaveUI()) {\r\n        // Show the UI...\r\n        const params = Pages.getUIParameters();\r\n\r\n        ReactDOM.render(\r\n            <ConversationFiler mailbox={params.mailbox} onComplete={params.onComplete} storedResults={params.storedResults} />,\r\n            document.getElementById(\"conversationFilerRoot\")\r\n        );\r\n    } else {\r\n        AppFunctions.register();\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.tsx","import { EventGroup } from './EventGroup';\r\nimport { findScrollableParent } from './scroll';\r\nimport { getRect } from './dom';\r\nimport { IRectangle } from './IRectangle';\r\n\r\ndeclare function setTimeout(cb: Function, delay: number): number;\r\n\r\nconst SCROLL_ITERATION_DELAY = 16;\r\nconst SCROLL_GUTTER_HEIGHT = 100;\r\nconst MAX_SCROLL_VELOCITY = 15;\r\n\r\n/**\r\n * AutoScroll simply hooks up mouse events given a parent element, and scrolls the container\r\n * up/down depending on how close the mouse is to the top/bottom of the container.\r\n *\r\n * Once you don't want autoscroll any more, just dispose the helper and it will unhook events.\r\n */\r\nexport class AutoScroll {\r\n  private _events: EventGroup;\r\n  private _scrollableParent: HTMLElement;\r\n  private _scrollRect: IRectangle;\r\n  private _scrollVelocity: number;\r\n  private _timeoutId: number;\r\n\r\n  constructor(element: HTMLElement) {\r\n    this._events = new EventGroup(this);\r\n    this._scrollableParent = findScrollableParent(element);\r\n\r\n    this._incrementScroll = this._incrementScroll.bind(this);\r\n    this._scrollRect = getRect(this._scrollableParent);\r\n\r\n    if (this._scrollableParent === window as any) {\r\n      this._scrollableParent = document.body;\r\n    }\r\n\r\n    if (this._scrollableParent) {\r\n      this._events.on(window, 'mousemove', this._onMouseMove, true);\r\n      this._events.on(window, 'touchmove', this._onTouchMove, true);\r\n    }\r\n  }\r\n\r\n  public dispose() {\r\n    this._events.dispose();\r\n    this._stopScroll();\r\n  }\r\n\r\n  private _onMouseMove(ev: MouseEvent) {\r\n    this._computeScrollVelocity(ev.clientY);\r\n  }\r\n\r\n  private _onTouchMove(ev: TouchEvent) {\r\n    if (ev.touches.length > 0) {\r\n      this._computeScrollVelocity(ev.touches[0].clientY);\r\n    }\r\n  }\r\n\r\n  private _computeScrollVelocity(clientY: number) {\r\n    let scrollRectTop = this._scrollRect.top;\r\n    let scrollClientBottom = scrollRectTop + this._scrollRect.height - SCROLL_GUTTER_HEIGHT;\r\n\r\n    if (clientY < (scrollRectTop + SCROLL_GUTTER_HEIGHT)) {\r\n      this._scrollVelocity = Math.max(\r\n        -MAX_SCROLL_VELOCITY,\r\n        -MAX_SCROLL_VELOCITY * ((SCROLL_GUTTER_HEIGHT - (clientY - scrollRectTop)) / SCROLL_GUTTER_HEIGHT\r\n        ));\r\n    } else if (clientY > scrollClientBottom) {\r\n      this._scrollVelocity = Math.min(\r\n        MAX_SCROLL_VELOCITY,\r\n        MAX_SCROLL_VELOCITY * ((clientY - scrollClientBottom) / SCROLL_GUTTER_HEIGHT\r\n        ));\r\n    } else {\r\n      this._scrollVelocity = 0;\r\n    }\r\n\r\n    if (this._scrollVelocity) {\r\n      this._startScroll();\r\n    } else {\r\n      this._stopScroll();\r\n    }\r\n  }\r\n\r\n  private _startScroll() {\r\n    if (!this._timeoutId) {\r\n      this._incrementScroll();\r\n    }\r\n  }\r\n\r\n  private _incrementScroll() {\r\n    this._scrollableParent.scrollTop += Math.round(this._scrollVelocity);\r\n    this._timeoutId = setTimeout(this._incrementScroll, SCROLL_ITERATION_DELAY);\r\n  }\r\n\r\n  private _stopScroll() {\r\n    if (this._timeoutId) {\r\n      clearTimeout(this._timeoutId);\r\n      delete this._timeoutId;\r\n    }\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ../src/AutoScroll.ts","import * as React from 'react';\r\nimport { Async } from './Async';\r\nimport { EventGroup } from './EventGroup';\r\nimport { IDisposable } from './IDisposable';\r\n\r\nexport class BaseComponent<P, S> extends React.Component<P, S> {\r\n  /**\r\n   * External consumers should override BaseComponent.onError to hook into error messages that occur from\r\n   * exceptions thrown from within components.\r\n   */\r\n  public static onError: ((errorMessage?: string, ex?: any) => void);\r\n\r\n  private __async: Async;\r\n  private __events: EventGroup;\r\n  private __disposables: IDisposable[];\r\n  private __resolves: { [name: string]: (ref: any) => any };\r\n\r\n  /**\r\n   * BaseComponent constructor\r\n   * @param {P} props The props for the component.\r\n   * @param {Object} deprecatedProps The map of deprecated prop names to new names, where the key is the old name and the\r\n   * value is the new name. If a prop is removed rather than renamed, leave the value undefined.\r\n   */\r\n  constructor(props?: P, deprecatedProps?: { [propName: string]: string }) {\r\n    super(props);\r\n\r\n    if (deprecatedProps) {\r\n      for (let propName in deprecatedProps) {\r\n        if (propName in props) {\r\n          _warnDeprecation(this, propName, deprecatedProps[propName]);\r\n        }\r\n      }\r\n    }\r\n\r\n    _makeAllSafe(this, BaseComponent.prototype, [\r\n      'componentWillMount',\r\n      'componentDidMount',\r\n      'shouldComponentUpdate',\r\n      'componentWillUpdate',\r\n      'componentWillReceiveProps',\r\n      'render',\r\n      'componentDidUpdate',\r\n      'componentWillUnmount'\r\n    ]);\r\n  }\r\n\r\n  /** If we have disposables, dispose them automatically on unmount. */\r\n  public componentWillUnmount() {\r\n    if (this.__disposables) {\r\n      for (let i = 0, len = this._disposables.length; i < len; i++) {\r\n        let disposable = this.__disposables[i];\r\n\r\n        if (disposable.dispose) {\r\n          disposable.dispose();\r\n        }\r\n      }\r\n      this.__disposables = null;\r\n    }\r\n  }\r\n\r\n  /** Gets the object's class name. */\r\n  public get className() {\r\n    let funcNameRegex = /function (.{1,})\\(/;\r\n    let results = (funcNameRegex).exec((this).constructor.toString());\r\n\r\n    return (results && results.length > 1) ? results[1] : '';\r\n  }\r\n\r\n  /** Allows subclasses to push things to this._disposables to be auto disposed. */\r\n  protected get _disposables(): IDisposable[] {\r\n    if (!this.__disposables) {\r\n      this.__disposables = [];\r\n    }\r\n    return this.__disposables;\r\n  }\r\n\r\n  /**\r\n   * Gets the async instance associated with the component, created on demand. The async instance gives\r\n   * subclasses a way to execute setTimeout/setInterval async calls safely, where the callbacks\r\n   * will be cleared/ignored automatically after unmounting. The helpers within the async object also\r\n   * preserve the this pointer so that you don't need to \"bind\" the callbacks.\r\n   */\r\n  protected get _async(): Async {\r\n    if (!this.__async) {\r\n      this.__async = new Async(this);\r\n      this._disposables.push(this.__async);\r\n    }\r\n\r\n    return this.__async;\r\n  }\r\n\r\n  /**\r\n   * Gets the event group instance assocaited with the component, created on demand. The event instance\r\n   * provides on/off methods for listening to DOM (or regular javascript object) events. The event callbacks\r\n   * will be automatically disconnected after unmounting. The helpers within the events object also\r\n   * preserve the this reference so that you don't need to \"bind\" the callbacks.\r\n   */\r\n  protected get _events(): EventGroup {\r\n    if (!this.__events) {\r\n      this.__events = new EventGroup(this);\r\n      this._disposables.push(this.__events);\r\n    }\r\n\r\n    return this.__events;\r\n  }\r\n\r\n  /**\r\n   * Helper to return a memoized ref resolver function.\r\n   * @params refName Name of the member to assign the ref to.\r\n   *\r\n   * @examples\r\n   * class Foo extends BaseComponent<...> {\r\n   *   private _root: HTMLElement;\r\n   *\r\n   *   public render() {\r\n   *     return <div ref={ this._resolveRef('_root') } />\r\n   *   }\r\n   * }\r\n   */\r\n  protected _resolveRef(refName: string) {\r\n    if (!this.__resolves) {\r\n      this.__resolves = {};\r\n    }\r\n    if (!this.__resolves[refName]) {\r\n      this.__resolves[refName] = (ref) => {\r\n        return this[refName] = ref;\r\n      };\r\n    }\r\n    return this.__resolves[refName];\r\n  }\r\n}\r\n\r\n/**\r\n * Helper to override a given method with a wrapper method that can try/catch the original, but also\r\n * ensures that the BaseComponent's methods are called before the subclass's. This ensures that\r\n * componentWillUnmount in the base is called and that things in the _disposables array are disposed.\r\n */\r\nfunction _makeAllSafe(obj: BaseComponent<any, any>, prototype: Object, methodNames: string[]) {\r\n  for (let i = 0, len = methodNames.length; i < len; i++) {\r\n    _makeSafe(obj, prototype, methodNames[i]);\r\n  }\r\n}\r\n\r\nfunction _makeSafe(obj: BaseComponent<any, any>, prototype: Object, methodName: string) {\r\n  let classMethod = obj[methodName];\r\n  let prototypeMethod = prototype[methodName];\r\n\r\n  if (classMethod || prototypeMethod) {\r\n    obj[methodName] = function () {\r\n      let retVal;\r\n\r\n      try {\r\n        if (prototypeMethod) {\r\n          retVal = prototypeMethod.apply(this, arguments);\r\n        }\r\n        if (classMethod) {\r\n          retVal = classMethod.apply(this, arguments);\r\n        }\r\n      } catch (e) {\r\n        const errorMessage = `Exception in ${obj.className}.${methodName}(): ${typeof e === 'string' ? e : e.stack}`;\r\n\r\n        if (BaseComponent.onError) {\r\n          BaseComponent.onError(errorMessage, e);\r\n        }\r\n      }\r\n\r\n      return retVal;\r\n    };\r\n  }\r\n}\r\n\r\nfunction _warnDeprecation(obj: BaseComponent<any, any>, propertyName: string, newPropertyName: string) {\r\n  if (console && console.warn) {\r\n    let deprecationMessage = `${obj.className} property '${propertyName}' was used but has been deprecated.`;\r\n\r\n    if (newPropertyName) {\r\n      deprecationMessage += ` Use '${newPropertyName}' instead.`;\r\n    }\r\n\r\n    console.warn(deprecationMessage);\r\n  }\r\n}\r\n\r\nBaseComponent.onError = (errorMessage) => {\r\n  console.error(errorMessage);\r\n  throw errorMessage;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/BaseComponent.ts","import * as React from 'react';\r\n\r\nexport interface IDelayedRenderProps extends React.Props<any> {\r\n  /**\r\n   * Number of milliseconds to delay rendering children.\r\n   * @default 0\r\n   */\r\n  delay?: number;\r\n}\r\n\r\nexport interface IDelayedRenderState {\r\n  /**\r\n   * Whether the component is rendered or not.\r\n   */\r\n  isRendered: boolean;\r\n}\r\n\r\n/**\r\n * Utility component for delaying the render of a child component after a given delay. This component\r\n * requires a single child component; don't pass in many components. Wrap multiple components in a DIV\r\n * if necessary.\r\n *\r\n * @example\r\n * <DelayedRender delay={ 3000 }>\r\n *  <div className='foo-List-loadingSpinner'>\r\n *    <p>I am loading</p>\r\n *    <Spinner />\r\n *  </div>\r\n * </DelayedRender>\r\n */\r\nexport class DelayedRender extends React.Component<IDelayedRenderProps, IDelayedRenderState> {\r\n  public static defaultProps = {\r\n    delay: 0\r\n  };\r\n\r\n  private _timeoutId;\r\n\r\n  constructor(props: IDelayedRenderProps) {\r\n    super(props);\r\n    this.state = {\r\n      isRendered: false\r\n    };\r\n  }\r\n\r\n  public componentDidMount() {\r\n    let { delay } = this.props;\r\n    this._timeoutId = setTimeout(() => {\r\n      this.setState({\r\n        isRendered: true\r\n      });\r\n    }, delay);\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    clearTimeout(this._timeoutId);\r\n  }\r\n\r\n  public render() {\r\n    return this.state.isRendered ? React.Children.only(this.props.children) : null;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/DelayedRender.tsx","export class Rectangle {\r\n  public top: number;\r\n  public bottom: number;\r\n  public left: number;\r\n  public right: number;\r\n\r\n  constructor(left: number = 0, right: number = 0, top: number = 0, bottom: number = 0) {\r\n    this.top = top;\r\n    this.bottom = bottom;\r\n    this.left = left;\r\n    this.right = right;\r\n  }\r\n\r\n  /**\r\n   * Calculated automatically by subtracting the right from left\r\n   */\r\n  get width(): number {\r\n    return this.right - this.left;\r\n  }\r\n\r\n  /**\r\n   * Calculated automatically by subtracting the bottom from top.\r\n   */\r\n  get height(): number {\r\n    return this.bottom - this.top;\r\n  }\r\n\r\n  /**\r\n   * Tests if another rect is approximately equal to this rect (within 4 decimal places.)\r\n   */\r\n  public equals(rect: Rectangle): boolean {\r\n    // I'm fixing it to 4 decimal places because it allows enough precision and will handle cases when something should be rounded,\r\n    // like .999999 should round to 1.\r\n    return (\r\n      parseFloat(this.top.toFixed(4)) === parseFloat(rect.top.toFixed(4)) &&\r\n      parseFloat(this.bottom.toFixed(4)) === parseFloat(rect.bottom.toFixed(4)) &&\r\n      parseFloat(this.left.toFixed(4)) === parseFloat(rect.left.toFixed(4)) &&\r\n      parseFloat(this.right.toFixed(4)) === parseFloat(rect.right.toFixed(4))\r\n    );\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ../src/Rectangle.ts","export function findIndex(array: any[], cb: (item: any, index?: number) => boolean): number {\r\n  let index = -1;\r\n\r\n  for (let i = 0; array && i < array.length; i++) {\r\n    if (cb(array[i], i)) {\r\n      index = i;\r\n      break;\r\n    }\r\n  }\r\n\r\n  return index;\r\n}\r\n\r\nexport function createArray(size: number, getItem?: (index?: number) => any) {\r\n  let array = [];\r\n\r\n  for (let i = 0; i < size; i++) {\r\n    array.push(getItem(i));\r\n  }\r\n\r\n  return array;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/array.ts","/**\r\n * Autobind is a utility for binding methods in a class. This simplifies tagging methods as being \"bound\" to the this pointer\r\n * so that they can be used in scenarios that simply require a function callback.\r\n *\r\n * @example\r\n * import { autobind } from '../utilities/autobind';\r\n *\r\n * public class Foo {\r\n *   @autobind\r\n *   method() {\r\n *   }\r\n * }\r\n */\r\nexport function autobind<T extends Function>(target: any, key: string, descriptor: TypedPropertyDescriptor<T>) {\r\n  let fn = descriptor.value;\r\n\r\n  let defining = false;\r\n\r\n  return {\r\n    configurable: true,\r\n\r\n    get() {\r\n      if (defining || this === fn.prototype || this.hasOwnProperty(key)) {\r\n        return fn;\r\n      }\r\n\r\n      // Bind method only once, and update the property to return the bound value from now on\r\n      let fnBound = fn.bind(this);\r\n\r\n      defining = true;\r\n      Object.defineProperty(this, key, {\r\n        configurable: true,\r\n        writable: true,\r\n        enumerable: true,\r\n        value: fnBound\r\n      });\r\n      defining = false;\r\n\r\n      return fnBound;\r\n    },\r\n\r\n    set(newValue) {\r\n      Object.defineProperty(this, key, {\r\n        configurable: true,\r\n        writable: true,\r\n        enumerable: true,\r\n        value: newValue\r\n      });\r\n    }\r\n  };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/autobind.ts","\r\nexport interface ICssMapping {\r\n  [className: string]: boolean;\r\n}\r\n\r\nexport type ICssInput = string | ICssMapping | null | undefined | boolean;\r\n\r\nexport function css(...args: ICssInput[]) {\r\n  let classes = [];\r\n\r\n  for (let arg of args) {\r\n    if (arg) {\r\n      if (typeof arg === 'string') {\r\n        classes.push(arg);\r\n      } else {\r\n        for (let key in arg as any) {\r\n          if (arg[key]) {\r\n            classes.push(key);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return classes.join(' ');\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/css.ts","/* tslint:disable:no-string-literal */\r\n\r\nimport { elementContains, getDocument } from './dom';\r\n\r\nconst IS_FOCUSABLE_ATTRIBUTE = 'data-is-focusable';\r\nconst IS_VISIBLE_ATTRIBUTE = 'data-is-visible';\r\nconst FOCUSZONE_ID_ATTRIBUTE = 'data-focuszone-id';\r\n\r\nexport function getFirstFocusable(\r\n  rootElement: HTMLElement,\r\n  currentElement: HTMLElement,\r\n  includeElementsInFocusZones?: boolean): HTMLElement {\r\n\r\n  return getNextElement(rootElement, currentElement, true, false, false, includeElementsInFocusZones);\r\n}\r\n\r\nexport function getLastFocusable(\r\n  rootElement: HTMLElement,\r\n  currentElement: HTMLElement,\r\n  includeElementsInFocusZones?: boolean): HTMLElement {\r\n\r\n  return getPreviousElement(rootElement, currentElement, true, false, true, includeElementsInFocusZones);\r\n}\r\n\r\n/**\r\n * Attempts to focus the first focusable element that is a child or child's child of the rootElement.\r\n * @return True if focus was set, false if it was not.\r\n * @param {HTMLElement} rootElement - element to start the search for a focusable child.\r\n */\r\nexport function focusFirstChild(\r\n  rootElement: HTMLElement): boolean {\r\n  let element: HTMLElement = getNextElement(rootElement, rootElement, true, false, false, true);\r\n\r\n  if (element) {\r\n    element.focus();\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\n/** Traverse to find the previous element. */\r\nexport function getPreviousElement(\r\n  rootElement: HTMLElement,\r\n  currentElement: HTMLElement,\r\n  checkNode?: boolean,\r\n  suppressParentTraversal?: boolean,\r\n  traverseChildren?: boolean,\r\n  includeElementsInFocusZones?: boolean): HTMLElement {\r\n\r\n  if (!currentElement ||\r\n    currentElement === rootElement) {\r\n    return null;\r\n  }\r\n\r\n  let isCurrentElementVisible = isElementVisible(currentElement);\r\n\r\n  // Check its children.\r\n  if (traverseChildren && (includeElementsInFocusZones || !isElementFocusZone(currentElement)) && isCurrentElementVisible) {\r\n    const childMatch = getPreviousElement(\r\n      rootElement,\r\n      currentElement.lastElementChild as HTMLElement,\r\n      true,\r\n      true,\r\n      true,\r\n      includeElementsInFocusZones);\r\n\r\n    if (childMatch) {\r\n      return childMatch;\r\n    }\r\n  }\r\n\r\n  // Check the current node, if it's not the first traversal.\r\n  if (checkNode && isCurrentElementVisible && isElementTabbable(currentElement)) {\r\n    return currentElement;\r\n  }\r\n\r\n  // Check its previous sibling.\r\n  const siblingMatch = getPreviousElement(\r\n    rootElement,\r\n    currentElement.previousElementSibling as HTMLElement,\r\n    true,\r\n    true,\r\n    true,\r\n    includeElementsInFocusZones);\r\n\r\n  if (siblingMatch) {\r\n    return siblingMatch;\r\n  }\r\n\r\n  // Check its parent.\r\n  if (!suppressParentTraversal) {\r\n    return getPreviousElement(rootElement, currentElement.parentElement, true, false, false, includeElementsInFocusZones);\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/** Traverse to find the next focusable element. */\r\nexport function getNextElement(\r\n  rootElement: HTMLElement,\r\n  currentElement: HTMLElement,\r\n  checkNode?: boolean,\r\n  suppressParentTraversal?: boolean,\r\n  suppressChildTraversal?: boolean,\r\n  includeElementsInFocusZones?: boolean): HTMLElement {\r\n\r\n  if (\r\n    !currentElement ||\r\n    (currentElement === rootElement && suppressChildTraversal)) {\r\n    return null;\r\n  }\r\n\r\n  let isCurrentElementVisible = isElementVisible(currentElement);\r\n\r\n  // Check the current node, if it's not the first traversal.\r\n  if (checkNode && isCurrentElementVisible && isElementTabbable(currentElement)) {\r\n    return currentElement;\r\n  }\r\n\r\n  // Check its children.\r\n  if (!suppressChildTraversal && isCurrentElementVisible && (includeElementsInFocusZones || !isElementFocusZone(currentElement))) {\r\n    const childMatch = getNextElement(\r\n      rootElement,\r\n      currentElement.firstElementChild as HTMLElement,\r\n      true,\r\n      true,\r\n      false,\r\n      includeElementsInFocusZones);\r\n\r\n    if (childMatch) {\r\n      return childMatch;\r\n    }\r\n  }\r\n\r\n  if (currentElement === rootElement) {\r\n    return null;\r\n  }\r\n\r\n  // Check its sibling.\r\n  const siblingMatch = getNextElement(\r\n    rootElement,\r\n    currentElement.nextElementSibling as HTMLElement,\r\n    true,\r\n    true,\r\n    false,\r\n    includeElementsInFocusZones);\r\n\r\n  if (siblingMatch) {\r\n    return siblingMatch;\r\n  }\r\n\r\n  if (!suppressParentTraversal) {\r\n    return getNextElement(rootElement, currentElement.parentElement, false, false, true, includeElementsInFocusZones);\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nexport function isElementVisible(element: HTMLElement): boolean {\r\n  // If the element is not valid, return false.\r\n  if (!element || !element.getAttribute) {\r\n    return false;\r\n  }\r\n\r\n  const visibilityAttribute = element.getAttribute(IS_VISIBLE_ATTRIBUTE);\r\n\r\n  // If the element is explicitly marked with the visibility attribute, return that value as boolean.\r\n  if (visibilityAttribute !== null && visibilityAttribute !== undefined) {\r\n    return visibilityAttribute === 'true';\r\n  }\r\n\r\n  // Fallback to other methods of determining actual visibility.\r\n  return (element.offsetHeight !== 0 ||\r\n    element.offsetParent !== null ||\r\n    (element as any).isVisible === true); // used as a workaround for testing.\r\n}\r\n\r\nexport function isElementTabbable(element: HTMLElement): boolean {\r\n\r\n  // If this element is null or is disabled, it is not considered tabbable.\r\n  if (!element || (element as HTMLButtonElement).disabled) {\r\n    return false;\r\n  }\r\n\r\n  // In IE, element.tabIndex is default to 0. We need to use element get tabIndex attribute to get the correct tabIndex\r\n  let tabIndex = -1;\r\n\r\n  if (element && element.getAttribute) {\r\n    tabIndex = parseInt(element.getAttribute('tabIndex'), 10);\r\n  }\r\n\r\n  let isFocusableAttribute: string = element.getAttribute ? element.getAttribute(IS_FOCUSABLE_ATTRIBUTE) : null;\r\n\r\n  return (\r\n    !!element && isFocusableAttribute !== 'false' &&\r\n    (element.tagName === 'A' ||\r\n      (element.tagName === 'BUTTON') ||\r\n      (element.tagName === 'INPUT') ||\r\n      (element.tagName === 'TEXTAREA') ||\r\n      (tabIndex >= 0) ||\r\n      (element.getAttribute && (\r\n        isFocusableAttribute === 'true' ||\r\n        element.getAttribute('role') === 'button'\r\n      ))\r\n    ));\r\n}\r\n\r\nexport function isElementFocusZone(element?: HTMLElement): boolean {\r\n  return element && !!element.getAttribute(FOCUSZONE_ID_ATTRIBUTE);\r\n}\r\n\r\nexport function doesElementContainFocus(element: HTMLElement) {\r\n  let currentActiveElement: HTMLElement = getDocument(element).activeElement as HTMLElement;\r\n  if (currentActiveElement && elementContains(element, currentActiveElement)) {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/focus.ts","const REACT_LIFECYCLE_EXCLUSIONS = [\r\n  'setState',\r\n  'render',\r\n  'componentWillMount',\r\n  'componentDidMount',\r\n  'componentWillReceiveProps',\r\n  'shouldComponentUpdate',\r\n  'componentWillUpdate',\r\n  'componentDidUpdate',\r\n  'componentWillUnmount'\r\n];\r\n\r\n/**\r\n * Allows you to hoist methods, except those in an exclusion set from a source object into a destination object.\r\n * @param destination The instance of the object to hoist the methods onto.\r\n * @param source The instance of the object where the methods are hoisted from.\r\n * @param exclusions (Optional) What methods to exclude from being hoisted.\r\n * @returns {string[]} An array of names of methods that were hoisted.\r\n */\r\nexport function hoistMethods(destination, source, exclusions: string[] = REACT_LIFECYCLE_EXCLUSIONS): string[] {\r\n  let hoisted: string[] = [];\r\n  for (let methodName in source) {\r\n    if (\r\n      typeof source[methodName] === 'function' &&\r\n      destination[methodName] === undefined &&\r\n      (!exclusions || exclusions.indexOf(methodName) === -1)\r\n    ) {\r\n      hoisted.push(methodName);\r\n      /* tslint:disable:no-function-expression */\r\n      destination[methodName] = function () { source[methodName].apply(source, arguments); };\r\n      /* tslint:enable */\r\n    }\r\n  }\r\n\r\n  return hoisted;\r\n}\r\n\r\n/**\r\n * Provides a method for convenience to unhoist hoisted methods.\r\n * @param {any} source The source object upon which methods were hoisted.\r\n * @param {string[]} methodNames An array of method names to unhoist.\r\n */\r\nexport function unhoistMethods(source: any, methodNames: string[]): void {\r\n  methodNames\r\n    .forEach((methodName) => delete source[methodName]);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/hoist.ts","export * from './Async';\r\nexport * from './AutoScroll';\r\nexport * from './BaseComponent';\r\nexport * from './DelayedRender';\r\nexport * from './EventGroup';\r\nexport * from './IDisposable';\r\nexport * from './IPoint';\r\nexport * from './IRectangle';\r\nexport * from './IRenderFunction';\r\nexport * from './KeyCodes';\r\nexport * from './Rectangle';\r\nexport * from './array';\r\nexport * from './autobind';\r\nexport * from './css';\r\nexport * from './dom';\r\nexport * from './focus';\r\nexport * from './hoist';\r\nexport * from './initials';\r\nexport * from './math';\r\nexport * from './object';\r\nexport * from './properties';\r\nexport * from './resources';\r\nexport * from './rtl';\r\nexport * from './scroll';\r\nexport * from './string';\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/index.ts","/** Regex to detect words within paraenthesis in a string where gi implies global and case-insensitive. */\r\nconst CHARS_WITHIN_PARENTHESIS_REGEX: RegExp = new RegExp('\\\\(([^)]*)\\\\)', 'gi');\r\n\r\n/**\r\n *  Matches any non-word characters with respect to the Unicode codepoints; generated by\r\n * https://mothereff.in/regexpu for regex /\\W /u where u stands for Unicode support (ES6 feature).\r\n * More info here: http://stackoverflow.com/questions/280712/javascript-unicode-regexes.\r\n * gi implies global and case-insensitive.\r\n */\r\n/* tslint:disable:max-line-length */\r\nconst UNICODE_ALPHANUMERIC_CHARS_REGEX =\r\n  new RegExp(\r\n    '(?:[\\0-/:-@\\[-\\^`\\{-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]) ',\r\n    'gi');\r\n/* tslint:enable:max-line-length */\r\n\r\n/** Regex to detect multiple spaces in a string where gi implies global and case-insensitive. */\r\nconst MULTIPLE_WHITESPACES_REGEX_TOKEN: RegExp = new RegExp('\\\\s+', 'gi');\r\n\r\n/** Regex to detect Arabic text. */\r\nconst ARABIC_LANGUAGE_REGEX = new RegExp('[\\u0621-\\u064A\\u0660-\\u0669]');\r\n\r\n/** Regex to detect Korean text. */\r\nconst KOREAN_LANGUAGE_REGEX = new RegExp('[\\u1100-\\u11FF|\\u3130-\\u318F|\\uA960-\\uA97F|\\uAC00-\\uD7AF|\\uD7B0-\\uD7FF]');\r\n\r\n/** Regex to detect Chinese text. */\r\n/* tslint:disable:max-line-length */\r\nconst CHINESE_LANGUAGE_REGEX = new RegExp('[\\u4E00-\\u9FCC\\u3400-\\u4DB5\\uFA0E\\uFA0F\\uFA11\\uFA13\\uFA14\\uFA1F\\uFA21\\uFA23\\uFA24\\uFA27-\\uFA29]|[\\ud840-\\ud868][\\udc00-\\udfff]|\\ud869[\\udc00-\\uded6\\udf00-\\udfff]|[\\ud86a-\\ud86c][\\udc00-\\udfff]|\\ud86d[\\udc00-\\udf34\\udf40-\\udfff]|\\ud86e[\\udc00-\\udc1d]');\r\n/* tslint:enable:max-line-length */\r\n\r\nfunction getInitialsArabic(displayName: string, isRtl: boolean): string {\r\n  const name = displayName.replace(/\\s/, '');\r\n\r\n  return isRtl ? name[name.length - 1] : name[0];\r\n}\r\n\r\nfunction getInitialsAsian(displayName: string, isRtl: boolean): string {\r\n  const name = displayName.replace(/\\s/, '');\r\n\r\n  // For short names, only display a single character of the family name\r\n  if (name.length <= 2) {\r\n    return isRtl ? name[0] : name[name.length - 1];\r\n  }\r\n\r\n  // For long names, display the two most significant characters of the family name\r\n  return isRtl ? name.substr(0, 2) : name.substr(name.length - 2, name.length);\r\n}\r\n\r\nfunction getInitialsLatin(displayName: string, isRtl: boolean): string {\r\n  let initials = '';\r\n\r\n  const splits: string[] = displayName.split(' ');\r\n\r\n  if (splits.length === 2) {\r\n    initials += splits[0].charAt(0).toUpperCase();\r\n    initials += splits[1].charAt(0).toUpperCase();\r\n  } else if (splits.length === 3) {\r\n    initials += splits[0].charAt(0).toUpperCase();\r\n    initials += splits[2].charAt(0).toUpperCase();\r\n  } else if (splits.length !== 0) {\r\n    initials += splits[0].charAt(0).toUpperCase();\r\n  }\r\n\r\n  if (isRtl && initials.length > 1) {\r\n    return initials.charAt(1) + initials.charAt(0);\r\n  }\r\n\r\n  return initials;\r\n}\r\n\r\nfunction cleanupDisplayName(displayName: string): string {\r\n  // Do not consider the suffixes within parenthesis while computing the initials.\r\n  displayName = displayName.replace(CHARS_WITHIN_PARENTHESIS_REGEX, '');\r\n\r\n  // Ignore non-word characters\r\n  displayName = displayName.replace(UNICODE_ALPHANUMERIC_CHARS_REGEX, '');\r\n\r\n  // Make whitespace consistent\r\n  displayName = displayName.replace(MULTIPLE_WHITESPACES_REGEX_TOKEN, ' ');\r\n  displayName = displayName.trim();\r\n\r\n  return displayName;\r\n}\r\n\r\n/** Get (up to 2 characters) initials based on display name of the persona. */\r\nexport function getInitials(displayName: string, isRtl: boolean): string {\r\n  if (displayName == null) {\r\n    return '';\r\n  }\r\n\r\n  displayName = cleanupDisplayName(displayName);\r\n\r\n  if (ARABIC_LANGUAGE_REGEX.test(displayName)) {\r\n    return getInitialsArabic(displayName, isRtl);\r\n  }\r\n\r\n  if (KOREAN_LANGUAGE_REGEX.test(displayName) || CHINESE_LANGUAGE_REGEX.test(displayName)) {\r\n    return getInitialsAsian(displayName, isRtl);\r\n  }\r\n\r\n  return getInitialsLatin(displayName, isRtl);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/initials.ts","import { IPoint } from './IPoint';\r\n\r\nexport function getDistanceBetweenPoints(point1: IPoint, point2: IPoint): number {\r\n  let distance = Math.sqrt(Math.pow(point1.x - point2.x, 2) + Math.pow(point1.y - point2.y, 2));\r\n\r\n  return distance;\r\n}\n\n\n// WEBPACK FOOTER //\n// ../src/math.ts","import { filteredAssign } from './object';\r\nexport const baseElementEvents = [\r\n  'onCopy',\r\n  'onCut',\r\n  'onPaste',\r\n  'onCompositionEnd',\r\n  'onCompositionStart',\r\n  'onCompositionUpdate',\r\n  'onFocus',\r\n  'onFocusCapture',\r\n  'onBlur',\r\n  'onBlurCapture',\r\n  'onChange',\r\n  'onInput',\r\n  'onSubmit',\r\n  'onLoad',\r\n  'onError',\r\n  'onKeyDown',\r\n  'onKeyDownCapture',\r\n  'onKeyPress',\r\n  'onKeyUp',\r\n  'onAbort',\r\n  'onCanPlay',\r\n  'onCanPlayThrough',\r\n  'onDurationChange',\r\n  'onEmptied',\r\n  'onEncrypted',\r\n  'onEnded',\r\n  'onLoadedData',\r\n  'onLoadedMetadata',\r\n  'onLoadStart',\r\n  'onPause',\r\n  'onPlay',\r\n  'onPlaying',\r\n  'onProgress',\r\n  'onRateChange',\r\n  'onSeeked',\r\n  'onSeeking',\r\n  'onStalled',\r\n  'onSuspend',\r\n  'onTimeUpdate',\r\n  'onVolumeChange',\r\n  'onWaiting',\r\n  'onClick',\r\n  'onClickCapture',\r\n  'onContextMenu',\r\n  'onDoubleClick',\r\n  'onDrag',\r\n  'onDragEnd',\r\n  'onDragEnter',\r\n  'onDragExit',\r\n  'onDragLeave',\r\n  'onDragOver',\r\n  'onDragStart',\r\n  'onDrop',\r\n  'onMouseDown',\r\n  'onMouseDownCapture',\r\n  'onMouseEnter',\r\n  'onMouseLeave',\r\n  'onMouseMove',\r\n  'onMouseOut',\r\n  'onMouseOver',\r\n  'onMouseUp',\r\n  'onMouseUpCapture',\r\n  'onSelect',\r\n  'onTouchCancel',\r\n  'onTouchEnd',\r\n  'onTouchMove',\r\n  'onTouchStart',\r\n  'onScroll',\r\n  'onWheel'\r\n];\r\n\r\nexport const baseElementProperties = [\r\n  'defaultChecked',\r\n  'defaultValue',\r\n  'accept',\r\n  'acceptCharset',\r\n  'accessKey',\r\n  'action',\r\n  'allowFullScreen',\r\n  'allowTransparency',\r\n  'alt',\r\n  'async',\r\n  'autoComplete',\r\n  'autoFocus',\r\n  'autoPlay',\r\n  'capture',\r\n  'cellPadding',\r\n  'cellSpacing',\r\n  'charSet',\r\n  'challenge',\r\n  'checked',\r\n  'children',\r\n  'classID',\r\n  'className',\r\n  'cols',\r\n  'colSpan',\r\n  'content',\r\n  'contentEditable',\r\n  'contextMenu',\r\n  'controls',\r\n  'coords',\r\n  'crossOrigin',\r\n  'data',\r\n  'dateTime',\r\n  'default',\r\n  'defer',\r\n  'dir',\r\n  'download',\r\n  'draggable',\r\n  'encType',\r\n  'form',\r\n  'formAction',\r\n  'formEncType',\r\n  'formMethod',\r\n  'formNoValidate',\r\n  'formTarget',\r\n  'frameBorder',\r\n  'headers',\r\n  'height',\r\n  'hidden',\r\n  'high',\r\n  'hrefLang',\r\n  'htmlFor',\r\n  'httpEquiv',\r\n  'icon',\r\n  'id',\r\n  'inputMode',\r\n  'integrity',\r\n  'is',\r\n  'keyParams',\r\n  'keyType',\r\n  'kind',\r\n  'label',\r\n  'lang',\r\n  'list',\r\n  'loop',\r\n  'low',\r\n  'manifest',\r\n  'marginHeight',\r\n  'marginWidth',\r\n  'max',\r\n  'maxLength',\r\n  'media',\r\n  'mediaGroup',\r\n  'method',\r\n  'min',\r\n  'minLength',\r\n  'multiple',\r\n  'muted',\r\n  'name',\r\n  'noValidate',\r\n  'open',\r\n  'optimum',\r\n  'pattern',\r\n  'placeholder',\r\n  'poster',\r\n  'preload',\r\n  'radioGroup',\r\n  'readOnly',\r\n  'rel',\r\n  'required',\r\n  'role',\r\n  'rows',\r\n  'rowSpan',\r\n  'sandbox',\r\n  'scope',\r\n  'scoped',\r\n  'scrolling',\r\n  'seamless',\r\n  'selected',\r\n  'shape',\r\n  'size',\r\n  'sizes',\r\n  'span',\r\n  'spellCheck',\r\n  'src',\r\n  'srcDoc',\r\n  'srcLang',\r\n  'srcSet',\r\n  'start',\r\n  'step',\r\n  'style',\r\n  'summary',\r\n  'tabIndex',\r\n  'title',\r\n  'type',\r\n  'useMap',\r\n  'value',\r\n  'width',\r\n  'wmode',\r\n  'wrap'\r\n];\r\n\r\nexport const htmlElementProperties = baseElementProperties.concat(baseElementEvents);\r\n\r\nexport const anchorProperties = htmlElementProperties.concat([\r\n  'href',\r\n  'target'\r\n]);\r\n\r\nexport const buttonProperties = htmlElementProperties.concat([\r\n  'disabled'\r\n]);\r\n\r\nexport const divProperties = htmlElementProperties.concat(['align', 'noWrap']);\r\n\r\nexport const inputProperties = buttonProperties;\r\n\r\nexport const textAreaProperties = buttonProperties;\r\n\r\nexport const imageProperties = divProperties;\r\n\r\n/**\r\n * Gets native supported props for an html element provided the allowance set. Use one of the property\r\n * sets defined (divProperties, buttonPropertes, etc) to filter out supported properties from a given\r\n * props set. Note that all data- and aria- prefixed attributes will be allowed.\r\n * NOTE: getNativeProps should always be applied first when adding props to a react component. The\r\n * non-native props should be applied second. This will prevent getNativeProps from overriding your custom props.\r\n * For example, if props passed to getNativeProps has an onClick function and getNativeProps is added to\r\n * the component after an onClick function is added, then the getNativeProps onClick will override it.\r\n * @param props The unfiltered input props\r\n * @param allowedPropsNames The array of allowed propnames.\r\n * @returns The filtered props\r\n */\r\nexport function getNativeProps<T>(props: any, allowedPropNames: string[], excludedPropNames?: string[]): T {\r\n  return filteredAssign((propName) => {\r\n    return (\r\n      (!excludedPropNames || excludedPropNames.indexOf(propName) < 0) && (\r\n        (propName.indexOf('data-') === 0) ||\r\n        (propName.indexOf('aria-') === 0) ||\r\n        (allowedPropNames.indexOf(propName) >= 0)\r\n      ));\r\n  },\r\n    {},\r\n    props) as T;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/properties.ts","let _baseUrl = '';\r\n\r\n/** Sets the current base url used for fetching images. */\r\nexport function getResourceUrl(url) {\r\n  return _baseUrl + url;\r\n}\r\n\r\n/** Gets the current base url used for fetching images. */\r\nexport function setBaseUrl(baseUrl) {\r\n  _baseUrl = baseUrl;\r\n}\r\n\r\n/** Gets the current runtime language. */\r\nexport function getLanguage() {\r\n  return 'en-us';\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/resources.ts","import { KeyCodes } from './KeyCodes';\r\nimport { getDocument } from './dom';\r\n\r\n// Default to undefined so that we initialize on first read.\r\nlet _isRTL: boolean;\r\n\r\n/**\r\n * Gets the rtl state of the page (returns true if in rtl.)\r\n */\r\nexport function getRTL(): boolean {\r\n  if (_isRTL === undefined) {\r\n    let doc = getDocument();\r\n\r\n    if (doc) {\r\n      _isRTL = document.documentElement.getAttribute('dir') === 'rtl';\r\n    } else {\r\n      throw new Error(\r\n        'getRTL was called in a server environment without setRTL being called first. ' +\r\n        'Call setRTL to set the correct direction first.'\r\n      );\r\n    }\r\n  }\r\n\r\n  return _isRTL;\r\n}\r\n\r\n/**\r\n * Sets the rtl state of the page (by adjusting the dir attribute of the html element.)\r\n */\r\nexport function setRTL(isRTL: boolean) {\r\n  let doc = getDocument();\r\n\r\n  if (doc) {\r\n    doc.documentElement.setAttribute('dir', isRTL ? 'rtl' : 'ltr');\r\n  }\r\n\r\n  _isRTL = isRTL;\r\n}\r\n\r\n/**\r\n * Returns the given key, but flips right/left arrows if necessary.\r\n */\r\nexport function getRTLSafeKeyCode(key: number): number {\r\n  if (getRTL()) {\r\n    if (key === KeyCodes.left) {\r\n      key = KeyCodes.right;\r\n    } else if (key === KeyCodes.right) {\r\n      key = KeyCodes.left;\r\n    }\r\n  }\r\n\r\n  return key;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/rtl.ts","/* tslint:disable */\r\nimport { loadStyles } from '@microsoft/load-themed-styles';\r\n\r\nconst styles = {\r\n  msFabricScrollDisabled: 'msFabricScrollDisabled_577a715c',\r\n};\r\n\r\nexport default styles;\r\n\r\nloadStyles([{\"rawString\":\".msFabricScrollDisabled_577a715c{overflow:hidden!important}\"}]);\r\n/* tslint:enable */\n\n\n// WEBPACK FOOTER //\n// ../src/scroll.scss.ts","// Regex that finds { and } so they can be removed on a lookup for string format\r\nconst FORMAT_ARGS_REGEX = /[\\{\\}]/g;\r\n\r\n// Regex that finds {#} so it can be replaced by the arguments in string format\r\nconst FORMAT_REGEX = /\\{\\d+\\}/g;\r\n\r\n/**\r\n * String Format is like C# string format.\r\n * Usage Example: \"hello {0}!\".format(\"mike\") will return \"hello mike!\"\r\n * Calling format on a string with less arguments than specified in the format is invalid\r\n * Example \"I love {0} every {1}\".format(\"CXP\") will result in a Debug Exception.\r\n */\r\nexport function format(s: string, ...values: any[]): string {\r\n    'use strict';\r\n\r\n    let args = values;\r\n    // Callback match function\r\n    function replace_func(match: string) {\r\n        // looks up in the args\r\n        let replacement = args[match.replace(FORMAT_ARGS_REGEX, '')];\r\n\r\n        // catches undefined in nondebug and null in debug and nondebug\r\n        if (replacement === null || replacement === undefined) {\r\n            replacement = '';\r\n        }\r\n\r\n        return replacement;\r\n    }\r\n    return (s.replace(FORMAT_REGEX, replace_func));\r\n}\n\n\n// WEBPACK FOOTER //\n// ../src/string.ts","export * from './components/DetailsList/index';\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/DetailsList.ts","export * from './components/Fabric/index';\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/Fabric.ts","export * from './components/GroupedList/index';\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/GroupedList.ts","export * from './components/Layer/index';\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/Layer.ts","export * from './components/Spinner/index';\r\n\n\n\n// WEBPACK FOOTER //\n// ../src/Spinner.ts","import * as React from 'react';\r\nimport { css } from '../../Utilities';\r\nimport styles = require('./Check.scss');\r\n\r\nexport interface ICheckProps extends React.Props<Check> {\r\n  /**\r\n   * Whether or not this menu item is currently checked.\r\n   * @defaultvalue false\r\n   */\r\n  checked?: boolean;\r\n  /**\r\n   * @deprecated\r\n   * Deprecated at v.65.1 and will be removed by v 1.0. Use 'checked' instead.\r\n   */\r\n  isChecked?: boolean;\r\n}\r\n\r\nexport class Check extends React.Component<ICheckProps, {}> {\r\n  public static defaultProps = {\r\n    isChecked: false\r\n  };\r\n\r\n  public shouldComponentUpdate(newProps: ICheckProps) {\r\n    return this.props.isChecked !== newProps.isChecked || this.props.checked !== newProps.checked;\r\n  }\r\n\r\n  public render() {\r\n    let { isChecked, checked } = this.props;\r\n\r\n    isChecked = isChecked || checked;\r\n\r\n    return (\r\n      <div className={ css(\r\n        'ms-Check',\r\n        styles.root,\r\n        {\r\n          ['is-checked ' + styles.rootIsChecked]: isChecked\r\n        }) }>\r\n        <div className={ css('ms-Icon ms-Check-background', styles.background) }>\r\n        </div>\r\n        <i className={ css('ms-Check-check ms-Icon ms-Icon--CheckMark', styles.check) }></i>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Check/Check.tsx","/* tslint:disable */\r\nimport { loadStyles } from '@microsoft/load-themed-styles';\r\n\r\nconst styles = {\r\n  root: 'root_c567c213',\r\n  rootIsChecked: 'rootIsChecked_c567c213',\r\n  background: 'background_c567c213',\r\n  check: 'check_c567c213',\r\n};\r\n\r\nexport = styles;\r\n\r\nloadStyles([{\"rawString\":\".root_c567c213{line-height:1;width:24px;height:24px;vertical-align:top;position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.root_c567c213.rootIsChecked_c567c213 .background_c567c213:before{color:\"},{\"theme\":\"themePrimary\",\"defaultValue\":\"#0078d7\"},{\"rawString\":\"}.root_c567c213.rootIsChecked_c567c213 .background_c567c213:after{color:\"},{\"theme\":\"white\",\"defaultValue\":\"#ffffff\"},{\"rawString\":\"}.root_c567c213.rootIsChecked_c567c213 .check_c567c213{opacity:1;color:\"},{\"theme\":\"white\",\"defaultValue\":\"#ffffff\"},{\"rawString\":\";font-weight:900;font-size:12px}.root_c567c213:hover .check_c567c213{opacity:1}.check_c567c213{left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);position:absolute;color:\"},{\"theme\":\"neutralTertiaryAlt\",\"defaultValue\":\"#c8c8c8\"},{\"rawString\":\";opacity:0}.background_c567c213{position:relative;height:24px;width:24px}.background_c567c213:before{content:'\\\\E91F';color:\"},{\"theme\":\"white\",\"defaultValue\":\"#ffffff\"},{\"rawString\":\"}.background_c567c213:after{content:'\\\\EA3A';color:\"},{\"theme\":\"neutralTertiaryAlt\",\"defaultValue\":\"#c8c8c8\"},{\"rawString\":\"}.background_c567c213:after,.background_c567c213:before{left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);font-size:24px;height:24px;width:24px;position:absolute}\"}]);\r\n/* tslint:enable */\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Check/Check.scss.ts","export * from './Check';\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Check/index.ts","import * as React from 'react';\r\nimport {\r\n  BaseComponent,\r\n  autobind,\r\n  css,\r\n  getRTL\r\n} from '../../Utilities';\r\nimport { IColumn, DetailsListLayoutMode, ColumnActionsMode } from './DetailsList.Props';\r\nimport { FocusZone, FocusZoneDirection } from '../../FocusZone';\r\nimport { Check } from '../../Check';\r\nimport { Icon } from '../../Icon';\r\nimport { Layer } from '../../Layer';\r\nimport { GroupSpacer } from '../GroupedList/GroupSpacer';\r\nimport { ISelection, SelectionMode, SELECTION_CHANGE } from '../../utilities/selection/interfaces';\r\nimport styles = require('./DetailsHeader.scss');\r\n\r\nconst MOUSEDOWN_PRIMARY_BUTTON = 0; // for mouse down event we are using ev.button property, 0 means left button\r\nconst MOUSEMOVE_PRIMARY_BUTTON = 1; // for mouse move event we are using ev.buttons property, 1 means left button\r\nconst INNER_PADDING = 16;\r\n\r\nexport interface IDetailsHeaderProps extends React.Props<DetailsHeader> {\r\n  columns: IColumn[];\r\n  selection: ISelection;\r\n  selectionMode: SelectionMode;\r\n  layoutMode: DetailsListLayoutMode;\r\n  onColumnIsSizingChanged?: (column: IColumn, isSizing: boolean) => void;\r\n  onColumnResized?: (column: IColumn, newWidth: number) => void;\r\n  onColumnAutoResized?: (column: IColumn, columnIndex: number) => void;\r\n  onColumnClick?: (ev: React.MouseEvent<HTMLElement>, column: IColumn) => void;\r\n  onColumnContextMenu?: (column: IColumn, ev: Event) => void;\r\n  groupNestingDepth?: number;\r\n  isAllCollapsed?: boolean;\r\n  onToggleCollapseAll?: (isAllCollapsed: boolean) => void;\r\n  /** ariaLabel for the entire header */\r\n  ariaLabel?: string;\r\n  /** ariaLabel for the header checkbox that selects or deselects everything */\r\n  ariaLabelForSelectAllCheckbox?: string;\r\n  selectAllVisibility?: SelectAllVisibility;\r\n}\r\n\r\nexport enum SelectAllVisibility {\r\n  none = 0,\r\n  hidden = 1,\r\n  visible = 2\r\n}\r\n\r\nexport interface IDetailsHeaderState {\r\n  columnResizeDetails?: IColumnResizeDetails;\r\n  isAllSelected?: boolean;\r\n  isSizing?: boolean;\r\n  groupNestingDepth?: number;\r\n  isAllCollapsed?: boolean;\r\n}\r\n\r\nexport interface IColumnResizeDetails {\r\n  columnIndex: number;\r\n  originX: number;\r\n  columnMinWidth: number;\r\n}\r\n\r\nexport class DetailsHeader extends BaseComponent<IDetailsHeaderProps, IDetailsHeaderState> {\r\n  public static defaultProps = {\r\n    isSelectAllVisible: SelectAllVisibility.visible\r\n  };\r\n\r\n  public refs: {\r\n    [key: string]: React.ReactInstance;\r\n    root: HTMLElement;\r\n    focusZone: FocusZone;\r\n  };\r\n\r\n  constructor(props: IDetailsHeaderProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      columnResizeDetails: null,\r\n      groupNestingDepth: this.props.groupNestingDepth,\r\n      isAllCollapsed: this.props.isAllCollapsed\r\n    };\r\n\r\n    this._onToggleCollapseAll = this._onToggleCollapseAll.bind(this);\r\n    this._onSelectAllClicked = this._onSelectAllClicked.bind(this);\r\n  }\r\n\r\n  public componentDidMount() {\r\n    let { selection } = this.props;\r\n\r\n    this._events.on(selection, SELECTION_CHANGE, this._onSelectionChanged);\r\n\r\n    // We need to use native on this to avoid MarqueeSelection from handling the event before us.\r\n    this._events.on(this.refs.root, 'mousedown', this._onRootMouseDown);\r\n  }\r\n\r\n  public componentWillReceiveProps(newProps) {\r\n    let { groupNestingDepth } = this.state;\r\n\r\n    if (newProps.groupNestingDepth !== groupNestingDepth) {\r\n      this.setState({ groupNestingDepth: newProps.groupNestingDepth });\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    let { columns, ariaLabel, ariaLabelForSelectAllCheckbox, selectAllVisibility } = this.props;\r\n    let { isAllSelected, columnResizeDetails, isSizing, groupNestingDepth, isAllCollapsed } = this.state;\r\n\r\n    return (\r\n      <div\r\n        role='row'\r\n        aria-label={ ariaLabel }\r\n        className={ css('ms-DetailsHeader', styles.root, {\r\n          ['is-allSelected ' + styles.rootIsAllSelected]: isAllSelected,\r\n          ['is-selectAllHidden ' + styles.rootIsSelectAllHidden]: selectAllVisibility === SelectAllVisibility.hidden,\r\n          'is-resizingColumn': !!columnResizeDetails && isSizing,\r\n        }) }\r\n        ref='root'\r\n        onMouseMove={ this._onRootMouseMove }\r\n        data-automationid='DetailsHeader'>\r\n        <FocusZone ref='focusZone' direction={ FocusZoneDirection.horizontal }>\r\n          <div className={ css('ms-DetailsHeader-cellWrapper', styles.cellWrapper) } role='columnheader'>\r\n            { (selectAllVisibility === SelectAllVisibility.visible) ? (\r\n              <button\r\n                type='button'\r\n                className={ css('ms-DetailsHeader-cell is-check', styles.cell, styles.cellIsCheck) }\r\n                onClick={ this._onSelectAllClicked }\r\n                aria-label={ ariaLabelForSelectAllCheckbox }\r\n                aria-pressed={ isAllSelected }\r\n              >\r\n                <Check checked={ isAllSelected } />\r\n              </button>\r\n            ) : null }\r\n          </div>\r\n          { groupNestingDepth > 0 ? (\r\n            <button\r\n              type='button'\r\n              className={ css('ms-DetailsHeader-cell', styles.cell) }\r\n              onClick={ this._onToggleCollapseAll }>\r\n              <Icon\r\n                className={ css(\r\n                  'ms-DetailsHeader-collapseButton',\r\n                  styles.collapseButton,\r\n                  isAllCollapsed && ('is-collapsed ' + styles.collapseButtonIsCollapsed)\r\n                ) }\r\n                iconName='ChevronDown'\r\n              />\r\n            </button>\r\n          ) : (null) }\r\n          { GroupSpacer({ count: groupNestingDepth - 1 }) }\r\n          { columns.map((column, columnIndex) => (\r\n            <div\r\n              key={ column.key }\r\n              className={ css('ms-DetailsHeader-cellWrapper', styles.cellWrapper) }\r\n              role='columnheader'\r\n              aria-sort={ column.isSorted ? (column.isSortedDescending ? 'descending' : 'ascending') : 'none' }\r\n            >\r\n              <button\r\n                type='button'\r\n                key={ column.fieldName }\r\n                disabled={ column.columnActionsMode === ColumnActionsMode.disabled }\r\n                className={ css(\r\n                  'ms-DetailsHeader-cell',\r\n                  styles.cell,\r\n                  column.headerClassName, {\r\n                    ['is-actionable ' + styles.cellIsActionable]: column.columnActionsMode !== ColumnActionsMode.disabled,\r\n                    ['is-empty ' + styles.cellIsEmpty]: !column.name,\r\n                    'is-icon-visible': column.isSorted || column.isGrouped || column.isFiltered\r\n                  }) }\r\n                style={ { width: column.calculatedWidth + INNER_PADDING } }\r\n                onClick={ this._onColumnClick.bind(this, column) }\r\n                onContextMenu={ this._onColumnContextMenu.bind(this, column) }\r\n                aria-haspopup={ column.columnActionsMode === ColumnActionsMode.hasDropdown }\r\n                aria-label={ column.ariaLabel || column.name }\r\n                data-automationid='ColumnsHeaderColumn'\r\n                data-item-key={ column.key }\r\n              >\r\n\r\n                { column.isFiltered && (\r\n                  <Icon className={ styles.nearIcon } iconName='Filter' />\r\n                ) }\r\n\r\n                { column.isSorted && (\r\n                  <Icon className={ styles.nearIcon } iconName={ column.isSortedDescending ? 'SortDown' : 'SortUp' } />\r\n                ) }\r\n\r\n                { column.isGrouped && (\r\n                  <Icon className={ styles.nearIcon } iconName='GroupedDescending' />\r\n                ) }\r\n\r\n                { column.iconClassName && (\r\n                  <Icon className={ css(styles.nearIcon, column.iconClassName) } iconName={ column.iconName } />\r\n                ) }\r\n\r\n                { column.name }\r\n\r\n                { column.columnActionsMode === ColumnActionsMode.hasDropdown && (\r\n                  <Icon\r\n                    className={ css('ms-DetailsHeader-filterChevron', styles.filterChevron) }\r\n                    iconName='ChevronDown'\r\n                  />\r\n                ) }\r\n              </button>\r\n              { (column.isResizable) && (\r\n                <div\r\n                  data-sizer-index={ columnIndex }\r\n                  className={ css(\r\n                    'ms-DetailsHeader-cell is-sizer',\r\n                    styles.cell,\r\n                    styles.cellIsSizer,\r\n                    {\r\n                      ['is-resizing ' + styles.cellIsResizing]: isSizing && columnResizeDetails.columnIndex === columnIndex\r\n                    }) }\r\n                  onDoubleClick={ this._onSizerDoubleClick.bind(this, columnIndex) }\r\n                />\r\n              ) }\r\n            </div>\r\n          )) }\r\n        </FocusZone>\r\n        { isSizing && (\r\n          <Layer>\r\n            <div\r\n              className={ css(isSizing && styles.sizingOverlay) }\r\n              onMouseMove={ this._onSizerMouseMove }\r\n              onMouseUp={ this._onSizerMouseUp }\r\n            />\r\n          </Layer>\r\n        ) }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /** Set focus to the active thing in the focus area. */\r\n  public focus(): boolean {\r\n    return this.refs.focusZone.focus();\r\n  }\r\n\r\n  /**\r\n   * double click on the column sizer will auto ajust column width\r\n   * to fit the longest content among current rendered rows.\r\n   *\r\n   * @private\r\n   * @param {number} columnIndex (index of the column user double clicked)\r\n   * @param {React.MouseEvent} ev (mouse double click event)\r\n   */\r\n  private _onSizerDoubleClick(columnIndex: number, ev: React.MouseEvent<HTMLElement>) {\r\n    let { onColumnAutoResized, columns } = this.props;\r\n    if (onColumnAutoResized) {\r\n      onColumnAutoResized(columns[columnIndex], columnIndex);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Called when the select all toggle is clicked.\r\n   */\r\n\r\n  @autobind\r\n  private _onSelectAllClicked() {\r\n    let { selection } = this.props;\r\n\r\n    selection.toggleAllSelected();\r\n  }\r\n\r\n  @autobind\r\n  private _onRootMouseDown(ev: MouseEvent) {\r\n    let columnIndexAttr = (ev.target as HTMLElement).getAttribute('data-sizer-index');\r\n    let columnIndex = Number(columnIndexAttr);\r\n    let { columns } = this.props;\r\n\r\n    if (columnIndexAttr === null || ev.button !== MOUSEDOWN_PRIMARY_BUTTON) {\r\n      // Ignore anything except the primary button.\r\n      return;\r\n    }\r\n\r\n    this.setState({\r\n      columnResizeDetails: {\r\n        columnIndex: columnIndex,\r\n        columnMinWidth: columns[columnIndex].calculatedWidth,\r\n        originX: ev.clientX\r\n      }\r\n    });\r\n\r\n    ev.preventDefault();\r\n    ev.stopPropagation();\r\n  }\r\n\r\n  @autobind\r\n  private _onRootMouseMove(ev: React.MouseEvent<HTMLElement>) {\r\n    let { columnResizeDetails, isSizing } = this.state;\r\n\r\n    if (columnResizeDetails && !isSizing && ev.clientX !== columnResizeDetails.originX) {\r\n      this.setState({ isSizing: true });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * mouse move event handler in the header\r\n   * it will set isSizing state to true when user clicked on the sizer and move the mouse.\r\n   *\r\n   * @private\r\n   * @param {React.MouseEvent} ev (mouse move event)\r\n   */\r\n  @autobind\r\n  private _onSizerMouseMove(ev: React.MouseEvent<HTMLElement>) {\r\n    let {\r\n      // use buttons property here since ev.button in some edge case is not upding well during the move.\r\n      // but firefox doesn't support it, so we set the default value when it is not defined.\r\n      buttons\r\n    } = ev;\r\n    let { onColumnIsSizingChanged, onColumnResized, columns } = this.props;\r\n    let { columnResizeDetails } = this.state;\r\n\r\n    if (buttons !== undefined && buttons !== MOUSEMOVE_PRIMARY_BUTTON) {\r\n      // cancel mouse down event and return early when the primary button is not pressed\r\n      this._onSizerMouseUp(ev);\r\n      return;\r\n    }\r\n\r\n    if (ev.clientX !== columnResizeDetails.originX) {\r\n      if (onColumnIsSizingChanged) {\r\n        onColumnIsSizingChanged(columns[columnResizeDetails.columnIndex], true);\r\n      }\r\n    }\r\n\r\n    if (onColumnResized) {\r\n      let movement = ev.clientX - columnResizeDetails.originX;\r\n\r\n      if (getRTL()) {\r\n        movement = -movement;\r\n      }\r\n\r\n      onColumnResized(\r\n        columns[columnResizeDetails.columnIndex],\r\n        columnResizeDetails.columnMinWidth + movement\r\n      );\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * mouse up event handler in the header\r\n   * clear the resize related state.\r\n   * This is to ensure we can catch double click event\r\n   *\r\n   * @private\r\n   * @param {React.MouseEvent} ev (mouse up event)\r\n   */\r\n  @autobind\r\n  private _onSizerMouseUp(ev: React.MouseEvent<HTMLElement>) {\r\n    let { columns, onColumnIsSizingChanged } = this.props;\r\n    let { columnResizeDetails } = this.state;\r\n\r\n    this.setState({\r\n      columnResizeDetails: null,\r\n      isSizing: false\r\n    });\r\n\r\n    if (onColumnIsSizingChanged) {\r\n      onColumnIsSizingChanged(columns[columnResizeDetails.columnIndex], false);\r\n    }\r\n  }\r\n\r\n  private _onSelectionChanged() {\r\n    let isAllSelected = this.props.selection.isAllSelected();\r\n\r\n    if (this.state.isAllSelected !== isAllSelected) {\r\n      this.setState({\r\n        isAllSelected: isAllSelected\r\n      });\r\n    }\r\n  }\r\n\r\n  private _onColumnClick(column, ev) {\r\n    let { onColumnClick } = this.props;\r\n\r\n    if (column.onColumnClick) {\r\n      column.onColumnClick(ev, column);\r\n    }\r\n\r\n    if (onColumnClick) {\r\n      onColumnClick(ev, column);\r\n    }\r\n  }\r\n\r\n  private _onColumnContextMenu(column, ev) {\r\n    let { onColumnContextMenu } = this.props;\r\n\r\n    if (column.onContextMenu) {\r\n      column.onColumnContextMenu(column, ev);\r\n    }\r\n\r\n    if (onColumnContextMenu) {\r\n      onColumnContextMenu(column, ev);\r\n    }\r\n  }\r\n\r\n  private _onToggleCollapseAll() {\r\n    let { onToggleCollapseAll } = this.props;\r\n    let newCollapsed = !this.state.isAllCollapsed;\r\n    this.setState({\r\n      isAllCollapsed: newCollapsed\r\n    });\r\n    if (onToggleCollapseAll) {\r\n      onToggleCollapseAll(newCollapsed);\r\n    }\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/DetailsList/DetailsHeader.tsx","/* tslint:disable */\r\nimport { loadStyles } from '@microsoft/load-themed-styles';\r\n\r\nconst styles = {\r\n  root: 'root_87783ec3',\r\n  rootIsSelectAllHidden: 'rootIsSelectAllHidden_87783ec3',\r\n  cell: 'cell_87783ec3',\r\n  cellIsCheck: 'cellIsCheck_87783ec3',\r\n  rootIsAllSelected: 'rootIsAllSelected_87783ec3',\r\n  cellWrapper: 'cellWrapper_87783ec3',\r\n  cellIsActionable: 'cellIsActionable_87783ec3',\r\n  cellIsSizer: 'cellIsSizer_87783ec3',\r\n  cellIsEmpty: 'cellIsEmpty_87783ec3',\r\n  cellIsResizing: 'cellIsResizing_87783ec3',\r\n  collapseButton: 'collapseButton_87783ec3',\r\n  collapseButtonIsCollapsed: 'collapseButtonIsCollapsed_87783ec3',\r\n  nearIcon: 'nearIcon_87783ec3',\r\n  filterChevron: 'filterChevron_87783ec3',\r\n  sizingOverlay: 'sizingOverlay_87783ec3',\r\n};\r\n\r\nexport = styles;\r\n\r\nloadStyles([{\"rawString\":\".root_87783ec3{display:inline-block;min-width:100%;height:36px;line-height:36px;white-space:nowrap;padding-bottom:1px;border-bottom:1px solid \"},{\"theme\":\"neutralLight\",\"defaultValue\":\"#eaeaea\"},{\"rawString\":\";cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html[dir=ltr] .root_87783ec3.rootIsSelectAllHidden_87783ec3{padding-left:36px}html[dir=rtl] .root_87783ec3.rootIsSelectAllHidden_87783ec3{padding-right:36px}.cell_87783ec3.cellIsCheck_87783ec3 .ms-Check-background{opacity:0}.cell_87783ec3.cellIsCheck_87783ec3:hover .ms-Check-background,.root_87783ec3.rootIsAllSelected_87783ec3 .ms-Check-background{opacity:1}.cellWrapper_87783ec3{display:inline-block;position:relative}.cell_87783ec3{font-family:\\\"Segoe UI WestEuropean\\\",\\\"Segoe UI\\\",-apple-system,BlinkMacSystemFont,Roboto,\\\"Helvetica Neue\\\",sans-serif;-webkit-font-smoothing:antialiased;font-size:12px;font-weight:400;background:0 0;color:\"},{\"theme\":\"neutralTertiaryAlt\",\"defaultValue\":\"#c8c8c8\"},{\"rawString\":\";font-weight:400;position:relative;display:inline-block;box-sizing:border-box;padding:0 8px;border:none;line-height:inherit;margin:0;height:36px;vertical-align:top;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.cell_87783ec3::-moz-focus-inner{border:0}.cell_87783ec3{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .cell_87783ec3:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid \"},{\"theme\":\"neutralSecondary\",\"defaultValue\":\"#666666\"},{\"rawString\":\"}html[dir=ltr] .cell_87783ec3{text-align:left}html[dir=rtl] .cell_87783ec3{text-align:right}html[dir=ltr] .cell_87783ec3{text-align:left}html[dir=rtl] .cell_87783ec3{text-align:right}.cell_87783ec3.cellIsCheck_87783ec3{position:relative;padding:6px;margin:0}.cell_87783ec3.cellIsActionable_87783ec3{color:\"},{\"theme\":\"neutralSecondary\",\"defaultValue\":\"#666666\"},{\"rawString\":\"}.cell_87783ec3.cellIsActionable_87783ec3:hover{color:\"},{\"theme\":\"neutralPrimary\",\"defaultValue\":\"#333333\"},{\"rawString\":\";background:\"},{\"theme\":\"neutralLighterAlt\",\"defaultValue\":\"#f8f8f8\"},{\"rawString\":\"}.cell_87783ec3.cellIsActionable_87783ec3:active{background:\"},{\"theme\":\"neutralLight\",\"defaultValue\":\"#eaeaea\"},{\"rawString\":\"}.cell_87783ec3.cellIsSizer_87783ec3{position:absolute;width:16px;cursor:ew-resize;bottom:0;top:0;height:inherit;background:0 0}html[dir=ltr] .cell_87783ec3.cellIsSizer_87783ec3{margin-left:-10px}html[dir=rtl] .cell_87783ec3.cellIsSizer_87783ec3{margin-right:-10px}.cell_87783ec3.cellIsEmpty_87783ec3{text-overflow:clip}.cell_87783ec3.cellIsSizer_87783ec3:after{content:'';position:absolute;left:50%;top:0;bottom:0;width:1px;background:\"},{\"theme\":\"neutralTertiaryAlt\",\"defaultValue\":\"#c8c8c8\"},{\"rawString\":\";opacity:0}.cell_87783ec3.cellIsSizer_87783ec3.cellIsResizing_87783ec3:after,.cell_87783ec3.cellIsSizer_87783ec3:hover:after{opacity:1;-webkit-transition:opacity .3s linear;transition:opacity .3s linear}.collapseButton_87783ec3{text-align:center;-webkit-transform:rotate(-180deg);transform:rotate(-180deg);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transition:-webkit-transform .1s linear;transition:-webkit-transform .1s linear;transition:transform .1s linear;transition:transform .1s linear,-webkit-transform .1s linear;width:20px;outline:0}.collapseButton_87783ec3.collapseButtonIsCollapsed_87783ec3{-webkit-transform:rotate(0);transform:rotate(0)}.cell_87783ec3 .nearIcon_87783ec3{color:\"},{\"theme\":\"neutralSecondary\",\"defaultValue\":\"#666666\"},{\"rawString\":\";opacity:1}html[dir=ltr] .cell_87783ec3 .nearIcon_87783ec3{padding-right:4px}html[dir=rtl] .cell_87783ec3 .nearIcon_87783ec3{padding-left:4px}.cell_87783ec3 .filterChevron_87783ec3{color:\"},{\"theme\":\"neutralTertiary\",\"defaultValue\":\"#a6a6a6\"},{\"rawString\":\";vertical-align:middle}html[dir=ltr] .cell_87783ec3 .filterChevron_87783ec3{padding-left:4px}html[dir=rtl] .cell_87783ec3 .filterChevron_87783ec3{padding-right:4px}.sizingOverlay_87783ec3{position:absolute;left:0;top:0;right:0;bottom:0;cursor:ew-resize;background:rgba(255,255,255,0)}html[dir=ltr] .cell_87783ec3 .collapseButton_87783ec3{padding-right:0}html[dir=rtl] .cell_87783ec3 .collapseButton_87783ec3{padding-left:0}\"}]);\r\n/* tslint:enable */\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/DetailsList/DetailsHeader.scss.ts","import * as React from 'react';\r\nimport {\r\n  EventGroup,\r\n  KeyCodes,\r\n  assign,\r\n  autobind,\r\n  css,\r\n  getRTLSafeKeyCode\r\n} from '../../Utilities';\r\nimport {\r\n  IDetailsListProps,\r\n  ColumnActionsMode,\r\n  ConstrainMode,\r\n  DetailsListLayoutMode,\r\n  IColumn,\r\n  IDetailsList,\r\n  CheckboxVisibility\r\n} from '../DetailsList/DetailsList.Props';\r\nimport { DetailsHeader, SelectAllVisibility } from '../DetailsList/DetailsHeader';\r\nimport { DetailsRow, IDetailsRowProps } from '../DetailsList/DetailsRow';\r\nimport { FocusZone, FocusZoneDirection } from '../../FocusZone';\r\nimport { GroupedList } from '../../GroupedList';\r\nimport { List } from '../../List';\r\nimport { withViewport } from '../../utilities/decorators/withViewport';\r\nimport {\r\n  IObjectWithKey,\r\n  ISelection,\r\n  Selection,\r\n  SelectionMode,\r\n  SelectionZone\r\n} from '../../utilities/selection/index';\r\nimport { DragDropHelper } from '../../utilities/dragdrop/DragDropHelper';\r\nimport styles = require('./DetailsList.scss');\r\n\r\nexport interface IDetailsListState {\r\n  lastWidth?: number;\r\n  lastSelectionMode?: SelectionMode;\r\n  adjustedColumns?: IColumn[];\r\n  layoutMode?: DetailsListLayoutMode;\r\n  isCollapsed?: boolean;\r\n  isSizing?: boolean;\r\n  isDropping?: boolean;\r\n  isSomeGroupExpanded?: boolean;\r\n}\r\n\r\nconst MIN_COLUMN_WIDTH = 100; // this is the global min width\r\nconst CHECKBOX_WIDTH = 36;\r\nconst GROUP_EXPAND_WIDTH = 36;\r\nconst DEFAULT_INNER_PADDING = 16;\r\n\r\nconst DEFAULT_RENDERED_WINDOWS_AHEAD = 2;\r\nconst DEFAULT_RENDERED_WINDOWS_BEHIND = 2;\r\n\r\n@withViewport\r\nexport class DetailsList extends React.Component<IDetailsListProps, IDetailsListState> implements IDetailsList {\r\n  public static defaultProps = {\r\n    layoutMode: DetailsListLayoutMode.justified,\r\n    selectionMode: SelectionMode.multiple,\r\n    constrainMode: ConstrainMode.horizontalConstrained,\r\n    checkboxVisibility: CheckboxVisibility.onHover,\r\n    isHeaderVisible: true\r\n  };\r\n\r\n  public refs: {\r\n    [key: string]: React.ReactInstance,\r\n    header: DetailsHeader,\r\n    root: HTMLElement,\r\n    groupedList: GroupedList,\r\n    list: List,\r\n    focusZone: FocusZone,\r\n    selectionZone: SelectionZone\r\n  };\r\n\r\n  private _events: EventGroup;\r\n  private _selection: ISelection;\r\n  private _activeRows: { [key: string]: DetailsRow };\r\n  private _dragDropHelper: DragDropHelper;\r\n  private _initialFocusedIndex: number;\r\n\r\n  private _columnOverrides: {\r\n    [key: string]: IColumn;\r\n  };\r\n\r\n  constructor(props: IDetailsListProps) {\r\n    super(props);\r\n\r\n    this._activeRows = {};\r\n    this._columnOverrides = {};\r\n    this._onColumnIsSizingChanged = this._onColumnIsSizingChanged.bind(this);\r\n    this._onColumnResized = this._onColumnResized.bind(this);\r\n    this._onColumnAutoResized = this._onColumnAutoResized.bind(this);\r\n    this._onRowDidMount = this._onRowDidMount.bind(this);\r\n    this._onRowWillUnmount = this._onRowWillUnmount.bind(this);\r\n    this._onToggleCollapse = this._onToggleCollapse.bind(this);\r\n    this._onActiveRowChanged = this._onActiveRowChanged.bind(this);\r\n    this._onHeaderKeyDown = this._onHeaderKeyDown.bind(this);\r\n    this._onContentKeyDown = this._onContentKeyDown.bind(this);\r\n    this._onRenderCell = this._onRenderCell.bind(this);\r\n    this._onGroupExpandStateChanged = this._onGroupExpandStateChanged.bind(this);\r\n\r\n    this.state = {\r\n      lastWidth: 0,\r\n      adjustedColumns: this._getAdjustedColumns(props),\r\n      layoutMode: props.layoutMode,\r\n      isSizing: false,\r\n      isDropping: false,\r\n      isCollapsed: props.groupProps && props.groupProps.isAllGroupsCollapsed,\r\n      isSomeGroupExpanded: props.groupProps && !props.groupProps.isAllGroupsCollapsed\r\n    };\r\n\r\n    this._events = new EventGroup(this);\r\n    this._selection = props.selection || new Selection({ onSelectionChanged: null, getKey: props.getKey });\r\n    this._selection.setItems(props.items as IObjectWithKey[], false);\r\n    this._dragDropHelper = props.dragDropEvents ? new DragDropHelper({ selection: this._selection }) : null;\r\n    this._initialFocusedIndex = props.initialFocusedIndex;\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    this._events.dispose();\r\n    if (this._dragDropHelper) {\r\n      this._dragDropHelper.dispose();\r\n    }\r\n  }\r\n\r\n  public componentDidUpdate(prevProps: any, prevState: any) {\r\n    if (this.props.onDidUpdate) {\r\n      this.props.onDidUpdate(this);\r\n    }\r\n  }\r\n\r\n  public componentWillReceiveProps(newProps: IDetailsListProps) {\r\n    let {\r\n      checkboxVisibility,\r\n      items,\r\n      setKey,\r\n      selectionMode,\r\n      columns,\r\n      viewport\r\n    } = this.props;\r\n    let { layoutMode } = this.state;\r\n    let shouldResetSelection = (newProps.setKey !== setKey) || newProps.setKey === undefined;\r\n    let shouldForceUpdates = false;\r\n\r\n    if (newProps.layoutMode !== this.props.layoutMode) {\r\n      layoutMode = newProps.layoutMode;\r\n      this.setState({ layoutMode: layoutMode });\r\n      shouldForceUpdates = true;\r\n    }\r\n\r\n    if (shouldResetSelection) {\r\n      this._initialFocusedIndex = newProps.initialFocusedIndex;\r\n    }\r\n\r\n    if (newProps.items !== items) {\r\n      this._selection.setItems(newProps.items, shouldResetSelection);\r\n    }\r\n\r\n    if (\r\n      newProps.checkboxVisibility !== checkboxVisibility ||\r\n      newProps.columns !== columns ||\r\n      newProps.viewport.width !== viewport.width\r\n    ) {\r\n      shouldForceUpdates = true;\r\n    }\r\n\r\n    this._adjustColumns(newProps, true, layoutMode);\r\n\r\n    if (newProps.selectionMode !== selectionMode) {\r\n      shouldForceUpdates = true;\r\n    }\r\n\r\n    if (shouldForceUpdates) {\r\n      this._forceListUpdates();\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    let {\r\n      ariaLabelForListHeader,\r\n      ariaLabelForSelectAllCheckbox,\r\n      className,\r\n      checkboxVisibility,\r\n      constrainMode,\r\n      dragDropEvents,\r\n      groups,\r\n      groupProps,\r\n      items,\r\n      isHeaderVisible,\r\n      onItemInvoked,\r\n      onItemContextMenu,\r\n      onColumnHeaderClick,\r\n      onColumnHeaderContextMenu,\r\n      selectionMode,\r\n      selectionPreservedOnEmptyClick,\r\n      ariaLabel,\r\n      ariaLabelForGrid,\r\n      rowElementEventMap,\r\n      shouldApplyApplicationRole = false,\r\n      getKey\r\n    } = this.props;\r\n    let {\r\n      adjustedColumns,\r\n      isCollapsed,\r\n      layoutMode,\r\n      isSizing,\r\n      isSomeGroupExpanded\r\n    } = this.state;\r\n    let {\r\n      _selection: selection,\r\n      _dragDropHelper: dragDropHelper\r\n    } = this;\r\n    let groupNestingDepth = this._getGroupNestingDepth();\r\n    let additionalListProps = {\r\n      renderedWindowsAhead: isSizing ? 0 : DEFAULT_RENDERED_WINDOWS_AHEAD,\r\n      renderedWindowsBehind: isSizing ? 0 : DEFAULT_RENDERED_WINDOWS_BEHIND,\r\n      getKey\r\n    };\r\n    let selectAllVisibility = SelectAllVisibility.none; // for SelectionMode.none\r\n    if (selectionMode === SelectionMode.single) {\r\n      selectAllVisibility = SelectAllVisibility.hidden;\r\n    }\r\n    if (selectionMode === SelectionMode.multiple) {\r\n      // if isCollapsedGroupSelectVisible is false, disable select all when the list has all collapsed groups\r\n      let isCollapsedGroupSelectVisible = groupProps && groupProps.headerProps && groupProps.headerProps.isCollapsedGroupSelectVisible;\r\n      if (isCollapsedGroupSelectVisible === undefined) {\r\n        isCollapsedGroupSelectVisible = true;\r\n      }\r\n      let isSelectAllVisible = isCollapsedGroupSelectVisible || !groups || isSomeGroupExpanded;\r\n      selectAllVisibility = isSelectAllVisible ? SelectAllVisibility.visible : SelectAllVisibility.hidden;\r\n    }\r\n\r\n    if (checkboxVisibility === CheckboxVisibility.hidden) {\r\n      selectAllVisibility = SelectAllVisibility.none;\r\n    }\r\n\r\n    return (\r\n      // If shouldApplyApplicationRole is true, role application will be applied to make arrow keys work\r\n      // with JAWS.\r\n      <div\r\n        ref='root'\r\n        className={ css('ms-DetailsList', styles.root, className, {\r\n          'is-fixed': layoutMode === DetailsListLayoutMode.fixedColumns,\r\n          ['is-horizontalConstrained ' + styles.rootIsHorizontalConstrained]: constrainMode === ConstrainMode.horizontalConstrained\r\n        }) }\r\n        data-automationid='DetailsList'\r\n        data-is-scrollable='false'\r\n        aria-label={ ariaLabel }\r\n        { ...(shouldApplyApplicationRole ? { role: 'application' } : {}) }>\r\n        <div role='grid' aria-label={ ariaLabelForGrid }>\r\n          <div onKeyDown={ this._onHeaderKeyDown } role='presentation'>\r\n            { isHeaderVisible && (\r\n              <DetailsHeader\r\n                ref='header'\r\n                selectionMode={ selectionMode }\r\n                layoutMode={ layoutMode }\r\n                selection={ selection }\r\n                columns={ adjustedColumns }\r\n                onColumnClick={ onColumnHeaderClick }\r\n                onColumnContextMenu={ onColumnHeaderContextMenu }\r\n                onColumnResized={ this._onColumnResized }\r\n                onColumnIsSizingChanged={ this._onColumnIsSizingChanged }\r\n                onColumnAutoResized={ this._onColumnAutoResized }\r\n                groupNestingDepth={ groupNestingDepth }\r\n                isAllCollapsed={ isCollapsed }\r\n                onToggleCollapseAll={ this._onToggleCollapse }\r\n                ariaLabel={ ariaLabelForListHeader }\r\n                ariaLabelForSelectAllCheckbox={ ariaLabelForSelectAllCheckbox }\r\n                selectAllVisibility={ selectAllVisibility }\r\n              />\r\n            ) }\r\n          </div>\r\n          <div ref='contentContainer' onKeyDown={ this._onContentKeyDown } role='presentation'>\r\n            <FocusZone\r\n              ref='focusZone'\r\n              className={ styles.focusZone }\r\n              direction={ FocusZoneDirection.vertical }\r\n              isInnerZoneKeystroke={ (ev) => (ev.which === getRTLSafeKeyCode(KeyCodes.right)) }\r\n              onActiveElementChanged={ this._onActiveRowChanged }\r\n            >\r\n              <SelectionZone\r\n                ref='selectionZone'\r\n                selection={ selection }\r\n                selectionPreservedOnEmptyClick={ selectionPreservedOnEmptyClick }\r\n                selectionMode={ selectionMode }\r\n                onItemInvoked={ onItemInvoked }\r\n                onItemContextMenu={ onItemContextMenu }\r\n              >\r\n                { groups ? (\r\n                  <GroupedList\r\n                    groups={ groups }\r\n                    groupProps={ groupProps }\r\n                    items={ items }\r\n                    onRenderCell={ this._onRenderCell }\r\n                    selection={ selection }\r\n                    selectionMode={ selectionMode }\r\n                    dragDropEvents={ dragDropEvents }\r\n                    dragDropHelper={ dragDropHelper }\r\n                    eventsToRegister={ rowElementEventMap }\r\n                    listProps={ additionalListProps }\r\n                    onGroupExpandStateChanged={ this._onGroupExpandStateChanged }\r\n                    ref='groupedList'\r\n                  />\r\n                ) : (\r\n                    <List\r\n                      role={ null }\r\n                      items={ items }\r\n                      onRenderCell={ (item, itemIndex) => this._onRenderCell(0, item, itemIndex) }\r\n                      { ...additionalListProps }\r\n                      ref='list'\r\n                    />\r\n                  )\r\n                }\r\n              </SelectionZone>\r\n            </FocusZone>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  public forceUpdate() {\r\n    super.forceUpdate();\r\n    this._forceListUpdates();\r\n  }\r\n\r\n  @autobind\r\n  protected _onRenderRow(props: IDetailsRowProps, defaultRender?: any) {\r\n    return <DetailsRow { ...props } />;\r\n  }\r\n\r\n  private _onRenderCell(nestingDepth: number, item: any, index: number): React.ReactNode {\r\n    let {\r\n      dragDropEvents,\r\n      rowElementEventMap: eventsToRegister,\r\n      onRenderMissingItem,\r\n      onRenderItemColumn,\r\n      onRenderRow = this._onRenderRow,\r\n      selectionMode,\r\n      viewport,\r\n      checkboxVisibility,\r\n      getRowAriaLabel,\r\n      checkButtonAriaLabel\r\n    } = this.props;\r\n    let selection = this._selection;\r\n    let dragDropHelper = this._dragDropHelper;\r\n    let {\r\n      adjustedColumns: columns\r\n    } = this.state;\r\n\r\n    if (!item) {\r\n      if (onRenderMissingItem) {\r\n        onRenderMissingItem(index);\r\n      }\r\n\r\n      return null;\r\n    }\r\n\r\n    return onRenderRow({\r\n      item: item,\r\n      itemIndex: index,\r\n      columns: columns,\r\n      groupNestingDepth: nestingDepth,\r\n      selectionMode: selectionMode,\r\n      selection: selection,\r\n      onDidMount: this._onRowDidMount,\r\n      onWillUnmount: this._onRowWillUnmount,\r\n      onRenderItemColumn: onRenderItemColumn,\r\n      eventsToRegister: eventsToRegister,\r\n      dragDropEvents: dragDropEvents,\r\n      dragDropHelper: dragDropHelper,\r\n      viewport: viewport,\r\n      checkboxVisibility: checkboxVisibility,\r\n      getRowAriaLabel: getRowAriaLabel,\r\n      checkButtonAriaLabel: checkButtonAriaLabel\r\n    }, this._onRenderRow);\r\n  }\r\n\r\n  private _onGroupExpandStateChanged(isSomeGroupExpanded: boolean) {\r\n    this.setState({ isSomeGroupExpanded: isSomeGroupExpanded });\r\n  }\r\n\r\n  private _onColumnIsSizingChanged(column: IColumn, isSizing: boolean) {\r\n    this.setState({ isSizing: isSizing });\r\n  }\r\n\r\n  private _onHeaderKeyDown(ev: React.KeyboardEvent<HTMLElement>) {\r\n    if (ev.which === KeyCodes.down) {\r\n      if (this.refs.focusZone && this.refs.focusZone.focus()) {\r\n        ev.preventDefault();\r\n        ev.stopPropagation();\r\n      }\r\n    }\r\n  }\r\n\r\n  private _onContentKeyDown(ev: React.KeyboardEvent<HTMLElement>) {\r\n    if (ev.which === KeyCodes.up) {\r\n      if (this.refs.header && this.refs.header.focus()) {\r\n        ev.preventDefault();\r\n        ev.stopPropagation();\r\n      }\r\n    }\r\n  }\r\n\r\n  private _getGroupNestingDepth(): number {\r\n    let { groups } = this.props;\r\n    let level = 0;\r\n    let groupsInLevel = groups;\r\n\r\n    while (groupsInLevel && groupsInLevel.length > 0) {\r\n      level++;\r\n      groupsInLevel = groupsInLevel[0].children;\r\n    }\r\n\r\n    return level;\r\n  }\r\n\r\n  private _onRowDidMount(row: DetailsRow) {\r\n    let { onRowDidMount } = this.props;\r\n    let index = row.props.itemIndex;\r\n\r\n    this._activeRows[index] = row; // this is used for column auto resize\r\n\r\n    // Set focus to the row if it should receive focus.\r\n    if (this._initialFocusedIndex !== undefined && index === this._initialFocusedIndex) {\r\n      if (this.refs.selectionZone) {\r\n        this.refs.selectionZone.ignoreNextFocus();\r\n      }\r\n      row.focus();\r\n\r\n      delete this._initialFocusedIndex;\r\n    }\r\n\r\n    if (onRowDidMount) {\r\n      onRowDidMount(row.props.item, index);\r\n    }\r\n  }\r\n\r\n  private _onRowWillUnmount(row: DetailsRow) {\r\n    let { onRowWillUnmount } = this.props;\r\n    let index = row.props.itemIndex;\r\n\r\n    delete this._activeRows[index];\r\n    this._events.off(row.refs.root);\r\n    if (onRowWillUnmount) {\r\n      onRowWillUnmount(row.props.item, index);\r\n    }\r\n  }\r\n\r\n  private _onToggleCollapse(collapsed: boolean) {\r\n    this.setState({\r\n      isCollapsed: collapsed\r\n    });\r\n    if (this.refs.groupedList) {\r\n      this.refs.groupedList.toggleCollapseAll(collapsed);\r\n    }\r\n  }\r\n\r\n  private _forceListUpdates() {\r\n    if (this.refs.groupedList) {\r\n      this.refs.groupedList.forceUpdate();\r\n    }\r\n    if (this.refs.list) {\r\n      this.refs.list.forceUpdate();\r\n    }\r\n  }\r\n\r\n  private _adjustColumns(newProps: IDetailsListProps, forceUpdate?: boolean, layoutMode?: DetailsListLayoutMode) {\r\n    let adjustedColumns = this._getAdjustedColumns(newProps, forceUpdate, layoutMode);\r\n    let { viewport: { width: viewportWidth } } = this.props;\r\n\r\n    if (adjustedColumns) {\r\n      this.setState({\r\n        adjustedColumns: adjustedColumns,\r\n        lastWidth: viewportWidth,\r\n        layoutMode: layoutMode\r\n      });\r\n    }\r\n  }\r\n\r\n  /** Returns adjusted columns, given the viewport size and layout mode. */\r\n  private _getAdjustedColumns(newProps: IDetailsListProps, forceUpdate?: boolean, layoutMode?: DetailsListLayoutMode): IColumn[] {\r\n    let { columns: newColumns, items: newItems, viewport: { width: viewportWidth }, selectionMode } = newProps;\r\n\r\n    if (layoutMode === undefined) {\r\n      layoutMode = newProps.layoutMode;\r\n    }\r\n\r\n    let columns = this.props ? this.props.columns : [];\r\n    let lastWidth = this.state ? this.state.lastWidth : -1;\r\n    let lastSelectionMode = this.state ? this.state.lastSelectionMode : undefined;\r\n\r\n    if (viewportWidth !== undefined) {\r\n      if (!forceUpdate &&\r\n        lastWidth === viewportWidth &&\r\n        lastSelectionMode === selectionMode &&\r\n        (!columns || newColumns === columns)) {\r\n        return;\r\n      }\r\n    } else {\r\n      viewportWidth = this.props.viewport.width;\r\n    }\r\n\r\n    newColumns = newColumns || buildColumns(newItems, true);\r\n\r\n    let adjustedColumns: IColumn[];\r\n\r\n    if (layoutMode === DetailsListLayoutMode.fixedColumns) {\r\n      adjustedColumns = this._getFixedColumns(newColumns);\r\n    } else {\r\n      adjustedColumns = this._getJustifiedColumns(newColumns, viewportWidth);\r\n    }\r\n\r\n    // Preserve adjusted column calculated widths.\r\n    adjustedColumns.forEach(column => {\r\n      let overrides = this._columnOverrides[column.key] = this._columnOverrides[column.key] || {} as IColumn;\r\n      overrides.calculatedWidth = column.calculatedWidth;\r\n    });\r\n\r\n    return adjustedColumns;\r\n  }\r\n\r\n  /** Builds a set of columns based on the given columns mixed with the current overrides. */\r\n  private _getFixedColumns(newColumns: IColumn[]) {\r\n    return newColumns.map(column => {\r\n      let newColumn = assign({}, column, this._columnOverrides[column.key]);\r\n\r\n      if (!newColumn.calculatedWidth) {\r\n        newColumn.calculatedWidth = newColumn.maxWidth || newColumn.minWidth || MIN_COLUMN_WIDTH;\r\n      }\r\n\r\n      return newColumn;\r\n    });\r\n  }\r\n\r\n  /** Builds a set of columns to fix within the viewport width. */\r\n  private _getJustifiedColumns(newColumns: IColumn[], viewportWidth: number) {\r\n    let {\r\n      selectionMode,\r\n      groups\r\n    } = this.props;\r\n    let outerPadding = DEFAULT_INNER_PADDING;\r\n    let rowCheckWidth = (selectionMode !== SelectionMode.none) ? CHECKBOX_WIDTH : 0;\r\n    let groupExpandWidth = groups ? GROUP_EXPAND_WIDTH : 0;\r\n    let totalWidth = 0; // offset because we have one less inner padding.\r\n    let availableWidth = viewportWidth - outerPadding - rowCheckWidth - groupExpandWidth;\r\n    let adjustedColumns: IColumn[] = newColumns.map((column, i) => {\r\n      let newColumn = assign(\r\n        {},\r\n        column,\r\n        {\r\n          calculatedWidth: column.minWidth || MIN_COLUMN_WIDTH\r\n        });\r\n\r\n      totalWidth += newColumn.calculatedWidth + (i > 0 ? DEFAULT_INNER_PADDING : 0);\r\n\r\n      return newColumn;\r\n    });\r\n\r\n    let lastIndex = adjustedColumns.length - 1;\r\n\r\n    // Remove collapsable columns.\r\n    while (lastIndex > 1 && totalWidth > availableWidth) {\r\n      let column = adjustedColumns[lastIndex];\r\n\r\n      if (column.isCollapsable) {\r\n        totalWidth -= column.calculatedWidth + DEFAULT_INNER_PADDING;\r\n        adjustedColumns.splice(lastIndex, 1);\r\n      }\r\n      lastIndex--;\r\n    }\r\n\r\n    // Then expand columns starting at the beginning, until we've filled the width.\r\n    for (let i = 0; i < adjustedColumns.length && totalWidth < availableWidth; i++) {\r\n      let column = adjustedColumns[i];\r\n      let maxWidth = column.maxWidth;\r\n      let minWidth = column.minWidth || maxWidth || MIN_COLUMN_WIDTH;\r\n      let spaceLeft = availableWidth - totalWidth;\r\n      let increment = maxWidth ? Math.min(spaceLeft, maxWidth - minWidth) : spaceLeft;\r\n\r\n      // Add remaining space to the last column.\r\n      if (i === (adjustedColumns.length - 1)) {\r\n        increment = spaceLeft;\r\n      }\r\n\r\n      column.calculatedWidth += increment;\r\n      totalWidth += increment;\r\n    }\r\n\r\n    // Mark the last column as not resizable to avoid extra scrolling issues.\r\n    if (adjustedColumns.length) {\r\n      adjustedColumns[adjustedColumns.length - 1].isResizable = false;\r\n    }\r\n\r\n    return adjustedColumns;\r\n  }\r\n\r\n  private _onColumnResized(resizingColumn: IColumn, newWidth: number) {\r\n    let newCalculatedWidth = Math.max(resizingColumn.minWidth || MIN_COLUMN_WIDTH, newWidth);\r\n    if (this.props.onColumnResize) {\r\n      this.props.onColumnResize(resizingColumn, newCalculatedWidth);\r\n    }\r\n    this._columnOverrides[resizingColumn.key].calculatedWidth = newCalculatedWidth;\r\n    this._adjustColumns(this.props, true, DetailsListLayoutMode.fixedColumns);\r\n    this._forceListUpdates();\r\n  }\r\n\r\n  /**\r\n   * Callback function when double clicked on the details header column resizer\r\n   * which will measure the column cells of all the active rows and resize the\r\n   * column to the max cell width.\r\n   *\r\n   * @private\r\n   * @param {IColumn} column (double clicked column definition)\r\n   * @param {number} columnIndex (double clicked column index)\r\n   * @todo min width 100 should be changed to const value and should be consistent with the value used on _onSizerMove method in DetailsHeader\r\n   */\r\n  private _onColumnAutoResized(column: IColumn, columnIndex: number) {\r\n    let max = 0;\r\n    let count = 0;\r\n    let totalCount = Object.keys(this._activeRows).length;\r\n\r\n    for (let key in this._activeRows) {\r\n      if (this._activeRows.hasOwnProperty(key)) {\r\n        let currentRow = this._activeRows[key];\r\n        currentRow.measureCell(columnIndex, (width: number) => {\r\n          max = Math.max(max, width);\r\n          count++;\r\n          if (count === totalCount) {\r\n            this._onColumnResized(column, max);\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Call back function when an element in FocusZone becomes active. It will transalate it into item\r\n   * and call onActiveItemChanged callback if specified.\r\n   *\r\n   * @private\r\n   * @param {el} row element that became active in Focus Zone\r\n   * @param {ev} focus event from Focus Zone\r\n   */\r\n  private _onActiveRowChanged(el?: HTMLElement, ev?: React.FocusEvent<HTMLElement>) {\r\n    let { items, onActiveItemChanged } = this.props;\r\n\r\n    if (!onActiveItemChanged || !el) {\r\n      return;\r\n    }\r\n    let index = Number(el.getAttribute('data-item-index'));\r\n    if (index >= 0) {\r\n      onActiveItemChanged(items[index], index, ev);\r\n    }\r\n  };\r\n}\r\n\r\nexport function buildColumns(\r\n  items: any[],\r\n  canResizeColumns?: boolean,\r\n  onColumnClick?: (ev: React.MouseEvent<HTMLElement>, column: IColumn) => any,\r\n  sortedColumnKey?: string,\r\n  isSortedDescending?: boolean,\r\n  groupedColumnKey?: string,\r\n  isMultiline?: boolean) {\r\n  let columns: IColumn[] = [];\r\n\r\n  if (items && items.length) {\r\n    let firstItem = items[0];\r\n    let isFirstColumn = true;\r\n\r\n    for (let propName in firstItem) {\r\n      if (firstItem.hasOwnProperty(propName)) {\r\n        columns.push({\r\n          key: propName,\r\n          name: propName,\r\n          fieldName: propName,\r\n          minWidth: MIN_COLUMN_WIDTH,\r\n          maxWidth: 300,\r\n          isCollapsable: !!columns.length,\r\n          isMultiline: (isMultiline === undefined) ? false : isMultiline,\r\n          isSorted: sortedColumnKey === propName,\r\n          isSortedDescending: !!isSortedDescending,\r\n          isRowHeader: false,\r\n          columnActionsMode: ColumnActionsMode.clickable,\r\n          isResizable: canResizeColumns,\r\n          onColumnClick,\r\n          isGrouped: groupedColumnKey === propName\r\n        });\r\n\r\n        isFirstColumn = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  return columns;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/DetailsList/DetailsList.tsx","/* tslint:disable */\r\nimport { loadStyles } from '@microsoft/load-themed-styles';\r\n\r\nconst styles = {\r\n  root: 'root_999ed1e7',\r\n  focusZone: 'focusZone_999ed1e7',\r\n  rootIsHorizontalConstrained: 'rootIsHorizontalConstrained_999ed1e7',\r\n};\r\n\r\nexport = styles;\r\n\r\nloadStyles([{\"rawString\":\".root_999ed1e7{position:relative;font-size:12px}.focusZone_999ed1e7{display:inline-block;vertical-align:top;min-width:1px;min-height:1px}.rootIsHorizontalConstrained_999ed1e7{overflow-x:auto;overflow-y:visible;-webkit-overflow-scrolling:touch}.root_999ed1e7 .ms-List-cell{min-height:38px;word-break:break-word}\"}]);\r\n/* tslint:enable */\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/DetailsList/DetailsList.scss.ts","import * as React from 'react';\r\nimport { IColumn } from './DetailsList.Props';\r\nimport { css } from '../../Utilities';\r\nimport styles = require('./DetailsRow.scss');\r\n\r\nexport interface IDetailsRowFieldsProps {\r\n  item: any;\r\n  itemIndex: number;\r\n  columns: IColumn[];\r\n  onRenderItemColumn?: (item?: any, index?: number, column?: IColumn) => any;\r\n}\r\n\r\nexport interface IDetailsRowFieldsState {\r\n  cellContent: React.ReactNode[];\r\n}\r\n\r\nexport class DetailsRowFields extends React.Component<IDetailsRowFieldsProps, IDetailsRowFieldsState> {\r\n  constructor(props: IDetailsRowFieldsProps) {\r\n    super();\r\n\r\n    this.state = this._getState(props);\r\n  }\r\n\r\n  public componentWillReceiveProps(newProps: IDetailsRowFieldsProps) {\r\n    this.setState(this._getState(newProps));\r\n  }\r\n\r\n  public render() {\r\n    let { columns } = this.props;\r\n    let { cellContent } = this.state;\r\n\r\n    return (\r\n      <div className={ css('ms-DetailsRow-fields', styles.fields) } data-automationid='DetailsRowFields'>\r\n        { columns.map((column, columnIndex) => (\r\n          <div\r\n            key={ columnIndex }\r\n            role={ column.isRowHeader ? 'rowheader' : 'gridcell' }\r\n            className={ css('ms-DetailsRow-cell', styles.cell, column.className, {\r\n              'is-multiline': column.isMultiline,\r\n              [styles.isMultiline]: column.isMultiline\r\n            }) }\r\n            style={ { width: column.calculatedWidth } }\r\n            data-automationid='DetailsRowCell'\r\n            data-automation-key={ column.key }>\r\n            { cellContent[columnIndex] }\r\n          </div>\r\n        )) }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _getState(props: IDetailsRowFieldsProps) {\r\n    let { item, itemIndex, onRenderItemColumn } = props;\r\n\r\n    return {\r\n      cellContent: props.columns.map((column) => {\r\n        let cellContent;\r\n\r\n        try {\r\n          let render = column.onRender || onRenderItemColumn;\r\n\r\n          cellContent = render ? render(item, itemIndex, column) : this._getCellText(item, column);\r\n        } catch (e) { /* no-op */ }\r\n\r\n        return cellContent;\r\n      })\r\n    };\r\n  }\r\n\r\n  private _getCellText(item, column) {\r\n    let value = (item && column && column.fieldName) ? item[column.fieldName] : '';\r\n\r\n    if (value === null || value === undefined) {\r\n      value = '';\r\n    }\r\n\r\n    return value;\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/DetailsList/DetailsRowFields.tsx","export * from '../../utilities/selection/index';\r\nexport * from '../GroupedList/GroupedList.Props';\r\nexport * from './DetailsList';\r\nexport * from './DetailsList.Props';\r\nexport * from './DetailsRow';\r\nexport * from './DetailsRowCheck';\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/DetailsList/index.ts","import * as React from 'react';\r\nimport {\r\n  EventGroup,\r\n  KeyCodes,\r\n  css\r\n} from '../../Utilities';\r\n\r\nconst DIRECTIONAL_KEY_CODES = [\r\n  KeyCodes.up,\r\n  KeyCodes.down,\r\n  KeyCodes.left,\r\n  KeyCodes.right,\r\n  KeyCodes.home,\r\n  KeyCodes.end,\r\n  KeyCodes.tab,\r\n  KeyCodes.pageUp,\r\n  KeyCodes.pageDown\r\n];\r\n\r\nexport interface IFabricState {\r\n  isFocusVisible?: boolean;\r\n}\r\n\r\n// We will track the last focus visibility state so that if we tear down and recreate\r\n// the Fabric component, we will use the last known value as the default.\r\nlet _lastIsFocusVisible: boolean = false;\r\n\r\n// Ensure that the HTML element has a dir specified. This helps to ensure RTL/LTR macros in css for all components will work.\r\nif (typeof (document) === 'object' && document.documentElement && !document.documentElement.getAttribute('dir')) {\r\n  document.documentElement.setAttribute('dir', 'ltr');\r\n}\r\n\r\nexport class Fabric extends React.Component<React.HTMLProps<HTMLDivElement>, IFabricState> {\r\n  public refs: {\r\n    [key: string]: React.ReactInstance;\r\n    root: HTMLElement;\r\n  };\r\n\r\n  private _events: EventGroup;\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this.state = {\r\n      isFocusVisible: _lastIsFocusVisible\r\n    };\r\n\r\n    this._events = new EventGroup(this);\r\n  }\r\n\r\n  public componentDidMount() {\r\n    this._events.on(document.body, 'mousedown', this._onMouseDown, true);\r\n    this._events.on(document.body, 'keydown', this._onKeyDown, true);\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    this._events.dispose();\r\n  }\r\n\r\n  public render() {\r\n    const { isFocusVisible } = this.state;\r\n    const rootClass = css('ms-Fabric ms-font-m', this.props.className, {\r\n      'is-focusVisible': isFocusVisible\r\n    });\r\n\r\n    return (\r\n      <div { ...this.props } className={ rootClass } ref='root' />\r\n    );\r\n  }\r\n\r\n  private _onMouseDown() {\r\n    if (this.state.isFocusVisible) {\r\n      this.setState({\r\n        isFocusVisible: false\r\n      });\r\n\r\n      _lastIsFocusVisible = false;\r\n    }\r\n  }\r\n\r\n  private _onKeyDown(ev: KeyboardEvent) {\r\n    if (!this.state.isFocusVisible && DIRECTIONAL_KEY_CODES.indexOf(ev.which) > -1) {\r\n      this.setState({\r\n        isFocusVisible: true\r\n      });\r\n\r\n      _lastIsFocusVisible = true;\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Fabric/Fabric.tsx","export * from './Fabric';\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Fabric/index.ts","import * as React from 'react';\r\nimport {\r\n  FocusZoneDirection,\r\n  IFocusZone,\r\n  IFocusZoneProps\r\n} from './FocusZone.Props';\r\nimport {\r\n  BaseComponent,\r\n  EventGroup,\r\n  KeyCodes,\r\n  autobind,\r\n  css,\r\n  divProperties,\r\n  elementContains,\r\n  getDocument,\r\n  getId,\r\n  getNextElement,\r\n  getNativeProps,\r\n  getParent,\r\n  getPreviousElement,\r\n  getRTL,\r\n  isElementFocusZone,\r\n  isElementTabbable\r\n} from '../../Utilities';\r\n\r\nconst IS_FOCUSABLE_ATTRIBUTE = 'data-is-focusable';\r\nconst IS_ENTER_DISABLED_ATTRIBUTE = 'data-disable-click-on-enter';\r\nconst FOCUSZONE_ID_ATTRIBUTE = 'data-focuszone-id';\r\nconst TABINDEX = 'tabindex';\r\n\r\nlet _allInstances: {\r\n  [key: string]: FocusZone\r\n} = {};\r\n\r\ninterface IPoint {\r\n  left: number;\r\n  top: number;\r\n}\r\nconst ALLOWED_INPUT_TYPES = ['text', 'number', 'password', 'email', 'tel', 'url', 'search'];\r\n\r\nexport class FocusZone extends BaseComponent<IFocusZoneProps, {}> implements IFocusZone {\r\n\r\n  public static defaultProps: IFocusZoneProps = {\r\n    isCircularNavigation: false,\r\n    direction: FocusZoneDirection.bidirectional\r\n  };\r\n\r\n  public refs: {\r\n    [key: string]: React.ReactInstance,\r\n    root: HTMLElement\r\n  };\r\n\r\n  private _id: string;\r\n  private _activeElement: HTMLElement;\r\n  private _focusAlignment: IPoint;\r\n  private _isInnerZone: boolean;\r\n\r\n  constructor(props) {\r\n    super(props, { 'rootProps': null });\r\n\r\n    this._id = getId('FocusZone');\r\n    _allInstances[this._id] = this;\r\n\r\n    this._focusAlignment = {\r\n      left: 0,\r\n      top: 0\r\n    };\r\n  }\r\n\r\n  public componentDidMount() {\r\n    const windowElement = this.refs.root.ownerDocument.defaultView;\r\n\r\n    let parentElement = getParent(this.refs.root);\r\n\r\n    while (\r\n      parentElement &&\r\n      parentElement !== document.body &&\r\n      parentElement.nodeType === 1\r\n    ) {\r\n      if (isElementFocusZone(parentElement)) {\r\n        this._isInnerZone = true;\r\n        break;\r\n      }\r\n      parentElement = getParent(parentElement);\r\n    }\r\n\r\n    this._events.on(windowElement, 'keydown', this._onKeyDownCapture, true);\r\n\r\n    // Assign initial tab indexes so that we can set initial focus as appropriate.\r\n    this._updateTabIndexes();\r\n\r\n    if (this.props.defaultActiveElement) {\r\n      this._activeElement = getDocument().querySelector(this.props.defaultActiveElement) as HTMLElement;\r\n      this.focus();\r\n    }\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    delete _allInstances[this._id];\r\n  }\r\n\r\n  public render() {\r\n    let { rootProps, ariaLabelledBy, className } = this.props;\r\n    let divProps = getNativeProps(this.props, divProperties);\r\n\r\n    return (\r\n      <div\r\n        { ...divProps }\r\n        { ...rootProps }\r\n        className={ css('ms-FocusZone', className) }\r\n        ref='root'\r\n        data-focuszone-id={ this._id }\r\n        aria-labelledby={ ariaLabelledBy }\r\n        onKeyDown={ this._onKeyDown }\r\n        onFocus={ this._onFocus }\r\n        { ...{ onMouseDownCapture: this._onMouseDown } }\r\n      >\r\n        { this.props.children }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Sets focus to the first tabbable item in the zone.\r\n   * @returns True if focus could be set to an active element, false if no operation was taken.\r\n   */\r\n  public focus(): boolean {\r\n    if (this._activeElement && elementContains(this.refs.root, this._activeElement)) {\r\n      this._activeElement.focus();\r\n      return true;\r\n    } else {\r\n      const firstChild = this.refs.root.firstChild as HTMLElement;\r\n\r\n      return this.focusElement(getNextElement(this.refs.root, firstChild, true));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Sets focus to a specific child element within the zone. This can be used in conjunction with\r\n   * onBeforeFocus to created delayed focus scenarios (like animate the scroll position to the correct\r\n   * location and then focus.)\r\n   * @param {HTMLElement} element The child element within the zone to focus.\r\n   * @returns True if focus could be set to an active element, false if no operation was taken.\r\n   */\r\n  public focusElement(element: HTMLElement): boolean {\r\n    let { onBeforeFocus } = this.props;\r\n\r\n    if (onBeforeFocus && !onBeforeFocus(element)) {\r\n      return false;\r\n    }\r\n\r\n    if (element) {\r\n      if (this._activeElement) {\r\n        this._activeElement.tabIndex = -1;\r\n      }\r\n\r\n      this._activeElement = element;\r\n\r\n      if (element) {\r\n        if (!this._focusAlignment) {\r\n          this._setFocusAlignment(element, true, true);\r\n        }\r\n\r\n        this._activeElement.tabIndex = 0;\r\n        element.focus();\r\n\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  @autobind\r\n  private _onFocus(ev: React.FocusEvent<HTMLElement>) {\r\n    let { onActiveElementChanged } = this.props;\r\n\r\n    if (this._isImmediateDescendantOfZone(ev.target as HTMLElement)) {\r\n      this._activeElement = ev.target as HTMLElement;\r\n      this._setFocusAlignment(this._activeElement);\r\n    } else {\r\n      let parentElement = ev.target as HTMLElement;\r\n\r\n      while (parentElement && parentElement !== this.refs.root) {\r\n        if (isElementTabbable(parentElement) && this._isImmediateDescendantOfZone(parentElement)) {\r\n          this._activeElement = parentElement;\r\n          break;\r\n        }\r\n        parentElement = getParent(parentElement);\r\n      }\r\n    }\r\n    if (onActiveElementChanged) {\r\n      onActiveElementChanged(this._activeElement, ev);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle global tab presses so that we can patch tabindexes on the fly.\r\n   */\r\n  private _onKeyDownCapture(ev: KeyboardEvent) {\r\n    if (ev.which === KeyCodes.tab) {\r\n      this._updateTabIndexes();\r\n    }\r\n  }\r\n\r\n  @autobind\r\n  private _onMouseDown(ev: React.MouseEvent<HTMLElement>) {\r\n    const { disabled } = this.props;\r\n\r\n    if (disabled) {\r\n      return;\r\n    }\r\n\r\n    let target = ev.target as HTMLElement;\r\n    const path = [];\r\n\r\n    while (target && target !== this.refs.root) {\r\n      path.push(target);\r\n      target = getParent(target);\r\n    }\r\n\r\n    while (path.length) {\r\n      target = path.pop();\r\n\r\n      if (isElementFocusZone(target)) {\r\n        break;\r\n      } else if (target && isElementTabbable(target)) {\r\n        target.tabIndex = 0;\r\n        this._setFocusAlignment(target, true, true);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle the keystrokes.\r\n   */\r\n  @autobind\r\n  private _onKeyDown(ev: React.KeyboardEvent<HTMLElement>) {\r\n    const { direction, disabled, isInnerZoneKeystroke } = this.props;\r\n\r\n    if (disabled) {\r\n      return;\r\n    }\r\n\r\n    if (this.props.onKeyDown) {\r\n      this.props.onKeyDown(ev);\r\n\r\n      if (ev.isDefaultPrevented()) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (\r\n      isInnerZoneKeystroke &&\r\n      this._isImmediateDescendantOfZone(ev.target as HTMLElement) &&\r\n      isInnerZoneKeystroke(ev)) {\r\n\r\n      // Try to focus\r\n      let innerZone = this._getFirstInnerZone();\r\n\r\n      if (!innerZone || !innerZone.focus()) {\r\n        return;\r\n      }\r\n    } else if (ev.altKey) {\r\n      return;\r\n    } else {\r\n      switch (ev.which) {\r\n        case KeyCodes.space:\r\n          if (this._tryInvokeClickForFocusable(ev.target as HTMLElement)) {\r\n            break;\r\n          }\r\n          return;\r\n\r\n        case KeyCodes.left:\r\n          if (direction !== FocusZoneDirection.vertical && this._moveFocusLeft()) {\r\n            break;\r\n          }\r\n          return;\r\n\r\n        case KeyCodes.right:\r\n          if (direction !== FocusZoneDirection.vertical && this._moveFocusRight()) {\r\n            break;\r\n          }\r\n          return;\r\n\r\n        case KeyCodes.up:\r\n          if (direction !== FocusZoneDirection.horizontal && this._moveFocusUp()) {\r\n            break;\r\n          }\r\n          return;\r\n\r\n        case KeyCodes.down:\r\n          if (direction !== FocusZoneDirection.horizontal && this._moveFocusDown()) {\r\n            break;\r\n          }\r\n          return;\r\n\r\n        case KeyCodes.home:\r\n          const firstChild = this.refs.root.firstChild as HTMLElement;\r\n          if (this.focusElement(getNextElement(this.refs.root, firstChild, true))) {\r\n            break;\r\n          }\r\n          return;\r\n\r\n        case KeyCodes.end:\r\n          const lastChild = this.refs.root.lastChild as HTMLElement;\r\n          if (this.focusElement(getPreviousElement(this.refs.root, lastChild, true, true, true))) {\r\n            break;\r\n          }\r\n          return;\r\n\r\n        case KeyCodes.enter:\r\n          if (this._tryInvokeClickForFocusable(ev.target as HTMLElement)) {\r\n            break;\r\n          }\r\n          return;\r\n\r\n        default:\r\n          return;\r\n      }\r\n    }\r\n\r\n    ev.preventDefault();\r\n    ev.stopPropagation();\r\n  }\r\n\r\n  /**\r\n   * Walk up the dom try to find a focusable element.\r\n   */\r\n  private _tryInvokeClickForFocusable(target: HTMLElement): boolean {\r\n    do {\r\n      if (target.tagName === 'BUTTON' || target.tagName === 'A') {\r\n        return false;\r\n      }\r\n\r\n      if (\r\n        this._isImmediateDescendantOfZone(target) &&\r\n        target.getAttribute(IS_FOCUSABLE_ATTRIBUTE) === 'true' &&\r\n        target.getAttribute(IS_ENTER_DISABLED_ATTRIBUTE) !== 'true') {\r\n        EventGroup.raise(target, 'click', null, true);\r\n\r\n        return true;\r\n      }\r\n\r\n      target = getParent(target);\r\n    } while (target !== this.refs.root);\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Traverse to find first child zone.\r\n   */\r\n  private _getFirstInnerZone(rootElement?: HTMLElement): FocusZone {\r\n    rootElement = rootElement || this._activeElement || this.refs.root;\r\n\r\n    let child: HTMLElement = rootElement.firstElementChild as HTMLElement;\r\n\r\n    while (child) {\r\n      if (isElementFocusZone(child)) {\r\n        return _allInstances[child.getAttribute(FOCUSZONE_ID_ATTRIBUTE)];\r\n      }\r\n      let match = this._getFirstInnerZone(child);\r\n\r\n      if (match) {\r\n        return match;\r\n      }\r\n\r\n      child = child.nextElementSibling as HTMLElement;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  private _moveFocus(\r\n    isForward: boolean,\r\n    getDistanceFromCenter: (activeRect: ClientRect, targetRect: ClientRect) => number,\r\n    ev?: Event): boolean {\r\n\r\n    let element = this._activeElement;\r\n    let candidateDistance = -1;\r\n    let candidateElement: HTMLElement;\r\n    let changedFocus = false;\r\n    let isBidirectional = this.props.direction === FocusZoneDirection.bidirectional;\r\n\r\n    if (!element) {\r\n      return false;\r\n    }\r\n\r\n    if (this._isElementInput(element)) {\r\n      if (!this._shouldInputLoseFocus(element as HTMLInputElement, isForward)) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    const activeRect = isBidirectional ? element.getBoundingClientRect() : null;\r\n\r\n    do {\r\n      element = isForward ?\r\n        getNextElement(this.refs.root, element) :\r\n        getPreviousElement(this.refs.root, element);\r\n\r\n      if (isBidirectional) {\r\n        if (element) {\r\n          const targetRect = element.getBoundingClientRect();\r\n          const elementDistance = getDistanceFromCenter(activeRect, targetRect);\r\n\r\n          if (elementDistance > -1 && (candidateDistance === -1 || elementDistance < candidateDistance)) {\r\n            candidateDistance = elementDistance;\r\n            candidateElement = element;\r\n          }\r\n\r\n          if (candidateDistance >= 0 && elementDistance < 0) {\r\n            break;\r\n          }\r\n        }\r\n      } else {\r\n        candidateElement = element;\r\n        break;\r\n      }\r\n\r\n    } while (element);\r\n\r\n    // Focus the closest candidate\r\n    if (candidateElement && candidateElement !== this._activeElement) {\r\n      changedFocus = true;\r\n      this.focusElement(candidateElement);\r\n    } else if (this.props.isCircularNavigation) {\r\n      if (isForward) {\r\n        return this.focusElement(getNextElement(this.refs.root, this.refs.root.firstElementChild as HTMLElement, true));\r\n      } else {\r\n        return this.focusElement(getPreviousElement(this.refs.root, this.refs.root.lastElementChild as HTMLElement, true, true, true));\r\n      }\r\n    }\r\n\r\n    return changedFocus;\r\n  }\r\n\r\n  private _moveFocusDown(): boolean {\r\n    let targetTop = -1;\r\n    const leftAlignment = this._focusAlignment.left;\r\n\r\n    if (this._moveFocus(true, (activeRect: ClientRect, targetRect: ClientRect) => {\r\n      let distance = -1;\r\n      // ClientRect values can be floats that differ by very small fractions of a decimal.\r\n      // If the difference between top and bottom are within a pixel then we should treat\r\n      // them as equivalent by using Math.floor. For instance 5.2222 and 5.222221 should be equivalent,\r\n      // but without Math.Floor they will be handled incorrectly.\r\n      let targetRectTop = Math.floor(targetRect.top);\r\n      let activeRectBottom = Math.floor(activeRect.bottom);\r\n\r\n      if ((targetTop === -1 && targetRectTop >= activeRectBottom) ||\r\n        (targetRectTop === targetTop)) {\r\n        targetTop = targetRectTop;\r\n        if (leftAlignment >= targetRect.left && leftAlignment <= (targetRect.left + targetRect.width)) {\r\n          distance = 0;\r\n        } else {\r\n          distance = Math.abs((targetRect.left + (targetRect.width / 2)) - leftAlignment);\r\n        }\r\n      }\r\n\r\n      return distance;\r\n    })) {\r\n      this._setFocusAlignment(this._activeElement, false, true);\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  private _moveFocusUp(): boolean {\r\n    let targetTop = -1;\r\n    const leftAlignment = this._focusAlignment.left;\r\n\r\n    if (this._moveFocus(false, (activeRect: ClientRect, targetRect: ClientRect) => {\r\n      let distance = -1;\r\n      // ClientRect values can be floats that differ by very small fractions of a decimal.\r\n      // If the difference between top and bottom are within a pixel then we should treat\r\n      // them as equivalent by using Math.floor. For instance 5.2222 and 5.222221 should be equivalent,\r\n      // but without Math.Floor they will be handled incorrectly.\r\n      let targetRectBottom = Math.floor(targetRect.bottom);\r\n      let targetRectTop = Math.floor(targetRect.top);\r\n      let activeRectTop = Math.floor(activeRect.top);\r\n\r\n      if ((targetTop === -1 && targetRectBottom <= activeRectTop) ||\r\n        (targetRectTop === targetTop)) {\r\n        targetTop = targetRectTop;\r\n        if (leftAlignment >= targetRect.left && leftAlignment <= (targetRect.left + targetRect.width)) {\r\n          distance = 0;\r\n        } else {\r\n          distance = Math.abs((targetRect.left + (targetRect.width / 2)) - leftAlignment);\r\n        }\r\n      }\r\n\r\n      return distance;\r\n    })) {\r\n      this._setFocusAlignment(this._activeElement, false, true);\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  private _moveFocusLeft(): boolean {\r\n    let targetTop = -1;\r\n    const topAlignment = this._focusAlignment.top;\r\n\r\n    if (this._moveFocus(getRTL(), (activeRect: ClientRect, targetRect: ClientRect) => {\r\n      let distance = -1;\r\n\r\n      if ((\r\n        targetTop === -1 &&\r\n        targetRect.right <= activeRect.right &&\r\n        (this.props.direction === FocusZoneDirection.horizontal || targetRect.top === activeRect.top)) ||\r\n        (targetRect.top === targetTop)) {\r\n\r\n        targetTop = targetRect.top;\r\n        distance = Math.abs((targetRect.top + (targetRect.height / 2)) - topAlignment);\r\n      }\r\n\r\n      return distance;\r\n    })) {\r\n      this._setFocusAlignment(this._activeElement, true, false);\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  private _moveFocusRight(): boolean {\r\n    let targetTop = -1;\r\n    const topAlignment = this._focusAlignment.top;\r\n\r\n    if (this._moveFocus(!getRTL(), (activeRect: ClientRect, targetRect: ClientRect) => {\r\n      let distance = -1;\r\n\r\n      if ((\r\n        targetTop === -1 &&\r\n        targetRect.left >= activeRect.left &&\r\n        (this.props.direction === FocusZoneDirection.horizontal || targetRect.top === activeRect.top)) ||\r\n        (targetRect.top === targetTop)) {\r\n\r\n        targetTop = targetRect.top;\r\n        distance = Math.abs((targetRect.top + (targetRect.height / 2)) - topAlignment);\r\n      }\r\n\r\n      return distance;\r\n    })) {\r\n      this._setFocusAlignment(this._activeElement, true, false);\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  private _setFocusAlignment(element: HTMLElement, isHorizontal?: boolean, isVertical?: boolean) {\r\n    if (this.props.direction === FocusZoneDirection.bidirectional &&\r\n      (!this._focusAlignment || isHorizontal || isVertical)) {\r\n\r\n      const rect = element.getBoundingClientRect();\r\n      const left = rect.left + (rect.width / 2);\r\n      const top = rect.top + (rect.height / 2);\r\n\r\n      if (!this._focusAlignment) {\r\n        this._focusAlignment = { left, top };\r\n      }\r\n\r\n      if (isHorizontal) {\r\n        this._focusAlignment.left = left;\r\n      }\r\n\r\n      if (isVertical) {\r\n        this._focusAlignment.top = top;\r\n      }\r\n    }\r\n  }\r\n\r\n  private _isImmediateDescendantOfZone(element?: HTMLElement): boolean {\r\n    let parentElement = getParent(element);\r\n\r\n    while (parentElement && parentElement !== this.refs.root && parentElement !== document.body) {\r\n      if (isElementFocusZone(parentElement)) {\r\n        return false;\r\n      }\r\n\r\n      parentElement = getParent(parentElement);\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  private _updateTabIndexes(element?: HTMLElement) {\r\n    if (!element) {\r\n      element = this.refs.root;\r\n      if (this._activeElement && !elementContains(element, this._activeElement)) {\r\n        this._activeElement = null;\r\n      }\r\n    }\r\n\r\n    const childNodes = element.children;\r\n\r\n    for (let childIndex = 0; childNodes && childIndex < childNodes.length; childIndex++) {\r\n      const child = childNodes[childIndex] as HTMLElement;\r\n\r\n      if (!isElementFocusZone(child)) {\r\n        // If the item is explicitly set to not be focusable then TABINDEX needs to be set to -1.\r\n        if (child.getAttribute && child.getAttribute(IS_FOCUSABLE_ATTRIBUTE) === 'false') {\r\n          child.setAttribute(TABINDEX, '-1');\r\n        }\r\n        if (isElementTabbable(child)) {\r\n          if (this.props.disabled) {\r\n            child.setAttribute(TABINDEX, '-1');\r\n          } else if (!this._isInnerZone && (!this._activeElement || this._activeElement === child)) {\r\n            this._activeElement = child;\r\n            if (child.getAttribute(TABINDEX) !== '0') {\r\n              child.setAttribute(TABINDEX, '0');\r\n            }\r\n          } else if (child.getAttribute(TABINDEX) !== '-1') {\r\n            child.setAttribute(TABINDEX, '-1');\r\n          }\r\n        } else if (child.tagName === 'svg' && child.getAttribute('focusable') !== 'false') {\r\n          // Disgusting IE hack. Sad face.\r\n          child.setAttribute('focusable', 'false');\r\n        }\r\n\r\n        this._updateTabIndexes(child);\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  private _isElementInput(element: HTMLElement): boolean {\r\n    if (element && element.tagName && element.tagName.toLowerCase() === 'input') {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private _shouldInputLoseFocus(element: HTMLInputElement, isForward?: boolean) {\r\n    if (element &&\r\n      element.type &&\r\n      ALLOWED_INPUT_TYPES.indexOf(element.type.toLowerCase()) > -1) {\r\n      let selectionStart = element.selectionStart;\r\n      let selectionEnd = element.selectionEnd;\r\n      let isRangeSelected = selectionStart !== selectionEnd;\r\n      let inputValue = element.value;\r\n\r\n      // We shouldn't lose focus in the following cases:\r\n      // 1. There is range selected.\r\n      // 2. When selection start is larger than 0 and it is backward.\r\n      // 3. when selection start is not the end of lenght and it is forward.\r\n      if (isRangeSelected ||\r\n        (selectionStart > 0 && !isForward) ||\r\n        (selectionStart !== inputValue.length && isForward)) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/FocusZone/FocusZone.tsx","export * from './FocusZone';\r\nexport * from './FocusZone.Props';\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/FocusZone/index.ts","import * as React from 'react';\r\nimport {\r\n  BaseComponent,\r\n  autobind,\r\n  css\r\n} from '../../Utilities';\r\nimport { Link } from '../../Link';\r\nimport { IGroupDividerProps } from './GroupedList.Props';\r\nimport { GroupSpacer } from './GroupSpacer';\r\nimport styles = require('./GroupFooter.scss');\r\n\r\nexport class GroupFooter extends BaseComponent<IGroupDividerProps, {}> {\r\n  public render() {\r\n    let { group, groupLevel, showAllLinkText } = this.props;\r\n\r\n    return group && (\r\n      <div className={ css('ms-groupFooter', styles.root) }>\r\n        { GroupSpacer({ count: groupLevel }) }\r\n        <Link onClick={ this._onSummarizeClick }>{ showAllLinkText }</Link>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  @autobind\r\n  private _onSummarizeClick(ev: React.MouseEvent<HTMLElement>) {\r\n    this.props.onToggleSummarize(this.props.group);\r\n\r\n    ev.stopPropagation();\r\n    ev.preventDefault();\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/GroupedList/GroupFooter.tsx","/* tslint:disable */\r\nimport { loadStyles } from '@microsoft/load-themed-styles';\r\n\r\nconst styles = {\r\n  root: 'root_53787d98',\r\n};\r\n\r\nexport = styles;\r\n\r\nloadStyles([{\"rawString\":\".root_53787d98{position:relative;padding:10px 84px;cursor:pointer}.root_53787d98 .ms-Link{font-family:\\\"Segoe UI WestEuropean\\\",\\\"Segoe UI\\\",-apple-system,BlinkMacSystemFont,Roboto,\\\"Helvetica Neue\\\",sans-serif;-webkit-font-smoothing:antialiased;font-size:12px}\"}]);\r\n/* tslint:enable */\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/GroupedList/GroupFooter.scss.ts","import * as React from 'react';\r\nimport {\r\n  autobind,\r\n  css\r\n} from '../../Utilities';\r\nimport { IGroupDividerProps } from './GroupedList.Props';\r\nimport { SelectionMode } from '../../utilities/selection/index';\r\nimport { Check } from '../../Check';\r\nimport { Icon } from '../../Icon';\r\nimport { GroupSpacer } from './GroupSpacer';\r\nimport { Spinner } from '../../Spinner';\r\nimport { FocusZone, FocusZoneDirection } from '../../FocusZone';\r\nimport styles = require('./GroupHeader.scss');\r\n\r\nexport interface IGroupHeaderState {\r\n  isCollapsed: boolean;\r\n  isLoadingVisible: boolean;\r\n}\r\n\r\nexport class GroupHeader extends React.Component<IGroupDividerProps, IGroupHeaderState> {\r\n  constructor(props: IGroupDividerProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      isCollapsed: this.props.group && this.props.group.isCollapsed,\r\n      isLoadingVisible: false\r\n    };\r\n  }\r\n\r\n  public componentWillReceiveProps(newProps) {\r\n    if (newProps.group) {\r\n      let newCollapsed = newProps.group.isCollapsed;\r\n      let isGroupLoading = newProps.headerProps && newProps.headerProps.isGroupLoading;\r\n      let newLoadingVisible = !newCollapsed && isGroupLoading && isGroupLoading(newProps.group);\r\n\r\n      this.setState({\r\n        isCollapsed: newCollapsed,\r\n        isLoadingVisible: newLoadingVisible\r\n      });\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    let {\r\n      group,\r\n      groupLevel,\r\n      viewport,\r\n      selectionMode,\r\n      loadingText,\r\n      isSelected,\r\n      selected,\r\n      isCollapsedGroupSelectVisible\r\n    } = this.props;\r\n    let { isCollapsed, isLoadingVisible } = this.state;\r\n\r\n    if (isCollapsedGroupSelectVisible === undefined) {\r\n      isCollapsedGroupSelectVisible = true;\r\n    }\r\n    let canSelectGroup = selectionMode === SelectionMode.multiple;\r\n    let isSelectionCheckVisible = canSelectGroup && (isCollapsedGroupSelectVisible || !(group && group.isCollapsed));\r\n    let currentlySelected = isSelected || selected;\r\n    return group && (\r\n      <div\r\n        className={ css('ms-GroupHeader', styles.root, {\r\n          ['is-selected ' + styles.rootIsSelected]: currentlySelected\r\n        }) }\r\n        style={ viewport ? { minWidth: viewport.width } : {} }\r\n        onClick={ this._onHeaderClick }\r\n        aria-label={ group.ariaLabel || group.name }\r\n        data-is-focusable={ true } >\r\n\r\n        <FocusZone direction={ FocusZoneDirection.horizontal }>\r\n\r\n          { isSelectionCheckVisible ? (\r\n            <button\r\n              type='button'\r\n              className={ css('ms-GroupHeader-check', styles.check) }\r\n              data-selection-toggle={ true }\r\n              onClick={ this._onToggleSelectGroupClick } >\r\n              <Check checked={ currentlySelected } />\r\n            </button>\r\n          ) : (selectionMode !== SelectionMode.none ? GroupSpacer({ count: 1 }) : null)\r\n          }\r\n\r\n          { GroupSpacer({ count: groupLevel }) }\r\n\r\n          <div className={ css('ms-GroupHeader-dropIcon', styles.dropIcon) }>\r\n            <Icon iconName='Tag' />\r\n          </div>\r\n          <button\r\n            type='button'\r\n            className={ css('ms-GroupHeader-expand', styles.expand) }\r\n            onClick={ this._onToggleCollapse }>\r\n            <Icon\r\n              className={ css(\r\n                isCollapsed && ('is-collapsed ' + styles.expandIsCollapsed)\r\n              ) }\r\n              iconName='ChevronDown'\r\n            />\r\n          </button>\r\n\r\n          <div className={ css('ms-GroupHeader-title ms-font-xl', styles.title) }>\r\n            <span>{ group.name }</span>\r\n            {\r\n              // hasMoreData flag is set when grouping is throttle by SPO server which in turn resorts to regular\r\n              // sorting to simulate grouping behaviors, in which case group count is the number of items returned\r\n              // so far. That's the reasons we need to use \"+\" to show we might have more items than count\r\n              // indicates.\r\n            }\r\n            <span>({ group.count }{ group.hasMoreData && '+' })</span>\r\n          </div>\r\n\r\n          <div\r\n            className={ css(\r\n              'ms-GroupHeader-loading',\r\n              styles.loading,\r\n              isLoadingVisible && ('is-loading ' + styles.loadingIsVisible)\r\n            ) }\r\n          >\r\n            <Spinner label={ loadingText } />\r\n          </div>\r\n\r\n        </FocusZone>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  @autobind\r\n  private _onToggleCollapse(ev: React.MouseEvent<HTMLElement>) {\r\n    let { group, onToggleCollapse, isGroupLoading } = this.props;\r\n    let { isCollapsed } = this.state;\r\n\r\n    let newCollapsed = !isCollapsed;\r\n    let newLoadingVisible = !newCollapsed && isGroupLoading && isGroupLoading(group);\r\n\r\n    this.setState({\r\n      isCollapsed: newCollapsed,\r\n      isLoadingVisible: newLoadingVisible\r\n    });\r\n    if (onToggleCollapse) {\r\n      onToggleCollapse(group);\r\n    }\r\n\r\n    ev.stopPropagation();\r\n    ev.preventDefault();\r\n  }\r\n\r\n  @autobind\r\n  private _onToggleSelectGroupClick(ev: React.MouseEvent<HTMLElement>) {\r\n    let { onToggleSelectGroup, group } = this.props;\r\n\r\n    if (onToggleSelectGroup) {\r\n      onToggleSelectGroup(group);\r\n    }\r\n\r\n    ev.preventDefault();\r\n    ev.stopPropagation();\r\n  }\r\n\r\n  @autobind\r\n  private _onHeaderClick() {\r\n    let { group, onGroupHeaderClick, onToggleSelectGroup } = this.props;\r\n\r\n    if (onGroupHeaderClick) {\r\n      onGroupHeaderClick(group);\r\n    } else if (onToggleSelectGroup) {\r\n      onToggleSelectGroup(group);\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/GroupedList/GroupHeader.tsx","/* tslint:disable */\r\nimport { loadStyles } from '@microsoft/load-themed-styles';\r\n\r\nconst styles = {\r\n  root: 'root_c02d6efa',\r\n  rootIsSelected: 'rootIsSelected_c02d6efa',\r\n  check: 'check_c02d6efa',\r\n  expand: 'expand_c02d6efa',\r\n  title: 'title_c02d6efa',\r\n  expandIsCollapsed: 'expandIsCollapsed_c02d6efa',\r\n  loading: 'loading_c02d6efa',\r\n  loadingIsVisible: 'loadingIsVisible_c02d6efa',\r\n  dropIcon: 'dropIcon_c02d6efa',\r\n};\r\n\r\nexport = styles;\r\n\r\nloadStyles([{\"rawString\":\".root_c02d6efa{cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.root_c02d6efa::-moz-focus-inner{border:0}.root_c02d6efa{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .root_c02d6efa:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid \"},{\"theme\":\"neutralSecondary\",\"defaultValue\":\"#666666\"},{\"rawString\":\"}.root_c02d6efa:hover{background:\"},{\"theme\":\"themeLighterAlt\",\"defaultValue\":\"#eff6fc\"},{\"rawString\":\"}.root_c02d6efa.rootIsSelected_c02d6efa{background:\"},{\"theme\":\"themeLighter\",\"defaultValue\":\"#deecf9\"},{\"rawString\":\"}.root_c02d6efa.rootIsSelected_c02d6efa:hover{background:\"},{\"theme\":\"themeLight\",\"defaultValue\":\"#c7e0f4\"},{\"rawString\":\"}.check_c02d6efa,.expand_c02d6efa{display:inline-block;cursor:default;padding:6px;-webkit-transform:translateY(50%);transform:translateY(50%);margin-top:-12px;box-sizing:border-box;vertical-align:top;background:0 0;border:none;font-size:12px;top:4px}.check_c02d6efa::-moz-focus-inner,.expand_c02d6efa::-moz-focus-inner{border:0}.check_c02d6efa,.expand_c02d6efa{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .check_c02d6efa:focus:after,.ms-Fabric.is-focusVisible .expand_c02d6efa:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid \"},{\"theme\":\"neutralSecondary\",\"defaultValue\":\"#666666\"},{\"rawString\":\"}.check_c02d6efa{opacity:0;margin-top:-10px}.check_c02d6efa:focus{opacity:1}.root_c02d6efa.rootIsSelected_c02d6efa .check_c02d6efa,.root_c02d6efa:hover .check_c02d6efa{opacity:1}.title_c02d6efa{padding:14px 6px;display:inline-block;cursor:pointer;outline:0}.expand_c02d6efa{width:36px;height:40px;color:\"},{\"theme\":\"neutralSecondary\",\"defaultValue\":\"#666666\"},{\"rawString\":\"}.expand_c02d6efa .ms-Icon{-webkit-transform:rotate(-180deg);transform:rotate(-180deg);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;-webkit-transition:-webkit-transform .1s linear;transition:-webkit-transform .1s linear;transition:transform .1s linear;transition:transform .1s linear,-webkit-transform .1s linear}.expand_c02d6efa .ms-Icon.expandIsCollapsed_c02d6efa{-webkit-transform:rotate(0);transform:rotate(0)}.loading_c02d6efa{display:inline-block;visibility:hidden;opacity:0;padding:0 16px;vertical-align:middle;-webkit-transition:visibility 367ms,opacity 367ms;transition:visibility 367ms,opacity 367ms}.loading_c02d6efa.loadingIsVisible_c02d6efa{visibility:visible;opacity:1}.dropIcon_c02d6efa{display:inline-block;position:relative;top:-16px;font-size:20px;color:\"},{\"theme\":\"neutralSecondaryAlt\",\"defaultValue\":\"#767676\"},{\"rawString\":\";-webkit-transition:opacity 467ms cubic-bezier(.39,.575,.565,1),-webkit-transform 267ms cubic-bezier(.6,-.28,.735,.045);transition:opacity 467ms cubic-bezier(.39,.575,.565,1),-webkit-transform 267ms cubic-bezier(.6,-.28,.735,.045);transition:transform 267ms cubic-bezier(.6,-.28,.735,.045),opacity 467ms cubic-bezier(.39,.575,.565,1);transition:transform 267ms cubic-bezier(.6,-.28,.735,.045),opacity 467ms cubic-bezier(.39,.575,.565,1),-webkit-transform 267ms cubic-bezier(.6,-.28,.735,.045);opacity:0;-webkit-transform:rotate(.2deg) scale(.65);transform:rotate(.2deg) scale(.65);-webkit-transform-origin:10px 10px;transform-origin:10px 10px}html[dir=ltr] .dropIcon_c02d6efa{left:-26px}html[dir=rtl] .dropIcon_c02d6efa{right:-26px}.dropIcon_c02d6efa .ms-Icon--Tag{position:absolute}.ms-GroupedList-group.is-dropping>.root_c02d6efa .dropIcon_c02d6efa{-webkit-transition:opacity 167ms cubic-bezier(.39,.575,.565,1),-webkit-transform 467ms cubic-bezier(.075,.82,.165,1);transition:opacity 167ms cubic-bezier(.39,.575,.565,1),-webkit-transform 467ms cubic-bezier(.075,.82,.165,1);transition:transform 467ms cubic-bezier(.075,.82,.165,1),opacity 167ms cubic-bezier(.39,.575,.565,1);transition:transform 467ms cubic-bezier(.075,.82,.165,1),opacity 167ms cubic-bezier(.39,.575,.565,1),-webkit-transform 467ms cubic-bezier(.075,.82,.165,1);-webkit-transition-delay:367ms;transition-delay:367ms;opacity:1;-webkit-transform:rotate(.2deg) scale(1);transform:rotate(.2deg) scale(1)}.ms-GroupedList-group.is-dropping .check_c02d6efa{opacity:0}\"}]);\r\n/* tslint:enable */\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/GroupedList/GroupHeader.scss.ts","/* tslint:disable */\r\nimport { loadStyles } from '@microsoft/load-themed-styles';\r\n\r\nconst styles = {\r\n  root: 'root_195d11b1',\r\n};\r\n\r\nexport = styles;\r\n\r\nloadStyles([{\"rawString\":\".root_195d11b1{display:inline-block}\"}]);\r\n/* tslint:enable */\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/GroupedList/GroupSpacer.scss.ts","import * as React from 'react';\r\nimport {\r\n  BaseComponent,\r\n  autobind,\r\n  assign,\r\n  css\r\n} from '../../Utilities';\r\nimport {\r\n  IGroupedList,\r\n  IGroupedListProps,\r\n  IGroup\r\n} from './GroupedList.Props';\r\nimport {\r\n  GroupedListSection\r\n} from './GroupedListSection';\r\nimport {\r\n  List\r\n} from '../../List';\r\nimport {\r\n  SelectionMode\r\n} from '../../utilities/selection/index';\r\nimport styles = require('./GroupedList.scss');\r\n\r\nexport interface IGroupedListState {\r\n  lastWidth?: number;\r\n  lastSelectionMode?: SelectionMode;\r\n  groups?: IGroup[];\r\n}\r\n\r\nexport class GroupedList extends BaseComponent<IGroupedListProps, IGroupedListState> implements IGroupedList {\r\n  public static defaultProps = {\r\n    selectionMode: SelectionMode.multiple,\r\n    isHeaderVisible: true,\r\n    groupProps: {}\r\n  };\r\n\r\n  public refs: {\r\n    [key: string]: React.ReactInstance,\r\n    root: HTMLElement,\r\n    list: List\r\n  };\r\n\r\n  private _isSomeGroupExpanded: boolean;\r\n\r\n  constructor(props: IGroupedListProps) {\r\n    super(props);\r\n\r\n    this._isSomeGroupExpanded = this._computeIsSomeGroupExpanded(props.groups);\r\n\r\n    this.state = {\r\n      lastWidth: 0,\r\n      groups: props.groups\r\n    };\r\n  }\r\n\r\n  public componentWillReceiveProps(newProps) {\r\n    let {\r\n      groups,\r\n      selectionMode\r\n    } = this.props;\r\n    let shouldForceUpdates = false;\r\n\r\n    if (newProps.groups !== groups) {\r\n      this.setState({ groups: newProps.groups });\r\n      shouldForceUpdates = true;\r\n    }\r\n\r\n    if (newProps.selectionMode !== selectionMode) {\r\n      shouldForceUpdates = true;\r\n    }\r\n\r\n    if (shouldForceUpdates) {\r\n      this._forceListUpdates();\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    let {\r\n      className\r\n    } = this.props;\r\n    let {\r\n      groups\r\n    } = this.state;\r\n\r\n    return (\r\n      <div\r\n        ref='root'\r\n        className={ css('ms-GroupedList', styles.root, className) }\r\n        data-automationid='GroupedList'\r\n        data-is-scrollable='false'\r\n        role='grid'\r\n      >\r\n        { !groups ?\r\n          this._renderGroup(null, 0) : (\r\n            <List\r\n              ref='list'\r\n              items={ groups }\r\n              onRenderCell={ this._renderGroup }\r\n              getItemCountForPage={ () => 1 }\r\n            />\r\n          )\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  public forceUpdate() {\r\n    super.forceUpdate();\r\n    this._forceListUpdates();\r\n  }\r\n\r\n  public toggleCollapseAll(allCollapsed: boolean) {\r\n    let { groups } = this.state;\r\n    let { groupProps } = this.props;\r\n    let onToggleCollapseAll = groupProps && groupProps.onToggleCollapseAll;\r\n\r\n    if (groups) {\r\n      if (onToggleCollapseAll) {\r\n        onToggleCollapseAll(allCollapsed);\r\n      }\r\n\r\n      for (let groupIndex = 0; groupIndex < groups.length; groupIndex++) {\r\n        groups[groupIndex].isCollapsed = allCollapsed;\r\n      }\r\n\r\n      this._updateIsSomeGroupExpanded();\r\n\r\n      this.forceUpdate();\r\n    }\r\n  }\r\n\r\n  @autobind\r\n  private _renderGroup(group, groupIndex) {\r\n    let {\r\n      dragDropEvents,\r\n      dragDropHelper,\r\n      eventsToRegister,\r\n      groupProps,\r\n      items,\r\n      listProps,\r\n      onRenderCell,\r\n      selectionMode,\r\n      selection,\r\n      viewport\r\n    } = this.props;\r\n\r\n    // override group header/footer props as needed\r\n    let dividerProps = {\r\n      onToggleSelectGroup: this._onToggleSelectGroup,\r\n      onToggleCollapse: this._onToggleCollapse,\r\n      onToggleSummarize: this._onToggleSummarize\r\n    };\r\n\r\n    let headerProps = assign({}, groupProps.headerProps, dividerProps);\r\n    let footerProps = assign({}, groupProps.footerProps, dividerProps);\r\n    let groupNestingDepth = this._getGroupNestingDepth();\r\n\r\n    return (!group || group.count > 0) ? (\r\n      <GroupedListSection\r\n        ref={ 'group_' + groupIndex }\r\n        key={ this._getGroupKey(group, groupIndex) }\r\n        dragDropEvents={ dragDropEvents }\r\n        dragDropHelper={ dragDropHelper }\r\n        eventsToRegister={ eventsToRegister }\r\n        footerProps={ footerProps }\r\n        getGroupItemLimit={ groupProps && groupProps.getGroupItemLimit }\r\n        group={ group }\r\n        groupIndex={ groupIndex }\r\n        groupNestingDepth={ groupNestingDepth }\r\n        headerProps={ headerProps }\r\n        listProps={ listProps }\r\n        items={ items }\r\n        onRenderCell={ onRenderCell }\r\n        onRenderGroupHeader={ groupProps.onRenderHeader }\r\n        onRenderGroupFooter={ groupProps.onRenderFooter }\r\n        selectionMode={ selectionMode }\r\n        selection={ selection }\r\n        viewport={ viewport }\r\n      />\r\n    ) : null;\r\n  }\r\n\r\n  private _getGroupKey(group: IGroup, index: number): string {\r\n    return 'group-' + ((group && group.key) ? group.key : String(index));\r\n  }\r\n\r\n  private _getGroupNestingDepth(): number {\r\n    let { groups } = this.state;\r\n    let level = 0;\r\n    let groupsInLevel = groups;\r\n\r\n    while (groupsInLevel && groupsInLevel.length > 0) {\r\n      level++;\r\n      groupsInLevel = groupsInLevel[0].children;\r\n    }\r\n\r\n    return level;\r\n  }\r\n\r\n  @autobind\r\n  private _onToggleCollapse(group: IGroup) {\r\n    let { groupProps } = this.props;\r\n    let onToggleCollapse = groupProps && groupProps.headerProps && groupProps.headerProps.onToggleCollapse;\r\n\r\n    if (group) {\r\n      if (onToggleCollapse) {\r\n        onToggleCollapse(group);\r\n      }\r\n\r\n      group.isCollapsed = !group.isCollapsed;\r\n      this._updateIsSomeGroupExpanded();\r\n      this.forceUpdate();\r\n    }\r\n  }\r\n\r\n  @autobind\r\n  private _onToggleSelectGroup(group: IGroup) {\r\n    if (group) {\r\n      this.props.selection.toggleRangeSelected(group.startIndex, group.count);\r\n    }\r\n  }\r\n\r\n  private _forceListUpdates(groups?: IGroup[]) {\r\n    groups = groups || this.state.groups;\r\n\r\n    let groupCount = groups ? groups.length : 1;\r\n\r\n    if (this.refs.list) {\r\n      this.refs.list.forceUpdate();\r\n\r\n      for (let i = 0; i < groupCount; i++) {\r\n        let group = this.refs.list.refs['group_' + String(i)] as GroupedListSection;\r\n        if (group) {\r\n          group.forceListUpdate();\r\n        }\r\n      }\r\n    } else {\r\n      let group = this.refs['group_' + String(0)] as GroupedListSection;\r\n      if (group) {\r\n        group.forceListUpdate();\r\n      }\r\n    }\r\n  }\r\n\r\n  @autobind\r\n  private _onToggleSummarize(group: IGroup) {\r\n    let { groupProps } = this.props;\r\n    let onToggleSummarize = groupProps && groupProps.footerProps && groupProps.footerProps.onToggleSummarize;\r\n\r\n    if (onToggleSummarize) {\r\n      onToggleSummarize(group);\r\n    } else {\r\n      if (group) {\r\n        group.isShowingAll = !group.isShowingAll;\r\n      }\r\n\r\n      this.forceUpdate();\r\n    }\r\n  }\r\n\r\n  private _computeIsSomeGroupExpanded(groups: IGroup[]) {\r\n    return groups && groups.some(group => group.children ? this._computeIsSomeGroupExpanded(group.children) : !group.isCollapsed);\r\n  }\r\n\r\n  private _updateIsSomeGroupExpanded() {\r\n    let { groups } = this.state;\r\n    let { onGroupExpandStateChanged } = this.props;\r\n\r\n    let newIsSomeGroupExpanded = this._computeIsSomeGroupExpanded(groups);\r\n    if (this._isSomeGroupExpanded !== newIsSomeGroupExpanded) {\r\n      if (onGroupExpandStateChanged) {\r\n        onGroupExpandStateChanged(newIsSomeGroupExpanded);\r\n      }\r\n      this._isSomeGroupExpanded = newIsSomeGroupExpanded;\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/GroupedList/GroupedList.tsx","import * as React from 'react';\r\nimport {\r\n  IGroup,\r\n  IGroupDividerProps\r\n} from './GroupedList.Props';\r\n\r\nimport {\r\n  IDragDropContext,\r\n  IDragDropEvents,\r\n  IDragDropHelper\r\n} from '../../utilities/dragdrop/index';\r\n\r\nimport {\r\n  BaseComponent,\r\n  IRenderFunction,\r\n  autobind\r\n} from '../../Utilities';\r\n\r\nimport {\r\n  ISelection,\r\n  SelectionMode,\r\n  SELECTION_CHANGE\r\n} from '../../utilities/selection/index';\r\n\r\nimport { GroupFooter } from './GroupFooter';\r\nimport { GroupHeader } from './GroupHeader';\r\n\r\nimport {\r\n  List\r\n} from '../../List';\r\nimport {\r\n  IDragDropOptions\r\n} from './../../utilities/dragdrop/interfaces';\r\nimport { assign, css } from '../../Utilities';\r\nimport { IViewport } from '../../utilities/decorators/withViewport';\r\nimport styles = require('./GroupedList.scss');\r\nimport { IDisposable } from '@uifabric/utilities';\r\n\r\nexport interface IGroupedListSectionProps extends React.Props<GroupedListSection> {\r\n  /** Map of callback functions related to drag and drop functionality. */\r\n  dragDropEvents?: IDragDropEvents;\r\n\r\n  /** helper to manage drag/drop across item rows and groups */\r\n  dragDropHelper?: IDragDropHelper;\r\n\r\n  /** Event names and corresponding callbacks that will be registered to the group and the rendered elements */\r\n  eventsToRegister?: { eventName: string, callback: (context: IDragDropContext, event?: any) => void }[];\r\n\r\n  /** Information to pass in to the group footer. */\r\n  footerProps?: IGroupDividerProps;\r\n\r\n  /** Grouping item limit. */\r\n  getGroupItemLimit?: (group: IGroup) => number;\r\n\r\n  /** Optional grouping instructions. */\r\n  groupIndex?: number;\r\n\r\n  /** Optional group nesting level. */\r\n  groupNestingDepth?: number;\r\n\r\n  /** Optional grouping instructions. */\r\n  group?: IGroup;\r\n\r\n  /** Information to pass in to the group header. */\r\n  headerProps?: IGroupDividerProps;\r\n\r\n  /** List of items to render. */\r\n  items: any[];\r\n\r\n  /** Optional list props to pass to list renderer.  */\r\n  listProps?: any;\r\n\r\n  /** Rendering callback to render the group items. */\r\n  onRenderCell: (\r\n    nestingDepth?: number,\r\n    item?: any,\r\n    index?: number\r\n  ) => React.ReactNode;\r\n\r\n  /** Optional selection model to track selection state.  */\r\n  selection?: ISelection;\r\n\r\n  /** Controls how/if the details list manages selection. */\r\n  selectionMode?: SelectionMode;\r\n\r\n  /** Optional Viewport, provided by the parent component. */\r\n  viewport?: IViewport;\r\n\r\n  /** Override for rendering the group header. */\r\n  onRenderGroupHeader?: IRenderFunction<IGroupDividerProps>;\r\n\r\n  /** Override for rendering the group footer. */\r\n  onRenderGroupFooter?: IRenderFunction<IGroupDividerProps>;\r\n}\r\n\r\nexport interface IGroupedListSectionState {\r\n  isDropping?: boolean;\r\n  isSelected?: boolean;\r\n}\r\n\r\nconst DEFAULT_DROPPING_CSS_CLASS = 'is-dropping';\r\n\r\nexport class GroupedListSection extends BaseComponent<IGroupedListSectionProps, IGroupedListSectionState> {\r\n  public refs: {\r\n    [key: string]: React.ReactInstance,\r\n    root: HTMLElement,\r\n    list: List\r\n  };\r\n\r\n  private _subGroups: {\r\n    [key: string]: GroupedListSection;\r\n  };\r\n  private _dragDropSubscription: IDisposable;\r\n\r\n  constructor(props: IGroupedListSectionProps) {\r\n    super(props);\r\n\r\n    let { selection, group } = props;\r\n\r\n    this._subGroups = {};\r\n    this.state = {\r\n      isDropping: false,\r\n      isSelected: (selection && group) ? selection.isRangeSelected(group.startIndex, group.count) : false\r\n    };\r\n  }\r\n\r\n  public componentDidMount() {\r\n    let { dragDropHelper, selection } = this.props;\r\n\r\n    if (dragDropHelper) {\r\n      this._dragDropSubscription = dragDropHelper.subscribe(this.refs.root, this._events, this._getGroupDragDropOptions());\r\n    }\r\n\r\n    if (selection) {\r\n      this._events.on(selection, SELECTION_CHANGE, this._onSelectionChange);\r\n    }\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    if (this._dragDropSubscription) {\r\n      this._dragDropSubscription.dispose();\r\n    }\r\n  }\r\n\r\n  public componentDidUpdate(previousProps: IGroupedListSectionProps) {\r\n    if (this.props.group !== previousProps.group ||\r\n      this.props.groupIndex !== previousProps.groupIndex ||\r\n      this.props.dragDropHelper !== previousProps.dragDropHelper) {\r\n      if (this._dragDropSubscription) {\r\n        this._dragDropSubscription.dispose();\r\n        delete this._dragDropSubscription;\r\n      }\r\n\r\n      if (this.props.dragDropHelper) {\r\n        this._dragDropSubscription = this.props.dragDropHelper.subscribe(this.refs.root, this._events, this._getGroupDragDropOptions());\r\n      }\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    let {\r\n      getGroupItemLimit,\r\n      group,\r\n      groupIndex,\r\n      headerProps,\r\n      footerProps,\r\n      viewport,\r\n      selectionMode,\r\n      onRenderGroupHeader = this._onRenderGroupHeader,\r\n      onRenderGroupFooter = this._onRenderGroupFooter\r\n    } = this.props;\r\n    let { isSelected } = this.state;\r\n    let renderCount = group && getGroupItemLimit ? getGroupItemLimit(group) : Infinity;\r\n    let isFooterVisible = group && !group.children && !group.isCollapsed && !group.isShowingAll &&\r\n      (group.count > renderCount || group.hasMoreData);\r\n    let hasNestedGroups = group && group.children && group.children.length > 0;\r\n\r\n    let dividerProps: IGroupDividerProps = {\r\n      group: group,\r\n      groupIndex: groupIndex,\r\n      groupLevel: group ? group.level : 0,\r\n      isSelected,\r\n      viewport: viewport,\r\n      selectionMode: selectionMode\r\n    };\r\n    let groupHeaderProps: IGroupDividerProps = assign({}, headerProps, dividerProps);\r\n    let groupFooterProps: IGroupDividerProps = assign({}, footerProps, dividerProps);\r\n\r\n    return (\r\n      <div\r\n        ref='root'\r\n        className={ css('ms-GroupedList-group', styles.group, this._getDroppingClassName()) }\r\n      >\r\n        { onRenderGroupHeader(groupHeaderProps, this._onRenderGroupHeader) }\r\n        {\r\n          group && group.isCollapsed ?\r\n            null :\r\n            (\r\n              hasNestedGroups ?\r\n                (\r\n                  <List\r\n                    ref='list'\r\n                    items={ group.children }\r\n                    onRenderCell={ this._renderSubGroup }\r\n                    getItemCountForPage={ () => 1 }\r\n                  />\r\n                ) :\r\n                this._onRenderGroup(renderCount)\r\n            )\r\n        }\r\n        { isFooterVisible && onRenderGroupFooter(groupFooterProps, this._onRenderGroupFooter) }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  public forceUpdate() {\r\n    super.forceUpdate();\r\n    this.forceListUpdate();\r\n  }\r\n\r\n  public forceListUpdate() {\r\n    let { group } = this.props;\r\n\r\n    if (this.refs.list) {\r\n      this.refs.list.forceUpdate();\r\n\r\n      if (group && group.children && group.children.length > 0) {\r\n        let subGroupCount = group.children.length;\r\n\r\n        for (let i = 0; i < subGroupCount; i++) {\r\n          let subGroup = this.refs.list.refs['subGroup_' + String(i)] as GroupedListSection;\r\n\r\n          if (subGroup) {\r\n            subGroup.forceListUpdate();\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      let subGroup = this.refs['subGroup_' + String(0)] as GroupedListSection;\r\n\r\n      if (subGroup) {\r\n        subGroup.forceListUpdate();\r\n      }\r\n    }\r\n  }\r\n\r\n  @autobind\r\n  private _onRenderGroupHeader(props: IGroupDividerProps) {\r\n    return <GroupHeader { ...props } />;\r\n  }\r\n\r\n  @autobind\r\n  private _onRenderGroupFooter(props: IGroupDividerProps) {\r\n    return <GroupFooter { ...props } />;\r\n  }\r\n\r\n  private _onSelectionChange() {\r\n    let { group, selection } = this.props;\r\n    let isSelected = selection.isRangeSelected(group.startIndex, group.count);\r\n\r\n    if (isSelected !== this.state.isSelected) {\r\n      this.setState({ isSelected });\r\n    }\r\n  }\r\n\r\n  private _onRenderGroup(renderCount: number) {\r\n    let {\r\n      group,\r\n      items,\r\n      onRenderCell,\r\n      listProps,\r\n      groupNestingDepth\r\n    } = this.props;\r\n    let count = group ? group.count : items.length;\r\n    let startIndex = group ? group.startIndex : 0;\r\n\r\n    return (\r\n      <List\r\n        items={ items }\r\n        onRenderCell={ (item, itemIndex) => onRenderCell(groupNestingDepth, item, itemIndex) }\r\n        ref={ 'list' }\r\n        renderCount={ Math.min(count, renderCount) }\r\n        startIndex={ startIndex }\r\n        { ...listProps }\r\n      />\r\n    );\r\n  }\r\n\r\n  @autobind\r\n  private _renderSubGroup(subGroup, subGroupIndex) {\r\n    let {\r\n      dragDropEvents,\r\n      dragDropHelper,\r\n      eventsToRegister,\r\n      getGroupItemLimit,\r\n      groupNestingDepth,\r\n      items,\r\n      headerProps,\r\n      footerProps,\r\n      listProps,\r\n      onRenderCell,\r\n      selection,\r\n      selectionMode,\r\n      viewport\r\n    } = this.props;\r\n\r\n    return (!subGroup || subGroup.count > 0) ? (\r\n      <GroupedListSection\r\n        ref={ 'subGroup_' + subGroupIndex }\r\n        key={ this._getGroupKey(subGroup, subGroupIndex) }\r\n        dragDropEvents={ dragDropEvents }\r\n        dragDropHelper={ dragDropHelper }\r\n        eventsToRegister={ eventsToRegister }\r\n        footerProps={ footerProps }\r\n        getGroupItemLimit={ getGroupItemLimit }\r\n        group={ subGroup }\r\n        groupIndex={ subGroupIndex }\r\n        groupNestingDepth={ groupNestingDepth }\r\n        headerProps={ headerProps }\r\n        items={ items }\r\n        listProps={ listProps }\r\n        onRenderCell={ onRenderCell }\r\n        selection={ selection }\r\n        selectionMode={ selectionMode }\r\n        viewport={ viewport }\r\n      />\r\n    ) : null;\r\n  }\r\n\r\n  private _getGroupKey(group, index) {\r\n    return 'group-' + ((group && group.key) ? group.key : String(group.level) + String(index));\r\n  }\r\n\r\n  /**\r\n   * collect all the data we need to enable drag/drop for a group\r\n   */\r\n  @autobind\r\n  private _getGroupDragDropOptions(): IDragDropOptions {\r\n    let { group, groupIndex, dragDropEvents, eventsToRegister } = this.props;\r\n    let options = {\r\n      eventMap: eventsToRegister,\r\n      selectionIndex: -1,\r\n      context: { data: group, index: groupIndex, isGroup: true },\r\n      canDrag: () => false, // cannot drag groups\r\n      canDrop: dragDropEvents.canDrop,\r\n      onDragStart: null,\r\n      updateDropState: this._updateDroppingState\r\n    };\r\n    return options;\r\n  }\r\n\r\n  /**\r\n   * update groupIsDropping state based on the input value, which is used to change style during drag and drop\r\n   *\r\n   * @private\r\n   * @param {boolean} newValue (new isDropping state value)\r\n   * @param {DragEvent} event (the event trigger dropping state change which can be dragenter, dragleave etc)\r\n   */\r\n  @autobind\r\n  private _updateDroppingState(newIsDropping: boolean, event: DragEvent) {\r\n    let { isDropping } = this.state;\r\n    let { dragDropEvents } = this.props;\r\n\r\n    if (!isDropping) {\r\n      if (dragDropEvents.onDragLeave) {\r\n        dragDropEvents.onDragLeave(event, null);\r\n      }\r\n    } else {\r\n      if (dragDropEvents.onDragEnter) {\r\n        dragDropEvents.onDragEnter(event, null);\r\n      }\r\n    }\r\n\r\n    if (isDropping !== newIsDropping) {\r\n      this.setState({ isDropping: newIsDropping });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * get the correct css class to reflect the dropping state for a given group\r\n   *\r\n   * If the group is the current drop target, return the default dropping class name\r\n   * Otherwise, return '';\r\n   *\r\n   */\r\n  private _getDroppingClassName(): string {\r\n    let { isDropping } = this.state;\r\n    let { group } = this.props;\r\n\r\n    isDropping = !!(group && isDropping);\r\n\r\n    return css(\r\n      isDropping && DEFAULT_DROPPING_CSS_CLASS,\r\n      isDropping && styles.groupIsDropping\r\n    );\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/GroupedList/GroupedListSection.tsx","export * from './GroupedList';\r\nexport * from './GroupedList.Props';\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/GroupedList/index.ts","/* tslint:disable */\r\nimport * as React from 'react';\r\nimport styles = require('./Icon.scss')\r\n/* tslint:enable */\r\nimport { IIconProps } from './Icon.Props';\r\nimport { IconType } from './IconType';\r\nimport { Image } from '../Image/Image';\r\nimport {\r\n  css,\r\n  getNativeProps,\r\n  htmlElementProperties\r\n} from '../../Utilities';\r\n\r\nexport const Icon: (props: IIconProps) => JSX.Element = (props: IIconProps) => {\r\n  let customIcon = props.iconName === 'None';\r\n  let iconClassName = props.iconName ? ('ms-Icon--' + props.iconName) : '';\r\n\r\n  if (props.iconType === IconType.Image) {\r\n    let containerClassName = css('ms-Icon', 'ms-Icon-imageContainer', styles.imageContainer, props.className);\r\n\r\n    return (\r\n      <div className={ containerClassName } >\r\n        <Image { ...props.imageProps as any } />\r\n      </div>\r\n    );\r\n  } else {\r\n    let className = css('ms-Icon', customIcon ? '' : iconClassName, props.className);\r\n\r\n    return <i { ...getNativeProps(props, htmlElementProperties) } className={ className } />;\r\n  }\r\n};\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Icon/Icon.tsx","/* tslint:disable */\r\nimport { loadStyles } from '@microsoft/load-themed-styles';\r\n\r\nconst styles = {\r\n  imageContainer: 'imageContainer_a4860255',\r\n};\r\n\r\nexport = styles;\r\n\r\nloadStyles([{\"rawString\":\".imageContainer_a4860255{overflow:hidden}\"}]);\r\n/* tslint:enable */\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Icon/Icon.scss.ts","export * from './Icon';\r\nexport * from './Icon.Props';\r\nexport * from './IconName';\r\nexport * from './IconType';\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Icon/index.ts","/* tslint:disable:no-unused-variable */\r\nimport * as React from 'react';\r\n/* tslint:enable:no-unused-variable */\r\nimport {\r\n  autobind,\r\n  BaseComponent,\r\n  css,\r\n  getNativeProps,\r\n  imageProperties\r\n} from '../../Utilities';\r\nimport { IImageProps, ImageFit, ImageLoadState } from './Image.Props';\r\n\r\nimport styles = require('./Image.scss');\r\n\r\nexport interface IImageState {\r\n  loadState?: ImageLoadState;\r\n}\r\n\r\nexport enum CoverStyle {\r\n  landscape = 0,\r\n  portrait = 1\r\n}\r\n\r\nexport const CoverStyleMap = {\r\n  [CoverStyle.landscape]: 'ms-Image-image--landscape ' + styles.imageIsLandscape,\r\n  [CoverStyle.portrait]: 'ms-Image-image--portrait ' + styles.imageIsPortrait\r\n};\r\n\r\nexport const ImageFitMap = {\r\n  [ImageFit.center]: 'ms-Image-image--center ' + styles.imageIsCenter,\r\n  [ImageFit.contain]: 'ms-Image-image--contain ' + styles.imageIsContain,\r\n  [ImageFit.cover]: 'ms-Image-image--cover ' + styles.imageIsCover,\r\n  [ImageFit.none]: 'ms-Image-image--none ' + styles.imageIsNone\r\n};\r\n\r\nconst KEY_PREFIX: string = 'fabricImage';\r\n\r\nexport class Image extends BaseComponent<IImageProps, IImageState> {\r\n  public static defaultProps = {\r\n    shouldFadeIn: true\r\n  };\r\n\r\n  private static _svgRegex = /\\.svg$/i;\r\n\r\n  // Make an initial assumption about the image layout until we can\r\n  // check the rendered element. The value here only takes effect when\r\n  // shouldStartVisible is true.\r\n  private _coverStyle: CoverStyle = CoverStyle.portrait;\r\n  private _imageElement: HTMLImageElement;\r\n  private _frameElement: HTMLDivElement;\r\n\r\n  constructor(props: IImageProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      loadState: ImageLoadState.notLoaded\r\n    };\r\n  }\r\n\r\n  public componentWillReceiveProps(nextProps: IImageProps) {\r\n    if (nextProps.src !== this.props.src) {\r\n      this.setState({\r\n        loadState: ImageLoadState.notLoaded\r\n      });\r\n    } else if (this.state.loadState === ImageLoadState.loaded) {\r\n      this._computeCoverStyle(nextProps);\r\n    }\r\n  }\r\n\r\n  public componentDidUpdate(prevProps: IImageProps, prevState: IImageState) {\r\n    this._checkImageLoaded();\r\n    if (this.props.onLoadingStateChange\r\n      && prevState.loadState !== this.state.loadState) {\r\n      this.props.onLoadingStateChange(this.state.loadState);\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    let imageProps = getNativeProps(this.props, imageProperties, ['width', 'height']);\r\n    let { src, alt, width, height, shouldFadeIn, className, imageFit, role, maximizeFrame} = this.props;\r\n    let { loadState } = this.state;\r\n    let coverStyle = this._coverStyle;\r\n    let loaded = loadState === ImageLoadState.loaded || (loadState === ImageLoadState.notLoaded && this.props.shouldStartVisible);\r\n\r\n    // If image dimensions aren't specified, the natural size of the image is used.\r\n    return (\r\n      <div\r\n        className={ css(\r\n          'ms-Image',\r\n          styles.root,\r\n          className,\r\n          {\r\n            ['ms-Image--maximizeFrame ' + styles.rootIsMaximizeFrame]: maximizeFrame\r\n          })\r\n        }\r\n        style={ { width: width, height: height } }\r\n        ref={ this._resolveRef('_frameElement') }\r\n      >\r\n        <img\r\n          { ...imageProps }\r\n          onLoad={ this._onImageLoaded }\r\n          onError={ this._onImageError }\r\n          key={ KEY_PREFIX + this.props.src || '' }\r\n          className={\r\n            css(\r\n              'ms-Image-image',\r\n              styles.image,\r\n              CoverStyleMap[coverStyle],\r\n              (imageFit !== undefined) && ImageFitMap[imageFit], {\r\n                'is-fadeIn': shouldFadeIn,\r\n                'is-notLoaded': !loaded,\r\n                ['is-loaded ' + styles.imageIsLoaded]: loaded,\r\n                'ms-u-fadeIn400': loaded && shouldFadeIn,\r\n                'is-error': loadState === ImageLoadState.error,\r\n                ['ms-Image-image--scaleWidth ' + styles.imageIsScaleWidth]: (imageFit === undefined && !!width && !height),\r\n                ['ms-Image-image--scaleHeight ' + styles.imageIsScaleHeight]: (imageFit === undefined && !width && !!height),\r\n                ['ms-Image-image--scaleWidthHeight ' + styles.imageIsScaleWidthHeight]: (imageFit === undefined && !!width && !!height),\r\n              }) }\r\n          ref={ this._resolveRef('_imageElement') }\r\n          src={ src }\r\n          alt={ alt }\r\n          role={ role }\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  @autobind\r\n  private _onImageLoaded(ev: React.SyntheticEvent<HTMLImageElement>): void {\r\n    let { src, onLoad } = this.props;\r\n    if (onLoad) {\r\n      onLoad(ev);\r\n    }\r\n\r\n    this._computeCoverStyle(this.props);\r\n\r\n    if (src) {\r\n      this.setState({\r\n        loadState: ImageLoadState.loaded\r\n      });\r\n    }\r\n  }\r\n\r\n  private _checkImageLoaded(): void {\r\n    let { src } = this.props;\r\n    let { loadState } = this.state;\r\n\r\n    if (loadState === ImageLoadState.notLoaded) {\r\n      // testing if naturalWidth and naturalHeight are greater than zero is better than checking\r\n      // .complete, because .complete will also be set to true if the image breaks. However,\r\n      // for some browsers, SVG images do not have a naturalWidth or naturalHeight, so fall back\r\n      // to checking .complete for these images.\r\n      let isLoaded: boolean = src && (this._imageElement.naturalWidth > 0 && this._imageElement.naturalHeight > 0) ||\r\n        (this._imageElement.complete && Image._svgRegex.test(src));\r\n\r\n      if (isLoaded) {\r\n        this._computeCoverStyle(this.props);\r\n        this.setState({\r\n          loadState: ImageLoadState.loaded\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  private _computeCoverStyle(props: IImageProps) {\r\n    let { imageFit, width, height } = props;\r\n    if (imageFit === ImageFit.cover || imageFit === ImageFit.contain) {\r\n      if (this._imageElement) {\r\n        // Determine the desired ratio using the width and height props.\r\n        // If those props aren't available, measure measure the frame.\r\n        let desiredRatio;\r\n        if (!!width && !!height) {\r\n          desiredRatio = (width as number) / (height as number);\r\n        } else {\r\n          desiredRatio = this._frameElement.clientWidth / this._frameElement.clientHeight;\r\n        }\r\n\r\n        // Examine the source image to determine its original ratio.\r\n        let naturalRatio = this._imageElement.naturalWidth / this._imageElement.naturalHeight;\r\n\r\n        // Should we crop from the top or the sides?\r\n        if (naturalRatio > desiredRatio) {\r\n          this._coverStyle = CoverStyle.landscape;\r\n        } else {\r\n          this._coverStyle = CoverStyle.portrait;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  @autobind\r\n  private _onImageError(ev: React.SyntheticEvent<HTMLImageElement>) {\r\n    if (this.props.onError) {\r\n      this.props.onError(ev);\r\n    }\r\n    this.setState({\r\n      loadState: ImageLoadState.error\r\n    });\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Image/Image.tsx","/* tslint:disable */\r\nimport { loadStyles } from '@microsoft/load-themed-styles';\r\n\r\nconst styles = {\r\n  root: 'root_c274dbaf',\r\n  rootIsMaximizeFrame: 'rootIsMaximizeFrame_c274dbaf',\r\n  image: 'image_c274dbaf',\r\n  imageIsLoaded: 'imageIsLoaded_c274dbaf',\r\n  imageIsCenter: 'imageIsCenter_c274dbaf',\r\n  imageIsContain: 'imageIsContain_c274dbaf',\r\n  imageIsCover: 'imageIsCover_c274dbaf',\r\n  imageIsLandscape: 'imageIsLandscape_c274dbaf',\r\n  imageIsPortrait: 'imageIsPortrait_c274dbaf',\r\n  imageIsNone: 'imageIsNone_c274dbaf',\r\n  imageIsScaleWidthHeight: 'imageIsScaleWidthHeight_c274dbaf',\r\n  imageIsScaleWidth: 'imageIsScaleWidth_c274dbaf',\r\n  imageIsScaleHeight: 'imageIsScaleHeight_c274dbaf',\r\n};\r\n\r\nexport = styles;\r\n\r\nloadStyles([{\"rawString\":\".root_c274dbaf{overflow:hidden}.rootIsMaximizeFrame_c274dbaf{height:100%;width:100%}.image_c274dbaf{display:block;opacity:0}.image_c274dbaf.imageIsLoaded_c274dbaf{opacity:1}.imageIsCenter_c274dbaf,.imageIsContain_c274dbaf,.imageIsCover_c274dbaf{position:relative;top:50%}html[dir=ltr] .imageIsCenter_c274dbaf,html[dir=ltr] .imageIsContain_c274dbaf,html[dir=ltr] .imageIsCover_c274dbaf{left:50%}html[dir=rtl] .imageIsCenter_c274dbaf,html[dir=rtl] .imageIsContain_c274dbaf,html[dir=rtl] .imageIsCover_c274dbaf{right:50%}html[dir=ltr] .imageIsCenter_c274dbaf,html[dir=ltr] .imageIsContain_c274dbaf,html[dir=ltr] .imageIsCover_c274dbaf{-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}html[dir=rtl] .imageIsCenter_c274dbaf,html[dir=rtl] .imageIsContain_c274dbaf,html[dir=rtl] .imageIsCover_c274dbaf{-webkit-transform:translate(50%,-50%);transform:translate(50%,-50%)}.imageIsContain_c274dbaf.imageIsLandscape_c274dbaf{width:100%;height:auto}.imageIsContain_c274dbaf.imageIsPortrait_c274dbaf{height:100%;width:auto}.imageIsCover_c274dbaf.imageIsLandscape_c274dbaf{height:100%;width:auto}.imageIsCover_c274dbaf.imageIsPortrait_c274dbaf{width:100%;height:auto}.imageIsNone_c274dbaf{height:auto;width:auto}.imageIsScaleWidthHeight_c274dbaf{height:100%;width:100%}.imageIsScaleWidth_c274dbaf{height:auto;width:100%}.imageIsScaleHeight_c274dbaf{height:100%;width:auto}\"}]);\r\n/* tslint:enable */\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Image/Image.scss.ts","/* tslint:disable */\r\nimport { loadStyles } from '@microsoft/load-themed-styles';\r\n\r\nconst styles = {\r\n  rootIsFixed: 'rootIsFixed_421ed432',\r\n  content: 'content_421ed432',\r\n};\r\n\r\nexport = styles;\r\n\r\nloadStyles([{\"rawString\":\".rootIsFixed_421ed432{position:fixed;z-index:1000000;top:0;left:0;width:100vw;height:100vh;visibility:hidden}.content_421ed432{visibility:visible}\"}]);\r\n/* tslint:enable */\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Layer/Layer.scss.ts","import * as React from 'react';\r\nimport {\r\n  BaseComponent,\r\n  css\r\n} from '../../Utilities';\r\nimport {\r\n  Layer\r\n} from './Layer';\r\n\r\nexport class LayerHost extends BaseComponent<React.HTMLProps<HTMLElement>, {}> {\r\n\r\n  public shouldComponentUpdate() {\r\n    return false;\r\n  }\r\n\r\n  public componentDidMount() {\r\n    Layer.notifyHostChanged(this.props.id);\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    Layer.notifyHostChanged(this.props.id);\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <div { ...this.props } className={ css('ms-LayerHost', this.props.className) } />\r\n    );\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Layer/LayerHost.tsx","export * from './Layer';\r\nexport * from './Layer.Props';\r\nexport * from './LayerHost';\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Layer/index.ts","import * as React from 'react';\r\nimport {\r\n  BaseComponent,\r\n  anchorProperties,\r\n  autobind,\r\n  buttonProperties,\r\n  css,\r\n  getNativeProps\r\n} from '../../Utilities';\r\nimport { ILink, ILinkProps } from './Link.Props';\r\nimport styles = require('./Link.scss');\r\n\r\ninterface IMyScreen extends Screen {\r\n  left: number;\r\n  top: number;\r\n}\r\n\r\ndeclare var screen: IMyScreen;\r\n\r\nexport class Link extends BaseComponent<ILinkProps, any> implements ILink {\r\n  private _link: HTMLElement;\r\n\r\n  public render() {\r\n    let { disabled, children, className, href } = this.props;\r\n\r\n    return (\r\n      href ? (\r\n        <a\r\n          { ...getNativeProps(this.props, anchorProperties) }\r\n          className={ css('ms-Link', styles.root, className, {\r\n            'is-disabled': disabled,\r\n            [styles.isDisabled]: disabled,\r\n            [styles.isEnabled]: !disabled\r\n          }) }\r\n          onClick={ this._onClick }\r\n          ref={ this._resolveRef('_link') }\r\n          target={ this.props.target }\r\n        >\r\n          { children }\r\n        </a>\r\n      ) : (\r\n          <button\r\n            { ...getNativeProps(this.props, buttonProperties) }\r\n            className={ css('ms-Link', styles.root, className, {\r\n              'is-disabled': disabled,\r\n              [styles.isDisabled]: disabled\r\n            }) }\r\n            onClick={ this._onClick }\r\n            ref={ this._resolveRef('_link') }\r\n          >\r\n            { children }\r\n          </button>\r\n        ));\r\n  }\r\n\r\n  public focus() {\r\n    if (this._link) {\r\n      this._link.focus();\r\n    }\r\n  }\r\n\r\n  @autobind\r\n  private _onClick(ev: React.MouseEvent<HTMLAnchorElement | HTMLButtonElement>) {\r\n    let { onClick } = this.props;\r\n\r\n    if (onClick) {\r\n      onClick(ev);\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Link/Link.tsx","/* tslint:disable */\r\nimport { loadStyles } from '@microsoft/load-themed-styles';\r\n\r\nconst styles = {\r\n  root: 'root_5a9f2fae',\r\n  isEnabled: 'isEnabled_5a9f2fae',\r\n  isDisabled: 'isDisabled_5a9f2fae',\r\n};\r\n\r\nexport = styles;\r\n\r\nloadStyles([{\"rawString\":\".root_5a9f2fae{font-family:\\\"Segoe UI WestEuropean\\\",\\\"Segoe UI\\\",-apple-system,BlinkMacSystemFont,Roboto,\\\"Helvetica Neue\\\",sans-serif;-webkit-font-smoothing:antialiased;color:\"},{\"theme\":\"themePrimary\",\"defaultValue\":\"#0078d7\"},{\"rawString\":\";margin:0;overflow:inherit;padding:0;text-overflow:inherit}.isEnabled_5a9f2fae:focus,.isEnabled_5a9f2fae:hover{color:\"},{\"theme\":\"themeDarker\",\"defaultValue\":\"#004578\"},{\"rawString\":\"}.isEnabled_5a9f2fae:active{color:\"},{\"theme\":\"themePrimary\",\"defaultValue\":\"#0078d7\"},{\"rawString\":\"}.isDisabled_5a9f2fae{color:\"},{\"theme\":\"neutralTertiary\",\"defaultValue\":\"#a6a6a6\"},{\"rawString\":\";pointer-events:none;cursor:default}button.root_5a9f2fae{background:0 0;border:none;cursor:pointer;display:inline;font-size:inherit}button.root_5a9f2fae::-moz-focus-inner{border:0}button.root_5a9f2fae{outline:transparent;position:relative}.ms-Fabric.is-focusVisible button.root_5a9f2fae:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid \"},{\"theme\":\"neutralSecondary\",\"defaultValue\":\"#666666\"},{\"rawString\":\"}html[dir=ltr] button.root_5a9f2fae{text-align:left}html[dir=rtl] button.root_5a9f2fae{text-align:right}a.root_5a9f2fae{text-decoration:none}.ms-Fabric.is-focusVisible a.root_5a9f2fae:focus{outline:1px solid \"},{\"theme\":\"neutralSecondary\",\"defaultValue\":\"#666666\"},{\"rawString\":\"}\"}]);\r\n/* tslint:enable */\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Link/Link.scss.ts","export * from './Link';\r\nexport * from './Link.Props';\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Link/index.ts","import * as React from 'react';\r\nimport {\r\n  BaseComponent,\r\n  IRectangle,\r\n  assign,\r\n  css,\r\n  findIndex,\r\n  findScrollableParent,\r\n  getParent,\r\n  divProperties,\r\n  getNativeProps\r\n} from '../../Utilities';\r\nimport { IListProps, IPage } from './List.Props';\r\n\r\nconst RESIZE_DELAY = 16;\r\nconst MIN_SCROLL_UPDATE_DELAY = 100;\r\nconst MAX_SCROLL_UPDATE_DELAY = 500;\r\nconst IDLE_DEBOUNCE_DELAY = 200;\r\nconst DEFAULT_ITEMS_PER_PAGE = 10;\r\nconst DEFAULT_PAGE_HEIGHT = 30;\r\nconst DEFAULT_RENDERED_WINDOWS_BEHIND = 2;\r\nconst DEFAULT_RENDERED_WINDOWS_AHEAD = 2;\r\n\r\nexport interface IListState {\r\n  pages?: IPage[];\r\n\r\n  /** The last versionstamp for  */\r\n  measureVersion?: number;\r\n}\r\n\r\nconst EMPTY_RECT = {\r\n  top: -1,\r\n  bottom: -1,\r\n  left: -1,\r\n  right: -1,\r\n  width: 0,\r\n  height: 0\r\n};\r\n\r\n// Naming expensive measures so that they're named in profiles.\r\nconst _measurePageRect = (element: HTMLElement) => element.getBoundingClientRect();\r\nconst _measureSurfaceRect = _measurePageRect;\r\nconst _measureScrollRect = _measurePageRect;\r\n\r\n/**\r\n * The List renders virtualized pages of items. Each page's item count is determined by the getItemCountForPage callback if\r\n * provided by the caller, or 10 as default. Each page's height is determined by the getPageHeight callback if provided by\r\n * the caller, or by cached measurements if available, or by a running average, or a default fallback.\r\n *\r\n * The algorithm for rendering pages works like this:\r\n *\r\n * 1. Predict visible pages based on \"current measure data\" (page heights, surface position, visible window)\r\n * 2. If changes are necessary, apply changes (add/remove pages)\r\n * 3. For pages that are added, measure the page heights if we need to using getBoundingClientRect\r\n * 4. If measurements don't match predictions, update measure data and goto step 1 asynchronously\r\n *\r\n * Measuring too frequently can pull performance down significantly. To compensate, we cache measured values so that\r\n * we can avoid re-measuring during operations that should not alter heights, like scrolling.\r\n *\r\n * However, certain operations can make measure data stale. For example, resizing the list, or passing in new props,\r\n * or forcing an update change cause pages to shrink/grow. When these operations occur, we increment a measureVersion\r\n * number, which we associate with cached measurements and use to determine if a remeasure should occur.\r\n */\r\nexport class List extends BaseComponent<IListProps, IListState> {\r\n  public static defaultProps = {\r\n    startIndex: 0,\r\n    onRenderCell: (item, index, containsFocus) => (<div>{ (item && item.name) || '' }</div>),\r\n    renderedWindowsAhead: DEFAULT_RENDERED_WINDOWS_AHEAD,\r\n    renderedWindowsBehind: DEFAULT_RENDERED_WINDOWS_BEHIND\r\n  };\r\n\r\n  public refs: {\r\n    [key: string]: React.ReactInstance,\r\n    root: HTMLElement,\r\n    surface: HTMLElement\r\n  };\r\n\r\n  private _estimatedPageHeight: number;\r\n  private _totalEstimates: number;\r\n  private _cachedPageHeights: {\r\n    [key: string]: {\r\n      height: number,\r\n      measureVersion: number\r\n    }\r\n  };\r\n  private _focusedIndex: number;\r\n  private _scrollElement: HTMLElement;\r\n  private _scrollingToIndex: number;\r\n  private _hasCompletedFirstRender: boolean;\r\n\r\n  // surface rect relative to window\r\n  private _surfaceRect: IRectangle;\r\n\r\n  // The visible rect that we're required to render given the current list state.\r\n  private _requiredRect: IRectangle;\r\n\r\n  // The visible rect that we're allowed to keep rendered. Pages outside of this rect will be removed.\r\n  private _allowedRect: IRectangle;\r\n\r\n  // materialized rect around visible items, relative to surface\r\n  private _materializedRect: IRectangle;\r\n\r\n  private _requiredWindowsAhead: number;\r\n  private _requiredWindowsBehind: number;\r\n\r\n  private _measureVersion: number;\r\n\r\n  constructor(props: IListProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      pages: []\r\n    };\r\n\r\n    this._estimatedPageHeight = 0;\r\n    this._totalEstimates = 0;\r\n    this._requiredWindowsAhead = 0;\r\n    this._requiredWindowsBehind = 0;\r\n\r\n    // Track the measure version for everything.\r\n    this._measureVersion = 0;\r\n\r\n    // Ensure that scrolls are lazy updated.\r\n    this._onAsyncScroll = this._async.debounce(\r\n      this._onAsyncScroll,\r\n      MIN_SCROLL_UPDATE_DELAY,\r\n      {\r\n        leading: false,\r\n        maxWait: MAX_SCROLL_UPDATE_DELAY\r\n      });\r\n\r\n    this._onAsyncIdle = this._async.debounce(\r\n      this._onAsyncIdle,\r\n      IDLE_DEBOUNCE_DELAY, {\r\n        leading: false\r\n      });\r\n\r\n    this._onAsyncResize = this._async.debounce(\r\n      this._onAsyncResize,\r\n      RESIZE_DELAY,\r\n      {\r\n        leading: false\r\n      });\r\n\r\n    this._cachedPageHeights = {};\r\n    this._estimatedPageHeight = 0;\r\n    this._focusedIndex = -1;\r\n    this._scrollingToIndex = -1;\r\n  }\r\n\r\n  /**\r\n   * Scroll to the given index. By default will bring the page the specified item is on into the view. If a callback\r\n   * to measure the height of an individual item is specified, will only scroll to bring the specific item into view.\r\n   *\r\n   * Note: with items of variable height and no passed in `getPageHeight` method, the list might jump after scrolling\r\n   * when windows before/ahead are being rendered, and the estimated height is replaced using actual elements.\r\n   *\r\n   * @param index Index of item to scroll to\r\n   * @param measureItem Optional callback to measure the height of an individual item\r\n   */\r\n  public scrollToIndex(index: number, measureItem?: (itemIndex: number) => number): void {\r\n    const { startIndex } = this.props;\r\n    const renderCount = this._getRenderCount();\r\n    const endIndex = startIndex + renderCount;\r\n\r\n    let scrollTop = 0;\r\n\r\n    let itemsPerPage = 1;\r\n    for (let itemIndex = startIndex; itemIndex < endIndex; itemIndex += itemsPerPage) {\r\n      itemsPerPage = this._getItemCountForPage(itemIndex, this._allowedRect);\r\n\r\n      const requestedIndexIsInPage = itemIndex <= index && (itemIndex + itemsPerPage) > index;\r\n      if (requestedIndexIsInPage) {\r\n        // We have found the page. If the user provided a way to measure an individual item, we will try to scroll in just\r\n        // the given item, otherwise we'll only bring the page into view\r\n        if (measureItem) {\r\n          // Adjust for actual item position within page\r\n          const itemPositionWithinPage = index - itemIndex;\r\n          for (let itemIndexInPage = 0; itemIndexInPage < itemPositionWithinPage; ++itemIndexInPage) {\r\n            scrollTop += measureItem(itemIndex + itemIndexInPage);\r\n          }\r\n          const scrollBottom = scrollTop + measureItem(index);\r\n\r\n          const scrollRect = _measureScrollRect(this._scrollElement);\r\n          const scrollWindow = {\r\n            top: this._scrollElement.scrollTop,\r\n            bottom: this._scrollElement.scrollTop + scrollRect.height\r\n          };\r\n\r\n          const itemIsFullyVisible = scrollTop >= scrollWindow.top && scrollBottom <= scrollWindow.bottom;\r\n          if (itemIsFullyVisible) {\r\n            // Item is already visible, do nothing.\r\n            return;\r\n          }\r\n\r\n          const itemIsPartiallyAbove = scrollTop < scrollWindow.top;\r\n          const itemIsPartiallyBelow = scrollBottom > scrollWindow.bottom;\r\n\r\n          if (itemIsPartiallyAbove) {\r\n            // We will just scroll to 'scrollTop'\r\n            //  ______\r\n            // |Item  |   - scrollTop\r\n            // |  ____|_\r\n            // |_|____| | - scrollWindow.top\r\n            //   |      |\r\n            //   |______|\r\n          } else if (itemIsPartiallyBelow) {\r\n            // Adjust scrollTop position to just bring in the element\r\n            //  ______   - scrollTop\r\n            // |      |\r\n            // |  ____|_  - scrollWindow.bottom\r\n            // |_|____| |\r\n            //   | Item |\r\n            //   |______| - scrollBottom\r\n            scrollTop = this._scrollElement.scrollTop + (scrollBottom - scrollWindow.bottom);\r\n          }\r\n        }\r\n\r\n        this._scrollElement.scrollTop = scrollTop;\r\n        break;\r\n      }\r\n\r\n      scrollTop += this._getPageHeight(itemIndex, itemsPerPage, this._surfaceRect);\r\n    }\r\n  }\r\n\r\n  public componentDidMount() {\r\n\r\n    this._updatePages();\r\n    this._measureVersion++;\r\n    this._scrollElement = findScrollableParent(this.refs.root);\r\n\r\n    this._events.on(window, 'resize', this._onAsyncResize);\r\n    this._events.on(this.refs.root, 'focus', this._onFocus, true);\r\n    if (this._scrollElement) {\r\n      this._events.on(this._scrollElement, 'scroll', this._onScroll);\r\n      this._events.on(this._scrollElement, 'scroll', this._onAsyncScroll);\r\n    }\r\n  }\r\n\r\n  public componentWillReceiveProps(newProps: IListProps) {\r\n    if (newProps.items !== this.props.items ||\r\n      newProps.renderCount !== this.props.renderCount ||\r\n      newProps.startIndex !== this.props.startIndex) {\r\n\r\n      this._measureVersion++;\r\n      this._updatePages(newProps);\r\n    }\r\n  }\r\n\r\n  public shouldComponentUpdate(newProps: IListProps, newState: IListState) {\r\n    let { renderedWindowsAhead, renderedWindowsBehind } = this.props;\r\n    let { pages: oldPages } = this.state;\r\n    let { pages: newPages, measureVersion } = newState;\r\n    let shouldComponentUpdate = false;\r\n\r\n    if (\r\n      this._measureVersion === measureVersion &&\r\n      newProps.renderedWindowsAhead === renderedWindowsAhead,\r\n      newProps.renderedWindowsBehind === renderedWindowsBehind,\r\n      newProps.items === this.props.items &&\r\n      oldPages.length === newPages.length) {\r\n      for (let i = 0; i < oldPages.length; i++) {\r\n        let oldPage = oldPages[i];\r\n        let newPage = newPages[i];\r\n\r\n        if ((oldPage.key !== newPage.key ||\r\n          oldPage.itemCount !== newPage.itemCount)) {\r\n          shouldComponentUpdate = true;\r\n          break;\r\n        }\r\n      }\r\n    } else {\r\n      shouldComponentUpdate = true;\r\n    }\r\n\r\n    return shouldComponentUpdate;\r\n  }\r\n\r\n  public forceUpdate() {\r\n    // Ensure that when the list is force updated we update the pages first before render.\r\n    this._updateRenderRects(this.props, true);\r\n    this._updatePages();\r\n    this._measureVersion++;\r\n\r\n    super.forceUpdate();\r\n  }\r\n\r\n  public render() {\r\n    let { className, role } = this.props;\r\n    let { pages } = this.state;\r\n    let pageElements = [];\r\n    let divProps = getNativeProps(this.props, divProperties);\r\n\r\n    // assign list if no role\r\n    role = (role === undefined) ? 'list' : role;\r\n\r\n    for (let i = 0; i < pages.length; i++) {\r\n      pageElements.push(this._renderPage(pages[i]));\r\n    }\r\n\r\n    return (\r\n      <div ref='root' { ...divProps } role={ role } className={ css('ms-List', className) } >\r\n        <div ref='surface' className='ms-List-surface'>\r\n          { pageElements }\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _renderPage(page: IPage): any {\r\n    let { onRenderCell, role } = this.props;\r\n    let cells = [];\r\n    let pageStyle = this._getPageStyle(page);\r\n\r\n    // only assign list item role if no role is assigned\r\n    role = (role === undefined) ? 'listitem' : null;\r\n\r\n    for (let i = 0; page.items && i < page.items.length; i++) {\r\n      let item = page.items[i];\r\n      const index = page.startIndex + i;\r\n      let itemKey =\r\n        this.props.getKey\r\n          ? this.props.getKey(item, index)\r\n          : item && item.key;\r\n\r\n      if (itemKey === null || itemKey === undefined) {\r\n        itemKey = index;\r\n      }\r\n\r\n      cells.push(\r\n        <div role={ role } className='ms-List-cell' key={ itemKey } data-list-index={ i + page.startIndex } data-automationid='ListCell'>\r\n          { onRenderCell(item, page.startIndex + i) }\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className='ms-List-page' key={ page.key } ref={ page.key } style={ pageStyle }>\r\n        { cells }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /** Generate the style object for the page. */\r\n  private _getPageStyle(page) {\r\n    let style;\r\n    let { getPageStyle } = this.props;\r\n\r\n    if (getPageStyle) {\r\n      style = getPageStyle(page);\r\n    }\r\n\r\n    if (!page.items) {\r\n      style = style || {};\r\n      style.height = page.height;\r\n    }\r\n\r\n    return style;\r\n  }\r\n\r\n  /** Track the last item index focused so that we ensure we keep it rendered. */\r\n  private _onFocus(ev) {\r\n    let target = ev.target as HTMLElement;\r\n\r\n    while (target !== this.refs.surface) {\r\n      let indexString = target.getAttribute('data-list-index');\r\n\r\n      if (indexString) {\r\n        this._focusedIndex = Number(indexString);\r\n        break;\r\n      }\r\n\r\n      target = getParent(target);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Called synchronously to reset the required render range to 0 on scrolling. After async scroll has executed,\r\n   * we will call onAsyncIdle which will reset it back to it's correct value.\r\n   */\r\n  private _onScroll() {\r\n    this._requiredWindowsAhead = 0;\r\n    this._requiredWindowsBehind = 0;\r\n  }\r\n\r\n  /**\r\n   * Debounced method to asynchronously update the visible region on a scroll event.\r\n   */\r\n  private _onAsyncScroll() {\r\n    this._updateRenderRects();\r\n\r\n    // Only update pages when the visible rect falls outside of the materialized rect.\r\n    if (!this._materializedRect || !_isContainedWithin(this._requiredRect, this._materializedRect)) {\r\n      this._updatePages();\r\n    } else {\r\n      // console.log('requiredRect contained in materialized', this._requiredRect, this._materializedRect);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * This is an async debounced method that will try and increment the windows we render. If we can increment\r\n   * either, we increase the amount we render and re-evaluate.\r\n   */\r\n  private _onAsyncIdle() {\r\n    const { renderedWindowsAhead, renderedWindowsBehind } = this.props;\r\n    const {\r\n      _requiredWindowsAhead: requiredWindowsAhead,\r\n      _requiredWindowsBehind: requiredWindowsBehind\r\n    } = this;\r\n    const windowsAhead = Math.min(renderedWindowsAhead, requiredWindowsAhead + 1);\r\n    const windowsBehind = Math.min(renderedWindowsBehind, requiredWindowsBehind + 1);\r\n\r\n    if (windowsAhead !== requiredWindowsAhead || windowsBehind !== requiredWindowsBehind) {\r\n\r\n      // console.log('idling', windowsBehind, windowsAhead);\r\n\r\n      this._requiredWindowsAhead = windowsAhead;\r\n      this._requiredWindowsBehind = windowsBehind;\r\n      this._updateRenderRects();\r\n      this._updatePages();\r\n    }\r\n\r\n    if (renderedWindowsAhead > windowsAhead || renderedWindowsBehind > windowsBehind) {\r\n      // Async increment on next tick.\r\n      this._onAsyncIdle();\r\n    }\r\n  }\r\n\r\n  private _onAsyncResize() {\r\n    this.forceUpdate();\r\n  }\r\n\r\n  private _updatePages(props?: IListProps) {\r\n    let { items, startIndex, renderCount } = (props || this.props);\r\n\r\n    renderCount = this._getRenderCount(props);\r\n\r\n    // console.log('updating pages');\r\n\r\n    if (!this._requiredRect) {\r\n      this._updateRenderRects(props);\r\n    }\r\n\r\n    let newListState = this._buildPages(items, startIndex, renderCount);\r\n    let oldListPages = this.state.pages;\r\n\r\n    this.setState(newListState, () => {\r\n      // If measured version is invalid since we've updated the DOM\r\n      const heightsChanged = this._updatePageMeasurements(oldListPages, newListState.pages);\r\n\r\n      // On first render, we should re-measure so that we don't get a visual glitch.\r\n      if (heightsChanged) {\r\n        this._materializedRect = null;\r\n        if (!this._hasCompletedFirstRender) {\r\n          this._hasCompletedFirstRender = true;\r\n          this._updatePages();\r\n        } else {\r\n          this._onAsyncScroll();\r\n        }\r\n      } else {\r\n        // Enqueue an idle bump.\r\n        this._onAsyncIdle();\r\n      }\r\n    });\r\n  }\r\n\r\n  private _updatePageMeasurements(oldPages: IPage[], newPages: IPage[]) {\r\n    let renderedIndexes = {};\r\n    let heightChanged = false;\r\n    let renderCount = this._getRenderCount();\r\n\r\n    for (let i = 0; i < oldPages.length; i++) {\r\n      let page = oldPages[i];\r\n\r\n      if (page.items) {\r\n        renderedIndexes[page.startIndex] = page;\r\n      }\r\n    }\r\n\r\n    for (let i = 0; i < newPages.length; i++) {\r\n      let page = newPages[i];\r\n\r\n      if (page.items) {\r\n        // Only evaluate page height if the page contains less items than total.\r\n        if (page.items.length < renderCount) {\r\n          heightChanged = this._measurePage(page) || heightChanged;\r\n        }\r\n\r\n        if (!renderedIndexes[page.startIndex]) {\r\n          this._onPageAdded(page);\r\n        } else {\r\n          delete renderedIndexes[page.startIndex];\r\n        }\r\n      }\r\n    }\r\n\r\n    for (let index in renderedIndexes) {\r\n      if (renderedIndexes.hasOwnProperty(index)) {\r\n        this._onPageRemoved(renderedIndexes[index]);\r\n      }\r\n    }\r\n\r\n    return heightChanged;\r\n  }\r\n\r\n  /**\r\n   * Given a page, measure its dimensions, update cache.\r\n   * @returns True if the height has changed.\r\n   */\r\n  private _measurePage(page: IPage): boolean {\r\n    let hasChangedHeight = false;\r\n    let pageElement = this.refs[page.key] as HTMLElement;\r\n    let cachedHeight = this._cachedPageHeights[page.startIndex];\r\n\r\n    // console.log('   * measure attempt', page.startIndex, cachedHeight);\r\n\r\n    if (pageElement && (!cachedHeight || cachedHeight.measureVersion !== this._measureVersion)) {\r\n      let newClientRect = _measurePageRect(pageElement);\r\n\r\n      hasChangedHeight = page.height !== newClientRect.height;\r\n\r\n      // console.warn(' *** expensive page measure', page.startIndex, page.height, newClientRect.height);\r\n\r\n      page.height = newClientRect.height;\r\n\r\n      this._cachedPageHeights[page.startIndex] = {\r\n        height: newClientRect.height,\r\n        measureVersion: this._measureVersion\r\n      };\r\n\r\n      this._estimatedPageHeight = Math.round(\r\n        ((this._estimatedPageHeight * this._totalEstimates) + newClientRect.height) /\r\n        (this._totalEstimates + 1));\r\n\r\n      this._totalEstimates++;\r\n    }\r\n\r\n    return hasChangedHeight;\r\n  }\r\n\r\n  /** Called when a page has been added to the DOM. */\r\n  private _onPageAdded(page: IPage) {\r\n    let { onPageAdded } = this.props;\r\n\r\n    // console.log('page added', page.startIndex, this.state.pages.map(page=>page.key).join(', '));\r\n\r\n    if (onPageAdded) {\r\n      onPageAdded(page);\r\n    }\r\n  }\r\n\r\n  /** Called when a page has been removed from the DOM. */\r\n  private _onPageRemoved(page: IPage) {\r\n    let { onPageRemoved } = this.props;\r\n\r\n    // console.log('  --- page removed', page.startIndex, this.state.pages.map(page=>page.key).join(', '));\r\n\r\n    if (onPageRemoved) {\r\n      onPageRemoved(page);\r\n    }\r\n  }\r\n\r\n  /** Build up the pages that should be rendered. */\r\n  private _buildPages(items: any[], startIndex: number, renderCount: number): IListState {\r\n    let materializedRect = assign({}, EMPTY_RECT) as IRectangle;\r\n    let itemsPerPage = 1;\r\n    let pages = [];\r\n    let pageTop = 0;\r\n    let currentSpacer = null;\r\n    let focusedIndex = this._focusedIndex;\r\n    let endIndex = startIndex + renderCount;\r\n\r\n    // First render is very important to track; when we render cells, we have no idea of estimated page height.\r\n    // So we should default to rendering only the first page so that we can get information.\r\n    // However if the user provides a measure function, let's just assume they know the right heights.\r\n    let isFirstRender = this._estimatedPageHeight === 0 && !this.props.getPageHeight;\r\n\r\n    for (let itemIndex = startIndex; itemIndex < endIndex; itemIndex += itemsPerPage) {\r\n      itemsPerPage = this._getItemCountForPage(itemIndex, this._allowedRect);\r\n\r\n      let pageHeight = this._getPageHeight(itemIndex, itemsPerPage, this._surfaceRect);\r\n      let pageBottom = pageTop + pageHeight - 1;\r\n\r\n      let isPageRendered = findIndex(this.state.pages, (page) => page.items && page.startIndex === itemIndex) > -1;\r\n      let isPageInAllowedRange = pageBottom >= this._allowedRect.top && pageTop <= this._allowedRect.bottom;\r\n      let isPageInRequiredRange = pageBottom >= this._requiredRect.top && pageTop <= this._requiredRect.bottom;\r\n      let isPageVisible = !isFirstRender && (isPageInRequiredRange || (isPageInAllowedRange && isPageRendered));\r\n      let isPageFocused = focusedIndex >= itemIndex && focusedIndex < (itemIndex + itemsPerPage);\r\n      let isFirstPage = itemIndex === startIndex;\r\n\r\n      // console.log('building page', itemIndex, 'pageTop: ' + pageTop, 'inAllowed: ' + isPageInAllowedRange, 'inRequired: ' + isPageInRequiredRange);\r\n\r\n      // Only render whats visible, focused, or first page.\r\n      if (isPageVisible || isPageFocused || isFirstPage) {\r\n        if (currentSpacer) {\r\n          pages.push(currentSpacer);\r\n          currentSpacer = null;\r\n        }\r\n\r\n        let itemsInPage = Math.min(itemsPerPage, endIndex - itemIndex);\r\n        let newPage = this._createPage(null, items.slice(itemIndex, itemIndex + itemsInPage), itemIndex);\r\n\r\n        newPage.top = pageTop;\r\n        newPage.height = pageHeight;\r\n\r\n        pages.push(newPage);\r\n\r\n        if (isPageInRequiredRange) {\r\n          _mergeRect(materializedRect, {\r\n            top: pageTop,\r\n            bottom: pageBottom,\r\n            height: pageHeight,\r\n            left: this._allowedRect.left,\r\n            right: this._allowedRect.right,\r\n            width: this._allowedRect.width\r\n          });\r\n        }\r\n\r\n      } else {\r\n        if (!currentSpacer) {\r\n          currentSpacer = this._createPage('spacer-' + itemIndex, null, itemIndex, 0);\r\n        }\r\n        currentSpacer.height = (currentSpacer.height || 0) + (pageBottom - pageTop) + 1;\r\n        currentSpacer.itemCount += itemsPerPage;\r\n      }\r\n      pageTop += (pageBottom - pageTop + 1);\r\n\r\n      if (isFirstRender) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (currentSpacer) {\r\n      currentSpacer.key = 'spacer-end';\r\n      pages.push(currentSpacer);\r\n    }\r\n\r\n    this._materializedRect = materializedRect;\r\n\r\n    // console.log('materialized: ', materializedRect);\r\n    return {\r\n      pages: pages,\r\n      measureVersion: this._measureVersion\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get the pixel height of a give page. Will use the props getPageHeight first, and if not provided, fallback to\r\n   * cached height, or estimated page height, or default page height.\r\n   */\r\n  private _getPageHeight(itemIndex: number, itemsPerPage: number, visibleRect: IRectangle): number {\r\n    if (this.props.getPageHeight) {\r\n      return this.props.getPageHeight(itemIndex, visibleRect);\r\n    } else {\r\n      let cachedHeight = (this._cachedPageHeights[itemIndex]);\r\n\r\n      return cachedHeight ? cachedHeight.height : (this._estimatedPageHeight || DEFAULT_PAGE_HEIGHT);\r\n    }\r\n  }\r\n\r\n  private _getItemCountForPage(itemIndex: number, visibileRect: IRectangle): number {\r\n    let itemsPerPage = this.props.getItemCountForPage ? this.props.getItemCountForPage(itemIndex, visibileRect) : DEFAULT_ITEMS_PER_PAGE;\r\n\r\n    return itemsPerPage ? itemsPerPage : DEFAULT_ITEMS_PER_PAGE;\r\n  }\r\n\r\n  private _createPage(pageKey: string, items: any[], startIndex?: number, count?: number, style?: any): IPage {\r\n    pageKey = pageKey || ('page-' + startIndex);\r\n\r\n    // Fill undefined cells because array.map will ignore undefined cells.\r\n    if (items) {\r\n      for (let i = 0; i < items.length; i++) {\r\n        items[i] = items[i] || null;\r\n      }\r\n    }\r\n\r\n    return {\r\n      key: pageKey,\r\n      startIndex: startIndex === undefined ? -1 : startIndex,\r\n      itemCount: (count === undefined) ? (items ? items.length : 0) : count,\r\n      items: items,\r\n      style: style || {},\r\n      top: 0,\r\n      height: 0\r\n    };\r\n  }\r\n\r\n  private _getRenderCount(props?: IListProps): number {\r\n    let { items, startIndex, renderCount } = props || this.props;\r\n\r\n    return (renderCount === undefined ? (items ? items.length - startIndex : 0) : renderCount);\r\n  }\r\n\r\n  /** Calculate the visible rect within the list where top: 0 and left: 0 is the top/left of the list. */\r\n  private _updateRenderRects(props?: IListProps, forceUpdate?: boolean) {\r\n    const { renderedWindowsAhead, renderedWindowsBehind } = (props || this.props);\r\n    const { pages } = this.state;\r\n    const renderCount = this._getRenderCount(props);\r\n    let surfaceRect = this._surfaceRect;\r\n\r\n    // WARNING: EXPENSIVE CALL! We need to know the surface top relative to the window.\r\n    if (\r\n      forceUpdate ||\r\n      !pages ||\r\n      !this._surfaceRect ||\r\n      (pages.length > 0 && pages[0].items && pages[0].items.length < renderCount)) {\r\n      surfaceRect = this._surfaceRect = _measureSurfaceRect(this.refs.surface);\r\n    }\r\n\r\n    // If the surface is above the container top or below the container bottom, or if this is not the first\r\n    // render return empty rect.\r\n    // The first time the list gets rendered we need to calculate the rectangle. The width of the list is\r\n    // used to calculate the width of the list items.\r\n    const visibleTop = Math.max(0, -surfaceRect.top);\r\n    const visibleRect = {\r\n      top: visibleTop,\r\n      left: surfaceRect.left,\r\n      bottom: visibleTop + window.innerHeight,\r\n      right: surfaceRect.right,\r\n      width: surfaceRect.width,\r\n      height: window.innerHeight\r\n    };\r\n\r\n    // The required/allowed rects are adjusted versions of the visible rect.\r\n    this._requiredRect = _expandRect(visibleRect, this._requiredWindowsBehind, this._requiredWindowsAhead);\r\n    this._allowedRect = _expandRect(visibleRect, renderedWindowsBehind, renderedWindowsAhead);\r\n  }\r\n}\r\n\r\nfunction _expandRect(rect, pagesBefore, pagesAfter): IRectangle {\r\n  const top = rect.top - (pagesBefore * rect.height);\r\n  const height = rect.height + ((pagesBefore + pagesAfter) * rect.height);\r\n\r\n  return {\r\n    top: top,\r\n    bottom: top + height,\r\n    height: height,\r\n    left: rect.left,\r\n    right: rect.right,\r\n    width: rect.width\r\n  };\r\n}\r\n\r\nfunction _isContainedWithin(innerRect: IRectangle, outerRect: IRectangle): boolean {\r\n  return (\r\n    innerRect.top >= outerRect.top &&\r\n    innerRect.left >= outerRect.left &&\r\n    innerRect.bottom <= outerRect.bottom &&\r\n    innerRect.right <= outerRect.right);\r\n}\r\n\r\nfunction _mergeRect(targetRect: IRectangle, newRect: IRectangle): IRectangle {\r\n  targetRect.top = (newRect.top < targetRect.top || targetRect.top === -1) ? newRect.top : targetRect.top;\r\n  targetRect.left = (newRect.left < targetRect.left || targetRect.left === -1) ? newRect.left : targetRect.left;\r\n  targetRect.bottom = (newRect.bottom > targetRect.bottom || targetRect.bottom === -1) ? newRect.bottom : targetRect.bottom;\r\n  targetRect.right = (newRect.right > targetRect.right || targetRect.right === -1) ? newRect.right : targetRect.right;\r\n  targetRect.width = targetRect.right - targetRect.left + 1;\r\n  targetRect.height = targetRect.bottom - targetRect.top + 1;\r\n\r\n  return targetRect;\r\n}\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/List/List.tsx","export * from './List';\r\nexport * from './List.Props';\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/List/index.ts","import * as React from 'react';\r\nimport { css } from '../../Utilities';\r\nimport { ISpinnerProps, SpinnerType, SpinnerSize } from './Spinner.Props';\r\nimport styles = require('./Spinner.scss');\r\n\r\nexport class Spinner extends React.Component<ISpinnerProps, any> {\r\n  public static defaultProps: ISpinnerProps = {\r\n    size: SpinnerSize.medium\r\n  };\r\n\r\n  public render() {\r\n    let { type, size, label, className } = this.props; // TODO remove deprecated type property at >= 2.0.0\r\n\r\n    return (\r\n      <div className={ css('ms-Spinner', styles.root, className) }>\r\n        <div className={ css('ms-Spinner-circle', styles.circle,\r\n          {\r\n            ['ms-Spinner--xSmall ' + styles.circleIsXSmall]: size === SpinnerSize.xSmall,\r\n            ['ms-Spinner--small ' + styles.circleIsSmall]: size === SpinnerSize.small,\r\n            ['ms-Spinner--medium ' + styles.circleIsMedium]: size === SpinnerSize.medium,\r\n            ['ms-Spinner--large ' + styles.circleIsLarge]: size === SpinnerSize.large,\r\n            ['ms-Spinner--normal ' + styles.circleIsTypeMedium]: type === SpinnerType.normal, // TODO remove deprecated value at >= 2.0.0\r\n            ['ms-Spinner--large ' + styles.circleIsTypeLarge]: type === SpinnerType.large // TODO remove deprecated value at >= 2.0.0\r\n          })\r\n        }>\r\n        </div>\r\n        { label && (\r\n          <div className={ css('ms-Spinner-label', styles.label) }>{ label }</div>\r\n        ) }\r\n      </div >\r\n    );\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Spinner/Spinner.tsx","/* tslint:disable */\r\nimport { loadStyles } from '@microsoft/load-themed-styles';\r\n\r\nconst styles = {\r\n  root: 'root_3e7f0799',\r\n  circle: 'circle_3e7f0799',\r\n  spinAnimation: 'spinAnimation_3e7f0799',\r\n  circleIsXSmall: 'circleIsXSmall_3e7f0799',\r\n  circleIsSmall: 'circleIsSmall_3e7f0799',\r\n  circleIsTypeMedium: 'circleIsTypeMedium_3e7f0799',\r\n  circleIsMedium: 'circleIsMedium_3e7f0799',\r\n  circleIsTypeLarge: 'circleIsTypeLarge_3e7f0799',\r\n  circleIsLarge: 'circleIsLarge_3e7f0799',\r\n  label: 'label_3e7f0799',\r\n};\r\n\r\nexport = styles;\r\n\r\nloadStyles([{\"rawString\":\"@-webkit-keyframes spinAnimation_3e7f0799{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinAnimation_3e7f0799{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.root_3e7f0799>.circle_3e7f0799{margin:auto;box-sizing:border-box;border-radius:50%;width:100%;height:100%;border:1.5px solid \"},{\"theme\":\"themeLight\",\"defaultValue\":\"#c7e0f4\"},{\"rawString\":\";border-top-color:\"},{\"theme\":\"themePrimary\",\"defaultValue\":\"#0078d7\"},{\"rawString\":\";-webkit-animation:spinAnimation_3e7f0799 1.3s infinite cubic-bezier(.53,.21,.29,.67);animation:spinAnimation_3e7f0799 1.3s infinite cubic-bezier(.53,.21,.29,.67)}.root_3e7f0799>.circle_3e7f0799.circleIsXSmall_3e7f0799{width:12px;height:12px}.root_3e7f0799>.circle_3e7f0799.circleIsSmall_3e7f0799{width:16px;height:16px}.root_3e7f0799>.circle_3e7f0799.circleIsMedium_3e7f0799,.root_3e7f0799>.circle_3e7f0799.circleIsTypeMedium_3e7f0799{width:20px;height:20px}.root_3e7f0799>.circle_3e7f0799.circleIsLarge_3e7f0799,.root_3e7f0799>.circle_3e7f0799.circleIsTypeLarge_3e7f0799{width:28px;height:28px}.root_3e7f0799>.label_3e7f0799{color:\"},{\"theme\":\"themePrimary\",\"defaultValue\":\"#0078d7\"},{\"rawString\":\";margin-top:10px;text-align:center}@media screen and (-ms-high-contrast:active){.root_3e7f0799>.circle_3e7f0799{border-top-style:none}}\"}]);\r\n/* tslint:enable */\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Spinner/Spinner.scss.ts","export * from './Spinner';\r\nexport * from './Spinner.Props';\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/components/Spinner/index.ts","import * as React from 'react';\r\nimport {\r\n  BaseComponent,\r\n  hoistMethods,\r\n  unhoistMethods\r\n} from '../../Utilities';\r\n\r\nexport class BaseDecorator<P, S> extends BaseComponent<P, S> {\r\n  protected _composedComponentInstance: React.Component<P, S>;\r\n  private _hoisted: string[];\r\n\r\n  constructor() {\r\n    super();\r\n    this._updateComposedComponentRef = this._updateComposedComponentRef.bind(this);\r\n  }\r\n\r\n  /**\r\n   * Updates the ref to the component composed by the decorator, which will also take care of hoisting\r\n   * (and unhoisting as appropriate) methods from said component.\r\n   *\r\n   * Pass this method as the argument to the 'ref' property of the composed component.\r\n   */\r\n  protected _updateComposedComponentRef(composedComponentInstance: React.Component<P, S>) {\r\n    this._composedComponentInstance = composedComponentInstance;\r\n    if (composedComponentInstance) {\r\n      this._hoisted = hoistMethods(this, composedComponentInstance);\r\n    } else if (this._hoisted) {\r\n      unhoistMethods(this, this._hoisted);\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/utilities/decorators/BaseDecorator.ts","import * as React from 'react';\r\nimport { BaseDecorator } from './BaseDecorator';\r\nimport {\r\n  findScrollableParent,\r\n  getRect\r\n} from '../../Utilities';\r\n\r\nexport interface IViewport {\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\nexport interface IWithViewportState {\r\n  viewport?: IViewport;\r\n}\r\n\r\nconst RESIZE_DELAY = 500;\r\n\r\nexport function withViewport<P extends { viewport?: IViewport }, S>(ComposedComponent: (new (props: P, ...args: any[]) => React.Component<P, S>)): any {\r\n\r\n  return class WithViewportComponent extends BaseDecorator<P, IWithViewportState> {\r\n\r\n    public refs: {\r\n      [key: string]: React.ReactInstance;\r\n    };\r\n\r\n    constructor() {\r\n      super();\r\n\r\n      this.state = {\r\n        viewport: {\r\n          width: 0,\r\n          height: 0\r\n        }\r\n      };\r\n    }\r\n\r\n    public componentDidMount() {\r\n      this._onAsyncResize = this._async.debounce(\r\n        this._onAsyncResize,\r\n        RESIZE_DELAY,\r\n        {\r\n          leading: false\r\n        });\r\n\r\n      this._events.on(window, 'resize', this._onAsyncResize);\r\n      this._updateViewport();\r\n    }\r\n\r\n    public componentWillUnmount() {\r\n      this._events.dispose();\r\n    }\r\n\r\n    public render() {\r\n      let { viewport } = this.state;\r\n      let isViewportVisible = viewport.width > 0 && viewport.height > 0;\r\n\r\n      return (\r\n        <div className='ms-Viewport' ref='root' style={ { minWidth: 1, minHeight: 1 } }>\r\n          { isViewportVisible && (\r\n            <ComposedComponent ref={ this._updateComposedComponentRef } viewport={ viewport } { ...this.props } />\r\n          ) }\r\n        </div>\r\n      );\r\n    }\r\n\r\n    public forceUpdate() {\r\n      this._updateViewport(true);\r\n    }\r\n\r\n    private _onAsyncResize() {\r\n      this._updateViewport();\r\n    }\r\n\r\n    private _updateViewport(withForceUpdate?: boolean) {\r\n      let { viewport } = this.state;\r\n      let viewportElement = (this.refs as any).root;\r\n      let scrollElement = findScrollableParent(viewportElement);\r\n      let scrollRect = getRect(scrollElement);\r\n      let clientRect = getRect(viewportElement);\r\n      let updateComponent = () => {\r\n        if (withForceUpdate && this._composedComponentInstance) {\r\n          this._composedComponentInstance.forceUpdate();\r\n        }\r\n      };\r\n\r\n      let isSizeChanged = (\r\n        clientRect.width !== viewport.width ||\r\n        scrollRect.height !== viewport.height);\r\n\r\n      if (isSizeChanged) {\r\n        this.setState({\r\n          viewport: {\r\n            width: clientRect.width,\r\n            height: scrollRect.height\r\n          }\r\n        }, updateComponent);\r\n      } else {\r\n        updateComponent();\r\n      }\r\n    }\r\n  };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/utilities/decorators/withViewport.tsx","import * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport { EventGroup } from '../../Utilities';\r\nimport {\r\n  IDragDropHelper,\r\n  IDragDropTarget,\r\n  IDragDropOptions,\r\n  IDragDropEvent,\r\n  IDragDropContext\r\n} from './interfaces';\r\nimport { ISelection } from '../../utilities/selection/interfaces';\r\n\r\nconst DISTANCE_FOR_DRAG_SQUARED = 25; // the minimum mouse move distance to treat it as drag event\r\nconst MOUSEDOWN_PRIMARY_BUTTON = 0; // for mouse down event we are using ev.button property, 0 means left button\r\nconst MOUSEMOVE_PRIMARY_BUTTON = 1; // for mouse move event we are using ev.buttons property, 1 means left button\r\n\r\nexport interface IDragDropHelperParams {\r\n  selection: ISelection;\r\n}\r\n\r\nexport class DragDropHelper implements IDragDropHelper {\r\n  private _dragEnterCounts: { [key: string]: number };\r\n  private _isDragging: boolean;\r\n  private _dragData: {\r\n    eventTarget: EventTarget;\r\n    clientX: number;\r\n    clientY: number;\r\n    dataTransfer?: DataTransfer;\r\n    dropTarget?: IDragDropTarget;\r\n    dragTarget?: IDragDropTarget;\r\n  };\r\n  private _selection: ISelection;\r\n  private _activeTargets: {\r\n    [key: string]: {\r\n      target: IDragDropTarget;\r\n      dispose: () => void;\r\n    };\r\n  };\r\n  private _events: EventGroup;\r\n  private _lastId: number;\r\n\r\n  constructor(params: IDragDropHelperParams) {\r\n    this._selection = params.selection;\r\n    this._dragEnterCounts = {};\r\n    this._activeTargets = {};\r\n    this._lastId = 0;\r\n\r\n    this._events = new EventGroup(this);\r\n    // clear drag data when mouse up, use capture event to ensure it will be run\r\n    this._events.on(document.body, 'mouseup', this._onMouseUp.bind(this), true);\r\n    this._events.on(document, 'mouseup', this._onDocumentMouseUp.bind(this), true);\r\n  }\r\n\r\n  public dispose() {\r\n    this._events.dispose();\r\n  }\r\n\r\n  public subscribe(root: HTMLElement, events: EventGroup, dragDropOptions: IDragDropOptions): {\r\n    key: string;\r\n    dispose(): void;\r\n  } {\r\n    const {\r\n      key = `${++this._lastId}`\r\n    } = dragDropOptions;\r\n\r\n    const handlers: {\r\n      callback: (context: IDragDropContext, event?: any) => void;\r\n      eventName: string;\r\n    }[] = [];\r\n\r\n    let onDragLeave: (event: DragEvent) => void;\r\n    let onDragEnter: (event: DragEvent) => void;\r\n    let onDragEnd: (event: DragEvent) => void;\r\n    let onDrop: (event: DragEvent) => void;\r\n    let onDragOver: (event: DragEvent) => void;\r\n    let onMouseDown: (event: MouseEvent) => void;\r\n\r\n    let isDraggable: boolean;\r\n    let isDroppable: boolean;\r\n\r\n    let activeTarget: {\r\n      target: IDragDropTarget;\r\n      dispose: () => void;\r\n    };\r\n\r\n    if (dragDropOptions && root) {\r\n      const {\r\n        eventMap,\r\n        context,\r\n        updateDropState\r\n      } = dragDropOptions;\r\n\r\n      const dragDropTarget: IDragDropTarget = {\r\n        root: root,\r\n        options: dragDropOptions,\r\n        key: key\r\n      };\r\n\r\n      isDraggable = this._isDraggable(dragDropTarget);\r\n      isDroppable = this._isDroppable(dragDropTarget);\r\n\r\n      if (isDraggable || isDroppable) {\r\n        if (eventMap) {\r\n          for (const event of eventMap) {\r\n            const handler = {\r\n              callback: event.callback.bind(null, context),\r\n              eventName: event.eventName\r\n            };\r\n\r\n            handlers.push(handler);\r\n\r\n            this._events.on(root, handler.eventName, handler.callback);\r\n          }\r\n        }\r\n      }\r\n\r\n      if (isDroppable) {\r\n        // If the target is droppable, wire up global event listeners to track drop-related events.\r\n        onDragLeave = (event: DragEvent) => {\r\n          if (!(event as IDragDropEvent).isHandled) {\r\n            (event as IDragDropEvent).isHandled = true;\r\n            this._dragEnterCounts[key]--;\r\n            if (this._dragEnterCounts[key] === 0) {\r\n              updateDropState(false /* isDropping */, event);\r\n            }\r\n          }\r\n        };\r\n\r\n        onDragEnter = (event: DragEvent) => {\r\n          event.preventDefault(); // needed for IE\r\n          if (!(event as IDragDropEvent).isHandled) {\r\n            (event as IDragDropEvent).isHandled = true;\r\n            this._dragEnterCounts[key]++;\r\n            if (this._dragEnterCounts[key] === 1) {\r\n              updateDropState(true /* isDropping */, event);\r\n            }\r\n          }\r\n        };\r\n\r\n        onDragEnd = (event: DragEvent) => {\r\n          this._dragEnterCounts[key] = 0;\r\n          updateDropState(false /* isDropping */, event);\r\n        };\r\n\r\n        onDrop = (event: DragEvent) => {\r\n          this._dragEnterCounts[key] = 0;\r\n          updateDropState(false /* isDropping */, event);\r\n\r\n          if (dragDropOptions.onDrop) {\r\n            dragDropOptions.onDrop(dragDropOptions.context.data, event);\r\n          }\r\n        };\r\n\r\n        onDragOver = (event: DragEvent) => {\r\n          event.preventDefault();\r\n        };\r\n\r\n        this._dragEnterCounts[key] = 0;\r\n\r\n        // dragenter and dragleave will be fired when hover to the child element\r\n        // but we only want to change state when enter or leave the current element\r\n        // use the count to ensure it.\r\n        events.on(root, 'dragenter', onDragEnter);\r\n        events.on(root, 'dragleave', onDragLeave);\r\n        events.on(root, 'dragend', onDragEnd);\r\n        events.on(root, 'drop', onDrop);\r\n        events.on(root, 'dragover', onDragOver);\r\n      }\r\n\r\n      if (isDraggable) {\r\n        // If the target is draggable, wire up local event listeners for mouse events.\r\n        onMouseDown = this._onMouseDown.bind(this, dragDropTarget);\r\n        onDragEnd = this._onDragEnd.bind(this, dragDropTarget);\r\n\r\n        events.on(root, 'mousedown', onMouseDown);\r\n        events.on(root, 'dragend', onDragEnd);\r\n      }\r\n\r\n      activeTarget = {\r\n        target: dragDropTarget,\r\n        dispose: () => {\r\n          if (this._activeTargets[key] === activeTarget) {\r\n            delete this._activeTargets[key];\r\n          }\r\n\r\n          if (root) {\r\n            for (const handler of handlers) {\r\n              this._events.off(root, handler.eventName, handler.callback);\r\n            }\r\n\r\n            if (isDroppable) {\r\n              events.off(root, 'dragenter', onDragEnter);\r\n              events.off(root, 'dragleave', onDragLeave);\r\n              events.off(root, 'dragend', onDragEnd);\r\n              events.off(root, 'dragover', onDragOver);\r\n              events.off(root, 'drop', onDrop);\r\n            }\r\n\r\n            if (isDraggable) {\r\n              events.off(root, 'mousedown', onMouseDown);\r\n              events.off(root, 'dragend', onDragEnd);\r\n            }\r\n          }\r\n        }\r\n      };\r\n\r\n      this._activeTargets[key] = activeTarget;\r\n    }\r\n\r\n    return {\r\n      key: key,\r\n      dispose: () => {\r\n        if (activeTarget) {\r\n          activeTarget.dispose();\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  public unsubscribe(root: HTMLElement, key: string): void {\r\n    const activeTarget = this._activeTargets[key];\r\n\r\n    if (activeTarget) {\r\n      activeTarget.dispose();\r\n    }\r\n  }\r\n\r\n  private _onDragEnd(target: IDragDropTarget, event: DragEvent) {\r\n    let { options } = target;\r\n    if (options.onDragEnd) {\r\n      options.onDragEnd(options.context.data, event);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * clear drag data when mouse up on body\r\n   */\r\n  private _onMouseUp(event: MouseEvent) {\r\n    this._isDragging = false;\r\n    if (this._dragData) {\r\n      for (const key of Object.keys(this._activeTargets)) {\r\n        const activeTarget = this._activeTargets[key];\r\n\r\n        if (activeTarget.target.root) {\r\n          this._events.off(activeTarget.target.root, 'mousemove');\r\n          this._events.off(activeTarget.target.root, 'mouseleave');\r\n        }\r\n      }\r\n\r\n      if (this._dragData.dropTarget) {\r\n        // raise dragleave event to let dropTarget know it need to remove dropping style\r\n        EventGroup.raise(this._dragData.dropTarget.root, 'dragleave');\r\n        EventGroup.raise(this._dragData.dropTarget.root, 'drop');\r\n      }\r\n    }\r\n    this._dragData = null;\r\n  }\r\n\r\n  /**\r\n   * clear drag data when mouse up outside of the document\r\n   */\r\n  private _onDocumentMouseUp(event: MouseEvent) {\r\n    if (event.target === document.documentElement) {\r\n      this._onMouseUp(event);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * when mouse move over a new drop target while dragging some items,\r\n   * fire dragleave on the old target and fire dragenter to the new target\r\n   * The target will handle style change on dragenter and dragleave events.\r\n   */\r\n  private _onMouseMove(target: IDragDropTarget, event: MouseEvent) {\r\n    let {\r\n      // use buttons property here since ev.button in some edge case is not updating well during the move.\r\n      // but firefox doesn't support it, so we set the default value when it is not defined.\r\n      buttons = MOUSEMOVE_PRIMARY_BUTTON\r\n    } = event;\r\n\r\n    if (this._dragData && buttons !== MOUSEMOVE_PRIMARY_BUTTON) {\r\n      // cancel mouse down event and return early when the primary button is not pressed\r\n      this._onMouseUp(event);\r\n      return;\r\n    }\r\n\r\n    let { root, options, key } = target;\r\n    if (this._isDragging) {\r\n      if (this._isDroppable(target)) {\r\n        // we can have nested drop targets in the DOM, like a folder inside a group. In that case, when we drag into\r\n        // the inner target (folder), we first set dropTarget to the inner element. But the same event is bubbled to the\r\n        // outer target too, and we need to prevent the outer one from taking over.\r\n        // So, check if the last dropTarget is not a child of the current.\r\n        if (this._dragData.dropTarget &&\r\n          this._dragData.dropTarget.key !== key &&\r\n          !this._isChild(root, this._dragData.dropTarget.root)) {\r\n          EventGroup.raise(this._dragData.dropTarget.root, 'dragleave');\r\n          this._dragData.dropTarget = null;\r\n        }\r\n\r\n        if (!this._dragData.dropTarget) {\r\n          EventGroup.raise(root, 'dragenter');\r\n          this._dragData.dropTarget = target;\r\n        }\r\n      }\r\n    } else if (this._dragData) {\r\n      if (this._isDraggable(target)) {\r\n        let xDiff = this._dragData.clientX - event.clientX;\r\n        let yDiff = this._dragData.clientY - event.clientY;\r\n        if (xDiff * xDiff + yDiff * yDiff >= DISTANCE_FOR_DRAG_SQUARED) {\r\n          if (this._dragData.dragTarget) {\r\n            this._isDragging = true;\r\n            if (options.onDragStart) {\r\n              options.onDragStart(options.context.data, options.context.index, this._selection.getSelection(), event);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * when mouse leave a target while dragging some items, fire dragleave to the target\r\n   */\r\n  private _onMouseLeave(target: IDragDropTarget, event: MouseEvent) {\r\n    if (this._isDragging) {\r\n      if (this._dragData && this._dragData.dropTarget && this._dragData.dropTarget.key === target.key) {\r\n        EventGroup.raise(target.root, 'dragleave');\r\n        this._dragData.dropTarget = null;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * when mouse down on a draggable item, we start to track dragdata.\r\n   */\r\n  private _onMouseDown(target: IDragDropTarget, event: MouseEvent) {\r\n    if (event.button !== MOUSEDOWN_PRIMARY_BUTTON) {\r\n      // Ignore anything except the primary button.\r\n      return;\r\n    }\r\n\r\n    if (this._isDraggable(target)) {\r\n      this._dragData = {\r\n        clientX: event.clientX,\r\n        clientY: event.clientY,\r\n        eventTarget: event.target,\r\n        dragTarget: target\r\n      };\r\n\r\n      for (const key of Object.keys(this._activeTargets)) {\r\n        const activeTarget = this._activeTargets[key];\r\n        if (activeTarget.target.root) {\r\n          this._events.on(activeTarget.target.root, 'mousemove', this._onMouseMove.bind(this, activeTarget.target));\r\n          this._events.on(activeTarget.target.root, 'mouseleave', this._onMouseLeave.bind(this, activeTarget.target));\r\n        }\r\n      }\r\n    } else {\r\n      this._dragData = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * determine whether the child target is a descendant of the parent\r\n   */\r\n  private _isChild(parent: React.ReactInstance, child: React.ReactInstance): boolean {\r\n    let parentElement = ReactDOM.findDOMNode(parent);\r\n    let childElement = ReactDOM.findDOMNode(child);\r\n    while (childElement && childElement.parentElement) {\r\n      if (childElement.parentElement === parentElement) {\r\n        return true;\r\n      }\r\n      childElement = childElement.parentElement;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private _isDraggable(target: IDragDropTarget): boolean {\r\n    let { options } = target;\r\n    return options.canDrag && options.canDrag(options.context.data);\r\n  }\r\n\r\n  private _isDroppable(target: IDragDropTarget): boolean {\r\n    // TODO: take the drag item into consideration to prevent dragging an item into the same group\r\n    let { options } = target;\r\n    let dragContext = this._dragData && this._dragData.dragTarget ? this._dragData.dragTarget.options.context : null;\r\n    return options.canDrop && options.canDrop(options.context, dragContext);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/utilities/dragdrop/DragDropHelper.tsx","import { IObjectWithKey, ISelection, SELECTION_CHANGE } from './interfaces';\r\nimport { EventGroup } from '../../Utilities';\r\n\r\nexport interface ISelectionOptions {\r\n  onSelectionChanged?: () => void;\r\n  getKey?: (item: IObjectWithKey, index?: number) => string;\r\n  canSelectItem?: (item: IObjectWithKey) => boolean;\r\n}\r\n\r\nexport class Selection implements ISelection {\r\n  public count: number;\r\n  public getKey: (item: IObjectWithKey, index?: number) => string;\r\n  public canSelectItem: (item: IObjectWithKey) => boolean;\r\n\r\n  private _changeEventSuppressionCount: number;\r\n  private _items: IObjectWithKey[];\r\n  private _selectedItems: IObjectWithKey[];\r\n  private _isAllSelected: boolean;\r\n  private _exemptedIndices: { [index: string]: boolean };\r\n  private _exemptedCount: number;\r\n  private _keyToIndexMap: { [key: string]: number };\r\n  private _anchoredIndex: number;\r\n  private _onSelectionChanged: () => void;\r\n  private _hasChanged: boolean;\r\n  private _unselectableIndices: { [index: string]: boolean };\r\n  private _unselectableCount: number;\r\n\r\n  constructor(options: ISelectionOptions = {}) {\r\n    let {\r\n      onSelectionChanged,\r\n      getKey,\r\n      canSelectItem = (item: IObjectWithKey) => { return true; }\r\n    } = options;\r\n    this.getKey = getKey || ((item: IObjectWithKey, index?: number) => (item ? item.key : String(index)));\r\n\r\n    this._changeEventSuppressionCount = 0;\r\n    this._exemptedCount = 0;\r\n    this._anchoredIndex = 0;\r\n    this._unselectableCount = 0;\r\n    this.setItems([], true);\r\n\r\n    this._onSelectionChanged = onSelectionChanged;\r\n    this.canSelectItem = canSelectItem;\r\n  }\r\n\r\n  public setChangeEvents(isEnabled: boolean, suppressChange?: boolean) {\r\n    this._changeEventSuppressionCount += isEnabled ? -1 : 1;\r\n\r\n    if (this._changeEventSuppressionCount === 0 && this._hasChanged) {\r\n      this._hasChanged = false;\r\n\r\n      if (!suppressChange) {\r\n        this._change();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Selection needs the items, call this method to set them. If the set\r\n   * of items is the same, this will re-evaluate selection and index maps.\r\n   * Otherwise, shouldClear should be set to true, so that selection is\r\n   * cleared.\r\n   */\r\n  public setItems(items: IObjectWithKey[], shouldClear = true) {\r\n    let newKeyToIndexMap: { [key: string]: number } = {};\r\n    let newUnselectableIndices: { [key: string]: boolean } = {};\r\n    let hasSelectionChanged = false;\r\n\r\n    this.setChangeEvents(false);\r\n\r\n    // Reset the unselectable count.\r\n    this._unselectableCount = 0;\r\n\r\n    // Build lookup table for quick selection evaluation.\r\n    for (let i = 0; i < items.length; i++) {\r\n      let item = items[i];\r\n\r\n      if (item) {\r\n        newKeyToIndexMap[this.getKey(item, i)] = i;\r\n      }\r\n\r\n      newUnselectableIndices[i] = item && !this.canSelectItem(item);\r\n      if (newUnselectableIndices[i]) {\r\n        this._unselectableCount++;\r\n      }\r\n    }\r\n\r\n    if (shouldClear) {\r\n      this.setAllSelected(false);\r\n    }\r\n\r\n    // Check the exemption list for discrepencies.\r\n    let newExemptedIndicies: { [key: string]: boolean } = {};\r\n\r\n    for (let indexProperty in this._exemptedIndices) {\r\n      if (this._exemptedIndices.hasOwnProperty(indexProperty)) {\r\n        let index = Number(indexProperty);\r\n        let item = this._items[index];\r\n        let exemptKey = item ? this.getKey(item, Number(index)) : undefined;\r\n        let newIndex = exemptKey ? newKeyToIndexMap[exemptKey] : index;\r\n\r\n        if (newIndex === undefined) {\r\n          // We don't know the index of the item any more so it's either moved or removed.\r\n          // In this case we reset the entire selection.\r\n          this.setAllSelected(false);\r\n          break;\r\n        } else {\r\n          // We know the new index of the item. update the existing exemption table.\r\n          newExemptedIndicies[newIndex] = true;\r\n          hasSelectionChanged = hasSelectionChanged || (newIndex !== index);\r\n        }\r\n      }\r\n    }\r\n\r\n    this._exemptedIndices = newExemptedIndicies;\r\n    this._keyToIndexMap = newKeyToIndexMap;\r\n    this._unselectableIndices = newUnselectableIndices;\r\n    this._items = items || [];\r\n\r\n    if (hasSelectionChanged) {\r\n      this._change();\r\n    }\r\n\r\n    this.setChangeEvents(true);\r\n  }\r\n\r\n  public getItems(): IObjectWithKey[] {\r\n    return this._items;\r\n  }\r\n\r\n  public getSelection(): IObjectWithKey[] {\r\n    if (!this._selectedItems) {\r\n      this._selectedItems = [];\r\n\r\n      for (let i = 0; i < this._items.length; i++) {\r\n        if (this.isIndexSelected(i)) {\r\n          this._selectedItems.push(this._items[i]);\r\n        }\r\n      }\r\n    }\r\n\r\n    return this._selectedItems;\r\n  }\r\n\r\n  public getSelectedCount(): number {\r\n    return this._isAllSelected ? (this._items.length - this._exemptedCount - this._unselectableCount) : (this._exemptedCount);\r\n  }\r\n\r\n  public isRangeSelected(fromIndex: number, count: number): boolean {\r\n    let endIndex = fromIndex + count;\r\n\r\n    for (let i = fromIndex; i < endIndex; i++) {\r\n      if (!this.isIndexSelected(i)) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  public isAllSelected(): boolean {\r\n    let selectableCount = this._items.length - this._unselectableCount;\r\n\r\n    return (\r\n      (this.count > 0) &&\r\n      (this._isAllSelected && this._exemptedCount === 0) ||\r\n      (!this._isAllSelected && (this._exemptedCount === selectableCount) && selectableCount > 0));\r\n  }\r\n\r\n  public isKeySelected(key: string): boolean {\r\n    let index = this._keyToIndexMap[key];\r\n\r\n    return this.isIndexSelected(index);\r\n  }\r\n\r\n  public isIndexSelected(index: number): boolean {\r\n    return !!(\r\n      (this.count > 0) &&\r\n      (this._isAllSelected && !this._exemptedIndices[index] && !this._unselectableIndices[index]) ||\r\n      (!this._isAllSelected && this._exemptedIndices[index]));\r\n  }\r\n\r\n  public setAllSelected(isAllSelected: boolean) {\r\n    let selectableCount = this._items ? (this._items.length - this._unselectableCount) : 0;\r\n\r\n    if (selectableCount > 0 && (this._exemptedCount > 0 || isAllSelected !== this._isAllSelected)) {\r\n      this._exemptedIndices = {};\r\n      this._exemptedCount = 0;\r\n      this._isAllSelected = isAllSelected;\r\n      this._updateCount();\r\n    }\r\n  }\r\n\r\n  public setKeySelected(key: string, isSelected: boolean, shouldAnchor: boolean) {\r\n    let index = this._keyToIndexMap[key];\r\n\r\n    if (index >= 0) {\r\n      this.setIndexSelected(index, isSelected, shouldAnchor);\r\n    }\r\n  }\r\n\r\n  public setIndexSelected(index: number, isSelected: boolean, shouldAnchor: boolean) {\r\n    // Clamp the index.\r\n    index = Math.min(Math.max(0, index), this._items.length - 1);\r\n\r\n    // No-op on out of bounds selections.\r\n    if (index < 0 || index >= this._items.length) {\r\n      return;\r\n    }\r\n\r\n    let isExempt = this._exemptedIndices[index];\r\n    let hasChanged = false;\r\n    let canSelect = !this._unselectableIndices[index];\r\n\r\n    if (canSelect) {\r\n      // Determine if we need to remove the exemption.\r\n      if (isExempt && (\r\n        (isSelected && this._isAllSelected) ||\r\n        (!isSelected && !this._isAllSelected)\r\n      )) {\r\n        hasChanged = true;\r\n        delete this._exemptedIndices[index];\r\n        this._exemptedCount--;\r\n      }\r\n\r\n      // Determine if we need to add the exemption.\r\n      if (!isExempt && (\r\n        (isSelected && !this._isAllSelected) ||\r\n        (!isSelected && this._isAllSelected)\r\n      )) {\r\n        hasChanged = true;\r\n        this._exemptedIndices[index] = true;\r\n        this._exemptedCount++;\r\n      }\r\n\r\n      if (shouldAnchor) {\r\n        this._anchoredIndex = index;\r\n      }\r\n    }\r\n\r\n    if (hasChanged) {\r\n      this._updateCount();\r\n    }\r\n  }\r\n\r\n  public selectToKey(key: string, clearSelection?: boolean) {\r\n    this.selectToIndex(this._keyToIndexMap[key], clearSelection);\r\n  }\r\n\r\n  public selectToIndex(index: number, clearSelection?: boolean) {\r\n    let anchorIndex = this._anchoredIndex || 0;\r\n    let startIndex = Math.min(index, anchorIndex);\r\n    let endIndex = Math.max(index, anchorIndex);\r\n\r\n    this.setChangeEvents(false);\r\n\r\n    if (clearSelection) {\r\n      this.setAllSelected(false);\r\n    }\r\n\r\n    for (; startIndex <= endIndex; startIndex++) {\r\n      this.setIndexSelected(startIndex, true, false);\r\n    }\r\n\r\n    this.setChangeEvents(true);\r\n  }\r\n\r\n  public toggleAllSelected() {\r\n    this.setAllSelected(!this.isAllSelected());\r\n  }\r\n\r\n  public toggleKeySelected(key: string) {\r\n    this.setKeySelected(key, !this.isKeySelected(key), true);\r\n  }\r\n\r\n  public toggleIndexSelected(index: number) {\r\n    this.setIndexSelected(index, !this.isIndexSelected(index), true);\r\n  }\r\n\r\n  public toggleRangeSelected(fromIndex: number, count: number) {\r\n    let isRangeSelected = this.isRangeSelected(fromIndex, count);\r\n    let endIndex = fromIndex + count;\r\n\r\n    this.setChangeEvents(false);\r\n    for (let i = fromIndex; i < endIndex; i++) {\r\n      this.setIndexSelected(i, !isRangeSelected, false);\r\n    }\r\n    this.setChangeEvents(true);\r\n  }\r\n\r\n  private _updateCount() {\r\n    this.count = this.getSelectedCount();\r\n    this._change();\r\n  }\r\n\r\n  private _change() {\r\n    if (this._changeEventSuppressionCount === 0) {\r\n      this._selectedItems = null;\r\n\r\n      EventGroup.raise(this, SELECTION_CHANGE);\r\n\r\n      if (this._onSelectionChanged) {\r\n        this._onSelectionChanged();\r\n      }\r\n    } else {\r\n      this._hasChanged = true;\r\n    }\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/utilities/selection/Selection.ts","import * as React from 'react';\r\nimport {\r\n  BaseComponent,\r\n  KeyCodes,\r\n  autobind,\r\n  elementContains,\r\n  findScrollableParent,\r\n  getParent,\r\n  getDocument,\r\n  getWindow,\r\n  isElementTabbable\r\n} from '../../Utilities';\r\nimport { SelectionLayout } from './SelectionLayout';\r\nimport {\r\n  ISelection,\r\n  ISelectionLayout,\r\n  SelectionDirection,\r\n  SelectionMode\r\n} from './interfaces';\r\n\r\n// Selection definitions:\r\n//\r\n// Anchor index: the point from which a range selection starts.\r\n// Focus index: the point from which layout movement originates from.\r\n//\r\n// These two can differ. Tests:\r\n//\r\n// If you start at index 5\r\n// Shift click to index 10\r\n//    The focus is 10, the anchor is 5.\r\n// If you shift click at index 0\r\n//    The anchor remains at 5, the items between 0 and 5 are selected and everything else is cleared.\r\n// If you click index 8\r\n//    The anchor and focus are set to 8.\r\n\r\nconst SELECTION_DISABLED_ATTRIBUTE_NAME = 'data-selection-disabled';\r\nconst SELECTION_INDEX_ATTRIBUTE_NAME = 'data-selection-index';\r\nconst SELECTION_TOGGLE_ATTRIBUTE_NAME = 'data-selection-toggle';\r\nconst SELECTION_INVOKE_ATTRIBUTE_NAME = 'data-selection-invoke';\r\nconst SELECTALL_TOGGLE_ALL_ATTRIBUTE_NAME = 'data-selection-all-toggle';\r\n\r\nexport interface ISelectionZoneProps extends React.Props<SelectionZone> {\r\n  selection: ISelection;\r\n  layout?: ISelectionLayout;\r\n  selectionMode?: SelectionMode;\r\n  selectionPreservedOnEmptyClick?: boolean;\r\n  isSelectedOnFocus?: boolean;\r\n  onItemInvoked?: (item?: any, index?: number, ev?: Event) => void;\r\n  onItemContextMenu?: (item?: any, index?: number, ev?: Event) => void;\r\n}\r\n\r\nexport class SelectionZone extends BaseComponent<ISelectionZoneProps, {}> {\r\n  public static defaultProps = {\r\n    layout: new SelectionLayout(SelectionDirection.vertical),\r\n    isMultiSelectEnabled: true,\r\n    isSelectedOnFocus: true,\r\n    selectionMode: SelectionMode.multiple\r\n  };\r\n\r\n  public refs: {\r\n    [key: string]: React.ReactInstance,\r\n    root: HTMLElement\r\n  };\r\n\r\n  private _isCtrlPressed: boolean;\r\n  private _isShiftPressed: boolean;\r\n  private _isMetaPressed: boolean;\r\n  private _shouldHandleFocus: boolean;\r\n\r\n  public componentDidMount() {\r\n    let win = getWindow(this.refs.root);\r\n    let scrollElement = findScrollableParent(this.refs.root);\r\n\r\n    // Track the latest modifier keys globally.\r\n    this._events.on(win, 'keydown keyup', this._updateModifiers);\r\n    this._events.on(scrollElement, 'click', this._tryClearOnEmptyClick);\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <div\r\n        className='ms-SelectionZone'\r\n        ref='root'\r\n        onKeyDown={ this._onKeyDown }\r\n        onMouseDown={ this._onMouseDown }\r\n        onClick={ this._onClick }\r\n\r\n        onDoubleClick={ this._onDoubleClick }\r\n        onContextMenu={ this._onContextMenu }\r\n        { ...{\r\n          onMouseDownCapture: this._onMouseDownCapture,\r\n          onFocusCapture: this._onFocus\r\n        } }\r\n      >\r\n        { this.props.children }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * In some cases, the consuming scenario requires to set focus on a row without having SelectionZone\r\n   * react to the event. Note that focus events in IE <= 11 will occur asynchronously after .focus() has\r\n   * been called on an element, so we need a flag to store the idea that we will bypass the \"next\"\r\n   * focus event that occurs. This method does that.\r\n   */\r\n  @autobind\r\n  public ignoreNextFocus() {\r\n    this._shouldHandleFocus = false;\r\n  }\r\n\r\n  @autobind\r\n  private _onMouseDownCapture(ev) {\r\n    if (document.activeElement !== ev.target && !elementContains(document.activeElement as HTMLElement, ev.target)) {\r\n      this.ignoreNextFocus();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * When we focus an item, for single/multi select scenarios, we should try to select it immediately\r\n   * as long as the focus did not originate from a mouse down/touch event. For those cases, we handle them\r\n   * specially.\r\n   */\r\n  @autobind\r\n  private _onFocus(ev: React.FocusEvent<HTMLElement>) {\r\n    let target = ev.target as HTMLElement;\r\n    let { selection, selectionMode } = this.props;\r\n    let isToggleModifierPressed = this._isCtrlPressed || this._isMetaPressed;\r\n\r\n    if (this._shouldHandleFocus && selectionMode !== SelectionMode.none) {\r\n      let isToggle = this._hasAttribute(target, SELECTION_TOGGLE_ATTRIBUTE_NAME);\r\n      let itemRoot = this._findItemRoot(target);\r\n\r\n      if (!isToggle && itemRoot) {\r\n        let index = this._getItemIndex(itemRoot);\r\n\r\n        if (isToggleModifierPressed) {\r\n          // set anchor only.\r\n          selection.setIndexSelected(index, selection.isIndexSelected(index), true);\r\n        } else {\r\n          this._onItemSurfaceClick(ev, index);\r\n        }\r\n      }\r\n    }\r\n\r\n    this._shouldHandleFocus = false;\r\n  }\r\n\r\n  @autobind\r\n  private _onMouseDown(ev: React.MouseEvent<HTMLElement>) {\r\n    this._updateModifiers(ev);\r\n\r\n    let target = ev.target as HTMLElement;\r\n    let itemRoot = this._findItemRoot(target);\r\n\r\n    while (target !== this.refs.root) {\r\n      if (this._hasAttribute(target, SELECTALL_TOGGLE_ALL_ATTRIBUTE_NAME)) {\r\n        break;\r\n      } else if (itemRoot) {\r\n        if (this._hasAttribute(target, SELECTION_TOGGLE_ATTRIBUTE_NAME)) {\r\n          break;\r\n        } else if (this._hasAttribute(target, SELECTION_INVOKE_ATTRIBUTE_NAME)) {\r\n          this._onInvokeMouseDown(ev, this._getItemIndex(itemRoot));\r\n          break;\r\n        } else if (target === itemRoot) {\r\n          break;\r\n        }\r\n      }\r\n\r\n      target = getParent(target);\r\n    }\r\n  }\r\n\r\n  @autobind\r\n  private _onClick(ev: React.MouseEvent<HTMLElement>) {\r\n    this._updateModifiers(ev);\r\n\r\n    let target = ev.target as HTMLElement;\r\n    let itemRoot = this._findItemRoot(target);\r\n\r\n    // No-op if selection is disabled\r\n    if (this._isSelectionDisabled(target)) {\r\n      return;\r\n    }\r\n\r\n    while (target !== this.refs.root) {\r\n      if (this._hasAttribute(target, SELECTALL_TOGGLE_ALL_ATTRIBUTE_NAME)) {\r\n        this._onToggleAllClick(ev);\r\n        break;\r\n      } else if (itemRoot) {\r\n        let index = this._getItemIndex(itemRoot);\r\n\r\n        if (this._hasAttribute(target, SELECTION_TOGGLE_ATTRIBUTE_NAME)) {\r\n          if (this._isShiftPressed) {\r\n            this._onItemSurfaceClick(ev, index);\r\n          } else {\r\n            this._onToggleClick(ev, index);\r\n          }\r\n          break;\r\n        } else if (this._hasAttribute(target, SELECTION_INVOKE_ATTRIBUTE_NAME)) {\r\n          this._onInvokeClick(ev, index);\r\n          break;\r\n        } else if (target === itemRoot) {\r\n          this._onItemSurfaceClick(ev, index);\r\n          break;\r\n        }\r\n      }\r\n\r\n      target = getParent(target);\r\n    }\r\n  }\r\n\r\n  @autobind\r\n  private _onContextMenu(ev: React.MouseEvent<HTMLElement>) {\r\n    const target = ev.target as HTMLElement;\r\n\r\n    const { onItemContextMenu, selection } = this.props;\r\n    if (onItemContextMenu) {\r\n      const itemRoot = this._findItemRoot(target);\r\n\r\n      if (itemRoot) {\r\n        const index = this._getItemIndex(itemRoot);\r\n        onItemContextMenu(selection.getItems()[index], index, ev.nativeEvent);\r\n        ev.preventDefault();\r\n      }\r\n    }\r\n  }\r\n\r\n  private _isSelectionDisabled(target: HTMLElement): boolean {\r\n    while (target !== this.refs.root) {\r\n      if (this._hasAttribute(target, SELECTION_DISABLED_ATTRIBUTE_NAME)) {\r\n        return true;\r\n      }\r\n      target = getParent(target);\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * In multi selection, if you double click within an item's root (but not within the invoke element or input elements),\r\n   * we should execute the invoke handler.\r\n   */\r\n  @autobind\r\n  private _onDoubleClick(ev: React.MouseEvent<HTMLElement>) {\r\n    let target = ev.target as HTMLElement;\r\n\r\n    if (this._isSelectionDisabled(target)) {\r\n      return;\r\n    }\r\n\r\n    let { selectionMode, onItemInvoked } = this.props;\r\n    let itemRoot = this._findItemRoot(target);\r\n\r\n    if (itemRoot && onItemInvoked && selectionMode !== SelectionMode.none && !this._isInputElement(target)) {\r\n      let index = this._getItemIndex(itemRoot);\r\n\r\n      while (target !== this.refs.root) {\r\n        if (\r\n          this._hasAttribute(target, SELECTION_TOGGLE_ATTRIBUTE_NAME) ||\r\n          this._hasAttribute(target, SELECTION_INVOKE_ATTRIBUTE_NAME)) {\r\n          break;\r\n        } else if (target === itemRoot) {\r\n          this._onInvokeClick(ev, index);\r\n          break;\r\n        }\r\n\r\n        target = getParent(target);\r\n      }\r\n\r\n      target = getParent(target);\r\n    }\r\n  }\r\n\r\n  @autobind\r\n  private _onKeyDown(ev: React.KeyboardEvent<HTMLElement>) {\r\n    this._updateModifiers(ev);\r\n\r\n    let target = ev.target as HTMLElement;\r\n\r\n    if (this._isSelectionDisabled(target)) {\r\n      return;\r\n    }\r\n\r\n    let { selection, selectionMode } = this.props;\r\n    let isSelectAllKey = ev.which === KeyCodes.a && (this._isCtrlPressed || this._isMetaPressed);\r\n    let isClearSelectionKey = ev.which === KeyCodes.escape;\r\n\r\n    // Ignore key downs from input elements.\r\n    if (this._isInputElement(target)) {\r\n      return;\r\n    }\r\n\r\n    // If ctrl-a is pressed, select all (if all are not already selected.)\r\n    if (isSelectAllKey && selectionMode === SelectionMode.multiple && !selection.isAllSelected()) {\r\n      selection.setAllSelected(true);\r\n      ev.stopPropagation();\r\n      ev.preventDefault();\r\n      return;\r\n    }\r\n\r\n    // If escape is pressed, clear selection (if any are selected.)\r\n    if (isClearSelectionKey && selection.getSelectedCount() > 0) {\r\n      selection.setAllSelected(false);\r\n      ev.stopPropagation();\r\n      ev.preventDefault();\r\n      return;\r\n    }\r\n\r\n    let itemRoot = this._findItemRoot(target);\r\n\r\n    // If a key was pressed within an item, we should treat \"enters\" as invokes and \"space\" as toggle\r\n    if (itemRoot) {\r\n      let index = this._getItemIndex(itemRoot);\r\n\r\n      while (target !== this.refs.root) {\r\n        if (this._hasAttribute(target, SELECTION_TOGGLE_ATTRIBUTE_NAME)) {\r\n          // For toggle elements, assuming they are rendered as buttons, they will generate a click event,\r\n          // so we can no-op for any keydowns in this case.\r\n          break;\r\n        } else if (target === itemRoot) {\r\n          if (ev.which === KeyCodes.enter) {\r\n            this._onInvokeClick(ev, index);\r\n            ev.preventDefault();\r\n            return;\r\n          } else if (ev.which === KeyCodes.space) {\r\n            this._onToggleClick(ev, index);\r\n            ev.preventDefault();\r\n            return;\r\n          }\r\n          break;\r\n        }\r\n\r\n        target = getParent(target);\r\n      }\r\n\r\n      // A key was pressed while an item in this zone was focused.\r\n      this._shouldHandleFocus = true;\r\n    }\r\n  }\r\n\r\n  private _onToggleAllClick(ev: React.MouseEvent<HTMLElement>) {\r\n    let { selection, selectionMode } = this.props;\r\n\r\n    if (selectionMode === SelectionMode.multiple) {\r\n      selection.toggleAllSelected();\r\n      ev.stopPropagation();\r\n      ev.preventDefault();\r\n    }\r\n  }\r\n\r\n  private _onToggleClick(ev: React.MouseEvent<HTMLElement> | React.KeyboardEvent<HTMLElement>, index: number) {\r\n    let { selection, selectionMode } = this.props;\r\n\r\n    if (selectionMode === SelectionMode.multiple) {\r\n      selection.toggleIndexSelected(index);\r\n    } else if (selectionMode === SelectionMode.single) {\r\n      let isSelected = selection.isIndexSelected(index);\r\n      selection.setChangeEvents(false);\r\n      selection.setAllSelected(false);\r\n      selection.setIndexSelected(index, !isSelected, true);\r\n      selection.setChangeEvents(true);\r\n    } else {\r\n      return;\r\n    }\r\n\r\n    ev.stopPropagation();\r\n\r\n    // NOTE: ev.preventDefault is not called for toggle clicks, because this will kill the browser behavior\r\n    // for checkboxes if you use a checkbox for the toggle.\r\n  }\r\n\r\n  private _onInvokeClick(ev: React.MouseEvent<HTMLElement> | React.KeyboardEvent<HTMLElement>, index: number) {\r\n    let { selection, onItemInvoked } = this.props;\r\n\r\n    if (onItemInvoked) {\r\n      onItemInvoked(selection.getItems()[index], index, ev.nativeEvent);\r\n      ev.preventDefault();\r\n      ev.stopPropagation();\r\n    }\r\n  }\r\n\r\n  private _onItemSurfaceClick(ev: React.SyntheticEvent<HTMLElement>, index: number) {\r\n    let { selection, selectionMode } = this.props;\r\n    let isToggleModifierPressed = this._isCtrlPressed || this._isMetaPressed;\r\n\r\n    if (selectionMode === SelectionMode.multiple) {\r\n      if (this._isShiftPressed) {\r\n        selection.selectToIndex(index, !isToggleModifierPressed);\r\n      } else if (isToggleModifierPressed) {\r\n        selection.toggleIndexSelected(index);\r\n      } else {\r\n        this._clearAndSelectIndex(index);\r\n      }\r\n    } else if (selectionMode === SelectionMode.single) {\r\n      this._clearAndSelectIndex(index);\r\n    }\r\n  }\r\n\r\n  private _onInvokeMouseDown(ev: React.MouseEvent<HTMLElement> | React.KeyboardEvent<HTMLElement>, index: number) {\r\n    let { selection } = this.props;\r\n\r\n    // Only do work if item is not selected.\r\n    if (selection.isIndexSelected(index)) {\r\n      return;\r\n    }\r\n\r\n    this._clearAndSelectIndex(index);\r\n  }\r\n\r\n  private _tryClearOnEmptyClick(ev: MouseEvent) {\r\n    if (\r\n      !this.props.selectionPreservedOnEmptyClick &&\r\n      this._isNonHandledClick(ev.target as HTMLElement)\r\n    ) {\r\n      this.props.selection.setAllSelected(false);\r\n    }\r\n  }\r\n\r\n  private _clearAndSelectIndex(index: number) {\r\n    let { selection } = this.props;\r\n    let isAlreadySingleSelected = selection.getSelectedCount() === 1 && selection.isIndexSelected(index);\r\n\r\n    if (!isAlreadySingleSelected) {\r\n      selection.setChangeEvents(false);\r\n      selection.setAllSelected(false);\r\n      selection.setIndexSelected(index, true, true);\r\n      selection.setChangeEvents(true);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * We need to track the modifier key states so that when focus events occur, which do not contain\r\n   * modifier states in the Event object, we know how to behave.\r\n   */\r\n  private _updateModifiers(ev: React.KeyboardEvent<HTMLElement> | React.MouseEvent<HTMLElement>) {\r\n    this._isShiftPressed = ev.shiftKey;\r\n    this._isCtrlPressed = ev.ctrlKey;\r\n    this._isMetaPressed = ev.metaKey;\r\n  }\r\n\r\n  private _findItemRoot(target: HTMLElement): HTMLElement {\r\n    let { selection } = this.props;\r\n\r\n    while (target !== this.refs.root) {\r\n      let indexValue = target.getAttribute(SELECTION_INDEX_ATTRIBUTE_NAME);\r\n      let index = Number(indexValue);\r\n\r\n      if (indexValue !== null && index >= 0 && index < selection.getItems().length) {\r\n        break;\r\n      }\r\n\r\n      target = getParent(target);\r\n    }\r\n\r\n    if (target === this.refs.root) {\r\n      return undefined;\r\n    }\r\n\r\n    return target;\r\n  }\r\n\r\n  private _getItemIndex(itemRoot: HTMLElement): number {\r\n    return Number(itemRoot.getAttribute(SELECTION_INDEX_ATTRIBUTE_NAME));\r\n  }\r\n\r\n  private _hasAttribute(element: HTMLElement, attributeName: string): boolean {\r\n    let isToggle = false;\r\n\r\n    while (!isToggle && element !== this.refs.root) {\r\n      isToggle = element.getAttribute(attributeName) === 'true';\r\n      element = getParent(element);\r\n    }\r\n\r\n    return isToggle;\r\n  }\r\n\r\n  private _isInputElement(element: HTMLElement): boolean {\r\n    return element.tagName === 'INPUT' || element.tagName === 'TEXTAREA';\r\n  }\r\n\r\n  private _isNonHandledClick(element: HTMLElement): boolean {\r\n    let doc = getDocument();\r\n\r\n    if (doc && element) {\r\n      while (element && element !== doc.documentElement) {\r\n        if (isElementTabbable(element)) {\r\n          return false;\r\n        }\r\n\r\n        element = getParent(element);\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/utilities/selection/SelectionZone.tsx","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/process/browser.js\n// module id = 104\n// module chunks = 0","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 105\n// module chunks = 0"],"sourceRoot":""}